2025-09-01 15:44:06.589 +03:00 [INF] This is a test log to file!
2025-09-01 15:44:06.935 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 15:44:06.947 +03:00 [INF] API configured successfully.
2025-09-01 15:44:07.046 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 15:44:07.102 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 15:44:08.280 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:44:08.323 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 15:44:08.332 +03:00 [INF] Registered 13 endpoints in 1,621 milliseconds.
2025-09-01 15:44:08.343 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:44:08.381 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:44:08.479 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:44:08.491 +03:00 [DBG] Created DbConnection. (10ms).
2025-09-01 15:44:08.494 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:08.501 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:44:08.506 +03:00 [DBG] Created DbConnection. (5ms).
2025-09-01 15:44:08.513 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:08.526 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:08.531 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:08.538 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 15:44:08.545 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:08.548 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:08.551 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 15:44:08.556 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:08.561 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:44:08.564 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-09-01 15:44:08.570 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:44:08.605 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:44:08.610 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:08.611 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:44:08.612 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:44:08.614 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:44:08.6098399+00:00');
SELECT changes();
2025-09-01 15:44:08.632 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:44:08.6098399+00:00');
SELECT changes();
2025-09-01 15:44:08.692 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:44:08.696 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:44:08.699 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 15:44:08.701 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 15:44:08.703 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (4ms).
2025-09-01 15:44:08.705 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:44:08.707 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:44:08.711 +03:00 [DBG] Committing transaction.
2025-09-01 15:44:08.713 +03:00 [DBG] Committed transaction.
2025-09-01 15:44:08.715 +03:00 [DBG] Disposing transaction.
2025-09-01 15:44:08.719 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:44:08.720 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:44:08.724 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:44:08.725 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 15:44:08.727 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:08.729 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:08.730 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:08.732 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:44:08.734 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:08.735 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:44:08.736 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:44:08.738 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:44:08.741 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:44:08.745 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:44:08.746 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:44:08.747 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 15:44:08.750 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:44:08.752 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:44:08.757 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:08.760 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 15:44:08.766 +03:00 [INF] Applying migration '20250831091732_setdatabasenameinprofile'.
2025-09-01 15:44:08.771 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 15:44:08.772 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 15:44:08.773 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 15:44:08.775 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Profiles" ADD "DatabaseName" TEXT NOT NULL DEFAULT '';
2025-09-01 15:44:08.778 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Profiles" ADD "DatabaseName" TEXT NOT NULL DEFAULT '';
2025-09-01 15:44:08.780 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 15:44:08.782 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 15:44:08.783 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 15:44:08.784 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250831091732_setdatabasenameinprofile', '9.0.8');
2025-09-01 15:44:08.787 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250831091732_setdatabasenameinprofile', '9.0.8');
2025-09-01 15:44:08.790 +03:00 [DBG] Committing transaction.
2025-09-01 15:44:08.793 +03:00 [DBG] Committed transaction.
2025-09-01 15:44:08.794 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:08.795 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:44:08.797 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:44:08.798 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:44:08.801 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:44:08.803 +03:00 [DBG] Disposing transaction.
2025-09-01 15:44:08.805 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:08.809 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-09-01 15:44:08.811 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:44:08.812 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:08.813 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:44:08.815 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:44:08.815 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:44:08.846 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 15:44:08.893 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 15:44:08.896 +03:00 [DBG] Hosting starting
2025-09-01 15:44:08.911 +03:00 [DBG] Middleware loaded
2025-09-01 15:44:08.915 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 15:44:08.917 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 15:44:09.022 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 15:44:09.024 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 15:44:09.026 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 15:44:09.082 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 15:44:09.352 +03:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5000: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-09-01 15:44:26.204 +03:00 [INF] This is a test log to file!
2025-09-01 15:44:26.441 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 15:44:26.450 +03:00 [INF] API configured successfully.
2025-09-01 15:44:26.524 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 15:44:26.566 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 15:44:27.074 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:44:27.111 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 15:44:27.120 +03:00 [INF] Registered 13 endpoints in 824 milliseconds.
2025-09-01 15:44:27.129 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:44:27.162 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:44:27.240 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:44:27.252 +03:00 [DBG] Created DbConnection. (10ms).
2025-09-01 15:44:27.256 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:27.261 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:44:27.263 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 15:44:27.265 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:27.272 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:27.275 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:27.279 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:44:27.280 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:27.282 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:27.284 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 15:44:27.288 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:27.292 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:44:27.294 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-09-01 15:44:27.299 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:44:27.317 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:44:27.320 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:27.321 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 15:44:27.321 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:44:27.323 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:44:27.3201461+00:00');
SELECT changes();
2025-09-01 15:44:27.328 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:44:27.3201461+00:00');
SELECT changes();
2025-09-01 15:44:27.376 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:44:27.379 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:44:27.381 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 15:44:27.382 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 15:44:27.384 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 15:44:27.385 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:44:27.387 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:44:27.390 +03:00 [DBG] Committing transaction.
2025-09-01 15:44:27.392 +03:00 [DBG] Committed transaction.
2025-09-01 15:44:27.394 +03:00 [DBG] Disposing transaction.
2025-09-01 15:44:27.396 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:44:27.397 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:44:27.399 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:44:27.400 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 15:44:27.401 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:27.403 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:27.405 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:27.406 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:44:27.408 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:27.409 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:44:27.411 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:44:27.413 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:44:27.415 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:44:27.418 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:44:27.420 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:44:27.421 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 15:44:27.423 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:44:27.426 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:44:27.431 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:27.434 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 15:44:27.439 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 15:44:27.440 +03:00 [DBG] Committing transaction.
2025-09-01 15:44:27.441 +03:00 [DBG] Committed transaction.
2025-09-01 15:44:27.442 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:44:27.444 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:44:27.445 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:44:27.447 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:44:27.452 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:44:27.454 +03:00 [DBG] Disposing transaction.
2025-09-01 15:44:27.456 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:44:27.459 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 15:44:27.461 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:44:27.462 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:44:27.463 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:44:27.464 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:44:27.465 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:44:27.489 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 15:44:27.516 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 15:44:27.517 +03:00 [DBG] Hosting starting
2025-09-01 15:44:27.530 +03:00 [DBG] Middleware loaded
2025-09-01 15:44:27.533 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 15:44:27.534 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 15:44:27.598 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 15:44:27.600 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 15:44:27.602 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 15:44:27.628 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 15:44:27.664 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 15:44:27.665 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 15:44:27.666 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 15:44:27.667 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 15:44:27.668 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 15:44:27.668 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 15:44:27.674 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 15:44:27.687 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 15:44:27.821 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 15:44:27.822 +03:00 [INF] Hosting environment: Development
2025-09-01 15:44:27.823 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 15:44:27.824 +03:00 [DBG] Hosting started
2025-09-01 15:46:33.052 +03:00 [INF] This is a test log to file!
2025-09-01 15:46:33.338 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 15:46:33.345 +03:00 [INF] API configured successfully.
2025-09-01 15:46:33.429 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 15:46:33.491 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 15:46:34.011 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:46:34.086 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 15:46:34.097 +03:00 [INF] Registered 13 endpoints in 931 milliseconds.
2025-09-01 15:46:34.106 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:46:34.159 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:46:34.273 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:46:34.285 +03:00 [DBG] Created DbConnection. (9ms).
2025-09-01 15:46:34.288 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 15:46:34.292 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:46:34.295 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 15:46:34.297 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:46:34.307 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:46:34.311 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:46:34.315 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:46:34.316 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:46:34.318 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:46:34.320 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 15:46:34.324 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:46:34.328 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:46:34.330 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-09-01 15:46:34.335 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:46:34.352 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:46:34.355 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:46:34.356 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:46:34.357 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:46:34.358 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:46:34.355385+00:00');
SELECT changes();
2025-09-01 15:46:34.366 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:46:34.355385+00:00');
SELECT changes();
2025-09-01 15:46:34.404 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:46:34.406 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:46:34.408 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 15:46:34.409 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 15:46:34.410 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 15:46:34.411 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:46:34.413 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:46:34.414 +03:00 [DBG] Committing transaction.
2025-09-01 15:46:34.416 +03:00 [DBG] Committed transaction.
2025-09-01 15:46:34.417 +03:00 [DBG] Disposing transaction.
2025-09-01 15:46:34.419 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:46:34.420 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:46:34.422 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:46:34.424 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 15:46:34.425 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:46:34.426 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:46:34.427 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:46:34.429 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:46:34.430 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:46:34.431 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 15:46:34.432 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:46:34.433 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:46:34.434 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:46:34.437 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:46:34.438 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:46:34.439 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 15:46:34.441 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:46:34.443 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:46:34.447 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:46:34.449 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 15:46:34.453 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 15:46:34.454 +03:00 [DBG] Committing transaction.
2025-09-01 15:46:34.454 +03:00 [DBG] Committed transaction.
2025-09-01 15:46:34.455 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:46:34.457 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:46:34.458 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 15:46:34.459 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:46:34.468 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:46:34.470 +03:00 [DBG] Disposing transaction.
2025-09-01 15:46:34.471 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:46:34.474 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 15:46:34.475 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:46:34.476 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:46:34.477 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 15:46:34.478 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:46:34.479 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:46:34.498 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 15:46:34.524 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 15:46:34.525 +03:00 [DBG] Hosting starting
2025-09-01 15:46:34.537 +03:00 [DBG] Middleware loaded
2025-09-01 15:46:34.539 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 15:46:34.541 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 15:46:34.602 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 15:46:34.603 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 15:46:34.605 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 15:46:34.633 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 15:46:34.663 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 15:46:34.665 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 15:46:34.666 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 15:46:34.666 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 15:46:34.667 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 15:46:34.668 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 15:46:34.673 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 15:46:34.680 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 15:46:34.761 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 15:46:34.763 +03:00 [INF] Hosting environment: Development
2025-09-01 15:46:34.764 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 15:46:34.765 +03:00 [DBG] Hosting started
2025-09-01 15:47:07.512 +03:00 [DBG] Connection id "0HNF9AMKHMS7U" received FIN.
2025-09-01 15:47:07.524 +03:00 [DBG] Connection id "0HNF9AMKHMS7U" accepted.
2025-09-01 15:47:07.532 +03:00 [DBG] Connection id "0HNF9AMKHMS7U" started.
2025-09-01 15:47:07.534 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" accepted.
2025-09-01 15:47:07.535 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" started.
2025-09-01 15:47:07.538 +03:00 [DBG] Connection id "0HNF9AMKHMS7U" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 15:47:07.541 +03:00 [DBG] Connection id "0HNF9AMKHMS7U" disconnecting.
2025-09-01 15:47:07.543 +03:00 [DBG] Connection id "0HNF9AMKHMS7U" stopped.
2025-09-01 15:47:07.560 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/providers - null null
2025-09-01 15:47:07.600 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-09-01 15:47:07.602 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-09-01 15:47:07.627 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 15:47:07.631 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/providers'.
2025-09-01 15:47:07.633 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" completed keep alive response.
2025-09-01 15:47:07.635 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/providers - 307 0 null 79.3777ms
2025-09-01 15:47:07.639 +03:00 [DBG] Connection id "0HNF9AMKHMS80" accepted.
2025-09-01 15:47:07.639 +03:00 [DBG] Connection id "0HNF9AMKHMS80" received FIN.
2025-09-01 15:47:07.639 +03:00 [DBG] Connection id "0HNF9AMKHMS81" accepted.
2025-09-01 15:47:07.646 +03:00 [DBG] Connection id "0HNF9AMKHMS80" started.
2025-09-01 15:47:07.648 +03:00 [DBG] Connection id "0HNF9AMKHMS81" started.
2025-09-01 15:47:07.649 +03:00 [DBG] Connection id "0HNF9AMKHMS80" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 15:47:07.650 +03:00 [DBG] Connection id "0HNF9AMKHMS80" disconnecting.
2025-09-01 15:47:07.651 +03:00 [DBG] Connection id "0HNF9AMKHMS80" stopped.
2025-09-01 15:47:07.690 +03:00 [DBG] Connection 0HNF9AMKHMS81 established using the following protocol: "Tls13"
2025-09-01 15:47:07.695 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-09-01 15:47:07.699 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-09-01 15:47:07.700 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-09-01 15:47:07.705 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-09-01 15:47:07.716 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:47:07.747 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-09-01 15:47:07.750 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:47:07.751 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:47:07.754 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 58.8548ms
2025-09-01 15:47:12.871 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/servers/SqlServer - null null
2025-09-01 15:47:12.874 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-09-01 15:47:12.876 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-09-01 15:47:12.878 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-09-01 15:47:12.890 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/servers/SqlServer'.
2025-09-01 15:47:12.891 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" completed keep alive response.
2025-09-01 15:47:12.892 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/servers/SqlServer - 307 0 null 20.9166ms
2025-09-01 15:47:12.893 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-09-01 15:47:12.897 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-09-01 15:47:12.898 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-09-01 15:47:12.900 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-09-01 15:47:12.901 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-09-01 15:47:12.911 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:47:12.937 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-09-01 15:47:12.940 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-09-01 15:47:12.953 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-09-01 15:47:13.283 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-09-01 15:47:13.289 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-09-01 15:47:13.486 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-09-01 15:47:13.567 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-09-01 15:47:13.568 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-09-01 15:47:13.573 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-09-01 15:47:13.577 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:47:13.578 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:47:13.579 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 685.932ms
2025-09-01 15:47:16.466 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-09-01 15:47:16.470 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-09-01 15:47:16.471 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-09-01 15:47:16.473 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-09-01 15:47:16.474 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5%5CSQLEXPRESS'.
2025-09-01 15:47:16.475 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" completed keep alive response.
2025-09-01 15:47:16.476 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 307 0 null 11.0079ms
2025-09-01 15:47:16.476 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-09-01 15:47:16.480 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-09-01 15:47:16.481 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-09-01 15:47:16.483 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-09-01 15:47:16.484 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-09-01 15:47:16.486 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:47:16.491 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 15:47:16.499 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-09-01 15:47:16.501 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 15:47:17.086 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 15:47:17.089 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-09-01 15:47:17.091 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:47:17.092 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:47:17.093 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 616.7942ms
2025-09-01 15:47:21.269 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 185
2025-09-01 15:47:21.273 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-01 15:47:21.273 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:21.274 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-09-01 15:47:21.275 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" completed keep alive response.
2025-09-01 15:47:21.276 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 6.2752ms
2025-09-01 15:47:21.276 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-09-01 15:47:21.280 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-01 15:47:21.281 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:21.281 +03:00 [DBG] Connection id "0HNF9AMKHMS7V", Request id "0HNF9AMKHMS7V:00000004": started reading request body.
2025-09-01 15:47:21.282 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:21.283 +03:00 [DBG] Connection id "0HNF9AMKHMS7V", Request id "0HNF9AMKHMS7V:00000004": done reading request body.
2025-09-01 15:47:21.284 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:47:21.307 +03:00 [DBG] Connection id "0HNF9AMKHMS81", Request id "0HNF9AMKHMS81:00000004": started reading request body.
2025-09-01 15:47:21.309 +03:00 [DBG] Connection id "0HNF9AMKHMS81", Request id "0HNF9AMKHMS81:00000004": done reading request body.
2025-09-01 15:47:21.319 +03:00 [INF] Creating profile for provider "SqlServer"
2025-09-01 15:47:21.320 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:47:21.387 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:47:21.400 +03:00 [DBG] Saved secret profile-7db72d2b-13ee-4946-a974-a0698050485f for provider "SqlServer"
2025-09-01 15:47:21.401 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-09-01 15:47:21.450 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => p.DatabaseName.Equals(__profile_DatabaseName_0))'
2025-09-01 15:47:21.584 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 15:47:21.611 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:47:21.612 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 15:47:21.614 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:21.617 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:21.618 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:47:21.619 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:47:21.621 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 15:47:21.624 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-01 15:47:21.631 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-01 15:47:21.638 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:21.640 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-09-01 15:47:21.643 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:21.644 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:47:21.678 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 15:47:21.726 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 15:47:21.731 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 15:47:21.744 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 15:47:21.749 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-09-01 15:47:21.751 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 15:47:21.751 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 15:47:21.791 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:21.792 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:21.794 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:47:21.795 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:47:21.797 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 15:47:21.798 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 16), @p4='?' (Size = 28), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-09-01 15:47:21.807 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 16), @p4='?' (Size = 28), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-09-01 15:47:21.811 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:21.812 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 15:47:21.813 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:21.814 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:47:21.820 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 15:47:21.822 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-09-01 15:47:21.824 +03:00 [INF] Profile created successfully with Id "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 15:47:21.827 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:21.828 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:47:21.829 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:47:21.831 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:21.832 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:47:21.833 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 556.8338ms
2025-09-01 15:47:25.191 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 185
2025-09-01 15:47:25.194 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-01 15:47:25.195 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:25.196 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-09-01 15:47:25.197 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" completed keep alive response.
2025-09-01 15:47:25.198 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 6.4492ms
2025-09-01 15:47:25.198 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-09-01 15:47:25.201 +03:00 [DBG] Connection id "0HNF9AMKHMS7V", Request id "0HNF9AMKHMS7V:00000005": started reading request body.
2025-09-01 15:47:25.202 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-01 15:47:25.203 +03:00 [DBG] Connection id "0HNF9AMKHMS7V", Request id "0HNF9AMKHMS7V:00000005": done reading request body.
2025-09-01 15:47:25.204 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:25.206 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:25.207 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:47:25.209 +03:00 [DBG] Connection id "0HNF9AMKHMS81", Request id "0HNF9AMKHMS81:00000005": started reading request body.
2025-09-01 15:47:25.210 +03:00 [DBG] Connection id "0HNF9AMKHMS81", Request id "0HNF9AMKHMS81:00000005": done reading request body.
2025-09-01 15:47:25.211 +03:00 [INF] Creating profile for provider "SqlServer"
2025-09-01 15:47:25.212 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:47:25.213 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:47:25.237 +03:00 [DBG] Saved secret profile-24d4f14f-362a-465b-888c-e52f46d6018c for provider "SqlServer"
2025-09-01 15:47:25.238 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-09-01 15:47:25.242 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:47:25.243 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 15:47:25.244 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:25.245 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:25.246 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:47:25.246 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:47:25.248 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:47:25.249 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-01 15:47:25.250 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-01 15:47:25.253 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:25.254 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 15:47:25.255 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:25.256 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:47:25.434 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-09-01 15:47:25.480 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A profile for SqlServer - ProductInventory already exists.
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 28
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 56
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 15:47:25.500 +03:00 [ERR] Unhandled exception occurred.
2025-09-01 15:47:25.507 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:47:25.508 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:47:25.509 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:25.510 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:47:25.512 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 313.608ms
2025-09-01 15:47:32.252 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-09-01 15:47:32.254 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-09-01 15:47:32.255 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-09-01 15:47:32.256 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-09-01 15:47:32.257 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" completed keep alive response.
2025-09-01 15:47:32.258 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 6.394ms
2025-09-01 15:47:32.258 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/health - null null
2025-09-01 15:47:32.262 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-09-01 15:47:32.263 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-09-01 15:47:32.264 +03:00 [INF] Executing endpoint 'HTTP: GET api/health'
2025-09-01 15:47:32.269 +03:00 [INF] Health check sent.
2025-09-01 15:47:32.270 +03:00 [INF] Executed endpoint 'HTTP: GET api/health'
2025-09-01 15:47:32.271 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:47:32.272 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/health - 200 null application/json; charset=utf-8 13.9424ms
2025-09-01 15:47:34.167 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-09-01 15:47:34.170 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-01 15:47:34.171 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 15:47:34.172 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-09-01 15:47:34.173 +03:00 [DBG] Connection id "0HNF9AMKHMS7V" completed keep alive response.
2025-09-01 15:47:34.174 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 7.4676ms
2025-09-01 15:47:34.175 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-09-01 15:47:34.178 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-01 15:47:34.179 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 15:47:34.180 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 15:47:34.181 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:47:34.184 +03:00 [INF] Listing all profiles
2025-09-01 15:47:34.191 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()'
2025-09-01 15:47:34.201 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 15:47:34.261 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Profile>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Profile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Profile instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Profile);
                (object)dataReader.GetGuid(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                            {
                                return 
                                {
                                    Profile instance;
                                    instance = new Profile();
                                    instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                    instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                    instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                    instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Profile)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetGuid(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (Profile)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                Query entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    Query instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(Query);
                    dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                {
                                    return 
                                    {
                                        Query instance;
                                        instance = new Query();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                        instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                        instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                        instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                        instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                        instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Query)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                    entity: namelessParameter{11}, 
                    value: namelessParameter{12}, 
                    forMaterialization: True);
                return namelessParameter{12}.<Profile>k__BackingField = namelessParameter{11};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (Profile)(resultContext.Values[0]) : default(Profile);
    }, 
    contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-09-01 15:47:34.268 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:47:34.269 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 15:47:34.270 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:34.271 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.272 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:47:34.273 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:47:34.274 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:47:34.275 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-01 15:47:34.276 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-01 15:47:34.284 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.285 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-09-01 15:47:34.286 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.287 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 15:47:34.289 +03:00 [INF] Fetching connection string for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 15:47:34.291 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 15:47:34.293 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 15:47:34.307 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 15:47:34.313 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:34.314 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.315 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:47:34.316 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:47:34.317 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:47:34.317 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:47:34.319 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:47:34.322 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 15:47:34.325 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.326 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 15:47:34.327 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.328 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 15:47:34.348 +03:00 [DBG] Fetched secret for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 15:47:34.350 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 15:47:34.351 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:34.352 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.353 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:47:34.354 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:47:34.355 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:47:34.356 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:47:34.358 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:47:34.359 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 15:47:34.360 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.361 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 15:47:34.362 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:47:34.363 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 15:47:34.364 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 15:47:34.371 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 15:47:34.372 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:47:34.373 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:47:34.374 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:47:34.375 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:47:34.376 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 201.1907ms
2025-09-01 15:49:15.886 +03:00 [DBG] Connection id "0HNF9AMKHMS82" received FIN.
2025-09-01 15:49:15.888 +03:00 [DBG] Connection id "0HNF9AMKHMS82" accepted.
2025-09-01 15:49:15.893 +03:00 [DBG] Connection id "0HNF9AMKHMS82" started.
2025-09-01 15:49:15.893 +03:00 [DBG] Connection id "0HNF9AMKHMS83" accepted.
2025-09-01 15:49:15.898 +03:00 [DBG] Connection id "0HNF9AMKHMS82" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 15:49:15.899 +03:00 [DBG] Connection id "0HNF9AMKHMS83" started.
2025-09-01 15:49:15.900 +03:00 [DBG] Connection id "0HNF9AMKHMS82" disconnecting.
2025-09-01 15:49:15.900 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:15.901 +03:00 [DBG] Connection id "0HNF9AMKHMS82" stopped.
2025-09-01 15:49:15.902 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:15.904 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:15.906 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:15.907 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-09-01 15:49:15.907 +03:00 [DBG] Connection id "0HNF9AMKHMS83" completed keep alive response.
2025-09-01 15:49:15.908 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - 307 0 null 7.7048ms
2025-09-01 15:49:15.909 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:15.910 +03:00 [DBG] Connection id "0HNF9AMKHMS83", Request id "0HNF9AMKHMS83:00000001": started reading request body.
2025-09-01 15:49:15.913 +03:00 [DBG] Connection id "0HNF9AMKHMS83", Request id "0HNF9AMKHMS83:00000001": done reading request body.
2025-09-01 15:49:15.912 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:15.914 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:15.915 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:15.916 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:15.918 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:15.921 +03:00 [DBG] Connection id "0HNF9AMKHMS81", Request id "0HNF9AMKHMS81:00000008": started reading request body.
2025-09-01 15:49:15.922 +03:00 [DBG] Connection id "0HNF9AMKHMS81", Request id "0HNF9AMKHMS81:00000008": done reading request body.
2025-09-01 15:49:15.927 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:15.928 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:15.929 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:15.930 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:49:15.931 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:15.932 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 23.017ms
2025-09-01 15:49:23.255 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - null null
2025-09-01 15:49:23.257 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-09-01 15:49:23.258 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-09-01 15:49:23.259 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 15:49:23.260 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 15:49:23.260 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:23.265 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:49:23.266 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 15:49:23.266 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:23.267 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:23.268 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:49:23.269 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:49:23.269 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:49:23.270 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:49:23.271 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:49:23.273 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:23.273 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 15:49:23.274 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:23.275 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 15:49:23.351 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 15:49:23.385 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: No profile found with id: b4be75ee-37e6-4e39-9593-766e259f5729
   at NaturalToQuery.Application.Services.ProfileService.GetProfileDtoAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 209
   at NaturalToQuery.Api.Controllers.Query.GetProfile.HandleAsync(GetProfileRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\GetProfile.cs:line 26
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 15:49:23.388 +03:00 [ERR] Unhandled exception occurred.
2025-09-01 15:49:23.389 +03:00 [DBG] Connection id "0HNF9AMKHMS81" completed keep alive response.
2025-09-01 15:49:23.390 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:23.391 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:23.392 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:49:23.393 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - 500 null application/json; charset=utf-8 138.242ms
2025-09-01 15:49:41.986 +03:00 [INF] This is a test log to file!
2025-09-01 15:49:42.288 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 15:49:42.294 +03:00 [INF] API configured successfully.
2025-09-01 15:49:42.368 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 15:49:42.416 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 15:49:42.821 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:42.851 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 15:49:42.859 +03:00 [INF] Registered 13 endpoints in 769 milliseconds.
2025-09-01 15:49:42.866 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:42.898 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:42.974 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:49:42.983 +03:00 [DBG] Created DbConnection. (7ms).
2025-09-01 15:49:42.986 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:42.990 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:49:42.993 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 15:49:42.994 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:43.001 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:43.005 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:43.008 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:49:43.010 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:43.012 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:43.014 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 15:49:43.018 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:49:43.022 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:49:43.023 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-09-01 15:49:43.028 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:49:43.045 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 15:49:43.049 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:49:43.050 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 15:49:43.051 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:49:43.052 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:49:43.0492704+00:00');
SELECT changes();
2025-09-01 15:49:43.057 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 12:49:43.0492704+00:00');
SELECT changes();
2025-09-01 15:49:43.101 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:49:43.106 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:49:43.109 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 15:49:43.111 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 15:49:43.114 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (4ms).
2025-09-01 15:49:43.115 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:49:43.118 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 15:49:43.121 +03:00 [DBG] Committing transaction.
2025-09-01 15:49:43.123 +03:00 [DBG] Committed transaction.
2025-09-01 15:49:43.126 +03:00 [DBG] Disposing transaction.
2025-09-01 15:49:43.128 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 15:49:43.130 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 15:49:43.132 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:49:43.133 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 15:49:43.134 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:43.135 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:43.136 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:43.138 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:49:43.140 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:49:43.141 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:49:43.142 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 15:49:43.143 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:49:43.145 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 15:49:43.147 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:49:43.148 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:49:43.149 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 15:49:43.150 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:49:43.152 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 15:49:43.155 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:43.157 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 15:49:43.160 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 15:49:43.161 +03:00 [DBG] Committing transaction.
2025-09-01 15:49:43.162 +03:00 [DBG] Committed transaction.
2025-09-01 15:49:43.163 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 15:49:43.163 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 15:49:43.164 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 15:49:43.166 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:49:43.173 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 15:49:43.174 +03:00 [DBG] Disposing transaction.
2025-09-01 15:49:43.175 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:49:43.178 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 15:49:43.179 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:43.179 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:49:43.180 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 15:49:43.181 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:49:43.182 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 15:49:43.203 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 15:49:43.226 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 15:49:43.228 +03:00 [DBG] Hosting starting
2025-09-01 15:49:43.239 +03:00 [DBG] Middleware loaded
2025-09-01 15:49:43.241 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 15:49:43.243 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 15:49:43.302 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 15:49:43.304 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 15:49:43.306 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 15:49:43.333 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 15:49:43.389 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 15:49:43.390 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 15:49:43.391 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 15:49:43.392 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 15:49:43.392 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 15:49:43.393 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 15:49:43.398 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 15:49:43.404 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 15:49:43.483 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 15:49:43.484 +03:00 [INF] Hosting environment: Development
2025-09-01 15:49:43.484 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 15:49:43.485 +03:00 [DBG] Hosting started
2025-09-01 15:49:54.236 +03:00 [DBG] Connection id "0HNF9AO67N8EH" received FIN.
2025-09-01 15:49:54.241 +03:00 [DBG] Connection id "0HNF9AO67N8EH" accepted.
2025-09-01 15:49:54.242 +03:00 [DBG] Connection id "0HNF9AO67N8EH" started.
2025-09-01 15:49:54.244 +03:00 [DBG] Connection id "0HNF9AO67N8EI" accepted.
2025-09-01 15:49:54.245 +03:00 [DBG] Connection id "0HNF9AO67N8EI" started.
2025-09-01 15:49:54.248 +03:00 [DBG] Connection id "0HNF9AO67N8EH" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 15:49:54.250 +03:00 [DBG] Connection id "0HNF9AO67N8EH" disconnecting.
2025-09-01 15:49:54.252 +03:00 [DBG] Connection id "0HNF9AO67N8EH" stopped.
2025-09-01 15:49:54.268 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:54.300 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:54.302 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:54.304 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:54.324 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 15:49:54.327 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-09-01 15:49:54.329 +03:00 [DBG] Connection id "0HNF9AO67N8EI" completed keep alive response.
2025-09-01 15:49:54.331 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - 307 0 null 67.3676ms
2025-09-01 15:49:54.332 +03:00 [DBG] Connection id "0HNF9AO67N8EJ" received FIN.
2025-09-01 15:49:54.332 +03:00 [DBG] Connection id "0HNF9AO67N8EK" accepted.
2025-09-01 15:49:54.331 +03:00 [DBG] Connection id "0HNF9AO67N8EJ" accepted.
2025-09-01 15:49:54.340 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000001": started reading request body.
2025-09-01 15:49:54.340 +03:00 [DBG] Connection id "0HNF9AO67N8EK" started.
2025-09-01 15:49:54.341 +03:00 [DBG] Connection id "0HNF9AO67N8EJ" started.
2025-09-01 15:49:54.343 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000001": done reading request body.
2025-09-01 15:49:54.344 +03:00 [DBG] Connection id "0HNF9AO67N8EJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 15:49:54.346 +03:00 [DBG] Connection id "0HNF9AO67N8EJ" disconnecting.
2025-09-01 15:49:54.347 +03:00 [DBG] Connection id "0HNF9AO67N8EJ" stopped.
2025-09-01 15:49:54.371 +03:00 [DBG] Connection 0HNF9AO67N8EK established using the following protocol: "Tls13"
2025-09-01 15:49:54.373 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:54.376 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:54.377 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:54.379 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:54.382 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:54.393 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:54.423 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000001": started reading request body.
2025-09-01 15:49:54.426 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000001": done reading request body.
2025-09-01 15:49:54.454 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:54.681 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:54.693 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:54.696 +03:00 [DBG] Connection id "0HNF9AO67N8EK" completed keep alive response.
2025-09-01 15:49:54.698 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:54.700 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 326.5599ms
2025-09-01 15:49:56.387 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:56.391 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:56.392 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:56.394 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:56.396 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-09-01 15:49:56.397 +03:00 [DBG] Connection id "0HNF9AO67N8EI" completed keep alive response.
2025-09-01 15:49:56.406 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:56.407 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - 307 0 null 19.7781ms
2025-09-01 15:49:56.409 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:56.412 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000002": started reading request body.
2025-09-01 15:49:56.413 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:56.414 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000002": done reading request body.
2025-09-01 15:49:56.415 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:56.417 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:56.426 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:56.428 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000002": started reading request body.
2025-09-01 15:49:56.429 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000002": done reading request body.
2025-09-01 15:49:56.431 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:56.433 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:56.435 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:56.436 +03:00 [DBG] Connection id "0HNF9AO67N8EK" completed keep alive response.
2025-09-01 15:49:56.437 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:56.438 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 31.6554ms
2025-09-01 15:49:57.194 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:57.197 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.198 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.199 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.199 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-09-01 15:49:57.200 +03:00 [DBG] Connection id "0HNF9AO67N8EI" completed keep alive response.
2025-09-01 15:49:57.201 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - 307 0 null 7.3544ms
2025-09-01 15:49:57.201 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:57.203 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000003": started reading request body.
2025-09-01 15:49:57.205 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.206 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000003": done reading request body.
2025-09-01 15:49:57.207 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.209 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.210 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.212 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:57.213 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000003": started reading request body.
2025-09-01 15:49:57.214 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000003": done reading request body.
2025-09-01 15:49:57.216 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:57.217 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:57.218 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.219 +03:00 [DBG] Connection id "0HNF9AO67N8EK" completed keep alive response.
2025-09-01 15:49:57.220 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:57.221 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 20.075ms
2025-09-01 15:49:57.957 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:57.961 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.961 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.963 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.964 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-09-01 15:49:57.965 +03:00 [DBG] Connection id "0HNF9AO67N8EI" completed keep alive response.
2025-09-01 15:49:57.966 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - 307 0 null 8.4266ms
2025-09-01 15:49:57.966 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:57.969 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000004": started reading request body.
2025-09-01 15:49:57.971 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.971 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000004": done reading request body.
2025-09-01 15:49:57.972 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:57.974 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.975 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.976 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:57.977 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000004": started reading request body.
2025-09-01 15:49:57.978 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000004": done reading request body.
2025-09-01 15:49:57.980 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:57.981 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:57.983 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:57.984 +03:00 [DBG] Connection id "0HNF9AO67N8EK" completed keep alive response.
2025-09-01 15:49:57.985 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:57.986 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 20.3843ms
2025-09-01 15:49:58.574 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:58.576 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:58.579 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:58.579 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:58.580 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-09-01 15:49:58.581 +03:00 [DBG] Connection id "0HNF9AO67N8EI" completed keep alive response.
2025-09-01 15:49:58.582 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/test/SqlServer - 307 0 null 7.6884ms
2025-09-01 15:49:58.582 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - application/json 177
2025-09-01 15:49:58.585 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:58.584 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000005": started reading request body.
2025-09-01 15:49:58.586 +03:00 [DBG] Endpoint 'HTTP: POST api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-09-01 15:49:58.587 +03:00 [DBG] Connection id "0HNF9AO67N8EI", Request id "0HNF9AO67N8EI:00000005": done reading request body.
2025-09-01 15:49:58.588 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:58.590 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:58.591 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:49:58.592 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000005": started reading request body.
2025-09-01 15:49:58.593 +03:00 [DBG] Connection id "0HNF9AO67N8EK", Request id "0HNF9AO67N8EK:00000005": done reading request body.
2025-09-01 15:49:58.594 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:58.595 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 15:49:58.596 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/test/{ProviderType}'
2025-09-01 15:49:58.597 +03:00 [DBG] Connection id "0HNF9AO67N8EK" completed keep alive response.
2025-09-01 15:49:58.598 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:49:58.598 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 16.4972ms
2025-09-01 15:50:09.216 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema - null null
2025-09-01 15:50:09.219 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema'
2025-09-01 15:50:09.220 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema'
2025-09-01 15:50:09.221 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-09-01 15:50:09.225 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema'.
2025-09-01 15:50:09.226 +03:00 [DBG] Connection id "0HNF9AO67N8EI" completed keep alive response.
2025-09-01 15:50:09.226 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema - 307 0 null 10.8342ms
2025-09-01 15:50:09.227 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema - null null
2025-09-01 15:50:09.230 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema'
2025-09-01 15:50:09.231 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema'
2025-09-01 15:50:09.232 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-09-01 15:50:09.234 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-09-01 15:50:09.236 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 15:50:09.286 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 15:50:09.323 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 15:50:09.487 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 15:50:09.514 +03:00 [DBG] Creating DbConnection.
2025-09-01 15:50:09.514 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 15:50:09.516 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:50:09.519 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:50:09.520 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 15:50:09.520 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 15:50:09.523 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 15:50:09.525 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:50:09.530 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 15:50:09.535 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:50:09.536 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 15:50:09.538 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 15:50:09.539 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:50:09.678 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-09-01 15:50:09.716 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: No profile found with id: b458b95d-ec32-4211-a1bb-cf62d85604b6
   at NaturalToQuery.Application.Services.ProfileService.GetProviderTypeAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 200
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 61
   at NaturalToQuery.Application.Services.ProfileDbService.GetSchemaAsync(Guid profileId, Boolean forceRefresh, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 45
   at NaturalToQuery.Api.Controllers.Query.GetSchema.HandleAsync(GetSchemaRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\GetSchema.cs:line 39
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 15:50:09.726 +03:00 [ERR] Unhandled exception occurred.
2025-09-01 15:50:09.731 +03:00 [DBG] Connection id "0HNF9AO67N8EK" completed keep alive response.
2025-09-01 15:50:09.733 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 15:50:09.735 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 15:50:09.736 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 15:50:09.737 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/b458b95d-ec32-4211-a1bb-cf62d85604b6/schema - 500 null application/json; charset=utf-8 510.5006ms
2025-09-01 16:11:55.945 +03:00 [INF] This is a test log to file!
2025-09-01 16:11:56.310 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 16:11:56.320 +03:00 [INF] API configured successfully.
2025-09-01 16:11:56.443 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 16:11:56.509 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 16:11:57.110 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:11:57.150 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:11:57.163 +03:00 [INF] Registered 13 endpoints in 1,071 milliseconds.
2025-09-01 16:11:57.177 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:11:57.246 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:11:57.355 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:11:57.374 +03:00 [DBG] Created DbConnection. (16ms).
2025-09-01 16:11:57.376 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 16:11:57.381 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:11:57.390 +03:00 [DBG] Created DbConnection. (9ms).
2025-09-01 16:11:57.392 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:11:57.405 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:11:57.412 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:11:57.417 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 16:11:57.418 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:11:57.421 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:11:57.424 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 16:11:57.430 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:11:57.436 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 16:11:57.440 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (9ms).
2025-09-01 16:11:57.447 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:11:57.468 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:11:57.472 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:11:57.473 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:11:57.473 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:11:57.474 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:11:57.4717731+00:00');
SELECT changes();
2025-09-01 16:11:57.482 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:11:57.4717731+00:00');
SELECT changes();
2025-09-01 16:11:57.566 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:11:57.571 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:11:57.577 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 16:11:57.579 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 16:11:57.592 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (15ms).
2025-09-01 16:11:57.594 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:11:57.596 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:11:57.599 +03:00 [DBG] Committing transaction.
2025-09-01 16:11:57.601 +03:00 [DBG] Committed transaction.
2025-09-01 16:11:57.616 +03:00 [DBG] Disposing transaction.
2025-09-01 16:11:57.619 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:11:57.620 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:11:57.623 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:11:57.624 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:11:57.625 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:11:57.627 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:11:57.631 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:11:57.641 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (9ms).
2025-09-01 16:11:57.642 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:11:57.643 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 16:11:57.644 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:11:57.645 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:11:57.653 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:11:57.656 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:11:57.658 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:11:57.660 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 16:11:57.662 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:11:57.664 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:11:57.667 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:11:57.671 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 16:11:57.680 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 16:11:57.681 +03:00 [DBG] Committing transaction.
2025-09-01 16:11:57.681 +03:00 [DBG] Committed transaction.
2025-09-01 16:11:57.682 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:11:57.683 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 16:11:57.684 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:11:57.685 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:11:57.690 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:11:57.693 +03:00 [DBG] Disposing transaction.
2025-09-01 16:11:57.696 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:11:57.701 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-09-01 16:11:57.702 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:11:57.703 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:11:57.704 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:11:57.705 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:11:57.706 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:11:57.735 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 16:11:57.768 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 16:11:57.770 +03:00 [DBG] Hosting starting
2025-09-01 16:11:57.786 +03:00 [DBG] Middleware loaded
2025-09-01 16:11:57.796 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 16:11:57.798 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 16:11:57.889 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 16:11:57.894 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 16:11:57.896 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 16:11:57.931 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 16:11:57.977 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 16:11:57.977 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 16:11:57.978 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 16:11:57.979 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 16:11:57.980 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 16:11:57.981 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 16:11:57.987 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:11:57.996 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:11:58.107 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 16:11:58.108 +03:00 [INF] Hosting environment: Development
2025-09-01 16:11:58.109 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 16:11:58.110 +03:00 [DBG] Hosting started
2025-09-01 16:25:55.582 +03:00 [DBG] Connection id "0HNF9BCABTHGP" received FIN.
2025-09-01 16:25:55.592 +03:00 [DBG] Connection id "0HNF9BCABTHGP" accepted.
2025-09-01 16:25:55.596 +03:00 [DBG] Connection id "0HNF9BCABTHGP" started.
2025-09-01 16:25:55.599 +03:00 [DBG] Connection id "0HNF9BCABTHGQ" accepted.
2025-09-01 16:25:55.600 +03:00 [DBG] Connection id "0HNF9BCABTHGQ" started.
2025-09-01 16:25:55.604 +03:00 [DBG] Connection id "0HNF9BCABTHGP" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 16:25:55.607 +03:00 [DBG] Connection id "0HNF9BCABTHGP" disconnecting.
2025-09-01 16:25:55.609 +03:00 [DBG] Connection id "0HNF9BCABTHGP" stopped.
2025-09-01 16:25:55.624 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - application/json 279
2025-09-01 16:25:55.656 +03:00 [DBG] No candidates found for the request path '/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:25:55.658 +03:00 [DBG] Request did not match any endpoints
2025-09-01 16:25:55.684 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 16:25:55.685 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'.
2025-09-01 16:25:55.687 +03:00 [DBG] Connection id "0HNF9BCABTHGQ" completed keep alive response.
2025-09-01 16:25:55.689 +03:00 [DBG] Connection id "0HNF9BCABTHGR" accepted.
2025-09-01 16:25:55.690 +03:00 [DBG] Connection id "0HNF9BCABTHGS" accepted.
2025-09-01 16:25:55.739 +03:00 [DBG] Connection id "0HNF9BCABTHGR" started.
2025-09-01 16:25:55.694 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - 307 0 null 69.4765ms
2025-09-01 16:25:55.739 +03:00 [DBG] Connection id "0HNF9BCABTHGR" received FIN.
2025-09-01 16:25:55.743 +03:00 [DBG] Connection id "0HNF9BCABTHGS" started.
2025-09-01 16:25:55.747 +03:00 [DBG] Connection id "0HNF9BCABTHGR" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 16:25:55.748 +03:00 [DBG] Connection id "0HNF9BCABTHGQ", Request id "0HNF9BCABTHGQ:00000001": started reading request body.
2025-09-01 16:25:55.749 +03:00 [DBG] Connection id "0HNF9BCABTHGR" disconnecting.
2025-09-01 16:25:55.750 +03:00 [DBG] Connection id "0HNF9BCABTHGQ", Request id "0HNF9BCABTHGQ:00000001": done reading request body.
2025-09-01 16:25:55.751 +03:00 [DBG] Connection id "0HNF9BCABTHGR" stopped.
2025-09-01 16:25:55.779 +03:00 [DBG] Connection 0HNF9BCABTHGS established using the following protocol: "Tls13"
2025-09-01 16:25:55.783 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - application/json 279
2025-09-01 16:25:55.786 +03:00 [DBG] No candidates found for the request path '/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:25:55.787 +03:00 [DBG] Request did not match any endpoints
2025-09-01 16:25:55.791 +03:00 [DBG] Connection id "0HNF9BCABTHGS" completed keep alive response.
2025-09-01 16:25:55.793 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - 404 0 null 10.6596ms
2025-09-01 16:25:55.797 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute, Response status code: 404
2025-09-01 16:25:55.799 +03:00 [DBG] Connection id "0HNF9BCABTHGS", Request id "0HNF9BCABTHGS:00000001": started reading request body.
2025-09-01 16:25:55.800 +03:00 [DBG] Connection id "0HNF9BCABTHGS", Request id "0HNF9BCABTHGS:00000001": done reading request body.
2025-09-01 16:26:22.401 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - null 0
2025-09-01 16:26:22.405 +03:00 [DBG] No candidates found for the request path '/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:26:22.406 +03:00 [DBG] Request did not match any endpoints
2025-09-01 16:26:22.407 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'.
2025-09-01 16:26:22.409 +03:00 [DBG] Connection id "0HNF9BCABTHGQ" completed keep alive response.
2025-09-01 16:26:22.433 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - 307 0 null 10.863ms
2025-09-01 16:26:22.434 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - null 0
2025-09-01 16:26:22.438 +03:00 [DBG] No candidates found for the request path '/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:26:22.439 +03:00 [DBG] Request did not match any endpoints
2025-09-01 16:26:22.440 +03:00 [DBG] Connection id "0HNF9BCABTHGS" completed keep alive response.
2025-09-01 16:26:22.441 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - 404 0 null 7.0518ms
2025-09-01 16:26:22.444 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7202/api/query3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute, Response status code: 404
2025-09-01 16:26:30.343 +03:00 [INF] This is a test log to file!
2025-09-01 16:26:30.660 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 16:26:30.670 +03:00 [INF] API configured successfully.
2025-09-01 16:26:30.755 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 16:26:30.810 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 16:26:31.271 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:26:31.313 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:26:31.322 +03:00 [INF] Registered 13 endpoints in 837 milliseconds.
2025-09-01 16:26:31.328 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:26:31.363 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:26:31.436 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:26:31.446 +03:00 [DBG] Created DbConnection. (8ms).
2025-09-01 16:26:31.450 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:31.454 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:26:31.456 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 16:26:31.458 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:31.465 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:31.469 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:31.472 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:26:31.474 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:31.476 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:31.478 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 16:26:31.482 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:31.486 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 16:26:31.488 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-09-01 16:26:31.493 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:26:31.510 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:26:31.514 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:31.515 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:26:31.516 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 16:26:31.517 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:26:31.5140219+00:00');
SELECT changes();
2025-09-01 16:26:31.522 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:26:31.5140219+00:00');
SELECT changes();
2025-09-01 16:26:31.571 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:26:31.576 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:26:31.578 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 16:26:31.579 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 16:26:31.580 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 16:26:31.582 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:26:31.592 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:26:31.594 +03:00 [DBG] Committing transaction.
2025-09-01 16:26:31.596 +03:00 [DBG] Committed transaction.
2025-09-01 16:26:31.598 +03:00 [DBG] Disposing transaction.
2025-09-01 16:26:31.603 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:26:31.604 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:26:31.606 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:26:31.607 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:26:31.608 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:31.609 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:31.611 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:31.611 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:26:31.613 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:31.614 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:26:31.615 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 16:26:31.616 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:26:31.617 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:26:31.620 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:26:31.621 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:26:31.621 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:26:31.623 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:26:31.625 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:26:31.629 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:31.630 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 16:26:31.634 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 16:26:31.635 +03:00 [DBG] Committing transaction.
2025-09-01 16:26:31.636 +03:00 [DBG] Committed transaction.
2025-09-01 16:26:31.637 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:31.637 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 16:26:31.638 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:26:31.639 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:26:31.644 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:26:31.646 +03:00 [DBG] Disposing transaction.
2025-09-01 16:26:31.647 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:31.650 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 16:26:31.658 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:26:31.659 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:31.659 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:26:31.660 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:26:31.661 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:26:31.687 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 16:26:31.725 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 16:26:31.727 +03:00 [DBG] Hosting starting
2025-09-01 16:26:31.745 +03:00 [DBG] Middleware loaded
2025-09-01 16:26:31.748 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 16:26:31.750 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 16:26:31.860 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 16:26:31.862 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 16:26:31.865 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 16:26:31.903 +03:00 [INF] Now listening on: http://localhost:5262
2025-09-01 16:26:31.905 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 16:26:31.919 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 16:26:31.920 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 16:26:31.921 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 16:26:31.927 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:26:31.950 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:26:32.061 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 16:26:32.062 +03:00 [INF] Hosting environment: Development
2025-09-01 16:26:32.062 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 16:26:32.064 +03:00 [DBG] Hosting started
2025-09-01 16:26:44.364 +03:00 [INF] This is a test log to file!
2025-09-01 16:26:44.799 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 16:26:44.818 +03:00 [INF] API configured successfully.
2025-09-01 16:26:44.931 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 16:26:44.991 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 16:26:45.479 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:26:45.510 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:26:45.521 +03:00 [INF] Registered 13 endpoints in 1,022 milliseconds.
2025-09-01 16:26:45.527 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:26:45.560 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:26:45.637 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:26:45.649 +03:00 [DBG] Created DbConnection. (9ms).
2025-09-01 16:26:45.651 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:45.656 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:26:45.658 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 16:26:45.660 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:45.669 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:45.673 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:45.680 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 16:26:45.682 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:45.686 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:45.688 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 16:26:45.694 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:45.700 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 16:26:45.703 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (9ms).
2025-09-01 16:26:45.712 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:26:45.745 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:26:45.759 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:45.760 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:26:45.761 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 16:26:45.763 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:26:45.759201+00:00');
SELECT changes();
2025-09-01 16:26:45.768 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:26:45.759201+00:00');
SELECT changes();
2025-09-01 16:26:45.827 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:26:45.832 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:26:45.835 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 16:26:45.836 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 16:26:45.838 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-09-01 16:26:45.841 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:26:45.845 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:26:45.849 +03:00 [DBG] Committing transaction.
2025-09-01 16:26:45.851 +03:00 [DBG] Committed transaction.
2025-09-01 16:26:45.854 +03:00 [DBG] Disposing transaction.
2025-09-01 16:26:45.857 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:26:45.858 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:26:45.861 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:26:45.863 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 16:26:45.864 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:45.865 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:45.867 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:45.869 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:26:45.870 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:45.871 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 16:26:45.873 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 16:26:45.874 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:26:45.876 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:26:45.880 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:26:45.881 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:26:45.882 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:26:45.884 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:26:45.886 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:26:45.890 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:45.893 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:26:45.897 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 16:26:45.898 +03:00 [DBG] Committing transaction.
2025-09-01 16:26:45.899 +03:00 [DBG] Committed transaction.
2025-09-01 16:26:45.900 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:26:45.901 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:26:45.902 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:26:45.903 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:26:45.908 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:26:45.909 +03:00 [DBG] Disposing transaction.
2025-09-01 16:26:45.910 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:45.913 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 16:26:45.914 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:26:45.915 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:45.915 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:26:45.917 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:26:45.918 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:26:45.939 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 16:26:45.966 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 16:26:45.967 +03:00 [DBG] Hosting starting
2025-09-01 16:26:45.979 +03:00 [DBG] Middleware loaded
2025-09-01 16:26:45.981 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 16:26:45.983 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 16:26:46.048 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 16:26:46.050 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 16:26:46.052 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 16:26:46.079 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 16:26:46.137 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 16:26:46.138 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 16:26:46.139 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 16:26:46.139 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 16:26:46.140 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 16:26:46.141 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 16:26:46.146 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:26:46.152 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:26:46.234 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 16:26:46.235 +03:00 [INF] Hosting environment: Development
2025-09-01 16:26:46.236 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 16:26:46.236 +03:00 [DBG] Hosting started
2025-09-01 16:26:46.902 +03:00 [DBG] Connection id "0HNF9BCPLB8A1" received FIN.
2025-09-01 16:26:46.908 +03:00 [DBG] Connection id "0HNF9BCPLB8A1" accepted.
2025-09-01 16:26:46.909 +03:00 [DBG] Connection id "0HNF9BCPLB8A1" started.
2025-09-01 16:26:46.911 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" accepted.
2025-09-01 16:26:46.912 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" started.
2025-09-01 16:26:46.917 +03:00 [DBG] Connection id "0HNF9BCPLB8A1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 16:26:46.921 +03:00 [DBG] Connection id "0HNF9BCPLB8A1" disconnecting.
2025-09-01 16:26:46.924 +03:00 [DBG] Connection id "0HNF9BCPLB8A1" stopped.
2025-09-01 16:26:46.946 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - application/json 279
2025-09-01 16:26:47.003 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:26:47.022 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:26:47.024 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:26:47.050 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 16:26:47.053 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'.
2025-09-01 16:26:47.056 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" completed keep alive response.
2025-09-01 16:26:47.059 +03:00 [DBG] Connection id "0HNF9BCPLB8A3" accepted.
2025-09-01 16:26:47.060 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" accepted.
2025-09-01 16:26:47.060 +03:00 [DBG] Connection id "0HNF9BCPLB8A3" received FIN.
2025-09-01 16:26:47.059 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - 307 0 null 120.4715ms
2025-09-01 16:26:47.087 +03:00 [DBG] Connection id "0HNF9BCPLB8A3" started.
2025-09-01 16:26:47.142 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" started.
2025-09-01 16:26:47.148 +03:00 [DBG] Connection id "0HNF9BCPLB8A3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 16:26:47.148 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000001": started reading request body.
2025-09-01 16:26:47.150 +03:00 [DBG] Connection id "0HNF9BCPLB8A3" disconnecting.
2025-09-01 16:26:47.151 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000001": done reading request body.
2025-09-01 16:26:47.152 +03:00 [DBG] Connection id "0HNF9BCPLB8A3" stopped.
2025-09-01 16:26:47.186 +03:00 [DBG] Connection 0HNF9BCPLB8A4 established using the following protocol: "Tls13"
2025-09-01 16:26:47.191 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - application/json 279
2025-09-01 16:26:47.195 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:26:47.196 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute'
2025-09-01 16:26:47.198 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:26:47.203 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:26:47.217 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:26:47.219 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:26:47.268 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000001": started reading request body.
2025-09-01 16:26:47.270 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000001": done reading request body.
2025-09-01 16:26:47.377 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 16:26:47.431 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 16:26:47.683 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 16:26:47.715 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:26:47.716 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 16:26:47.719 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:47.722 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:47.724 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:26:47.726 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:26:47.729 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-09-01 16:26:47.732 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:26:47.738 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:26:47.770 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:26:47.794 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:47.796 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 56ms reading results.
2025-09-01 16:26:47.799 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:47.800 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:26:47.810 +03:00 [INF] Fetching connection string for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 16:26:47.812 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:47.814 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:47.815 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:26:47.816 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:26:47.817 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:26:47.818 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:26:47.820 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:26:47.823 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:47.824 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 16:26:47.825 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:26:47.827 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:26:47.835 +03:00 [DBG] Fetched secret for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 16:26:48.077 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:26:48.127 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No connection string for Profile 3d0cdaa1-a28f-48b0-a256-e9e404e13caa
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 29
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:26:48.145 +03:00 [ERR] Unhandled exception occurred.
2025-09-01 16:26:48.155 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" completed keep alive response.
2025-09-01 16:26:48.157 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:26:48.159 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:26:48.161 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:26:48.163 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/3D0CDAA1-A28F-48B0-A256-E9E404E13CAA/execute - 500 null application/json; charset=utf-8 972.616ms
2025-09-01 16:27:13.321 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 279
2025-09-01 16:27:13.324 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:13.326 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:13.327 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:13.329 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:27:13.330 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" completed keep alive response.
2025-09-01 16:27:13.331 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 9.9676ms
2025-09-01 16:27:13.337 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 279
2025-09-01 16:27:13.338 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000002": started reading request body.
2025-09-01 16:27:13.339 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:13.340 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000002": done reading request body.
2025-09-01 16:27:13.341 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:13.343 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:13.344 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:13.354 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:27:13.355 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:27:13.356 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000002": started reading request body.
2025-09-01 16:27:13.357 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000002": done reading request body.
2025-09-01 16:27:13.359 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:27:13.360 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:27:13.361 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:13.362 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:13.363 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:13.363 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:13.365 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:27:13.366 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:13.367 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:13.369 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:13.370 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:13.372 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:27:13.373 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:13.374 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:27:13.375 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:13.377 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:13.378 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:13.379 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:13.380 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:13.381 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:13.381 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:13.383 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:13.385 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:13.386 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:27:13.387 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:13.388 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:27:13.390 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:13.403 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:27:13.406 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:27:13.409 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:27:13.411 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:13.864 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:27:14.078 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 16:27:14.091 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:14.120 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:14.244 +03:00 [INF] Loaded 3 tables
2025-09-01 16:27:14.455 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 16:27:14.564 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 16:27:14.565 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 16:27:14.566 +03:00 [INF] Non-query execution finished in 666 ms, affected 0 rows
2025-09-01 16:27:14.569 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:14.570 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:14.571 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:14.572 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:14.572 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:14.574 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:14.575 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:14.577 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:14.578 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:27:14.580 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:14.581 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:14.625 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:14.630 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:14.635 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 16:27:14.653 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:14.657 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 16:27:14.660 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-09-01 16:27:14.662 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 16:27:14.664 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 16:27:14.702 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:14.705 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:14.707 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:14.708 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:14.708 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:14.709 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 96), @p3='?' (Size = 71), @p4='?' (DbType = DateTime), @p5='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 16:27:14.718 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 96), @p3='?' (Size = 71), @p4='?' (DbType = DateTime), @p5='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 16:27:14.721 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:14.723 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:27:14.724 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:14.726 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:14.731 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:14.733 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-09-01 16:27:14.740 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-01T13:27:14.5939991Z","$type":"QueryAddedEvent"}
2025-09-01 16:27:14.744 +03:00 [INF] Saved query to DB for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:14.749 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:14.752 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" completed keep alive response.
2025-09-01 16:27:14.753 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:27:14.754 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:14.755 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:14.756 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 200 null application/json; charset=utf-8 1419.4679ms
2025-09-01 16:27:46.480 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 278
2025-09-01 16:27:46.485 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:46.487 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:46.488 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:46.489 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:27:46.491 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" completed keep alive response.
2025-09-01 16:27:46.492 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 14.7652ms
2025-09-01 16:27:46.516 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 278
2025-09-01 16:27:46.518 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000003": started reading request body.
2025-09-01 16:27:46.520 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:46.522 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000003": done reading request body.
2025-09-01 16:27:46.523 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:46.526 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:46.528 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:46.530 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:27:46.532 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:27:46.532 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000003": started reading request body.
2025-09-01 16:27:46.534 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000003": done reading request body.
2025-09-01 16:27:46.536 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:27:46.537 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:27:46.538 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:46.540 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.541 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:46.541 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:46.543 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:46.544 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:46.546 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:46.548 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:46.551 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:46.553 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.554 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-09-01 16:27:46.556 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.557 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:46.559 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:46.561 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:46.562 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.563 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:46.564 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:46.565 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:27:46.566 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:46.568 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:46.571 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.572 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:27:46.574 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.575 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:27:46.577 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:46.578 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:27:46.580 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:27:46.581 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:27:46.582 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:46.585 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:27:46.598 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 16:27:46.600 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:46.601 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:46.641 +03:00 [INF] Loaded 3 tables
2025-09-01 16:27:46.838 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 16:27:46.843 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 16:27:46.844 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 16:27:46.845 +03:00 [INF] Non-query execution finished in 15 ms, affected 0 rows
2025-09-01 16:27:46.846 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:46.847 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.848 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:46.849 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:46.850 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:46.851 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:46.852 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:46.854 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.855 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:27:46.857 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:46.858 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:27:46.859 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:27:46.860 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:46.861 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" completed keep alive response.
2025-09-01 16:27:46.862 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:27:46.863 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:46.864 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:27:46.865 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 200 null application/json; charset=utf-8 349.2009ms
2025-09-01 16:27:50.848 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 277
2025-09-01 16:27:50.850 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:50.851 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:50.853 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:50.854 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:27:50.855 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" completed keep alive response.
2025-09-01 16:27:50.856 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 8.3137ms
2025-09-01 16:27:50.856 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 277
2025-09-01 16:27:50.859 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000004": started reading request body.
2025-09-01 16:27:50.861 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:50.862 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000004": done reading request body.
2025-09-01 16:27:50.863 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:50.865 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:50.867 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:50.868 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:27:50.870 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:27:50.871 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000004": started reading request body.
2025-09-01 16:27:50.872 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000004": done reading request body.
2025-09-01 16:27:50.874 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:27:50.874 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:27:50.875 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:50.876 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:50.877 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:50.878 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:50.879 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:50.880 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:50.881 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:50.883 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:50.884 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:50.885 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:50.886 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:27:50.888 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:50.889 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:27:50.890 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:50.891 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:50.892 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:50.893 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:50.895 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:50.896 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:27:50.897 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:50.899 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:50.900 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:50.901 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:27:50.902 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:50.904 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:50.906 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:50.906 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:27:50.907 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:27:50.908 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:27:50.909 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:50.910 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:27:50.914 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 16:27:50.915 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:50.917 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:50.929 +03:00 [INF] Loaded 3 tables
2025-09-01 16:27:51.076 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 16:27:51.081 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 16:27:51.082 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 16:27:51.083 +03:00 [INF] Non-query execution finished in 4 ms, affected 0 rows
2025-09-01 16:27:51.084 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:51.086 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:51.087 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:51.088 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:51.089 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:27:51.090 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:51.092 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:51.094 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:51.095 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:27:51.096 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:51.097 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:51.099 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:27:51.100 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:51.101 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" completed keep alive response.
2025-09-01 16:27:51.102 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:27:51.103 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:51.104 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:51.106 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 200 null application/json; charset=utf-8 249.4742ms
2025-09-01 16:27:54.071 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:27:54.075 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:54.076 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:54.077 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:54.079 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:27:54.081 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" completed keep alive response.
2025-09-01 16:27:54.082 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:27:54.082 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 10.4763ms
2025-09-01 16:27:54.085 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:54.089 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000005": started reading request body.
2025-09-01 16:27:54.090 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:27:54.092 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000005": done reading request body.
2025-09-01 16:27:54.093 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:54.096 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:54.099 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:27:54.101 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:27:54.101 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000005": started reading request body.
2025-09-01 16:27:54.103 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000005": done reading request body.
2025-09-01 16:27:54.105 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:27:54.106 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:27:54.107 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:54.108 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.110 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:54.111 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:27:54.112 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:27:54.113 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:54.115 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:54.117 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:54.119 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:27:54.120 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.121 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 16:27:54.123 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.124 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:54.126 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:54.128 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:54.129 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.130 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:54.131 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:54.134 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 16:27:54.135 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:54.137 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:54.140 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.142 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:27:54.144 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.145 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:54.147 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:27:54.148 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:27:54.149 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:27:54.151 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:27:54.152 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:27:54.154 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:27:54.274 +03:00 [ERR] SQL execution failed after 122 ms: Must declare the scalar variable "@param1".
2025-09-01 16:27:54.327 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:54.328 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.329 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:27:54.330 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:27:54.331 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:27:54.332 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:54.334 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:27:54.336 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.337 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:27:54.338 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:27:54.338 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:27:54.340 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:27:54.574 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:27:54.710 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@param1".
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:d5716aeb-a3fd-4c4f-95c0-5c12792eef6d
Error Number:137,State:2,Class:15
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:27:54.720 +03:00 [ERR] Error occurred.
2025-09-01 16:27:54.722 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" completed keep alive response.
2025-09-01 16:27:54.723 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:27:54.724 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:27:54.725 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:27:54.727 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 500 null application/json; charset=utf-8 644.8736ms
2025-09-01 16:28:29.026 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:28:29.028 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:29.029 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:29.030 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:29.031 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:28:29.031 +03:00 [DBG] Connection id "0HNF9BCPLB8A2" completed keep alive response.
2025-09-01 16:28:29.033 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 6.7017ms
2025-09-01 16:28:29.037 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:28:29.039 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000006": started reading request body.
2025-09-01 16:28:29.041 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:29.042 +03:00 [DBG] Connection id "0HNF9BCPLB8A2", Request id "0HNF9BCPLB8A2:00000006": done reading request body.
2025-09-01 16:28:29.044 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:29.045 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:29.046 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:29.047 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:28:29.049 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:28:29.049 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000006": started reading request body.
2025-09-01 16:28:29.050 +03:00 [DBG] Connection id "0HNF9BCPLB8A4", Request id "0HNF9BCPLB8A4:00000006": done reading request body.
2025-09-01 16:28:29.052 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:28:29.052 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:28:29.053 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:29.054 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.056 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:28:29.056 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:28:29.057 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:28:29.059 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:29.061 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:29.063 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:28:29.064 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:28:29.065 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.066 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:28:29.067 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.068 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:28:29.070 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:28:29.070 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:29.071 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.072 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:28:29.073 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:28:29.074 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:28:29.075 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:29.077 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:29.078 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.079 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:28:29.080 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.081 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:28:29.082 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:28:29.083 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:28:29.084 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:28:29.085 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:28:29.085 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:28:29.086 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:28:29.172 +03:00 [ERR] SQL execution failed after 86 ms: Must declare the scalar variable "@param1".
2025-09-01 16:28:29.216 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:29.217 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.218 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:28:29.219 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:28:29.220 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:28:29.221 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:29.222 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:29.223 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.224 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:28:29.225 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:29.226 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:28:29.227 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:28:29.444 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:29.577 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@param1".
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:d5716aeb-a3fd-4c4f-95c0-5c12792eef6d
Error Number:137,State:2,Class:15
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:28:29.584 +03:00 [ERR] Error occurred.
2025-09-01 16:28:29.584 +03:00 [DBG] Connection id "0HNF9BCPLB8A4" completed keep alive response.
2025-09-01 16:28:29.585 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:28:29.586 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:29.587 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:28:29.588 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 500 null application/json; charset=utf-8 555.0157ms
2025-09-01 16:28:35.025 +03:00 [INF] This is a test log to file!
2025-09-01 16:28:35.375 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 16:28:35.385 +03:00 [INF] API configured successfully.
2025-09-01 16:28:35.481 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 16:28:35.534 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 16:28:36.074 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:28:36.124 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:28:36.134 +03:00 [INF] Registered 13 endpoints in 980 milliseconds.
2025-09-01 16:28:36.144 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:28:36.186 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:28:36.291 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:28:36.303 +03:00 [DBG] Created DbConnection. (10ms).
2025-09-01 16:28:36.306 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:36.311 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:28:36.313 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 16:28:36.315 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:36.323 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:36.328 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:36.332 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 16:28:36.334 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:36.343 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:36.345 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 16:28:36.349 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:28:36.355 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 16:28:36.360 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (10ms).
2025-09-01 16:28:36.367 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:28:36.387 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 16:28:36.391 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:28:36.392 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 16:28:36.393 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:28:36.394 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:28:36.3910423+00:00');
SELECT changes();
2025-09-01 16:28:36.399 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 13:28:36.3910423+00:00');
SELECT changes();
2025-09-01 16:28:36.440 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:28:36.444 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:28:36.446 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 16:28:36.447 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 16:28:36.448 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 16:28:36.449 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:28:36.451 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 16:28:36.454 +03:00 [DBG] Committing transaction.
2025-09-01 16:28:36.455 +03:00 [DBG] Committed transaction.
2025-09-01 16:28:36.457 +03:00 [DBG] Disposing transaction.
2025-09-01 16:28:36.460 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 16:28:36.462 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 16:28:36.465 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:28:36.466 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 16:28:36.467 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:36.470 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:36.472 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:36.474 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 16:28:36.476 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:28:36.478 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 16:28:36.479 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 16:28:36.481 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:28:36.483 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 16:28:36.486 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:28:36.487 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:28:36.489 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:28:36.490 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:28:36.492 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 16:28:36.497 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:36.499 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:28:36.503 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 16:28:36.504 +03:00 [DBG] Committing transaction.
2025-09-01 16:28:36.505 +03:00 [DBG] Committed transaction.
2025-09-01 16:28:36.506 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 16:28:36.507 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 16:28:36.508 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 16:28:36.509 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:28:36.513 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 16:28:36.515 +03:00 [DBG] Disposing transaction.
2025-09-01 16:28:36.516 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:36.519 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 16:28:36.521 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:28:36.522 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:36.523 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:28:36.524 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:28:36.525 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 16:28:36.548 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 16:28:36.576 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 16:28:36.578 +03:00 [DBG] Hosting starting
2025-09-01 16:28:36.589 +03:00 [DBG] Middleware loaded
2025-09-01 16:28:36.592 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 16:28:36.594 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 16:28:36.664 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 16:28:36.666 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 16:28:36.668 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 16:28:36.705 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 16:28:36.769 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 16:28:36.770 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 16:28:36.771 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 16:28:36.772 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 16:28:36.773 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 16:28:36.774 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 16:28:36.780 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:28:36.787 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 16:28:36.867 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 16:28:36.868 +03:00 [INF] Hosting environment: Development
2025-09-01 16:28:36.869 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 16:28:36.869 +03:00 [DBG] Hosting started
2025-09-01 16:28:37.711 +03:00 [DBG] Connection id "0HNF9BDQM3API" received FIN.
2025-09-01 16:28:37.717 +03:00 [DBG] Connection id "0HNF9BDQM3API" accepted.
2025-09-01 16:28:37.718 +03:00 [DBG] Connection id "0HNF9BDQM3API" started.
2025-09-01 16:28:37.719 +03:00 [DBG] Connection id "0HNF9BDQM3APJ" accepted.
2025-09-01 16:28:37.720 +03:00 [DBG] Connection id "0HNF9BDQM3APJ" started.
2025-09-01 16:28:37.724 +03:00 [DBG] Connection id "0HNF9BDQM3API" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 16:28:37.727 +03:00 [DBG] Connection id "0HNF9BDQM3API" disconnecting.
2025-09-01 16:28:37.729 +03:00 [DBG] Connection id "0HNF9BDQM3API" stopped.
2025-09-01 16:28:37.746 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:28:37.778 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:37.782 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:37.785 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:37.805 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 16:28:37.808 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:28:37.810 +03:00 [DBG] Connection id "0HNF9BDQM3APJ" completed keep alive response.
2025-09-01 16:28:37.812 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 71.2646ms
2025-09-01 16:28:37.812 +03:00 [DBG] Connection id "0HNF9BDQM3APK" received FIN.
2025-09-01 16:28:37.812 +03:00 [DBG] Connection id "0HNF9BDQM3APL" accepted.
2025-09-01 16:28:37.812 +03:00 [DBG] Connection id "0HNF9BDQM3APK" accepted.
2025-09-01 16:28:37.843 +03:00 [DBG] Connection id "0HNF9BDQM3APJ", Request id "0HNF9BDQM3APJ:00000001": started reading request body.
2025-09-01 16:28:37.843 +03:00 [DBG] Connection id "0HNF9BDQM3APL" started.
2025-09-01 16:28:37.844 +03:00 [DBG] Connection id "0HNF9BDQM3APK" started.
2025-09-01 16:28:37.846 +03:00 [DBG] Connection id "0HNF9BDQM3APJ", Request id "0HNF9BDQM3APJ:00000001": done reading request body.
2025-09-01 16:28:37.847 +03:00 [DBG] Connection id "0HNF9BDQM3APK" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 16:28:37.849 +03:00 [DBG] Connection id "0HNF9BDQM3APK" disconnecting.
2025-09-01 16:28:37.850 +03:00 [DBG] Connection id "0HNF9BDQM3APK" stopped.
2025-09-01 16:28:37.876 +03:00 [DBG] Connection 0HNF9BDQM3APL established using the following protocol: "Tls13"
2025-09-01 16:28:37.880 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:28:37.884 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:37.885 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:28:37.886 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:37.889 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:37.900 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:28:37.904 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:28:37.938 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000001": started reading request body.
2025-09-01 16:28:37.941 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000001": done reading request body.
2025-09-01 16:28:38.018 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 16:28:38.054 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 16:28:38.234 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 16:28:38.264 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:28:38.266 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 16:28:38.269 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:38.270 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.272 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:28:38.273 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:28:38.275 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 16:28:38.277 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:38.283 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:38.311 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:28:38.365 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:28:38.377 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.378 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 93ms reading results.
2025-09-01 16:28:38.380 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.382 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:28:38.390 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:28:38.393 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:38.395 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.396 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:28:38.396 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:28:38.397 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:28:38.398 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:38.400 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:38.402 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.403 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:28:38.404 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.406 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:28:38.415 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:28:38.426 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:28:38.429 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:28:38.431 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:28:38.435 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:28:38.701 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:28:38.868 +03:00 [ERR] SQL execution failed after 433 ms: Must declare the scalar variable "@param1".
2025-09-01 16:28:38.916 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:38.917 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.918 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:28:38.918 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:28:38.919 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:28:38.920 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:38.922 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:28:38.924 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.925 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:28:38.926 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:28:38.927 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:28:38.944 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:28:39.258 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:28:39.426 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@param1".
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:b978425c-06a6-430a-85e7-65d6ff57ae1a
Error Number:137,State:2,Class:15
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:28:39.441 +03:00 [ERR] Error occurred.
2025-09-01 16:28:39.450 +03:00 [DBG] Connection id "0HNF9BDQM3APL" completed keep alive response.
2025-09-01 16:28:39.452 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:28:39.456 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:28:39.458 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:28:39.460 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 500 null application/json; charset=utf-8 1579.7601ms
2025-09-01 16:29:10.553 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:29:10.557 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:10.558 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:10.560 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:29:10.561 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:29:10.563 +03:00 [DBG] Connection id "0HNF9BDQM3APJ" completed keep alive response.
2025-09-01 16:29:10.564 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 10.3903ms
2025-09-01 16:29:10.565 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:29:10.566 +03:00 [DBG] Connection id "0HNF9BDQM3APJ", Request id "0HNF9BDQM3APJ:00000002": started reading request body.
2025-09-01 16:29:10.569 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:10.570 +03:00 [DBG] Connection id "0HNF9BDQM3APJ", Request id "0HNF9BDQM3APJ:00000002": done reading request body.
2025-09-01 16:29:10.571 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:10.573 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:29:10.574 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:29:10.583 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:29:10.585 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:29:10.585 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000002": started reading request body.
2025-09-01 16:29:10.586 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000002": done reading request body.
2025-09-01 16:29:45.941 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:29:45.942 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 16:29:45.943 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:29:45.944 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:45.946 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:29:45.946 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:29:45.947 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:29:45.948 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:29:45.950 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:29:45.952 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:29:45.954 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:29:45.955 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:45.966 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 14ms reading results.
2025-09-01 16:29:45.968 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:45.969 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:29:45.970 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:29:45.979 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:29:45.982 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:45.984 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:29:45.984 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:29:45.986 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:29:45.990 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:29:45.992 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:29:45.995 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:45.996 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:29:45.997 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:45.999 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:29:46.000 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:29:46.001 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:29:46.002 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:29:46.004 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:29:46.005 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:29:46.007 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:29:46.115 +03:00 [ERR] SQL execution failed after 110 ms: Must declare the scalar variable "@param1".
2025-09-01 16:29:46.170 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:29:46.171 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:46.172 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:29:46.173 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:29:46.175 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:29:46.176 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:29:46.177 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:29:46.179 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:46.180 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:29:46.181 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:29:46.182 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:29:46.183 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:29:46.449 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:29:46.613 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@param1".
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:b978425c-06a6-430a-85e7-65d6ff57ae1a
Error Number:137,State:2,Class:15
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:29:46.620 +03:00 [ERR] Error occurred.
2025-09-01 16:29:46.622 +03:00 [DBG] Connection id "0HNF9BDQM3APL" completed keep alive response.
2025-09-01 16:29:46.623 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:29:46.624 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:29:46.625 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:29:46.626 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 500 null application/json; charset=utf-8 36060.5902ms
2025-09-01 16:29:56.567 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:29:56.570 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:56.571 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:56.572 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:29:56.573 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:29:56.574 +03:00 [DBG] Connection id "0HNF9BDQM3APJ" completed keep alive response.
2025-09-01 16:29:56.575 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 8.6551ms
2025-09-01 16:29:56.576 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 276
2025-09-01 16:29:56.578 +03:00 [DBG] Connection id "0HNF9BDQM3APJ", Request id "0HNF9BDQM3APJ:00000003": started reading request body.
2025-09-01 16:29:56.579 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:56.580 +03:00 [DBG] Connection id "0HNF9BDQM3APJ", Request id "0HNF9BDQM3APJ:00000003": done reading request body.
2025-09-01 16:29:56.581 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:29:56.583 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:29:56.584 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:29:56.586 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:29:56.587 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:29:56.588 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000003": started reading request body.
2025-09-01 16:29:56.589 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000003": done reading request body.
2025-09-01 16:30:05.719 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:30:05.721 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 16:30:05.722 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:30:05.723 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:05.724 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:30:05.725 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:30:05.726 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:30:05.727 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:30:05.728 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:30:05.729 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:30:05.731 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:30:05.732 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:05.733 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:30:05.734 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:05.735 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:30:05.737 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:30:05.738 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:30:05.738 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:05.739 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:30:05.740 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:30:05.740 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:30:05.741 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:30:05.742 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:30:05.744 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:05.745 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:30:05.746 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:05.746 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:30:05.748 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:30:06.202 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:30:17.572 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:30:18.065 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:30:22.753 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:30:22.755 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:30:22.871 +03:00 [ERR] SQL execution failed after 118 ms: Must declare the scalar variable "@param1".
2025-09-01 16:30:50.126 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:30:50.132 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:50.133 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:30:50.134 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:30:50.135 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:30:50.136 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:30:50.137 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:30:50.139 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:50.139 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:30:50.140 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:30:50.142 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:31:04.293 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:31:04.567 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:31:04.713 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@param1".
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:b978425c-06a6-430a-85e7-65d6ff57ae1a
Error Number:137,State:2,Class:15
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:31:04.721 +03:00 [ERR] Error occurred.
2025-09-01 16:31:04.722 +03:00 [DBG] Connection id "0HNF9BDQM3APL" completed keep alive response.
2025-09-01 16:31:04.723 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:31:04.724 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:31:04.726 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:31:04.727 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 500 null application/json; charset=utf-8 68151.4969ms
2025-09-01 16:31:20.820 +03:00 [DBG] Connection id "0HNF9BDQM3APM" accepted.
2025-09-01 16:31:20.820 +03:00 [DBG] Connection id "0HNF9BDQM3APM" received FIN.
2025-09-01 16:31:20.825 +03:00 [DBG] Connection id "0HNF9BDQM3APM" started.
2025-09-01 16:31:20.826 +03:00 [DBG] Connection id "0HNF9BDQM3APN" accepted.
2025-09-01 16:31:20.830 +03:00 [DBG] Connection id "0HNF9BDQM3APM" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 16:31:20.831 +03:00 [DBG] Connection id "0HNF9BDQM3APN" started.
2025-09-01 16:31:20.832 +03:00 [DBG] Connection id "0HNF9BDQM3APM" disconnecting.
2025-09-01 16:31:20.833 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 277
2025-09-01 16:31:20.833 +03:00 [DBG] Connection id "0HNF9BDQM3APM" stopped.
2025-09-01 16:31:20.835 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:31:20.836 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:31:20.837 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:31:20.839 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:31:20.839 +03:00 [DBG] Connection id "0HNF9BDQM3APN" completed keep alive response.
2025-09-01 16:31:20.840 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 7.3107ms
2025-09-01 16:31:20.840 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 277
2025-09-01 16:31:20.842 +03:00 [DBG] Connection id "0HNF9BDQM3APN", Request id "0HNF9BDQM3APN:00000001": started reading request body.
2025-09-01 16:31:20.844 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:31:20.845 +03:00 [DBG] Connection id "0HNF9BDQM3APN", Request id "0HNF9BDQM3APN:00000001": done reading request body.
2025-09-01 16:31:20.845 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:31:20.847 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:31:20.848 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:31:20.849 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:31:20.850 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:31:20.851 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000004": started reading request body.
2025-09-01 16:31:20.851 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000004": done reading request body.
2025-09-01 16:31:24.319 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:31:24.320 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:31:24.321 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:31:24.321 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.323 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:31:24.323 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:31:24.324 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:31:24.325 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:31:24.327 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:31:24.329 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:31:24.330 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:31:24.331 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.332 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:31:24.333 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.334 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 16:31:24.335 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:31:24.336 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:31:24.337 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.338 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:31:24.338 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 16:31:24.339 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:31:24.340 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:31:24.342 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:31:24.344 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.345 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:31:24.346 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.347 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:31:24.349 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:31:24.350 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:31:24.350 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:31:24.352 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:31:24.352 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:31:24.354 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:31:24.442 +03:00 [ERR] SQL execution failed after 89 ms: Must declare the scalar variable "@param1".
2025-09-01 16:31:24.486 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:31:24.487 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.488 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:31:24.489 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:31:24.490 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:31:24.491 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:31:24.493 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:31:24.495 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.496 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 16:31:24.497 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:31:24.498 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:31:24.499 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 16:31:24.707 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:31:24.822 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@param1".
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:b978425c-06a6-430a-85e7-65d6ff57ae1a
Error Number:137,State:2,Class:15
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:31:24.829 +03:00 [ERR] Error occurred.
2025-09-01 16:31:24.830 +03:00 [DBG] Connection id "0HNF9BDQM3APL" completed keep alive response.
2025-09-01 16:31:24.831 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:31:24.832 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:31:24.833 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:31:24.834 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 500 null application/json; charset=utf-8 3993.9279ms
2025-09-01 16:32:06.600 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 277
2025-09-01 16:32:06.603 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:32:06.604 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:32:06.606 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:32:06.607 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'.
2025-09-01 16:32:06.607 +03:00 [DBG] Connection id "0HNF9BDQM3APN" completed keep alive response.
2025-09-01 16:32:06.609 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 307 0 null 8.1232ms
2025-09-01 16:32:06.613 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - application/json 277
2025-09-01 16:32:06.615 +03:00 [DBG] Connection id "0HNF9BDQM3APN", Request id "0HNF9BDQM3APN:00000002": started reading request body.
2025-09-01 16:32:06.617 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:32:06.618 +03:00 [DBG] Connection id "0HNF9BDQM3APN", Request id "0HNF9BDQM3APN:00000002": done reading request body.
2025-09-01 16:32:06.619 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute'
2025-09-01 16:32:06.621 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:32:06.621 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:32:06.623 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 16:32:06.624 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 16:32:06.625 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000005": started reading request body.
2025-09-01 16:32:06.626 +03:00 [DBG] Connection id "0HNF9BDQM3APL", Request id "0HNF9BDQM3APL:00000005": done reading request body.
2025-09-01 16:32:09.603 +03:00 [DBG] Creating DbConnection.
2025-09-01 16:32:09.604 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 16:32:09.605 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:32:09.607 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.608 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:32:09.609 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:32:09.611 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:32:09.612 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:32:09.614 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:32:09.617 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:32:09.619 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.620 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:32:09.621 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.622 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:32:09.624 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:32:09.626 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:32:09.627 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.628 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:32:09.629 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:32:09.631 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:32:09.632 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:32:09.634 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:32:09.637 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.638 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:32:09.640 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.641 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:32:09.643 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:32:09.644 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 16:32:09.645 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 16:32:09.646 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-09-01 16:32:09.647 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 16:32:09.648 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 16:32:09.735 +03:00 [ERR] SQL execution failed after 87 ms: Must declare the scalar variable "@param1".
2025-09-01 16:32:09.781 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:32:09.783 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.784 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:32:09.785 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:32:09.786 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:32:09.788 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:32:09.789 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 16:32:09.792 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.793 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 16:32:09.794 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.796 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:32:09.821 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:32:09.826 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:32:09.831 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 16:32:09.851 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:32:09.855 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 16:32:09.860 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-09-01 16:32:09.862 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 16:32:09.864 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 16:32:09.913 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:32:09.914 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.917 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 16:32:09.919 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 16:32:09.920 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 16:32:09.921 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 148), @p3='?' (Size = 71), @p4='?' (DbType = DateTime), @p5='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 16:32:09.931 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 148), @p3='?' (Size = 71), @p4='?' (DbType = DateTime), @p5='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 16:32:09.935 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.937 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 16:32:09.938 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 16:32:09.940 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:32:09.947 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 16:32:09.949 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-09-01 16:32:09.955 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-01T13:32:09.7980610Z","$type":"QueryAddedEvent"}
2025-09-01 16:32:09.959 +03:00 [INF] Saved query to DB for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 16:32:10.189 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 16:32:10.366 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Must declare the scalar variable "@param1".
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:b978425c-06a6-430a-85e7-65d6ff57ae1a
Error Number:137,State:2,Class:15
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 16:32:10.372 +03:00 [ERR] Error occurred.
2025-09-01 16:32:10.374 +03:00 [DBG] Connection id "0HNF9BDQM3APL" completed keep alive response.
2025-09-01 16:32:10.375 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 16:32:10.376 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 16:32:10.377 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 16:32:10.378 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773C7D30-609C-442F-AD98-0546699311ED/execute - 500 null application/json; charset=utf-8 3765.2297ms
2025-09-01 18:24:09.740 +03:00 [INF] This is a test log to file!
2025-09-01 18:24:10.238 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 18:24:10.252 +03:00 [INF] API configured successfully.
2025-09-01 18:24:11.106 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 18:24:11.346 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 18:24:12.197 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:24:12.237 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:24:12.247 +03:00 [INF] Registered 13 endpoints in 2,272 milliseconds.
2025-09-01 18:24:12.254 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:24:12.320 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:24:12.457 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:24:12.472 +03:00 [DBG] Created DbConnection. (11ms).
2025-09-01 18:24:12.476 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 18:24:12.483 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:24:12.486 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-01 18:24:12.488 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:24:12.503 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:24:12.508 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:24:12.512 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:24:12.514 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:24:12.516 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:24:12.519 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 18:24:12.523 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:24:12.528 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 18:24:12.531 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-09-01 18:24:12.541 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:24:12.593 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:24:12.605 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:24:12.608 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:24:12.610 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (4ms).
2025-09-01 18:24:12.612 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:24:12.6052179+00:00');
SELECT changes();
2025-09-01 18:24:12.625 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:24:12.6052179+00:00');
SELECT changes();
2025-09-01 18:24:12.717 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:24:12.729 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:24:12.743 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 18:24:12.746 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-09-01 18:24:12.749 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (6ms).
2025-09-01 18:24:12.751 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:24:12.754 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:24:12.758 +03:00 [DBG] Committing transaction.
2025-09-01 18:24:12.760 +03:00 [DBG] Committed transaction.
2025-09-01 18:24:12.763 +03:00 [DBG] Disposing transaction.
2025-09-01 18:24:12.766 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:24:12.767 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:24:12.770 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:24:12.771 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 18:24:12.772 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:24:12.774 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:24:12.775 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:24:12.777 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:24:12.779 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:24:12.780 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 18:24:12.781 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:24:12.782 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:24:12.784 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:24:12.788 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:24:12.789 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:24:12.790 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:24:12.792 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:24:12.794 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:24:12.799 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:24:12.803 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 18:24:12.810 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 18:24:12.811 +03:00 [DBG] Committing transaction.
2025-09-01 18:24:12.812 +03:00 [DBG] Committed transaction.
2025-09-01 18:24:12.814 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:24:12.815 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 18:24:12.816 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:24:12.817 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:24:12.820 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:24:12.823 +03:00 [DBG] Disposing transaction.
2025-09-01 18:24:12.825 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:24:12.828 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 18:24:12.830 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:24:12.831 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:24:12.833 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:24:12.834 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:24:12.835 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:24:12.867 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 18:24:12.903 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 18:24:12.906 +03:00 [DBG] Hosting starting
2025-09-01 18:24:12.924 +03:00 [DBG] Middleware loaded
2025-09-01 18:24:12.927 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 18:24:12.930 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 18:24:13.082 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 18:24:13.090 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 18:24:13.095 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 18:24:13.254 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 18:24:13.322 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 18:24:13.323 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 18:24:13.325 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 18:24:13.326 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 18:24:13.326 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 18:24:13.327 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 18:24:13.334 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:24:13.351 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:24:13.382 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 18:24:13.383 +03:00 [INF] Hosting environment: Development
2025-09-01 18:24:13.384 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 18:24:13.385 +03:00 [DBG] Hosting started
2025-09-01 18:25:11.596 +03:00 [DBG] Connection id "0HNF9DEV0VO9P" received FIN.
2025-09-01 18:25:11.606 +03:00 [DBG] Connection id "0HNF9DEV0VO9P" accepted.
2025-09-01 18:25:11.610 +03:00 [DBG] Connection id "0HNF9DEV0VO9P" started.
2025-09-01 18:25:11.614 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q" accepted.
2025-09-01 18:25:11.616 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q" started.
2025-09-01 18:25:11.619 +03:00 [DBG] Connection id "0HNF9DEV0VO9P" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:25:11.623 +03:00 [DBG] Connection id "0HNF9DEV0VO9P" disconnecting.
2025-09-01 18:25:11.626 +03:00 [DBG] Connection id "0HNF9DEV0VO9P" stopped.
2025-09-01 18:25:11.646 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute - application/json 568
2025-09-01 18:25:11.732 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute'
2025-09-01 18:25:11.735 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute'
2025-09-01 18:25:11.737 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:11.767 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 18:25:11.774 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute'.
2025-09-01 18:25:11.780 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q" completed keep alive response.
2025-09-01 18:25:11.784 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute - 307 0 null 142.7321ms
2025-09-01 18:25:11.786 +03:00 [DBG] Connection id "0HNF9DEV0VO9R" accepted.
2025-09-01 18:25:11.786 +03:00 [DBG] Connection id "0HNF9DEV0VO9S" accepted.
2025-09-01 18:25:11.795 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000001": started reading request body.
2025-09-01 18:25:11.794 +03:00 [DBG] Connection id "0HNF9DEV0VO9R" started.
2025-09-01 18:25:11.787 +03:00 [DBG] Connection id "0HNF9DEV0VO9R" received FIN.
2025-09-01 18:25:11.795 +03:00 [DBG] Connection id "0HNF9DEV0VO9S" started.
2025-09-01 18:25:11.797 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000001": done reading request body.
2025-09-01 18:25:11.798 +03:00 [DBG] Connection id "0HNF9DEV0VO9R" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:25:11.808 +03:00 [DBG] Connection id "0HNF9DEV0VO9R" disconnecting.
2025-09-01 18:25:11.809 +03:00 [DBG] Connection id "0HNF9DEV0VO9R" stopped.
2025-09-01 18:25:11.856 +03:00 [DBG] Connection 0HNF9DEV0VO9S established using the following protocol: "Tls13"
2025-09-01 18:25:11.859 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute - application/json 568
2025-09-01 18:25:11.863 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute'
2025-09-01 18:25:11.864 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute'
2025-09-01 18:25:11.865 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:11.869 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:11.893 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:25:11.896 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:25:11.943 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000001": started reading request body.
2025-09-01 18:25:11.944 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000001": done reading request body.
2025-09-01 18:25:14.757 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 18:25:14.807 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 18:25:15.107 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 18:25:15.167 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:25:15.168 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:25:15.172 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:15.175 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:15.177 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:25:15.178 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:25:15.181 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 18:25:15.187 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:15.197 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:15.203 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:15.204 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 18:25:15.208 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:15.210 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:25:15.416 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:15.466 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: No profile found with id: 983262c2-87a6-4c7d-96f9-e8cc5e8dbc15
   at NaturalToQuery.Application.Services.ProfileService.GetProviderTypeAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 200
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 61
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 29
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:25:15.478 +03:00 [ERR] Unhandled exception occurred.
2025-09-01 18:25:15.489 +03:00 [DBG] Connection id "0HNF9DEV0VO9S" completed keep alive response.
2025-09-01 18:25:15.492 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:25:15.495 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:15.498 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 18:25:15.500 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/983262c2-87a6-4c7d-96f9-e8cc5e8dbc15/execute - 500 null application/json; charset=utf-8 3640.773ms
2025-09-01 18:25:25.972 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-09-01 18:25:25.975 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-01 18:25:25.976 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 18:25:25.984 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-09-01 18:25:25.985 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q" completed keep alive response.
2025-09-01 18:25:25.986 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 13.374ms
2025-09-01 18:25:25.987 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-09-01 18:25:25.991 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-01 18:25:25.992 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 18:25:25.994 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 18:25:25.996 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:25:26.009 +03:00 [INF] Listing all profiles
2025-09-01 18:25:26.016 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()'
2025-09-01 18:25:26.019 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 18:25:26.034 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Profile>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Profile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Profile instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Profile);
                (object)dataReader.GetGuid(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                            {
                                return 
                                {
                                    Profile instance;
                                    instance = new Profile();
                                    instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                    instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                    instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                    instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Profile)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetGuid(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (Profile)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                Query entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    Query instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(Query);
                    dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                {
                                    return 
                                    {
                                        Query instance;
                                        instance = new Query();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                        instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                        instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                        instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                        instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                        instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Query)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                    entity: namelessParameter{11}, 
                    value: namelessParameter{12}, 
                    forMaterialization: True);
                return namelessParameter{12}.<Profile>k__BackingField = namelessParameter{11};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (Profile)(resultContext.Values[0]) : default(Profile);
    }, 
    contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-09-01 18:25:26.039 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:25:26.040 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 18:25:26.040 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:26.041 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.043 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:25:26.044 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:25:26.046 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:25:26.047 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-01 18:25:26.049 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-01 18:25:26.065 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.068 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 16ms reading results.
2025-09-01 18:25:26.069 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.071 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:25:26.076 +03:00 [INF] Fetching connection string for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 18:25:26.083 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:26.084 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.086 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:25:26.087 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:25:26.088 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:25:26.089 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:26.092 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:26.128 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:25:26.156 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.158 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 65ms reading results.
2025-09-01 18:25:26.160 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.161 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:25:26.191 +03:00 [DBG] Fetched secret for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 18:25:26.193 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:25:26.194 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:26.196 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.197 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:25:26.197 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:25:26.198 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:25:26.199 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:26.202 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:26.204 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:25:26.216 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:25:26.223 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.225 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 21ms reading results.
2025-09-01 18:25:26.226 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:26.227 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:25:26.229 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:25:26.246 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 18:25:26.247 +03:00 [DBG] Connection id "0HNF9DEV0VO9S" completed keep alive response.
2025-09-01 18:25:26.248 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:25:26.249 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:26.250 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:25:26.252 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 265.1274ms
2025-09-01 18:25:38.184 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute - application/json 568
2025-09-01 18:25:38.187 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute'
2025-09-01 18:25:38.189 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute'
2025-09-01 18:25:38.191 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:38.192 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute'.
2025-09-01 18:25:38.194 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q" completed keep alive response.
2025-09-01 18:25:38.196 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute - 307 0 null 12.3862ms
2025-09-01 18:25:38.196 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute - application/json 568
2025-09-01 18:25:38.200 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000003": started reading request body.
2025-09-01 18:25:38.202 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute'
2025-09-01 18:25:38.203 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000003": done reading request body.
2025-09-01 18:25:38.205 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute'
2025-09-01 18:25:38.207 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:38.209 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:38.211 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:25:38.213 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:25:38.214 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000003": started reading request body.
2025-09-01 18:25:38.215 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000003": done reading request body.
2025-09-01 18:25:39.702 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:25:39.704 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:25:39.705 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:39.706 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:39.708 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:25:39.709 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:25:39.710 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:25:39.711 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:39.713 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:39.717 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:25:39.718 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:39.719 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 18:25:39.723 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:39.724 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:25:39.735 +03:00 [INF] Fetching connection string for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 18:25:39.736 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:39.737 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:39.738 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:25:39.739 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:25:39.740 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:25:39.741 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:39.743 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:25:39.745 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:39.746 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 18:25:39.748 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:25:39.749 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:25:39.751 +03:00 [DBG] Fetched secret for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 18:25:39.897 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:39.942 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No connection string for Profile 3d0cdaa1-a28f-48b0-a256-e9e404e13caa
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 29
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:25:39.946 +03:00 [ERR] Unhandled exception occurred.
2025-09-01 18:25:39.947 +03:00 [DBG] Connection id "0HNF9DEV0VO9S" completed keep alive response.
2025-09-01 18:25:39.948 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:25:39.949 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:25:39.950 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:25:39.952 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute - 500 null application/json; charset=utf-8 1755.8768ms
2025-09-01 18:25:59.495 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:25:59.498 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:25:59.499 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:25:59.500 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:59.501 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:25:59.502 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q" completed keep alive response.
2025-09-01 18:25:59.504 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 8.5621ms
2025-09-01 18:25:59.529 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:25:59.530 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000004": started reading request body.
2025-09-01 18:25:59.534 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:25:59.535 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000004": done reading request body.
2025-09-01 18:25:59.536 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:25:59.538 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:59.539 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:25:59.540 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:25:59.542 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:25:59.543 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000004": started reading request body.
2025-09-01 18:25:59.543 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000004": done reading request body.
2025-09-01 18:26:01.665 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:26:01.666 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:26:01.667 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:26:01.668 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:01.669 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:26:01.671 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:26:01.672 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:26:01.674 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:26:01.676 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:26:01.678 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:26:01.680 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:26:01.681 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:01.682 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 18:26:01.683 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:01.685 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:26:01.687 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:26:01.688 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:26:01.691 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:01.692 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:26:01.693 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:26:01.694 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:26:01.695 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:26:01.697 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:26:01.699 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:01.700 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:26:01.701 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:01.703 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:26:01.705 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:26:01.758 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:26:01.761 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:26:01.762 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:26:01.766 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:26:02.061 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 18:26:02.285 +03:00 [ERR] SQL execution failed after 519 ms: Conversion failed when converting from a character string to uniqueidentifier.
2025-09-01 18:26:02.360 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:26:02.361 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:02.363 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:26:02.364 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:26:02.365 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:26:02.366 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:26:02.368 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:26:02.370 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:02.371 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:26:02.373 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:02.379 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (6ms).
2025-09-01 18:26:02.430 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:26:02.436 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:26:02.443 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 18:26:02.464 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:26:02.469 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 18:26:02.473 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-09-01 18:26:02.475 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 18:26:02.476 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 18:26:02.525 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:26:02.527 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:02.530 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:26:02.530 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:26:02.531 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:26:02.533 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 174), @p3='?' (Size = 118), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 18:26:02.539 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 174), @p3='?' (Size = 118), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 18:26:02.542 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:02.543 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 18:26:02.545 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:26:02.546 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:26:02.553 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:26:02.555 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-09-01 18:26:02.561 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-01T15:26:02.4009043Z","$type":"QueryAddedEvent"}
2025-09-01 18:26:02.565 +03:00 [INF] Saved query to DB for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:26:02.834 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:26:02.972 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Conversion failed when converting from a character string to uniqueidentifier.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:9d3c10eb-7c7c-4c82-8733-13d1665a2507
Error Number:8169,State:2,Class:16
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:26:02.985 +03:00 [ERR] Error occurred.
2025-09-01 18:26:02.988 +03:00 [DBG] Connection id "0HNF9DEV0VO9S" completed keep alive response.
2025-09-01 18:26:02.989 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:26:02.990 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:26:02.991 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:26:02.992 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 3463.4372ms
2025-09-01 18:26:09.391 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:26:09.395 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:26:09.396 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:26:09.398 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:26:09.401 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:26:09.403 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q" completed keep alive response.
2025-09-01 18:26:09.409 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:26:09.428 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 36.5225ms
2025-09-01 18:26:09.434 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:26:09.438 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000005": started reading request body.
2025-09-01 18:26:09.439 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:26:09.440 +03:00 [DBG] Connection id "0HNF9DEV0VO9Q", Request id "0HNF9DEV0VO9Q:00000005": done reading request body.
2025-09-01 18:26:09.444 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:26:09.446 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:26:09.449 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:26:09.451 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:26:09.452 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000005": started reading request body.
2025-09-01 18:26:09.453 +03:00 [DBG] Connection id "0HNF9DEV0VO9S", Request id "0HNF9DEV0VO9S:00000005": done reading request body.
2025-09-01 18:28:29.576 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:28:29.600 +03:00 [DBG] Created DbConnection. (24ms).
2025-09-01 18:28:29.601 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:28:29.603 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:28:29.604 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:28:29.605 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:28:29.606 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:28:29.607 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:28:29.609 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:28:29.611 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:28:29.612 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:28:29.614 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:28:29.615 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:28:29.616 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 18:28:29.618 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:28:29.619 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:28:29.622 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:28:29.623 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:28:29.624 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:28:29.625 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:28:29.627 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:28:29.628 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:28:29.629 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:28:29.631 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:28:29.633 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:28:29.635 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:28:29.636 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:28:29.637 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:28:29.639 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:28:30.037 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:28:38.999 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:28:39.409 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:28:49.374 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:28:50.878 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 18:29:01.853 +03:00 [ERR] SQL execution failed after 14502 ms: Conversion failed when converting from a character string to uniqueidentifier.
2025-09-01 18:29:01.903 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:29:01.904 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:29:01.906 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:29:01.906 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:29:01.908 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:29:01.909 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:29:01.911 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:29:01.913 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:29:01.914 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:29:01.915 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:29:01.916 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:29:01.920 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 18:29:02.166 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:29:02.296 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Conversion failed when converting from a character string to uniqueidentifier.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 828
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 761
ClientConnectionId:9d3c10eb-7c7c-4c82-8733-13d1665a2507
Error Number:8169,State:2,Class:16
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 778
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 268
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 273
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:29:02.304 +03:00 [ERR] Error occurred.
2025-09-01 18:29:02.306 +03:00 [DBG] Connection id "0HNF9DEV0VO9S" completed keep alive response.
2025-09-01 18:29:02.307 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:29:02.308 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:29:02.309 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:29:02.310 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 172901.0455ms
2025-09-01 18:42:31.072 +03:00 [INF] This is a test log to file!
2025-09-01 18:42:31.538 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 18:42:31.551 +03:00 [INF] API configured successfully.
2025-09-01 18:42:31.664 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 18:42:31.719 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 18:42:32.321 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:42:32.352 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:42:32.360 +03:00 [INF] Registered 13 endpoints in 1,131 milliseconds.
2025-09-01 18:42:32.369 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:42:32.419 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:42:32.514 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:42:32.531 +03:00 [DBG] Created DbConnection. (15ms).
2025-09-01 18:42:32.534 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 18:42:32.538 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:42:32.540 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 18:42:32.542 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:42:32.554 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:42:32.561 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:42:32.566 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 18:42:32.568 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:42:32.571 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:42:32.574 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 18:42:32.579 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:42:32.586 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 18:42:32.589 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (9ms).
2025-09-01 18:42:32.596 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:42:32.625 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:42:32.629 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:42:32.630 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 18:42:32.631 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:42:32.633 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:42:32.629149+00:00');
SELECT changes();
2025-09-01 18:42:32.647 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:42:32.629149+00:00');
SELECT changes();
2025-09-01 18:42:32.692 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:42:32.695 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:42:32.697 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 18:42:32.698 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 18:42:32.699 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 18:42:32.701 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:42:32.702 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:42:32.705 +03:00 [DBG] Committing transaction.
2025-09-01 18:42:32.707 +03:00 [DBG] Committed transaction.
2025-09-01 18:42:32.708 +03:00 [DBG] Disposing transaction.
2025-09-01 18:42:32.711 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:42:32.713 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:42:32.715 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:42:32.716 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:42:32.717 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:42:32.718 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:42:32.720 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:42:32.721 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:42:32.722 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:42:32.723 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 18:42:32.724 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:42:32.725 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:42:32.726 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:42:32.729 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:42:32.730 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:42:32.731 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:42:32.732 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:42:32.735 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:42:32.738 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:42:32.740 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 18:42:32.745 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 18:42:32.746 +03:00 [DBG] Committing transaction.
2025-09-01 18:42:32.747 +03:00 [DBG] Committed transaction.
2025-09-01 18:42:32.748 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:42:32.749 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 18:42:32.750 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:42:32.752 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:42:32.756 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:42:32.758 +03:00 [DBG] Disposing transaction.
2025-09-01 18:42:32.759 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:42:32.761 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 18:42:32.763 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:42:32.764 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:42:32.765 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:42:32.766 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:42:32.768 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:42:32.791 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 18:42:32.823 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 18:42:32.825 +03:00 [DBG] Hosting starting
2025-09-01 18:42:32.839 +03:00 [DBG] Middleware loaded
2025-09-01 18:42:32.843 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 18:42:32.844 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 18:42:32.938 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 18:42:32.939 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 18:42:32.954 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 18:42:33.000 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 18:42:33.062 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 18:42:33.064 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 18:42:33.065 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 18:42:33.066 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 18:42:33.067 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 18:42:33.067 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 18:42:33.076 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:42:33.088 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:42:33.190 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 18:42:33.191 +03:00 [INF] Hosting environment: Development
2025-09-01 18:42:33.192 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 18:42:33.193 +03:00 [DBG] Hosting started
2025-09-01 18:43:03.819 +03:00 [DBG] Connection id "0HNF9DOUIG8LQ" received FIN.
2025-09-01 18:43:03.831 +03:00 [DBG] Connection id "0HNF9DOUIG8LQ" accepted.
2025-09-01 18:43:03.838 +03:00 [DBG] Connection id "0HNF9DOUIG8LQ" started.
2025-09-01 18:43:03.840 +03:00 [DBG] Connection id "0HNF9DOUIG8LR" accepted.
2025-09-01 18:43:03.846 +03:00 [DBG] Connection id "0HNF9DOUIG8LQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:43:03.848 +03:00 [DBG] Connection id "0HNF9DOUIG8LR" started.
2025-09-01 18:43:03.862 +03:00 [DBG] Connection id "0HNF9DOUIG8LQ" disconnecting.
2025-09-01 18:43:03.888 +03:00 [DBG] Connection id "0HNF9DOUIG8LQ" stopped.
2025-09-01 18:43:03.949 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:43:04.048 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:04.050 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:04.053 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:04.078 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 18:43:04.080 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:43:04.084 +03:00 [DBG] Connection id "0HNF9DOUIG8LR" completed keep alive response.
2025-09-01 18:43:04.086 +03:00 [DBG] Connection id "0HNF9DOUIG8LS" accepted.
2025-09-01 18:43:04.087 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 149.2529ms
2025-09-01 18:43:04.087 +03:00 [DBG] Connection id "0HNF9DOUIG8LS" received FIN.
2025-09-01 18:43:04.087 +03:00 [DBG] Connection id "0HNF9DOUIG8LT" accepted.
2025-09-01 18:43:04.113 +03:00 [DBG] Connection id "0HNF9DOUIG8LS" started.
2025-09-01 18:43:04.122 +03:00 [DBG] Connection id "0HNF9DOUIG8LR", Request id "0HNF9DOUIG8LR:00000001": started reading request body.
2025-09-01 18:43:04.122 +03:00 [DBG] Connection id "0HNF9DOUIG8LT" started.
2025-09-01 18:43:04.123 +03:00 [DBG] Connection id "0HNF9DOUIG8LS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:43:04.125 +03:00 [DBG] Connection id "0HNF9DOUIG8LR", Request id "0HNF9DOUIG8LR:00000001": done reading request body.
2025-09-01 18:43:04.126 +03:00 [DBG] Connection id "0HNF9DOUIG8LS" disconnecting.
2025-09-01 18:43:04.129 +03:00 [DBG] Connection id "0HNF9DOUIG8LS" stopped.
2025-09-01 18:43:04.163 +03:00 [DBG] Connection 0HNF9DOUIG8LT established using the following protocol: "Tls13"
2025-09-01 18:43:04.167 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:43:04.170 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:04.171 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:04.173 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:04.176 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:04.189 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:43:04.193 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:43:04.234 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000001": started reading request body.
2025-09-01 18:43:04.236 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000001": done reading request body.
2025-09-01 18:43:06.322 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 18:43:06.383 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 18:43:06.694 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 18:43:06.728 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:43:06.729 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 18:43:06.732 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:06.734 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:06.735 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:06.737 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:06.739 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-09-01 18:43:06.743 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:06.751 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:06.791 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:06.839 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:06.849 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:06.854 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:06.855 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 102ms reading results.
2025-09-01 18:43:06.860 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:06.861 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 18:43:06.873 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:43:06.877 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:06.878 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:06.879 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:06.880 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:43:06.880 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:06.882 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:06.884 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:06.886 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:06.887 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:43:06.889 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:06.890 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:43:06.899 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:43:06.912 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:43:06.915 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:43:06.917 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:43:06.920 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:43:07.141 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 18:43:07.349 +03:00 [ERR] SQL execution failed after 429 ms: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
2025-09-01 18:43:07.417 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:07.419 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:07.421 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:07.422 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:07.423 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:43:07.424 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:07.426 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:07.431 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:07.432 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 18:43:07.434 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:07.437 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 18:43:07.454 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 18:43:07.793 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:07.934 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.OverflowException: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
   at Microsoft.Data.SqlClient.TdsParser.WriteTime(TimeSpan value, Byte scale, Int32 length, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.WriteUnterminatedValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.WriteValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.TDSExecuteRPCAddParameter(TdsParserStateObject stateObj, SqlParameter param, MetaType mt, Byte options, SqlCommand command, Boolean isAnonymous)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteRPC(SqlCommand cmd, IList`1 rpcArray, Int32 timeout, Boolean inSchema, SqlNotificationRequest notificationRequest, TdsParserStateObject stateObj, Boolean isCommandProc, Boolean sync, TaskCompletionSource`1 completion, Int32 startRpc, Int32 startParam)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryInternal(CommandBehavior behavior, AsyncCallback callback, Object stateObject, Int32 timeout, Boolean inRetry, Boolean asyncWrite)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryAsync(AsyncCallback callback, Object stateObject)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_0(AsyncCallback callback, Object stateObject)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncImpl(Func`3 beginMethod, Func`2 endFunction, Action`1 endAction, Object state, TaskCreationOptions creationOptions)
   at System.Threading.Tasks.TaskFactory`1.FromAsync(Func`3 beginMethod, Func`2 endMethod, Object state)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQueryAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:43:07.950 +03:00 [ERR] Error occurred.
2025-09-01 18:43:07.958 +03:00 [DBG] Connection id "0HNF9DOUIG8LT" completed keep alive response.
2025-09-01 18:43:07.961 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:43:07.965 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:07.967 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:43:07.969 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 3801.9756ms
2025-09-01 18:43:24.426 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:43:24.429 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:24.430 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:24.433 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:24.435 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:43:24.436 +03:00 [DBG] Connection id "0HNF9DOUIG8LR" completed keep alive response.
2025-09-01 18:43:24.437 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 11.0143ms
2025-09-01 18:43:24.462 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:43:24.465 +03:00 [DBG] Connection id "0HNF9DOUIG8LR", Request id "0HNF9DOUIG8LR:00000002": started reading request body.
2025-09-01 18:43:24.466 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:24.467 +03:00 [DBG] Connection id "0HNF9DOUIG8LR", Request id "0HNF9DOUIG8LR:00000002": done reading request body.
2025-09-01 18:43:24.468 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:24.470 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:24.471 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:24.483 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:43:24.485 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:43:24.486 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000002": started reading request body.
2025-09-01 18:43:24.487 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000002": done reading request body.
2025-09-01 18:43:27.864 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:43:27.865 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:43:27.866 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:27.867 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:27.868 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:27.869 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:27.870 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:43:27.871 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:27.873 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:27.876 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:27.877 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:27.878 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:27.879 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:27.881 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 18:43:27.882 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:27.884 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:43:27.885 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:43:27.886 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:27.887 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:27.888 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:27.889 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:43:27.890 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:27.891 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:27.892 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:27.894 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:27.895 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:43:27.896 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:27.897 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:43:27.899 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:43:27.901 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:43:27.902 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:43:27.903 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:43:27.904 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:43:27.906 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 18:43:28.141 +03:00 [ERR] SQL execution failed after 237 ms: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
2025-09-01 18:43:28.196 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:28.197 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:28.199 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:28.199 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:43:28.200 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:28.201 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:28.204 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:28.206 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:28.207 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 18:43:28.208 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:28.209 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:43:28.210 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 18:43:28.475 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:28.614 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.OverflowException: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
   at Microsoft.Data.SqlClient.TdsParser.WriteTime(TimeSpan value, Byte scale, Int32 length, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.WriteUnterminatedValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.WriteValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.TDSExecuteRPCAddParameter(TdsParserStateObject stateObj, SqlParameter param, MetaType mt, Byte options, SqlCommand command, Boolean isAnonymous)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteRPC(SqlCommand cmd, IList`1 rpcArray, Int32 timeout, Boolean inSchema, SqlNotificationRequest notificationRequest, TdsParserStateObject stateObj, Boolean isCommandProc, Boolean sync, TaskCompletionSource`1 completion, Int32 startRpc, Int32 startParam)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryInternal(CommandBehavior behavior, AsyncCallback callback, Object stateObject, Int32 timeout, Boolean inRetry, Boolean asyncWrite)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryAsync(AsyncCallback callback, Object stateObject)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_0(AsyncCallback callback, Object stateObject)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncImpl(Func`3 beginMethod, Func`2 endFunction, Action`1 endAction, Object state, TaskCreationOptions creationOptions)
   at System.Threading.Tasks.TaskFactory`1.FromAsync(Func`3 beginMethod, Func`2 endMethod, Object state)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQueryAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:43:28.621 +03:00 [ERR] Error occurred.
2025-09-01 18:43:28.623 +03:00 [DBG] Connection id "0HNF9DOUIG8LT" completed keep alive response.
2025-09-01 18:43:28.624 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:43:28.625 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:28.626 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:43:28.627 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 4164.9399ms
2025-09-01 18:43:32.608 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:43:32.611 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:32.612 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:32.614 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:32.615 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:43:32.617 +03:00 [DBG] Connection id "0HNF9DOUIG8LR" completed keep alive response.
2025-09-01 18:43:32.618 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 9.9666ms
2025-09-01 18:43:32.618 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:43:32.621 +03:00 [DBG] Connection id "0HNF9DOUIG8LR", Request id "0HNF9DOUIG8LR:00000003": started reading request body.
2025-09-01 18:43:32.623 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:32.624 +03:00 [DBG] Connection id "0HNF9DOUIG8LR", Request id "0HNF9DOUIG8LR:00000003": done reading request body.
2025-09-01 18:43:32.625 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:43:32.627 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:32.629 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:43:32.630 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:43:32.632 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:43:32.633 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000003": started reading request body.
2025-09-01 18:43:32.635 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000003": done reading request body.
2025-09-01 18:43:41.817 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:43:41.819 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:43:41.819 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:41.821 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:41.823 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:41.824 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:41.824 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:41.825 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:41.827 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:41.829 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:41.830 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:41.831 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:43:41.832 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:41.833 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 18:43:41.834 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:41.836 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:43:41.837 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:43:41.838 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:43:41.839 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:41.840 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:43:41.841 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:43:41.841 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:43:41.842 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:41.844 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:43:41.846 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:41.847 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:43:41.848 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:43:41.849 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:43:41.850 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:43:41.976 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:43:52.706 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:43:53.413 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:44:37.432 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:44:38.172 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 18:47:11.287 +03:00 [ERR] SQL execution failed after 154834 ms: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
2025-09-01 18:47:11.436 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:47:11.438 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:47:11.439 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:47:11.440 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:47:11.441 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:47:11.442 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:47:11.444 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:47:11.446 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:47:11.459 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 13ms reading results.
2025-09-01 18:47:11.461 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:47:11.461 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:47:11.463 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 18:47:11.626 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:47:11.692 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.OverflowException: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
   at Microsoft.Data.SqlClient.TdsParser.WriteTime(TimeSpan value, Byte scale, Int32 length, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.WriteUnterminatedValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.WriteValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.TDSExecuteRPCAddParameter(TdsParserStateObject stateObj, SqlParameter param, MetaType mt, Byte options, SqlCommand command, Boolean isAnonymous)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteRPC(SqlCommand cmd, IList`1 rpcArray, Int32 timeout, Boolean inSchema, SqlNotificationRequest notificationRequest, TdsParserStateObject stateObj, Boolean isCommandProc, Boolean sync, TaskCompletionSource`1 completion, Int32 startRpc, Int32 startParam)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryInternal(CommandBehavior behavior, AsyncCallback callback, Object stateObject, Int32 timeout, Boolean inRetry, Boolean asyncWrite)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryAsync(AsyncCallback callback, Object stateObject)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_0(AsyncCallback callback, Object stateObject)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncImpl(Func`3 beginMethod, Func`2 endFunction, Action`1 endAction, Object state, TaskCreationOptions creationOptions)
   at System.Threading.Tasks.TaskFactory`1.FromAsync(Func`3 beginMethod, Func`2 endMethod, Object state)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQueryAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:47:11.701 +03:00 [ERR] Error occurred.
2025-09-01 18:47:11.712 +03:00 [DBG] Connection id "0HNF9DOUIG8LT" completed keep alive response.
2025-09-01 18:47:11.732 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:47:11.735 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:47:11.736 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:47:11.737 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 219119.4001ms
2025-09-01 18:50:17.339 +03:00 [DBG] Connection id "0HNF9DOUIG8LU" accepted.
2025-09-01 18:50:17.345 +03:00 [DBG] Connection id "0HNF9DOUIG8LU" received FIN.
2025-09-01 18:50:17.350 +03:00 [DBG] Connection id "0HNF9DOUIG8LU" started.
2025-09-01 18:50:17.356 +03:00 [DBG] Connection id "0HNF9DOUIG8LV" accepted.
2025-09-01 18:50:17.357 +03:00 [DBG] Connection id "0HNF9DOUIG8LU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:50:17.357 +03:00 [DBG] Connection id "0HNF9DOUIG8LV" started.
2025-09-01 18:50:17.358 +03:00 [DBG] Connection id "0HNF9DOUIG8LU" disconnecting.
2025-09-01 18:50:17.360 +03:00 [DBG] Connection id "0HNF9DOUIG8LU" stopped.
2025-09-01 18:50:17.359 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:50:17.362 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:17.363 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:17.365 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:17.366 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:50:17.366 +03:00 [DBG] Connection id "0HNF9DOUIG8LV" completed keep alive response.
2025-09-01 18:50:17.367 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 8.002ms
2025-09-01 18:50:17.368 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:50:17.369 +03:00 [DBG] Connection id "0HNF9DOUIG8LV", Request id "0HNF9DOUIG8LV:00000001": started reading request body.
2025-09-01 18:50:17.371 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:17.371 +03:00 [DBG] Connection id "0HNF9DOUIG8LV", Request id "0HNF9DOUIG8LV:00000001": done reading request body.
2025-09-01 18:50:17.372 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:17.375 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:17.376 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:17.377 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:50:17.379 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:50:17.379 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000004": started reading request body.
2025-09-01 18:50:17.380 +03:00 [DBG] Connection id "0HNF9DOUIG8LT", Request id "0HNF9DOUIG8LT:00000004": done reading request body.
2025-09-01 18:50:17.382 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:50:17.383 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 18:50:17.384 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:17.385 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.386 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:50:17.387 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:50:17.388 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:50:17.389 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:17.391 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:17.394 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:50:17.395 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:50:17.396 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:50:17.397 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.398 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 18:50:17.400 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.401 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:50:17.402 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:50:17.404 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:17.405 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.406 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:50:17.408 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:50:17.409 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:50:17.410 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:17.412 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:17.414 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.415 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:50:17.416 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.417 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:50:17.419 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:50:17.420 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:50:17.420 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:50:17.421 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:50:17.422 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:50:17.432 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 18:50:17.546 +03:00 [ERR] SQL execution failed after 123 ms: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
2025-09-01 18:50:17.593 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:17.594 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.595 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:50:17.596 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:50:17.597 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:50:17.598 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:17.599 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:17.600 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.601 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 18:50:17.602 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:17.603 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:50:17.604 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 18:50:17.846 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:17.987 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.OverflowException: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
   at Microsoft.Data.SqlClient.TdsParser.WriteTime(TimeSpan value, Byte scale, Int32 length, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.WriteUnterminatedValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.WriteValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.TDSExecuteRPCAddParameter(TdsParserStateObject stateObj, SqlParameter param, MetaType mt, Byte options, SqlCommand command, Boolean isAnonymous)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteRPC(SqlCommand cmd, IList`1 rpcArray, Int32 timeout, Boolean inSchema, SqlNotificationRequest notificationRequest, TdsParserStateObject stateObj, Boolean isCommandProc, Boolean sync, TaskCompletionSource`1 completion, Int32 startRpc, Int32 startParam)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryInternal(CommandBehavior behavior, AsyncCallback callback, Object stateObject, Int32 timeout, Boolean inRetry, Boolean asyncWrite)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryAsync(AsyncCallback callback, Object stateObject)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_0(AsyncCallback callback, Object stateObject)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncImpl(Func`3 beginMethod, Func`2 endFunction, Action`1 endAction, Object state, TaskCreationOptions creationOptions)
   at System.Threading.Tasks.TaskFactory`1.FromAsync(Func`3 beginMethod, Func`2 endMethod, Object state)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQueryAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:50:17.995 +03:00 [ERR] Error occurred.
2025-09-01 18:50:17.996 +03:00 [DBG] Connection id "0HNF9DOUIG8LT" completed keep alive response.
2025-09-01 18:50:17.996 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:50:17.997 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:17.998 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:50:17.999 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 631.7296ms
2025-09-01 18:50:28.200 +03:00 [INF] This is a test log to file!
2025-09-01 18:50:28.689 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 18:50:28.700 +03:00 [INF] API configured successfully.
2025-09-01 18:50:28.816 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 18:50:28.947 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 18:50:29.863 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:50:29.900 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:50:29.917 +03:00 [INF] Registered 13 endpoints in 1,530 milliseconds.
2025-09-01 18:50:29.929 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:50:29.978 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:50:30.098 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:50:30.113 +03:00 [DBG] Created DbConnection. (13ms).
2025-09-01 18:50:30.117 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:30.131 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:50:30.134 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-01 18:50:30.136 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:30.147 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:30.151 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:30.155 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 18:50:30.156 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:30.159 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:30.161 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 18:50:30.165 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:50:30.170 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:50:30.172 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-09-01 18:50:30.178 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:50:30.198 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:50:30.202 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:50:30.202 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 18:50:30.204 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:50:30.205 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:50:30.2017411+00:00');
SELECT changes();
2025-09-01 18:50:30.214 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:50:30.2017411+00:00');
SELECT changes();
2025-09-01 18:50:30.259 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:50:30.263 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:50:30.265 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 18:50:30.266 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 18:50:30.268 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 18:50:30.269 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:50:30.271 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:50:30.274 +03:00 [DBG] Committing transaction.
2025-09-01 18:50:30.275 +03:00 [DBG] Committed transaction.
2025-09-01 18:50:30.277 +03:00 [DBG] Disposing transaction.
2025-09-01 18:50:30.279 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:50:30.280 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:50:30.282 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:50:30.283 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 18:50:30.284 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:30.286 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:30.287 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:30.288 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:50:30.289 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:50:30.290 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 18:50:30.291 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:50:30.292 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:50:30.293 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:50:30.296 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:50:30.297 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:50:30.298 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:50:30.299 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:50:30.301 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:50:30.306 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:30.308 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 18:50:30.312 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 18:50:30.313 +03:00 [DBG] Committing transaction.
2025-09-01 18:50:30.314 +03:00 [DBG] Committed transaction.
2025-09-01 18:50:30.315 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:50:30.316 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 18:50:30.317 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 18:50:30.317 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:50:30.325 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:50:30.327 +03:00 [DBG] Disposing transaction.
2025-09-01 18:50:30.329 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:30.332 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 18:50:30.334 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:50:30.335 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:30.336 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:50:30.337 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:50:30.338 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:50:30.361 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 18:50:30.390 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 18:50:30.391 +03:00 [DBG] Hosting starting
2025-09-01 18:50:30.402 +03:00 [DBG] Middleware loaded
2025-09-01 18:50:30.405 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 18:50:30.407 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 18:50:30.470 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 18:50:30.472 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 18:50:30.475 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 18:50:30.501 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 18:50:30.565 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 18:50:30.566 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 18:50:30.567 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 18:50:30.568 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 18:50:30.570 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 18:50:30.571 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 18:50:30.581 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:50:30.627 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:50:30.675 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 18:50:30.676 +03:00 [INF] Hosting environment: Development
2025-09-01 18:50:30.677 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 18:50:30.678 +03:00 [DBG] Hosting started
2025-09-01 18:50:49.475 +03:00 [DBG] Connection id "0HNF9DT9BB4FJ" received FIN.
2025-09-01 18:50:49.479 +03:00 [DBG] Connection id "0HNF9DT9BB4FJ" accepted.
2025-09-01 18:50:49.481 +03:00 [DBG] Connection id "0HNF9DT9BB4FJ" started.
2025-09-01 18:50:49.482 +03:00 [DBG] Connection id "0HNF9DT9BB4FK" accepted.
2025-09-01 18:50:49.483 +03:00 [DBG] Connection id "0HNF9DT9BB4FK" started.
2025-09-01 18:50:49.487 +03:00 [DBG] Connection id "0HNF9DT9BB4FJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:50:49.491 +03:00 [DBG] Connection id "0HNF9DT9BB4FJ" disconnecting.
2025-09-01 18:50:49.492 +03:00 [DBG] Connection id "0HNF9DT9BB4FJ" stopped.
2025-09-01 18:50:49.508 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:50:49.539 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:49.541 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:49.544 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:49.566 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 18:50:49.567 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:50:49.570 +03:00 [DBG] Connection id "0HNF9DT9BB4FK" completed keep alive response.
2025-09-01 18:50:49.571 +03:00 [DBG] Connection id "0HNF9DT9BB4FL" accepted.
2025-09-01 18:50:49.572 +03:00 [DBG] Connection id "0HNF9DT9BB4FM" accepted.
2025-09-01 18:50:49.572 +03:00 [DBG] Connection id "0HNF9DT9BB4FL" received FIN.
2025-09-01 18:50:49.572 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 68.4814ms
2025-09-01 18:50:49.576 +03:00 [DBG] Connection id "0HNF9DT9BB4FL" started.
2025-09-01 18:50:49.577 +03:00 [DBG] Connection id "0HNF9DT9BB4FM" started.
2025-09-01 18:50:49.582 +03:00 [DBG] Connection id "0HNF9DT9BB4FL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:50:49.582 +03:00 [DBG] Connection id "0HNF9DT9BB4FK", Request id "0HNF9DT9BB4FK:00000001": started reading request body.
2025-09-01 18:50:49.584 +03:00 [DBG] Connection id "0HNF9DT9BB4FL" disconnecting.
2025-09-01 18:50:49.585 +03:00 [DBG] Connection id "0HNF9DT9BB4FK", Request id "0HNF9DT9BB4FK:00000001": done reading request body.
2025-09-01 18:50:49.586 +03:00 [DBG] Connection id "0HNF9DT9BB4FL" stopped.
2025-09-01 18:50:49.615 +03:00 [DBG] Connection 0HNF9DT9BB4FM established using the following protocol: "Tls13"
2025-09-01 18:50:49.620 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:50:49.624 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:49.625 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:50:49.626 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:49.630 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:49.642 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:50:49.645 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:50:49.679 +03:00 [DBG] Connection id "0HNF9DT9BB4FM", Request id "0HNF9DT9BB4FM:00000001": started reading request body.
2025-09-01 18:50:49.680 +03:00 [DBG] Connection id "0HNF9DT9BB4FM", Request id "0HNF9DT9BB4FM:00000001": done reading request body.
2025-09-01 18:50:49.766 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 18:50:49.814 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 18:50:50.024 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 18:50:50.054 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:50:50.055 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:50:50.057 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:50.059 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.060 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:50:50.061 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:50:50.063 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 18:50:50.067 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:50.073 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:50.103 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:50:50.141 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:50:50.150 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:50:50.154 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.156 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 80ms reading results.
2025-09-01 18:50:50.159 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.161 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:50:50.170 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:50:50.173 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:50.176 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.176 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:50:50.177 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:50:50.178 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:50:50.179 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:50.181 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:50.183 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.184 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:50:50.185 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.186 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:50:50.196 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:50:50.207 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:50:50.210 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:50:50.212 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:50:50.214 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:50:50.388 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 18:50:50.546 +03:00 [ERR] SQL execution failed after 332 ms: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
2025-09-01 18:50:50.612 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:50.613 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.614 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:50:50.615 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 18:50:50.617 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:50:50.618 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:50.619 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:50:50.621 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.622 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 18:50:50.624 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:50:50.625 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 18:50:50.636 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 18:50:50.855 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:50:50.987 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.OverflowException: SqlDbType.Time overflow.  Value '200.00:00:00' is out of range.  Must be between 00:00:00.0000000 and 23:59:59.9999999.
   at Microsoft.Data.SqlClient.TdsParser.WriteTime(TimeSpan value, Byte scale, Int32 length, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.TdsParser.WriteUnterminatedValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.WriteValue(Object value, MetaType type, Byte scale, Int32 actualLength, Int32 encodingByteSize, Int32 offset, TdsParserStateObject stateObj, Int32 paramSize, Boolean isDataFeed)
   at Microsoft.Data.SqlClient.TdsParser.TDSExecuteRPCAddParameter(TdsParserStateObject stateObj, SqlParameter param, MetaType mt, Byte options, SqlCommand command, Boolean isAnonymous)
   at Microsoft.Data.SqlClient.TdsParser.TdsExecuteRPC(SqlCommand cmd, IList`1 rpcArray, Int32 timeout, Boolean inSchema, SqlNotificationRequest notificationRequest, TdsParserStateObject stateObj, Boolean isCommandProc, Boolean sync, TaskCompletionSource`1 completion, Int32 startRpc, Int32 startParam)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryInternal(CommandBehavior behavior, AsyncCallback callback, Object stateObject, Int32 timeout, Boolean inRetry, Boolean asyncWrite)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryAsync(AsyncCallback callback, Object stateObject)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_0(AsyncCallback callback, Object stateObject)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncImpl(Func`3 beginMethod, Func`2 endFunction, Action`1 endAction, Object state, TaskCreationOptions creationOptions)
   at System.Threading.Tasks.TaskFactory`1.FromAsync(Func`3 beginMethod, Func`2 endMethod, Object state)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQueryAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 18:50:50.999 +03:00 [ERR] Error occurred.
2025-09-01 18:50:51.010 +03:00 [DBG] Connection id "0HNF9DT9BB4FM" completed keep alive response.
2025-09-01 18:50:51.013 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:50:51.017 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:50:51.019 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:50:51.021 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 1401.7332ms
2025-09-01 18:51:36.286 +03:00 [INF] This is a test log to file!
2025-09-01 18:51:36.813 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 18:51:36.848 +03:00 [INF] API configured successfully.
2025-09-01 18:51:36.990 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 18:51:37.060 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 18:51:37.879 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:51:37.940 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:51:37.960 +03:00 [INF] Registered 13 endpoints in 1,457 milliseconds.
2025-09-01 18:51:37.969 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:51:38.021 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:51:38.127 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:51:38.139 +03:00 [DBG] Created DbConnection. (10ms).
2025-09-01 18:51:38.142 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:38.148 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:51:38.150 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 18:51:38.153 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:38.164 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:38.170 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:38.174 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:51:38.176 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:38.179 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:38.182 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 18:51:38.188 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:51:38.193 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 18:51:38.196 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-09-01 18:51:38.202 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:51:38.225 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 18:51:38.230 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:51:38.231 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 18:51:38.232 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:51:38.234 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:51:38.2299307+00:00');
SELECT changes();
2025-09-01 18:51:38.238 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 15:51:38.2299307+00:00');
SELECT changes();
2025-09-01 18:51:38.292 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:51:38.296 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:51:38.298 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 18:51:38.299 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 18:51:38.301 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 18:51:38.303 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:51:38.306 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 18:51:38.309 +03:00 [DBG] Committing transaction.
2025-09-01 18:51:38.311 +03:00 [DBG] Committed transaction.
2025-09-01 18:51:38.313 +03:00 [DBG] Disposing transaction.
2025-09-01 18:51:38.315 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 18:51:38.317 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 18:51:38.318 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:51:38.319 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 18:51:38.321 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:38.322 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:38.324 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:38.325 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:51:38.326 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:51:38.327 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 18:51:38.328 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:51:38.330 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:51:38.331 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 18:51:38.335 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:51:38.336 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:51:38.337 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 18:51:38.339 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:51:38.341 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 18:51:38.346 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:38.348 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 18:51:38.352 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 18:51:38.353 +03:00 [DBG] Committing transaction.
2025-09-01 18:51:38.354 +03:00 [DBG] Committed transaction.
2025-09-01 18:51:38.355 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 18:51:38.356 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 18:51:38.357 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 18:51:38.358 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:51:38.362 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 18:51:38.365 +03:00 [DBG] Disposing transaction.
2025-09-01 18:51:38.367 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:38.371 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-09-01 18:51:38.373 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 18:51:38.374 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:38.375 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:51:38.378 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:51:38.380 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 18:51:38.416 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 18:51:38.450 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 18:51:38.452 +03:00 [DBG] Hosting starting
2025-09-01 18:51:38.468 +03:00 [DBG] Middleware loaded
2025-09-01 18:51:38.472 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 18:51:38.474 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 18:51:38.552 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 18:51:38.553 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 18:51:38.556 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 18:51:38.587 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 18:51:38.644 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 18:51:38.645 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 18:51:38.646 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 18:51:38.647 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 18:51:38.647 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 18:51:38.648 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 18:51:38.653 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:51:38.661 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 18:51:38.749 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 18:51:38.749 +03:00 [INF] Hosting environment: Development
2025-09-01 18:51:38.750 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 18:51:38.751 +03:00 [DBG] Hosting started
2025-09-01 18:51:45.348 +03:00 [DBG] Connection id "0HNF9DTQ068EU" received FIN.
2025-09-01 18:51:45.353 +03:00 [DBG] Connection id "0HNF9DTQ068EU" accepted.
2025-09-01 18:51:45.355 +03:00 [DBG] Connection id "0HNF9DTQ068EU" started.
2025-09-01 18:51:45.357 +03:00 [DBG] Connection id "0HNF9DTQ068EV" accepted.
2025-09-01 18:51:45.358 +03:00 [DBG] Connection id "0HNF9DTQ068EV" started.
2025-09-01 18:51:45.362 +03:00 [DBG] Connection id "0HNF9DTQ068EU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:51:45.366 +03:00 [DBG] Connection id "0HNF9DTQ068EU" disconnecting.
2025-09-01 18:51:45.368 +03:00 [DBG] Connection id "0HNF9DTQ068EU" stopped.
2025-09-01 18:51:45.381 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:51:45.414 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:51:45.416 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:51:45.419 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:51:45.440 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 18:51:45.442 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 18:51:45.445 +03:00 [DBG] Connection id "0HNF9DTQ068EV" completed keep alive response.
2025-09-01 18:51:45.447 +03:00 [DBG] Connection id "0HNF9DTQ068F0" accepted.
2025-09-01 18:51:45.448 +03:00 [DBG] Connection id "0HNF9DTQ068F0" received FIN.
2025-09-01 18:51:45.447 +03:00 [DBG] Connection id "0HNF9DTQ068F1" accepted.
2025-09-01 18:51:45.447 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 69.854ms
2025-09-01 18:51:45.452 +03:00 [DBG] Connection id "0HNF9DTQ068F0" started.
2025-09-01 18:51:45.454 +03:00 [DBG] Connection id "0HNF9DTQ068F1" started.
2025-09-01 18:51:45.459 +03:00 [DBG] Connection id "0HNF9DTQ068F0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 18:51:45.459 +03:00 [DBG] Connection id "0HNF9DTQ068EV", Request id "0HNF9DTQ068EV:00000001": started reading request body.
2025-09-01 18:51:45.461 +03:00 [DBG] Connection id "0HNF9DTQ068F0" disconnecting.
2025-09-01 18:51:45.462 +03:00 [DBG] Connection id "0HNF9DTQ068EV", Request id "0HNF9DTQ068EV:00000001": done reading request body.
2025-09-01 18:51:45.462 +03:00 [DBG] Connection id "0HNF9DTQ068F0" stopped.
2025-09-01 18:51:45.490 +03:00 [DBG] Connection 0HNF9DTQ068F1 established using the following protocol: "Tls13"
2025-09-01 18:51:45.494 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 568
2025-09-01 18:51:45.498 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:51:45.499 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 18:51:45.500 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:51:45.504 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 18:51:45.518 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 18:51:45.521 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 18:51:45.562 +03:00 [DBG] Connection id "0HNF9DTQ068F1", Request id "0HNF9DTQ068F1:00000001": started reading request body.
2025-09-01 18:51:45.565 +03:00 [DBG] Connection id "0HNF9DTQ068F1", Request id "0HNF9DTQ068F1:00000001": done reading request body.
2025-09-01 18:51:45.644 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 18:51:45.681 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 18:51:45.869 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 18:51:45.900 +03:00 [DBG] Creating DbConnection.
2025-09-01 18:51:45.902 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 18:51:45.904 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:45.906 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:45.908 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:51:45.909 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:51:45.911 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 18:51:45.914 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:51:45.922 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:51:45.965 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:51:46.027 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:51:46.037 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 18:51:46.043 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:46.044 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 118ms reading results.
2025-09-01 18:51:46.048 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:46.050 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 18:51:46.065 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:51:46.069 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 18:51:46.071 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:46.072 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 18:51:46.074 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 18:51:46.076 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 18:51:46.078 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:51:46.080 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 18:51:46.083 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:46.085 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 18:51:46.087 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 18:51:46.089 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 18:51:46.101 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 18:51:46.117 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 18:51:46.120 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 18:51:46.122 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 18:51:46.125 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 18:51:46.342 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 19:29:37.025 +03:00 [INF] This is a test log to file!
2025-09-01 19:29:37.622 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 19:29:37.640 +03:00 [INF] API configured successfully.
2025-09-01 19:29:37.792 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 19:29:37.865 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 19:29:38.332 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:29:38.382 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:29:38.390 +03:00 [INF] Registered 13 endpoints in 1,103 milliseconds.
2025-09-01 19:29:38.395 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:29:38.427 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:29:38.498 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:29:38.512 +03:00 [DBG] Created DbConnection. (8ms).
2025-09-01 19:29:38.516 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:38.523 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:29:38.525 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 19:29:38.527 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:38.558 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:38.563 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:38.567 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:29:38.568 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:38.571 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:38.573 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 19:29:38.577 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:29:38.582 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 19:29:38.585 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-09-01 19:29:38.591 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:29:38.614 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:29:38.618 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:29:38.618 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 19:29:38.619 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:29:38.620 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:29:38.6178722+00:00');
SELECT changes();
2025-09-01 19:29:38.625 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:29:38.6178722+00:00');
SELECT changes();
2025-09-01 19:29:38.663 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:29:38.666 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:29:38.668 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 19:29:38.669 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 19:29:38.670 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 19:29:38.672 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:29:38.673 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:29:38.676 +03:00 [DBG] Committing transaction.
2025-09-01 19:29:38.677 +03:00 [DBG] Committed transaction.
2025-09-01 19:29:38.678 +03:00 [DBG] Disposing transaction.
2025-09-01 19:29:38.680 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:29:38.681 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:29:38.683 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:29:38.684 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 19:29:38.685 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:38.686 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:38.687 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:38.688 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:29:38.690 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:29:38.690 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 19:29:38.691 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:29:38.692 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:29:38.694 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:29:38.697 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:29:38.698 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:29:38.700 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 19:29:38.701 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:29:38.704 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:29:38.708 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:38.710 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 19:29:38.714 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 19:29:38.715 +03:00 [DBG] Committing transaction.
2025-09-01 19:29:38.716 +03:00 [DBG] Committed transaction.
2025-09-01 19:29:38.717 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:29:38.718 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 19:29:38.719 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:29:38.720 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:29:38.724 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:29:38.725 +03:00 [DBG] Disposing transaction.
2025-09-01 19:29:38.727 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:38.730 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 19:29:38.731 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:29:38.732 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:38.734 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:29:38.735 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:29:38.736 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:29:38.768 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 19:29:38.799 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 19:29:38.801 +03:00 [DBG] Hosting starting
2025-09-01 19:29:38.811 +03:00 [DBG] Middleware loaded
2025-09-01 19:29:38.815 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 19:29:38.817 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 19:29:38.897 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 19:29:38.899 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 19:29:38.901 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 19:29:38.938 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 19:29:38.983 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 19:29:38.984 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 19:29:38.985 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 19:29:38.986 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 19:29:38.987 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 19:29:38.988 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 19:29:38.994 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:29:39.003 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:29:39.119 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 19:29:39.120 +03:00 [INF] Hosting environment: Development
2025-09-01 19:29:39.121 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 19:29:39.122 +03:00 [DBG] Hosting started
2025-09-01 19:29:40.500 +03:00 [DBG] Connection id "0HNF9EJ01NI39" received FIN.
2025-09-01 19:29:40.507 +03:00 [DBG] Connection id "0HNF9EJ01NI39" accepted.
2025-09-01 19:29:40.509 +03:00 [DBG] Connection id "0HNF9EJ01NI39" started.
2025-09-01 19:29:40.511 +03:00 [DBG] Connection id "0HNF9EJ01NI3A" accepted.
2025-09-01 19:29:40.512 +03:00 [DBG] Connection id "0HNF9EJ01NI3A" started.
2025-09-01 19:29:40.518 +03:00 [DBG] Connection id "0HNF9EJ01NI39" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:29:40.527 +03:00 [DBG] Connection id "0HNF9EJ01NI39" disconnecting.
2025-09-01 19:29:40.532 +03:00 [DBG] Connection id "0HNF9EJ01NI39" stopped.
2025-09-01 19:29:40.552 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:29:40.589 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:29:40.596 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:29:40.602 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:29:40.636 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 19:29:40.642 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 19:29:40.645 +03:00 [DBG] Connection id "0HNF9EJ01NI3A" completed keep alive response.
2025-09-01 19:29:40.647 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 100.7548ms
2025-09-01 19:29:40.650 +03:00 [DBG] Connection id "0HNF9EJ01NI3B" accepted.
2025-09-01 19:29:40.651 +03:00 [DBG] Connection id "0HNF9EJ01NI3B" received FIN.
2025-09-01 19:29:40.651 +03:00 [DBG] Connection id "0HNF9EJ01NI3C" accepted.
2025-09-01 19:29:40.677 +03:00 [DBG] Connection id "0HNF9EJ01NI3B" started.
2025-09-01 19:29:40.677 +03:00 [DBG] Connection id "0HNF9EJ01NI3A", Request id "0HNF9EJ01NI3A:00000001": started reading request body.
2025-09-01 19:29:40.678 +03:00 [DBG] Connection id "0HNF9EJ01NI3C" started.
2025-09-01 19:29:40.679 +03:00 [DBG] Connection id "0HNF9EJ01NI3B" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:29:40.680 +03:00 [DBG] Connection id "0HNF9EJ01NI3A", Request id "0HNF9EJ01NI3A:00000001": done reading request body.
2025-09-01 19:29:40.681 +03:00 [DBG] Connection id "0HNF9EJ01NI3B" disconnecting.
2025-09-01 19:29:40.683 +03:00 [DBG] Connection id "0HNF9EJ01NI3B" stopped.
2025-09-01 19:29:40.716 +03:00 [DBG] Connection 0HNF9EJ01NI3C established using the following protocol: "Tls13"
2025-09-01 19:29:40.720 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:29:40.723 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:29:40.724 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:29:40.725 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:29:40.729 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:29:40.750 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:29:40.753 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:29:40.793 +03:00 [DBG] Connection id "0HNF9EJ01NI3C", Request id "0HNF9EJ01NI3C:00000001": started reading request body.
2025-09-01 19:29:40.795 +03:00 [DBG] Connection id "0HNF9EJ01NI3C", Request id "0HNF9EJ01NI3C:00000001": done reading request body.
2025-09-01 19:29:40.885 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 19:29:40.922 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 19:29:41.140 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 19:29:41.173 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:29:41.175 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 19:29:41.177 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:41.178 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:41.179 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:29:41.180 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:29:41.182 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 19:29:41.185 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:29:41.191 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:29:41.223 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:29:41.270 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:29:41.280 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:29:41.285 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:41.295 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 102ms reading results.
2025-09-01 19:29:41.297 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:41.299 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:29:41.319 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:29:41.322 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:41.323 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:41.329 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:29:41.330 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:29:41.332 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 19:29:41.333 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:29:41.335 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:29:41.337 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:41.338 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:29:41.339 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:41.341 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:29:41.356 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:29:41.379 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 19:29:41.381 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 19:29:41.382 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 19:29:41.385 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:29:41.637 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 19:29:43.520 +03:00 [ERR] SQL execution failed after 2136 ms: Failed to convert parameter value from a Uri to a String.
2025-09-01 19:29:43.569 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:43.571 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:43.572 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:29:43.572 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:29:43.573 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:29:43.574 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:29:43.576 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:29:43.578 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:43.579 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:29:43.580 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:29:43.581 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:29:43.593 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 19:29:43.818 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:29:43.945 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.InvalidCastException: Failed to convert parameter value from a Uri to a String.
 ---> System.InvalidCastException: Object must implement IConvertible.
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   --- End of inner exception stack trace ---
   at Microsoft.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at Microsoft.Data.SqlClient.SqlParameter.GetCoercedValue()
   at Microsoft.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at Microsoft.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters, Boolean includeReturnValue)
   at Microsoft.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryInternal(CommandBehavior behavior, AsyncCallback callback, Object stateObject, Int32 timeout, Boolean inRetry, Boolean asyncWrite)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryAsync(AsyncCallback callback, Object stateObject)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_0(AsyncCallback callback, Object stateObject)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncImpl(Func`3 beginMethod, Func`2 endFunction, Action`1 endAction, Object state, TaskCreationOptions creationOptions)
   at System.Threading.Tasks.TaskFactory`1.FromAsync(Func`3 beginMethod, Func`2 endMethod, Object state)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQueryAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 19:29:43.958 +03:00 [ERR] Error occurred.
2025-09-01 19:29:43.965 +03:00 [DBG] Connection id "0HNF9EJ01NI3C" completed keep alive response.
2025-09-01 19:29:43.967 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:29:43.970 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:29:43.971 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:29:43.973 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 3253.1098ms
2025-09-01 19:33:05.505 +03:00 [INF] This is a test log to file!
2025-09-01 19:33:05.782 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 19:33:05.790 +03:00 [INF] API configured successfully.
2025-09-01 19:33:05.931 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 19:33:05.995 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 19:33:06.611 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:33:06.640 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:33:06.649 +03:00 [INF] Registered 13 endpoints in 1,054 milliseconds.
2025-09-01 19:33:06.656 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:33:06.690 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:33:06.776 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:06.795 +03:00 [DBG] Created DbConnection. (17ms).
2025-09-01 19:33:06.798 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:06.803 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:06.806 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 19:33:06.808 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:06.818 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:06.822 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:06.825 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:06.827 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:06.832 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:06.839 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 19:33:06.851 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:06.859 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (13ms).
2025-09-01 19:33:06.864 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (20ms).
2025-09-01 19:33:06.878 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:33:06.900 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:33:06.904 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:06.906 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:33:06.907 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:33:06.908 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:33:06.9042804+00:00');
SELECT changes();
2025-09-01 19:33:06.915 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:33:06.9042804+00:00');
SELECT changes();
2025-09-01 19:33:06.958 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:33:06.961 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:33:06.964 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 19:33:06.965 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 19:33:06.967 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-09-01 19:33:06.969 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:33:06.971 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:33:06.974 +03:00 [DBG] Committing transaction.
2025-09-01 19:33:06.975 +03:00 [DBG] Committed transaction.
2025-09-01 19:33:06.978 +03:00 [DBG] Disposing transaction.
2025-09-01 19:33:06.980 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:33:06.981 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:33:06.984 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:06.985 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 19:33:06.986 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:06.987 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:06.989 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:06.990 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:06.992 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:06.992 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 19:33:06.994 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:33:06.995 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:33:06.996 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:33:06.999 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:07.000 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:33:07.001 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 19:33:07.003 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:33:07.005 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:33:07.010 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:07.012 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 19:33:07.016 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 19:33:07.018 +03:00 [DBG] Committing transaction.
2025-09-01 19:33:07.019 +03:00 [DBG] Committed transaction.
2025-09-01 19:33:07.020 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:07.027 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (6ms).
2025-09-01 19:33:07.029 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-09-01 19:33:07.031 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:33:07.040 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:33:07.042 +03:00 [DBG] Disposing transaction.
2025-09-01 19:33:07.044 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:07.048 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-09-01 19:33:07.050 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:33:07.051 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:07.052 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:07.053 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:33:07.054 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:33:07.082 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 19:33:07.144 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 19:33:07.146 +03:00 [DBG] Hosting starting
2025-09-01 19:33:07.157 +03:00 [DBG] Middleware loaded
2025-09-01 19:33:07.160 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 19:33:07.169 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 19:33:07.258 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 19:33:07.260 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 19:33:07.264 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 19:33:07.305 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 19:33:07.382 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 19:33:07.383 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 19:33:07.384 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 19:33:07.384 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 19:33:07.385 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 19:33:07.386 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 19:33:07.393 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:33:07.403 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:33:07.451 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 19:33:07.457 +03:00 [INF] Hosting environment: Development
2025-09-01 19:33:07.457 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 19:33:07.458 +03:00 [DBG] Hosting started
2025-09-01 19:33:09.780 +03:00 [DBG] Connection id "0HNF9EKUDIRV3" received FIN.
2025-09-01 19:33:09.786 +03:00 [DBG] Connection id "0HNF9EKUDIRV3" accepted.
2025-09-01 19:33:09.787 +03:00 [DBG] Connection id "0HNF9EKUDIRV3" started.
2025-09-01 19:33:09.789 +03:00 [DBG] Connection id "0HNF9EKUDIRV4" accepted.
2025-09-01 19:33:09.790 +03:00 [DBG] Connection id "0HNF9EKUDIRV4" started.
2025-09-01 19:33:09.795 +03:00 [DBG] Connection id "0HNF9EKUDIRV3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:33:09.798 +03:00 [DBG] Connection id "0HNF9EKUDIRV3" disconnecting.
2025-09-01 19:33:09.801 +03:00 [DBG] Connection id "0HNF9EKUDIRV3" stopped.
2025-09-01 19:33:09.817 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:33:09.847 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:09.849 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:09.851 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:09.870 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 19:33:09.872 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 19:33:09.874 +03:00 [DBG] Connection id "0HNF9EKUDIRV4" completed keep alive response.
2025-09-01 19:33:09.876 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 63.5453ms
2025-09-01 19:33:09.876 +03:00 [DBG] Connection id "0HNF9EKUDIRV5" accepted.
2025-09-01 19:33:09.877 +03:00 [DBG] Connection id "0HNF9EKUDIRV5" received FIN.
2025-09-01 19:33:09.877 +03:00 [DBG] Connection id "0HNF9EKUDIRV6" accepted.
2025-09-01 19:33:09.905 +03:00 [DBG] Connection id "0HNF9EKUDIRV5" started.
2025-09-01 19:33:09.906 +03:00 [DBG] Connection id "0HNF9EKUDIRV4", Request id "0HNF9EKUDIRV4:00000001": started reading request body.
2025-09-01 19:33:09.907 +03:00 [DBG] Connection id "0HNF9EKUDIRV6" started.
2025-09-01 19:33:09.908 +03:00 [DBG] Connection id "0HNF9EKUDIRV5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:33:09.909 +03:00 [DBG] Connection id "0HNF9EKUDIRV4", Request id "0HNF9EKUDIRV4:00000001": done reading request body.
2025-09-01 19:33:09.911 +03:00 [DBG] Connection id "0HNF9EKUDIRV5" disconnecting.
2025-09-01 19:33:09.912 +03:00 [DBG] Connection id "0HNF9EKUDIRV5" stopped.
2025-09-01 19:33:09.946 +03:00 [DBG] Connection 0HNF9EKUDIRV6 established using the following protocol: "Tls13"
2025-09-01 19:33:09.950 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:33:09.955 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:09.956 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:09.959 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:09.963 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:09.977 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:33:09.981 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:33:10.017 +03:00 [DBG] Connection id "0HNF9EKUDIRV6", Request id "0HNF9EKUDIRV6:00000001": started reading request body.
2025-09-01 19:33:10.018 +03:00 [DBG] Connection id "0HNF9EKUDIRV6", Request id "0HNF9EKUDIRV6:00000001": done reading request body.
2025-09-01 19:33:10.088 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 19:33:10.122 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 19:33:10.286 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 19:33:10.316 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:10.319 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 19:33:10.321 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:10.324 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:10.325 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:10.326 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:10.330 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-09-01 19:33:10.333 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:10.339 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:10.370 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:10.405 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:10.414 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:10.418 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:10.419 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 77ms reading results.
2025-09-01 19:33:10.422 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:10.423 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:10.433 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:33:10.435 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:10.437 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:10.439 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:10.440 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:10.441 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 19:33:10.442 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:10.444 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:10.447 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:10.448 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:33:10.449 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:10.451 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:10.459 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:33:10.470 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 19:33:10.473 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 19:33:10.475 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 19:33:10.477 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:33:10.676 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 19:33:11.595 +03:00 [ERR] SQL execution failed after 1117 ms: Error converting data type varbinary to numeric.
2025-09-01 19:33:11.639 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:11.641 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:11.641 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:11.642 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:33:11.643 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:11.644 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:11.646 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:11.647 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:11.648 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 19:33:11.649 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:11.650 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:11.661 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 19:33:11.874 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:12.010 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Error converting data type varbinary to numeric.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
ClientConnectionId:196398b0-5a9a-4076-b250-66c11547d485
Error Number:8114,State:5,Class:16
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 19:33:12.029 +03:00 [ERR] Error occurred.
2025-09-01 19:33:12.037 +03:00 [DBG] Connection id "0HNF9EKUDIRV6" completed keep alive response.
2025-09-01 19:33:12.039 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:33:12.042 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:12.045 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 19:33:12.047 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 2096.8038ms
2025-09-01 19:33:41.475 +03:00 [INF] This is a test log to file!
2025-09-01 19:33:41.720 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 19:33:41.727 +03:00 [INF] API configured successfully.
2025-09-01 19:33:41.797 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 19:33:41.843 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 19:33:42.327 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:33:42.372 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:33:42.380 +03:00 [INF] Registered 13 endpoints in 806 milliseconds.
2025-09-01 19:33:42.386 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:33:42.451 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:33:42.563 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:42.573 +03:00 [DBG] Created DbConnection. (8ms).
2025-09-01 19:33:42.576 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:42.580 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:42.582 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 19:33:42.584 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:42.593 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:42.596 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:42.600 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:42.601 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:42.603 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:42.605 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 19:33:42.617 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:42.622 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:33:42.633 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (15ms).
2025-09-01 19:33:42.648 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:33:42.677 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:33:42.681 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:42.682 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:33:42.683 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:33:42.684 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:33:42.6807655+00:00');
SELECT changes();
2025-09-01 19:33:42.692 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:33:42.6807655+00:00');
SELECT changes();
2025-09-01 19:33:42.735 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:33:42.738 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:33:42.740 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 19:33:42.741 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 19:33:42.743 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 19:33:42.744 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:33:42.747 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:33:42.750 +03:00 [DBG] Committing transaction.
2025-09-01 19:33:42.752 +03:00 [DBG] Committed transaction.
2025-09-01 19:33:42.754 +03:00 [DBG] Disposing transaction.
2025-09-01 19:33:42.756 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:33:42.757 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:33:42.759 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:42.760 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 19:33:42.761 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:42.762 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:42.763 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:42.765 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:42.766 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:42.767 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:33:42.768 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:33:42.769 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:33:42.771 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:33:42.774 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:42.775 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:42.776 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 19:33:42.777 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:33:42.780 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:33:42.785 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:42.787 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 19:33:42.791 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 19:33:42.792 +03:00 [DBG] Committing transaction.
2025-09-01 19:33:42.793 +03:00 [DBG] Committed transaction.
2025-09-01 19:33:42.794 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:33:42.795 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 19:33:42.796 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:33:42.797 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:33:42.805 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:33:42.810 +03:00 [DBG] Disposing transaction.
2025-09-01 19:33:42.812 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:42.815 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 19:33:42.816 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:33:42.826 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:42.827 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:42.829 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:33:42.830 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:33:42.860 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 19:33:42.890 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 19:33:42.893 +03:00 [DBG] Hosting starting
2025-09-01 19:33:42.903 +03:00 [DBG] Middleware loaded
2025-09-01 19:33:42.906 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 19:33:42.907 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 19:33:42.999 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 19:33:43.000 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 19:33:43.002 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 19:33:43.028 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 19:33:43.087 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 19:33:43.088 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 19:33:43.090 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 19:33:43.099 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 19:33:43.100 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 19:33:43.101 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 19:33:43.107 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:33:43.120 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:33:43.214 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 19:33:43.223 +03:00 [INF] Hosting environment: Development
2025-09-01 19:33:43.225 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 19:33:43.225 +03:00 [DBG] Hosting started
2025-09-01 19:33:48.357 +03:00 [DBG] Connection id "0HNF9EL9TFEVB" received FIN.
2025-09-01 19:33:48.363 +03:00 [DBG] Connection id "0HNF9EL9TFEVB" accepted.
2025-09-01 19:33:48.367 +03:00 [DBG] Connection id "0HNF9EL9TFEVB" started.
2025-09-01 19:33:48.368 +03:00 [DBG] Connection id "0HNF9EL9TFEVC" accepted.
2025-09-01 19:33:48.370 +03:00 [DBG] Connection id "0HNF9EL9TFEVC" started.
2025-09-01 19:33:48.375 +03:00 [DBG] Connection id "0HNF9EL9TFEVB" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:33:48.378 +03:00 [DBG] Connection id "0HNF9EL9TFEVB" disconnecting.
2025-09-01 19:33:48.380 +03:00 [DBG] Connection id "0HNF9EL9TFEVB" stopped.
2025-09-01 19:33:48.396 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:33:48.428 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:48.430 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:48.432 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:48.453 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 19:33:48.456 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 19:33:48.458 +03:00 [DBG] Connection id "0HNF9EL9TFEVC" completed keep alive response.
2025-09-01 19:33:48.461 +03:00 [DBG] Connection id "0HNF9EL9TFEVD" accepted.
2025-09-01 19:33:48.461 +03:00 [DBG] Connection id "0HNF9EL9TFEVE" accepted.
2025-09-01 19:33:48.487 +03:00 [DBG] Connection id "0HNF9EL9TFEVD" started.
2025-09-01 19:33:48.461 +03:00 [DBG] Connection id "0HNF9EL9TFEVD" received FIN.
2025-09-01 19:33:48.461 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 69.3225ms
2025-09-01 19:33:48.492 +03:00 [DBG] Connection id "0HNF9EL9TFEVE" started.
2025-09-01 19:33:48.494 +03:00 [DBG] Connection id "0HNF9EL9TFEVD" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:33:48.499 +03:00 [DBG] Connection id "0HNF9EL9TFEVC", Request id "0HNF9EL9TFEVC:00000001": started reading request body.
2025-09-01 19:33:48.499 +03:00 [DBG] Connection id "0HNF9EL9TFEVD" disconnecting.
2025-09-01 19:33:48.500 +03:00 [DBG] Connection id "0HNF9EL9TFEVC", Request id "0HNF9EL9TFEVC:00000001": done reading request body.
2025-09-01 19:33:48.502 +03:00 [DBG] Connection id "0HNF9EL9TFEVD" stopped.
2025-09-01 19:33:48.528 +03:00 [DBG] Connection 0HNF9EL9TFEVE established using the following protocol: "Tls13"
2025-09-01 19:33:48.532 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:33:48.535 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:48.536 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:48.538 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:48.543 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:48.556 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:33:48.559 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:33:48.605 +03:00 [DBG] Connection id "0HNF9EL9TFEVE", Request id "0HNF9EL9TFEVE:00000001": started reading request body.
2025-09-01 19:33:48.607 +03:00 [DBG] Connection id "0HNF9EL9TFEVE", Request id "0HNF9EL9TFEVE:00000001": done reading request body.
2025-09-01 19:33:48.691 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 19:33:48.731 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 19:33:48.946 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 19:33:48.989 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:48.992 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 19:33:48.996 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:49.001 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:49.003 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:49.004 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:49.007 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-09-01 19:33:49.011 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:49.018 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:49.050 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:49.085 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:49.092 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:49.096 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:49.096 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 76ms reading results.
2025-09-01 19:33:49.099 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:49.100 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:49.109 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:33:49.112 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:49.113 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:49.114 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:49.115 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:33:49.116 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 19:33:49.118 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:49.119 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:49.121 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:49.122 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:33:49.123 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:49.124 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 19:33:49.132 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:33:49.143 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 19:33:49.146 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 19:33:49.147 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 19:33:49.149 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:33:49.459 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 19:33:50.148 +03:00 [ERR] SQL execution failed after 999 ms: Error converting data type varbinary to numeric.
2025-09-01 19:33:50.193 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:50.194 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:50.195 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:50.196 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:33:50.197 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:50.198 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:50.200 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:50.202 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:50.203 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:33:50.205 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:50.207 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:50.219 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 19:33:50.443 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:50.576 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Error converting data type varbinary to numeric.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
ClientConnectionId:aa38d40e-85e5-4d1c-9106-5c3a418eaa2c
Error Number:8114,State:5,Class:16
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 19:33:50.593 +03:00 [ERR] Error occurred.
2025-09-01 19:33:50.601 +03:00 [DBG] Connection id "0HNF9EL9TFEVE" completed keep alive response.
2025-09-01 19:33:50.603 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:33:50.606 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:50.607 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:50.609 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 2076.9883ms
2025-09-01 19:33:55.629 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:33:55.632 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:55.633 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:55.634 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:55.636 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 19:33:55.637 +03:00 [DBG] Connection id "0HNF9EL9TFEVC" completed keep alive response.
2025-09-01 19:33:55.638 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 9.3882ms
2025-09-01 19:33:55.639 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:33:55.641 +03:00 [DBG] Connection id "0HNF9EL9TFEVC", Request id "0HNF9EL9TFEVC:00000002": started reading request body.
2025-09-01 19:33:55.643 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:55.644 +03:00 [DBG] Connection id "0HNF9EL9TFEVC", Request id "0HNF9EL9TFEVC:00000002": done reading request body.
2025-09-01 19:33:55.645 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:33:55.647 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:55.649 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:33:55.658 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:33:55.660 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:33:55.661 +03:00 [DBG] Connection id "0HNF9EL9TFEVE", Request id "0HNF9EL9TFEVE:00000002": started reading request body.
2025-09-01 19:33:55.662 +03:00 [DBG] Connection id "0HNF9EL9TFEVE", Request id "0HNF9EL9TFEVE:00000002": done reading request body.
2025-09-01 19:33:55.665 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:33:55.665 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 19:33:55.666 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:55.668 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:55.669 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:55.669 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:33:55.671 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:55.672 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:55.673 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:55.675 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:55.676 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:55.678 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:33:55.679 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:55.680 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 19:33:55.681 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:55.682 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:55.684 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:33:55.685 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:33:55.687 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:55.688 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:33:55.688 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:33:55.689 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:33:55.691 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:55.693 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:33:55.694 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:55.695 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:33:55.697 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:33:55.698 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:33:55.699 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:33:55.700 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 19:33:55.701 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 19:33:55.703 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 19:33:55.703 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:33:55.705 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 19:37:21.291 +03:00 [ERR] SQL execution failed after 205587 ms: Error converting data type varbinary to numeric.
2025-09-01 19:37:21.335 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:37:21.336 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:37:21.337 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:37:21.338 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:37:21.339 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:37:21.340 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:37:21.342 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:37:21.343 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:37:21.344 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:37:21.345 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:37:21.346 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 19:37:21.347 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 19:37:21.568 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:37:21.678 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Error converting data type varbinary to numeric.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
ClientConnectionId:aa38d40e-85e5-4d1c-9106-5c3a418eaa2c
Error Number:8114,State:5,Class:16
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 19:37:21.685 +03:00 [ERR] Error occurred.
2025-09-01 19:37:21.686 +03:00 [DBG] Connection id "0HNF9EL9TFEVE" completed keep alive response.
2025-09-01 19:37:21.687 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:37:21.688 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:37:21.688 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 19:37:21.689 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 206049.8602ms
2025-09-01 19:38:39.312 +03:00 [DBG] Connection id "0HNF9EL9TFEVF" accepted.
2025-09-01 19:38:39.337 +03:00 [DBG] Connection id "0HNF9EL9TFEVF" started.
2025-09-01 19:38:39.338 +03:00 [DBG] Connection id "0HNF9EL9TFEVF" received FIN.
2025-09-01 19:38:39.342 +03:00 [DBG] Connection id "0HNF9EL9TFEVG" accepted.
2025-09-01 19:38:39.343 +03:00 [DBG] Connection id "0HNF9EL9TFEVF" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:38:39.346 +03:00 [DBG] Connection id "0HNF9EL9TFEVG" started.
2025-09-01 19:38:39.348 +03:00 [DBG] Connection id "0HNF9EL9TFEVF" disconnecting.
2025-09-01 19:38:39.349 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:38:39.349 +03:00 [DBG] Connection id "0HNF9EL9TFEVF" stopped.
2025-09-01 19:38:39.351 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:38:39.352 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:38:39.353 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:38:39.354 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 19:38:39.355 +03:00 [DBG] Connection id "0HNF9EL9TFEVG" completed keep alive response.
2025-09-01 19:38:39.356 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 6.8274ms
2025-09-01 19:38:39.356 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:38:39.358 +03:00 [DBG] Connection id "0HNF9EL9TFEVG", Request id "0HNF9EL9TFEVG:00000001": started reading request body.
2025-09-01 19:38:39.359 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:38:39.360 +03:00 [DBG] Connection id "0HNF9EL9TFEVG", Request id "0HNF9EL9TFEVG:00000001": done reading request body.
2025-09-01 19:38:39.361 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:38:39.362 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:38:39.364 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:38:39.365 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:38:39.367 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:38:39.367 +03:00 [DBG] Connection id "0HNF9EL9TFEVE", Request id "0HNF9EL9TFEVE:00000003": started reading request body.
2025-09-01 19:38:39.368 +03:00 [DBG] Connection id "0HNF9EL9TFEVE", Request id "0HNF9EL9TFEVE:00000003": done reading request body.
2025-09-01 19:38:39.370 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:38:39.371 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 19:38:39.372 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:38:39.373 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:38:39.373 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:38:39.374 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:38:39.375 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:38:39.376 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:38:39.377 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:38:39.379 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:38:39.380 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:38:39.381 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:38:39.382 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:38:39.383 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 19:38:39.384 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:38:39.384 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 19:38:39.386 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:38:39.386 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:38:39.387 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:38:39.388 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:38:39.389 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:38:39.390 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:38:39.391 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:38:39.392 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:38:39.394 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:38:39.395 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:38:39.396 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:38:39.396 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 19:38:39.398 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:38:39.398 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 19:38:39.399 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 19:38:39.400 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 19:38:39.401 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:38:39.402 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 19:44:07.986 +03:00 [INF] This is a test log to file!
2025-09-01 19:44:08.252 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 19:44:08.262 +03:00 [INF] API configured successfully.
2025-09-01 19:44:08.337 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 19:44:08.382 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 19:44:08.873 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:44:08.905 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:44:08.913 +03:00 [INF] Registered 13 endpoints in 822 milliseconds.
2025-09-01 19:44:08.920 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:44:08.966 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:44:09.073 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:44:09.100 +03:00 [DBG] Created DbConnection. (25ms).
2025-09-01 19:44:09.103 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:09.112 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:44:09.116 +03:00 [DBG] Created DbConnection. (4ms).
2025-09-01 19:44:09.118 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:09.126 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:09.131 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:09.136 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 19:44:09.137 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:09.139 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:09.141 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 19:44:09.145 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:44:09.149 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:44:09.151 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-09-01 19:44:09.156 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:44:09.175 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 19:44:09.178 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:44:09.179 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:44:09.180 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 19:44:09.181 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:44:09.1778482+00:00');
SELECT changes();
2025-09-01 19:44:09.186 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 16:44:09.1778482+00:00');
SELECT changes();
2025-09-01 19:44:09.225 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:44:09.228 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:44:09.230 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 19:44:09.231 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 19:44:09.232 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 19:44:09.233 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:44:09.235 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 19:44:09.237 +03:00 [DBG] Committing transaction.
2025-09-01 19:44:09.238 +03:00 [DBG] Committed transaction.
2025-09-01 19:44:09.240 +03:00 [DBG] Disposing transaction.
2025-09-01 19:44:09.242 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 19:44:09.242 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 19:44:09.244 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:44:09.245 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 19:44:09.245 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:09.247 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:09.248 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:09.249 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 19:44:09.250 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:44:09.251 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 19:44:09.252 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:44:09.253 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:44:09.254 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 19:44:09.257 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:44:09.257 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:44:09.258 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:44:09.260 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:44:09.262 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 19:44:09.265 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:09.267 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 19:44:09.271 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 19:44:09.271 +03:00 [DBG] Committing transaction.
2025-09-01 19:44:09.272 +03:00 [DBG] Committed transaction.
2025-09-01 19:44:09.273 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 19:44:09.274 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 19:44:09.274 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 19:44:09.275 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:44:09.279 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 19:44:09.280 +03:00 [DBG] Disposing transaction.
2025-09-01 19:44:09.282 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:09.284 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 19:44:09.285 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:44:09.286 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:09.287 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 19:44:09.288 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:44:09.289 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 19:44:09.312 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 19:44:09.338 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 19:44:09.340 +03:00 [DBG] Hosting starting
2025-09-01 19:44:09.351 +03:00 [DBG] Middleware loaded
2025-09-01 19:44:09.354 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 19:44:09.355 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 19:44:09.414 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 19:44:09.415 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 19:44:09.417 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 19:44:09.443 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 19:44:09.476 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 19:44:09.477 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 19:44:09.478 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 19:44:09.478 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 19:44:09.479 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 19:44:09.480 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 19:44:09.485 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:44:09.492 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 19:44:09.576 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 19:44:09.576 +03:00 [INF] Hosting environment: Development
2025-09-01 19:44:09.577 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 19:44:09.578 +03:00 [DBG] Hosting started
2025-09-01 19:44:10.669 +03:00 [DBG] Connection id "0HNF9ER3CA4Q8" received FIN.
2025-09-01 19:44:10.674 +03:00 [DBG] Connection id "0HNF9ER3CA4Q8" accepted.
2025-09-01 19:44:10.676 +03:00 [DBG] Connection id "0HNF9ER3CA4Q8" started.
2025-09-01 19:44:10.677 +03:00 [DBG] Connection id "0HNF9ER3CA4Q9" accepted.
2025-09-01 19:44:10.678 +03:00 [DBG] Connection id "0HNF9ER3CA4Q9" started.
2025-09-01 19:44:10.682 +03:00 [DBG] Connection id "0HNF9ER3CA4Q8" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:44:10.685 +03:00 [DBG] Connection id "0HNF9ER3CA4Q8" disconnecting.
2025-09-01 19:44:10.687 +03:00 [DBG] Connection id "0HNF9ER3CA4Q8" stopped.
2025-09-01 19:44:10.701 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:44:10.735 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:44:10.737 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:44:10.739 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:44:10.762 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 19:44:10.765 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 19:44:10.767 +03:00 [DBG] Connection id "0HNF9ER3CA4Q9" completed keep alive response.
2025-09-01 19:44:10.770 +03:00 [DBG] Connection id "0HNF9ER3CA4QA" accepted.
2025-09-01 19:44:10.770 +03:00 [DBG] Connection id "0HNF9ER3CA4QA" received FIN.
2025-09-01 19:44:10.770 +03:00 [DBG] Connection id "0HNF9ER3CA4QB" accepted.
2025-09-01 19:44:10.770 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 72.6696ms
2025-09-01 19:44:10.775 +03:00 [DBG] Connection id "0HNF9ER3CA4QA" started.
2025-09-01 19:44:10.777 +03:00 [DBG] Connection id "0HNF9ER3CA4QB" started.
2025-09-01 19:44:10.782 +03:00 [DBG] Connection id "0HNF9ER3CA4Q9", Request id "0HNF9ER3CA4Q9:00000001": started reading request body.
2025-09-01 19:44:10.782 +03:00 [DBG] Connection id "0HNF9ER3CA4QA" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 19:44:10.784 +03:00 [DBG] Connection id "0HNF9ER3CA4Q9", Request id "0HNF9ER3CA4Q9:00000001": done reading request body.
2025-09-01 19:44:10.785 +03:00 [DBG] Connection id "0HNF9ER3CA4QA" disconnecting.
2025-09-01 19:44:10.787 +03:00 [DBG] Connection id "0HNF9ER3CA4QA" stopped.
2025-09-01 19:44:10.812 +03:00 [DBG] Connection 0HNF9ER3CA4QB established using the following protocol: "Tls13"
2025-09-01 19:44:10.816 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 19:44:10.820 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:44:10.821 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 19:44:10.822 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:44:10.826 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:44:10.838 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 19:44:10.841 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 19:44:10.876 +03:00 [DBG] Connection id "0HNF9ER3CA4QB", Request id "0HNF9ER3CA4QB:00000001": started reading request body.
2025-09-01 19:44:10.877 +03:00 [DBG] Connection id "0HNF9ER3CA4QB", Request id "0HNF9ER3CA4QB:00000001": done reading request body.
2025-09-01 19:44:10.946 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 19:44:10.979 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 19:44:11.146 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 19:44:11.173 +03:00 [DBG] Creating DbConnection.
2025-09-01 19:44:11.173 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 19:44:11.175 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:11.177 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:11.178 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:44:11.179 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:44:11.182 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 19:44:11.185 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:44:11.191 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:44:11.220 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:44:11.251 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:44:11.260 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 19:44:11.264 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:11.265 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 72ms reading results.
2025-09-01 19:44:11.267 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:11.269 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:44:11.277 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:44:11.280 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:11.281 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:11.281 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:44:11.282 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 19:44:11.283 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:44:11.284 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:44:11.286 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:44:11.287 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:11.288 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 19:44:11.289 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:11.290 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:44:11.299 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 19:44:11.309 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 19:44:11.312 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 19:44:11.313 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 19:44:11.316 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:44:11.617 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 19:44:16.300 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 19:44:16.337 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:44:16.351 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 19:44:16.513 +03:00 [INF] Loaded 3 tables
2025-09-01 19:44:16.703 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 19:44:16.888 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 19:44:16.889 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 19:44:16.890 +03:00 [INF] Non-query execution finished in 4984 ms, affected 1 rows
2025-09-01 19:44:16.893 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:16.897 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:16.899 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 19:44:16.900 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 19:44:16.901 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 19:44:16.903 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:44:16.904 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 19:44:16.906 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:16.907 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 19:44:16.909 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 19:44:16.910 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:44:16.921 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 19:44:16.929 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 19:44:16.932 +03:00 [DBG] Connection id "0HNF9ER3CA4QB" completed keep alive response.
2025-09-01 19:44:16.934 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 19:44:16.936 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 19:44:16.938 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 19:44:16.940 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 200 null application/json; charset=utf-8 6124.2242ms
2025-09-01 20:01:03.881 +03:00 [INF] This is a test log to file!
2025-09-01 20:01:04.521 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 20:01:04.528 +03:00 [INF] API configured successfully.
2025-09-01 20:01:04.615 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 20:01:04.666 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 20:01:05.109 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:01:05.138 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 20:01:05.146 +03:00 [INF] Registered 13 endpoints in 824 milliseconds.
2025-09-01 20:01:05.152 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:01:05.186 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:01:05.253 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:01:05.263 +03:00 [DBG] Created DbConnection. (8ms).
2025-09-01 20:01:05.265 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 20:01:05.271 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:01:05.274 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-01 20:01:05.276 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:01:05.286 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:01:05.290 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:01:05.293 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:01:05.294 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:01:05.296 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:01:05.298 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 20:01:05.301 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:01:05.305 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:01:05.306 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-09-01 20:01:05.311 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:01:05.328 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:01:05.330 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:01:05.331 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 20:01:05.332 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:01:05.333 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:01:05.3306283+00:00');
SELECT changes();
2025-09-01 20:01:05.337 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:01:05.3306283+00:00');
SELECT changes();
2025-09-01 20:01:05.373 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:01:05.376 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:01:05.378 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 20:01:05.379 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 20:01:05.380 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 20:01:05.381 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:01:05.383 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:01:05.385 +03:00 [DBG] Committing transaction.
2025-09-01 20:01:05.386 +03:00 [DBG] Committed transaction.
2025-09-01 20:01:05.387 +03:00 [DBG] Disposing transaction.
2025-09-01 20:01:05.389 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:01:05.390 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:01:05.391 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:01:05.392 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:01:05.393 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:01:05.394 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:01:05.395 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:01:05.396 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:01:05.397 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:01:05.398 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 20:01:05.399 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:01:05.400 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:01:05.402 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:01:05.405 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:01:05.406 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:01:05.407 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:01:05.408 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:01:05.410 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:01:05.415 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:01:05.417 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 20:01:05.421 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 20:01:05.422 +03:00 [DBG] Committing transaction.
2025-09-01 20:01:05.423 +03:00 [DBG] Committed transaction.
2025-09-01 20:01:05.424 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:01:05.426 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:01:05.427 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:01:05.428 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:01:05.432 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:01:05.434 +03:00 [DBG] Disposing transaction.
2025-09-01 20:01:05.436 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:01:05.439 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 20:01:05.440 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:01:05.441 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:01:05.442 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:01:05.444 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:01:05.445 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:01:05.491 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 20:01:05.548 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 20:01:05.549 +03:00 [DBG] Hosting starting
2025-09-01 20:01:05.563 +03:00 [DBG] Middleware loaded
2025-09-01 20:01:05.571 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 20:01:05.573 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 20:01:05.653 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 20:01:05.660 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 20:01:05.663 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 20:01:05.719 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 20:01:06.011 +03:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5000: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__14_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-09-01 20:16:26.544 +03:00 [INF] This is a test log to file!
2025-09-01 20:16:26.923 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 20:16:26.935 +03:00 [INF] API configured successfully.
2025-09-01 20:16:27.051 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 20:16:27.106 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 20:16:27.585 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:16:27.616 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 20:16:27.627 +03:00 [INF] Registered 13 endpoints in 971 milliseconds.
2025-09-01 20:16:27.633 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:16:27.670 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:16:27.745 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:16:27.755 +03:00 [DBG] Created DbConnection. (8ms).
2025-09-01 20:16:27.758 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:27.763 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:16:27.766 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-01 20:16:27.768 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:27.777 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:27.781 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:27.785 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:16:27.787 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:27.789 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:27.791 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 20:16:27.796 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:16:27.801 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:16:27.803 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-09-01 20:16:27.808 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:16:27.827 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:16:27.830 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:16:27.831 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 20:16:27.832 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:16:27.833 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:16:27.8305711+00:00');
SELECT changes();
2025-09-01 20:16:27.841 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:16:27.8305711+00:00');
SELECT changes();
2025-09-01 20:16:27.884 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:16:27.890 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:16:27.893 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 20:16:27.894 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 20:16:27.896 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-09-01 20:16:27.898 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:16:27.901 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:16:27.905 +03:00 [DBG] Committing transaction.
2025-09-01 20:16:27.907 +03:00 [DBG] Committed transaction.
2025-09-01 20:16:27.910 +03:00 [DBG] Disposing transaction.
2025-09-01 20:16:27.913 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:16:27.915 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:16:27.918 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:16:27.919 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 20:16:27.920 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:27.922 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:27.925 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:27.938 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (12ms).
2025-09-01 20:16:27.940 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:16:27.941 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:16:27.943 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:16:27.944 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:16:27.946 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:16:27.950 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:16:27.951 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:16:27.952 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:16:27.955 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:16:27.957 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:16:27.962 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:27.982 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 21ms reading results.
2025-09-01 20:16:27.989 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 20:16:27.991 +03:00 [DBG] Committing transaction.
2025-09-01 20:16:27.991 +03:00 [DBG] Committed transaction.
2025-09-01 20:16:27.993 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:16:28.014 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (20ms).
2025-09-01 20:16:28.015 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (22ms).
2025-09-01 20:16:28.017 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:16:28.022 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:16:28.024 +03:00 [DBG] Disposing transaction.
2025-09-01 20:16:28.026 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:28.045 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (19ms).
2025-09-01 20:16:28.046 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:16:28.047 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:28.049 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:16:28.050 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:16:28.051 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:16:28.081 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 20:16:28.116 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 20:16:28.119 +03:00 [DBG] Hosting starting
2025-09-01 20:16:28.134 +03:00 [DBG] Middleware loaded
2025-09-01 20:16:28.143 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 20:16:28.144 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 20:16:28.225 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 20:16:28.227 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 20:16:28.229 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 20:16:28.256 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 20:16:28.299 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 20:16:28.300 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 20:16:28.301 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 20:16:28.302 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 20:16:28.303 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 20:16:28.304 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 20:16:28.311 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 20:16:28.318 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 20:16:28.408 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 20:16:28.411 +03:00 [INF] Hosting environment: Development
2025-09-01 20:16:28.412 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 20:16:28.413 +03:00 [DBG] Hosting started
2025-09-01 20:16:55.937 +03:00 [DBG] Connection id "0HNF9FDD2I8TS" received FIN.
2025-09-01 20:16:55.946 +03:00 [DBG] Connection id "0HNF9FDD2I8TS" accepted.
2025-09-01 20:16:55.951 +03:00 [DBG] Connection id "0HNF9FDD2I8TS" started.
2025-09-01 20:16:55.952 +03:00 [DBG] Connection id "0HNF9FDD2I8TT" accepted.
2025-09-01 20:16:55.953 +03:00 [DBG] Connection id "0HNF9FDD2I8TT" started.
2025-09-01 20:16:55.957 +03:00 [DBG] Connection id "0HNF9FDD2I8TS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:16:55.960 +03:00 [DBG] Connection id "0HNF9FDD2I8TS" disconnecting.
2025-09-01 20:16:55.962 +03:00 [DBG] Connection id "0HNF9FDD2I8TS" stopped.
2025-09-01 20:16:55.977 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 20:16:56.011 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:16:56.012 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:16:56.014 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:16:56.034 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 20:16:56.035 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 20:16:56.037 +03:00 [DBG] Connection id "0HNF9FDD2I8TT" completed keep alive response.
2025-09-01 20:16:56.039 +03:00 [DBG] Connection id "0HNF9FDD2I8TU" accepted.
2025-09-01 20:16:56.040 +03:00 [DBG] Connection id "0HNF9FDD2I8TU" received FIN.
2025-09-01 20:16:56.040 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 66.1773ms
2025-09-01 20:16:56.039 +03:00 [DBG] Connection id "0HNF9FDD2I8TV" accepted.
2025-09-01 20:16:56.065 +03:00 [DBG] Connection id "0HNF9FDD2I8TU" started.
2025-09-01 20:16:56.069 +03:00 [DBG] Connection id "0HNF9FDD2I8TV" started.
2025-09-01 20:16:56.070 +03:00 [DBG] Connection id "0HNF9FDD2I8TT", Request id "0HNF9FDD2I8TT:00000001": started reading request body.
2025-09-01 20:16:56.070 +03:00 [DBG] Connection id "0HNF9FDD2I8TU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:16:56.072 +03:00 [DBG] Connection id "0HNF9FDD2I8TT", Request id "0HNF9FDD2I8TT:00000001": done reading request body.
2025-09-01 20:16:56.072 +03:00 [DBG] Connection id "0HNF9FDD2I8TU" disconnecting.
2025-09-01 20:16:56.074 +03:00 [DBG] Connection id "0HNF9FDD2I8TU" stopped.
2025-09-01 20:16:56.102 +03:00 [DBG] Connection 0HNF9FDD2I8TV established using the following protocol: "Tls13"
2025-09-01 20:16:56.105 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 20:16:56.108 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:16:56.109 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:16:56.110 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:16:56.113 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:16:56.125 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:16:56.127 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 20:16:56.162 +03:00 [DBG] Connection id "0HNF9FDD2I8TV", Request id "0HNF9FDD2I8TV:00000001": started reading request body.
2025-09-01 20:16:56.164 +03:00 [DBG] Connection id "0HNF9FDD2I8TV", Request id "0HNF9FDD2I8TV:00000001": done reading request body.
2025-09-01 20:16:56.236 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 20:16:56.271 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 20:16:56.462 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 20:16:56.488 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:16:56.490 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 20:16:56.493 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:56.495 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:56.496 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:16:56.497 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:16:56.499 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 20:16:56.501 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:16:56.507 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:16:56.537 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:16:56.572 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:16:56.580 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:16:56.584 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:56.585 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 75ms reading results.
2025-09-01 20:16:56.588 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:56.589 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:16:56.597 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:16:56.599 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:56.600 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:56.601 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:16:56.602 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:16:56.603 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:16:56.604 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:16:56.606 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:16:56.608 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:56.608 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 20:16:56.609 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:56.610 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:16:56.618 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:16:56.628 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 20:16:56.632 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 20:16:56.633 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 20:16:56.635 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:16:56.839 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 20:16:56.900 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 20:16:56.909 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:16:56.919 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:16:56.993 +03:00 [INF] Loaded 3 tables
2025-09-01 20:16:57.145 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 20:16:57.247 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 20:16:57.248 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 20:16:57.250 +03:00 [INF] Non-query execution finished in 264 ms, affected 1 rows
2025-09-01 20:16:57.253 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:57.254 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:57.255 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:16:57.256 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:16:57.258 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:16:57.259 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:16:57.261 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:16:57.262 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:57.263 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 20:16:57.264 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:16:57.265 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:16:57.276 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 20:16:57.283 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:16:57.286 +03:00 [DBG] Connection id "0HNF9FDD2I8TV" completed keep alive response.
2025-09-01 20:16:57.288 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:16:57.290 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:16:57.291 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:16:57.293 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 200 null application/json; charset=utf-8 1187.7573ms
2025-09-01 20:22:40.284 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" accepted.
2025-09-01 20:22:40.286 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" started.
2025-09-01 20:22:40.292 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-09-01 20:22:40.294 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-09-01 20:22:40.296 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-09-01 20:22:40.298 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-09-01 20:22:40.299 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" completed keep alive response.
2025-09-01 20:22:40.300 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 8.1188ms
2025-09-01 20:22:40.380 +03:00 [DBG] Connection id "0HNF9FDD2I8U1" accepted.
2025-09-01 20:22:40.381 +03:00 [DBG] Connection id "0HNF9FDD2I8U1" started.
2025-09-01 20:22:40.403 +03:00 [DBG] Connection id "0HNF9FDD2I8U1" received FIN.
2025-09-01 20:22:40.522 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-09-01 20:22:40.527 +03:00 [DBG] Connection id "0HNF9FDD2I8U1" stopped.
2025-09-01 20:22:40.528 +03:00 [DBG] Connection id "0HNF9FDD2I8U1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:22:42.418 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-09-01 20:22:42.421 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-09-01 20:22:42.423 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-09-01 20:22:42.425 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-09-01 20:22:42.426 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" completed keep alive response.
2025-09-01 20:22:42.427 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 9.2517ms
2025-09-01 20:22:42.428 +03:00 [DBG] Connection id "0HNF9FDD2I8U2" accepted.
2025-09-01 20:22:42.430 +03:00 [DBG] Connection id "0HNF9FDD2I8U2" started.
2025-09-01 20:22:42.433 +03:00 [DBG] Connection id "0HNF9FDD2I8U2" received FIN.
2025-09-01 20:22:42.508 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-09-01 20:22:42.511 +03:00 [DBG] Connection id "0HNF9FDD2I8U2" stopped.
2025-09-01 20:22:42.512 +03:00 [DBG] Connection id "0HNF9FDD2I8U2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:22:44.436 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-09-01 20:22:44.440 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-09-01 20:22:44.442 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-09-01 20:22:44.443 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-09-01 20:22:44.444 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" completed keep alive response.
2025-09-01 20:22:44.445 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 8.8487ms
2025-09-01 20:22:44.446 +03:00 [DBG] Connection id "0HNF9FDD2I8U3" accepted.
2025-09-01 20:22:44.449 +03:00 [DBG] Connection id "0HNF9FDD2I8U3" started.
2025-09-01 20:22:44.453 +03:00 [DBG] Connection id "0HNF9FDD2I8U3" received FIN.
2025-09-01 20:22:44.536 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-09-01 20:22:44.538 +03:00 [DBG] Connection id "0HNF9FDD2I8U3" stopped.
2025-09-01 20:22:44.539 +03:00 [DBG] Connection id "0HNF9FDD2I8U3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:22:46.462 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-09-01 20:22:46.464 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-09-01 20:22:46.466 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-09-01 20:22:46.467 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-09-01 20:22:46.468 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" completed keep alive response.
2025-09-01 20:22:46.469 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 7.8701ms
2025-09-01 20:22:46.472 +03:00 [DBG] Connection id "0HNF9FDD2I8U4" accepted.
2025-09-01 20:22:46.473 +03:00 [DBG] Connection id "0HNF9FDD2I8U4" started.
2025-09-01 20:22:46.476 +03:00 [DBG] Connection id "0HNF9FDD2I8U4" received FIN.
2025-09-01 20:22:46.603 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-09-01 20:22:46.607 +03:00 [DBG] Connection id "0HNF9FDD2I8U4" stopped.
2025-09-01 20:22:46.608 +03:00 [DBG] Connection id "0HNF9FDD2I8U4" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:22:48.483 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-09-01 20:22:48.487 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-09-01 20:22:48.488 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-09-01 20:22:48.489 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-09-01 20:22:48.490 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" completed keep alive response.
2025-09-01 20:22:48.491 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 8.1997ms
2025-09-01 20:22:48.492 +03:00 [DBG] Connection id "0HNF9FDD2I8U5" accepted.
2025-09-01 20:22:48.493 +03:00 [DBG] Connection id "0HNF9FDD2I8U5" started.
2025-09-01 20:22:48.497 +03:00 [DBG] Connection id "0HNF9FDD2I8U5" received FIN.
2025-09-01 20:22:48.574 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-09-01 20:22:48.576 +03:00 [DBG] Connection id "0HNF9FDD2I8U5" stopped.
2025-09-01 20:22:48.576 +03:00 [DBG] Connection id "0HNF9FDD2I8U5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:22:52.492 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" received FIN.
2025-09-01 20:22:52.494 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:22:52.495 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" disconnecting.
2025-09-01 20:22:52.496 +03:00 [DBG] Connection id "0HNF9FDD2I8U0" stopped.
2025-09-01 20:27:03.184 +03:00 [INF] This is a test log to file!
2025-09-01 20:27:03.889 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 20:27:03.896 +03:00 [INF] API configured successfully.
2025-09-01 20:27:03.979 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 20:27:04.033 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 20:27:04.457 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:27:04.486 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 20:27:04.497 +03:00 [INF] Registered 13 endpoints in 753 milliseconds.
2025-09-01 20:27:04.504 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:27:04.537 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:27:04.612 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:27:04.621 +03:00 [DBG] Created DbConnection. (7ms).
2025-09-01 20:27:04.624 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 20:27:04.628 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:27:04.630 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 20:27:04.632 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:27:04.640 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:27:04.643 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:27:04.647 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:27:04.648 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:27:04.650 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:27:04.652 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 20:27:04.656 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:27:04.661 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:27:04.663 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-09-01 20:27:04.671 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:27:04.692 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:27:04.697 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:27:04.700 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 20:27:04.701 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (4ms).
2025-09-01 20:27:04.702 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:27:04.696633+00:00');
SELECT changes();
2025-09-01 20:27:04.712 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:27:04.696633+00:00');
SELECT changes();
2025-09-01 20:27:04.771 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:27:04.774 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:27:04.777 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 20:27:04.778 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 20:27:04.780 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-09-01 20:27:04.782 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:27:04.784 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:27:04.787 +03:00 [DBG] Committing transaction.
2025-09-01 20:27:04.789 +03:00 [DBG] Committed transaction.
2025-09-01 20:27:04.790 +03:00 [DBG] Disposing transaction.
2025-09-01 20:27:04.793 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:27:04.794 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:27:04.796 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:27:04.796 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:27:04.797 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:27:04.799 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:27:04.800 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:27:04.801 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:27:04.803 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:27:04.804 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:27:04.805 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:27:04.806 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:27:04.808 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:27:04.811 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:27:04.812 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:27:04.813 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:27:04.815 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:27:04.818 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:27:04.822 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:27:04.825 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 20:27:04.829 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 20:27:04.830 +03:00 [DBG] Committing transaction.
2025-09-01 20:27:04.830 +03:00 [DBG] Committed transaction.
2025-09-01 20:27:04.831 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:27:04.831 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 20:27:04.832 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:27:04.833 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:27:04.838 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:27:04.839 +03:00 [DBG] Disposing transaction.
2025-09-01 20:27:04.840 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:27:04.843 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 20:27:04.844 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:27:04.844 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:27:04.845 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:27:04.846 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:27:04.847 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:27:04.869 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 20:27:04.893 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 20:27:04.894 +03:00 [DBG] Hosting starting
2025-09-01 20:27:04.905 +03:00 [DBG] Middleware loaded
2025-09-01 20:27:04.907 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 20:27:04.908 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 20:27:04.972 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 20:27:04.974 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 20:27:04.977 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 20:27:05.004 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 20:27:05.045 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 20:27:05.047 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 20:27:05.048 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 20:27:05.050 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 20:27:05.051 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 20:27:05.052 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 20:27:05.058 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 20:27:05.067 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 20:27:05.094 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 20:27:05.096 +03:00 [INF] Hosting environment: Development
2025-09-01 20:27:05.097 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 20:27:05.098 +03:00 [DBG] Hosting started
2025-09-01 20:28:02.808 +03:00 [DBG] Connection id "0HNF9FJJQB59A" received FIN.
2025-09-01 20:28:02.817 +03:00 [DBG] Connection id "0HNF9FJJQB59A" accepted.
2025-09-01 20:28:02.824 +03:00 [DBG] Connection id "0HNF9FJJQB59A" started.
2025-09-01 20:28:02.825 +03:00 [DBG] Connection id "0HNF9FJJQB59B" accepted.
2025-09-01 20:28:02.826 +03:00 [DBG] Connection id "0HNF9FJJQB59B" started.
2025-09-01 20:28:02.830 +03:00 [DBG] Connection id "0HNF9FJJQB59A" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:28:02.833 +03:00 [DBG] Connection id "0HNF9FJJQB59A" disconnecting.
2025-09-01 20:28:02.835 +03:00 [DBG] Connection id "0HNF9FJJQB59A" stopped.
2025-09-01 20:28:02.849 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 20:28:02.885 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:28:02.886 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:28:02.889 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:28:02.916 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 20:28:02.918 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'.
2025-09-01 20:28:02.921 +03:00 [DBG] Connection id "0HNF9FJJQB59B" completed keep alive response.
2025-09-01 20:28:02.923 +03:00 [DBG] Connection id "0HNF9FJJQB59C" accepted.
2025-09-01 20:28:02.924 +03:00 [DBG] Connection id "0HNF9FJJQB59D" accepted.
2025-09-01 20:28:02.949 +03:00 [DBG] Connection id "0HNF9FJJQB59C" started.
2025-09-01 20:28:02.923 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 307 0 null 78.3006ms
2025-09-01 20:28:02.924 +03:00 [DBG] Connection id "0HNF9FJJQB59C" received FIN.
2025-09-01 20:28:02.954 +03:00 [DBG] Connection id "0HNF9FJJQB59D" started.
2025-09-01 20:28:02.959 +03:00 [DBG] Connection id "0HNF9FJJQB59C" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:28:02.961 +03:00 [DBG] Connection id "0HNF9FJJQB59C" disconnecting.
2025-09-01 20:28:02.963 +03:00 [DBG] Connection id "0HNF9FJJQB59C" stopped.
2025-09-01 20:28:02.991 +03:00 [DBG] Connection 0HNF9FJJQB59D established using the following protocol: "Tls13"
2025-09-01 20:28:02.995 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 20:28:02.998 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:28:02.999 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:28:03.000 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:28:03.004 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:28:03.037 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:28:03.116 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 20:28:03.152 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 20:28:03.353 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 20:28:03.380 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:28:03.380 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:28:03.382 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:28:03.384 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:03.385 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:28:03.386 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:28:03.388 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:28:03.390 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:03.395 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:03.425 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:28:03.456 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:28:03.464 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:28:03.468 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:03.470 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 72ms reading results.
2025-09-01 20:28:03.472 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:03.474 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:28:03.476 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:28:03.479 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:28:03.480 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:03.481 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:28:03.482 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:28:03.482 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:28:03.483 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:03.485 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:03.486 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:03.487 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 20:28:03.488 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:03.489 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:28:03.497 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:28:03.511 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:28:03.513 +03:00 [DBG] Connection id "0HNF9FJJQB59D" completed keep alive response.
2025-09-01 20:28:03.514 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:28:03.517 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:28:03.518 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:28:03.520 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 200 null application/json; charset=utf-8 525.5653ms
2025-09-01 20:28:17.954 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-09-01 20:28:17.958 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-01 20:28:17.959 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 20:28:17.960 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-09-01 20:28:17.961 +03:00 [DBG] Connection id "0HNF9FJJQB59B" completed keep alive response.
2025-09-01 20:28:17.962 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 8.175ms
2025-09-01 20:28:17.963 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-09-01 20:28:17.967 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-01 20:28:17.968 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 20:28:17.969 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 20:28:17.971 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:28:17.982 +03:00 [INF] Listing all profiles
2025-09-01 20:28:17.986 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()'
2025-09-01 20:28:17.988 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 20:28:18.001 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Profile>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Profile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Profile instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Profile);
                (object)dataReader.GetGuid(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                            {
                                return 
                                {
                                    Profile instance;
                                    instance = new Profile();
                                    instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                    instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                    instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                    instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Profile)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetGuid(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (Profile)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                Query entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    Query instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(Query);
                    dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                {
                                    return 
                                    {
                                        Query instance;
                                        instance = new Query();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                        instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                        instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                        instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                        instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                        instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Query)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                    entity: namelessParameter{11}, 
                    value: namelessParameter{12}, 
                    forMaterialization: True);
                return namelessParameter{12}.<Profile>k__BackingField = namelessParameter{11};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (Profile)(resultContext.Values[0]) : default(Profile);
    }, 
    contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-09-01 20:28:18.006 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:28:18.007 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:28:18.008 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:28:18.009 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.010 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:28:18.010 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:28:18.011 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:28:18.012 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-01 20:28:18.013 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-01 20:28:18.017 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.017 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 20:28:18.018 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.019 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:28:18.021 +03:00 [INF] Fetching connection string for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 20:28:18.022 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:28:18.023 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.023 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:28:18.024 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:28:18.025 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:28:18.026 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:18.027 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:18.029 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:28:18.030 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.031 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-01 20:28:18.032 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.033 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:28:18.035 +03:00 [DBG] Fetched secret for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-09-01 20:28:18.036 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:28:18.037 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:28:18.037 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.038 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:28:18.039 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:28:18.040 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:28:18.041 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:18.042 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:28:18.043 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:28:18.044 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:28:18.045 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:28:18.046 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.047 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 20:28:18.047 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:28:18.048 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:28:18.050 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:28:18.054 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-09-01 20:28:18.054 +03:00 [DBG] Connection id "0HNF9FJJQB59D" completed keep alive response.
2025-09-01 20:28:18.055 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:28:18.056 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:28:18.057 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:28:18.058 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 95.1445ms
2025-09-01 20:56:06.924 +03:00 [INF] This is a test log to file!
2025-09-01 20:56:07.279 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 20:56:07.286 +03:00 [INF] API configured successfully.
2025-09-01 20:56:07.364 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 20:56:07.409 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 20:56:07.789 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:56:07.815 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 20:56:07.822 +03:00 [INF] Registered 13 endpoints in 720 milliseconds.
2025-09-01 20:56:07.828 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:56:07.859 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:56:07.942 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:56:07.954 +03:00 [DBG] Created DbConnection. (10ms).
2025-09-01 20:56:07.957 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:07.962 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:56:07.964 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 20:56:07.965 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:07.981 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:07.991 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:07.995 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:56:07.996 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:07.999 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:08.001 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 20:56:08.006 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:56:08.012 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 20:56:08.014 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-09-01 20:56:08.021 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:56:08.040 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 20:56:08.044 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:56:08.045 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:56:08.046 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:56:08.047 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:56:08.0445615+00:00');
SELECT changes();
2025-09-01 20:56:08.053 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 17:56:08.0445615+00:00');
SELECT changes();
2025-09-01 20:56:08.099 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:56:08.105 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:56:08.107 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 20:56:08.108 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 20:56:08.109 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 20:56:08.121 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:56:08.123 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 20:56:08.126 +03:00 [DBG] Committing transaction.
2025-09-01 20:56:08.128 +03:00 [DBG] Committed transaction.
2025-09-01 20:56:08.133 +03:00 [DBG] Disposing transaction.
2025-09-01 20:56:08.141 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 20:56:08.142 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 20:56:08.145 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:56:08.146 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:56:08.147 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:08.148 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:08.150 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:08.151 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:56:08.153 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:56:08.154 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 20:56:08.155 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:56:08.156 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:56:08.157 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 20:56:08.160 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:56:08.161 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:56:08.162 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:56:08.163 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:56:08.166 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 20:56:08.170 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:08.173 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 20:56:08.177 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 20:56:08.178 +03:00 [DBG] Committing transaction.
2025-09-01 20:56:08.179 +03:00 [DBG] Committed transaction.
2025-09-01 20:56:08.180 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 20:56:08.181 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 20:56:08.182 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 20:56:08.183 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:56:08.188 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 20:56:08.190 +03:00 [DBG] Disposing transaction.
2025-09-01 20:56:08.192 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:08.195 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 20:56:08.196 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:56:08.197 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:08.198 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:56:08.199 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:56:08.199 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 20:56:08.218 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 20:56:08.240 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 20:56:08.241 +03:00 [DBG] Hosting starting
2025-09-01 20:56:08.251 +03:00 [DBG] Middleware loaded
2025-09-01 20:56:08.253 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 20:56:08.254 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 20:56:08.310 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 20:56:08.313 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 20:56:08.315 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 20:56:08.338 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 20:56:08.367 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 20:56:08.369 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 20:56:08.370 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 20:56:08.371 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 20:56:08.371 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 20:56:08.372 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 20:56:08.377 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 20:56:08.382 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 20:56:08.407 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 20:56:08.409 +03:00 [INF] Hosting environment: Development
2025-09-01 20:56:08.409 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 20:56:08.410 +03:00 [DBG] Hosting started
2025-09-01 20:56:12.617 +03:00 [DBG] Connection id "0HNF9G3BDJSG5" received FIN.
2025-09-01 20:56:12.623 +03:00 [DBG] Connection id "0HNF9G3BDJSG5" accepted.
2025-09-01 20:56:12.624 +03:00 [DBG] Connection id "0HNF9G3BDJSG5" started.
2025-09-01 20:56:12.625 +03:00 [DBG] Connection id "0HNF9G3BDJSG6" accepted.
2025-09-01 20:56:12.626 +03:00 [DBG] Connection id "0HNF9G3BDJSG6" started.
2025-09-01 20:56:12.630 +03:00 [DBG] Connection id "0HNF9G3BDJSG5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:56:12.633 +03:00 [DBG] Connection id "0HNF9G3BDJSG5" disconnecting.
2025-09-01 20:56:12.636 +03:00 [DBG] Connection id "0HNF9G3BDJSG5" stopped.
2025-09-01 20:56:12.653 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 20:56:12.684 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:56:12.685 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:56:12.687 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:56:12.710 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 20:56:12.712 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'.
2025-09-01 20:56:12.714 +03:00 [DBG] Connection id "0HNF9G3BDJSG6" completed keep alive response.
2025-09-01 20:56:12.716 +03:00 [DBG] Connection id "0HNF9G3BDJSG7" accepted.
2025-09-01 20:56:12.716 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 307 0 null 68.9299ms
2025-09-01 20:56:12.717 +03:00 [DBG] Connection id "0HNF9G3BDJSG7" received FIN.
2025-09-01 20:56:12.716 +03:00 [DBG] Connection id "0HNF9G3BDJSG8" accepted.
2025-09-01 20:56:12.721 +03:00 [DBG] Connection id "0HNF9G3BDJSG7" started.
2025-09-01 20:56:12.726 +03:00 [DBG] Connection id "0HNF9G3BDJSG8" started.
2025-09-01 20:56:12.727 +03:00 [DBG] Connection id "0HNF9G3BDJSG7" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:56:12.728 +03:00 [DBG] Connection id "0HNF9G3BDJSG7" disconnecting.
2025-09-01 20:56:12.729 +03:00 [DBG] Connection id "0HNF9G3BDJSG7" stopped.
2025-09-01 20:56:12.755 +03:00 [DBG] Connection 0HNF9G3BDJSG8 established using the following protocol: "Tls13"
2025-09-01 20:56:12.758 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 20:56:12.762 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:56:12.763 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:56:12.765 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:56:12.769 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:56:12.781 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:56:12.863 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 20:56:12.897 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 20:56:13.073 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 20:56:13.098 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:56:13.099 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:56:13.101 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:13.103 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:13.104 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:56:13.105 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:56:13.107 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-01 20:56:13.110 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:56:13.115 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:56:13.149 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:56:13.199 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:56:13.209 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:56:13.212 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:13.214 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 96ms reading results.
2025-09-01 20:56:13.216 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:13.219 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 20:56:13.223 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:56:13.227 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:13.229 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:13.230 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:56:13.231 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:56:13.233 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:56:13.236 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:56:13.237 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:56:13.239 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:13.240 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 20:56:13.242 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:56:13.243 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:56:13.253 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:56:13.276 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:56:13.278 +03:00 [DBG] Connection id "0HNF9G3BDJSG8" completed keep alive response.
2025-09-01 20:56:13.280 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:56:13.283 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:56:13.285 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:56:13.288 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 200 null application/json; charset=utf-8 529.3019ms
2025-09-01 20:58:22.470 +03:00 [DBG] Connection id "0HNF9G3BDJSG9" received FIN.
2025-09-01 20:58:22.473 +03:00 [DBG] Connection id "0HNF9G3BDJSG9" accepted.
2025-09-01 20:58:22.477 +03:00 [DBG] Connection id "0HNF9G3BDJSG9" started.
2025-09-01 20:58:22.478 +03:00 [DBG] Connection id "0HNF9G3BDJSGA" accepted.
2025-09-01 20:58:22.482 +03:00 [DBG] Connection id "0HNF9G3BDJSG9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 20:58:22.482 +03:00 [DBG] Connection id "0HNF9G3BDJSGA" started.
2025-09-01 20:58:22.483 +03:00 [DBG] Connection id "0HNF9G3BDJSG9" disconnecting.
2025-09-01 20:58:22.485 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 20:58:22.485 +03:00 [DBG] Connection id "0HNF9G3BDJSG9" stopped.
2025-09-01 20:58:22.487 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:58:22.488 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:58:22.489 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:58:22.490 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 20:58:22.491 +03:00 [DBG] Connection id "0HNF9G3BDJSGA" completed keep alive response.
2025-09-01 20:58:22.492 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 7.5943ms
2025-09-01 20:58:22.494 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 20:58:22.496 +03:00 [DBG] Connection id "0HNF9G3BDJSGA", Request id "0HNF9G3BDJSGA:00000001": started reading request body.
2025-09-01 20:58:22.498 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:58:22.499 +03:00 [DBG] Connection id "0HNF9G3BDJSGA", Request id "0HNF9G3BDJSGA:00000001": done reading request body.
2025-09-01 20:58:22.499 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:58:22.501 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:58:22.502 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:58:22.513 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:58:22.515 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 20:58:22.530 +03:00 [DBG] Connection id "0HNF9G3BDJSG8", Request id "0HNF9G3BDJSG8:00000002": started reading request body.
2025-09-01 20:58:22.531 +03:00 [DBG] Connection id "0HNF9G3BDJSG8", Request id "0HNF9G3BDJSG8:00000002": done reading request body.
2025-09-01 20:58:22.543 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:58:22.543 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:58:22.544 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:58:22.545 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:22.546 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:58:22.547 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:58:22.548 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:58:22.549 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:58:22.550 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:58:22.552 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:58:22.554 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:58:22.555 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:58:22.556 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:22.557 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 20:58:22.558 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:22.559 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:58:22.566 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:58:22.567 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:58:22.568 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:22.569 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:58:22.570 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:58:22.571 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:58:22.571 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:58:22.573 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:58:22.574 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:22.575 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 20:58:22.576 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:22.577 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:58:22.579 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:58:22.590 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 20:58:22.592 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 20:58:22.593 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 20:58:22.595 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:58:22.769 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 20:58:49.747 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 20:58:49.758 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:58:49.778 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:58:49.848 +03:00 [INF] Loaded 3 tables
2025-09-01 20:58:50.022 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 20:58:50.077 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 20:58:50.079 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 20:58:53.586 +03:00 [INF] Non-query execution finished in 7045 ms, affected 1 rows
2025-09-01 20:58:57.336 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:58:57.338 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:57.340 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:58:57.341 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:58:57.341 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:58:57.342 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:58:57.343 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:58:57.345 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:57.346 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 20:58:57.347 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:58:57.348 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:58:57.358 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 20:58:57.361 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:58:57.364 +03:00 [DBG] Connection id "0HNF9G3BDJSG8" completed keep alive response.
2025-09-01 20:58:57.365 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:58:57.365 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:58:57.366 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:58:57.367 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 200 null application/json; charset=utf-8 34873.4806ms
2025-09-01 20:59:03.530 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 20:59:03.532 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:59:03.533 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:59:03.535 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:59:03.535 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'.
2025-09-01 20:59:03.536 +03:00 [DBG] Connection id "0HNF9G3BDJSGA" completed keep alive response.
2025-09-01 20:59:03.537 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 307 0 null 6.4979ms
2025-09-01 20:59:03.537 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 20:59:03.541 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:59:03.542 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 20:59:03.544 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:59:03.546 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:59:03.547 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:59:03.550 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:59:03.551 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 20:59:03.552 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:59:03.553 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:03.554 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:59:03.555 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:59:03.557 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 20:59:03.558 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:03.561 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:03.563 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:59:03.565 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:59:03.566 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:59:03.567 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:03.569 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 20:59:03.570 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:03.571 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:59:03.573 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:59:03.575 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:59:03.576 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:03.577 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:59:03.578 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:59:03.579 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:59:03.580 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:03.582 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:03.595 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:03.596 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 20:59:03.598 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:03.599 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:59:03.601 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:59:03.602 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 20:59:03.603 +03:00 [DBG] Connection id "0HNF9G3BDJSG8" completed keep alive response.
2025-09-01 20:59:03.604 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 20:59:03.605 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:59:03.607 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 20:59:03.608 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 200 null application/json; charset=utf-8 70.8916ms
2025-09-01 20:59:26.461 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 20:59:26.465 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:59:26.466 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:59:26.467 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:59:26.468 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 20:59:26.469 +03:00 [DBG] Connection id "0HNF9G3BDJSGA" completed keep alive response.
2025-09-01 20:59:26.470 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 10.7711ms
2025-09-01 20:59:26.494 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 20:59:26.496 +03:00 [DBG] Connection id "0HNF9G3BDJSGA", Request id "0HNF9G3BDJSGA:00000003": started reading request body.
2025-09-01 20:59:26.498 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:59:26.499 +03:00 [DBG] Connection id "0HNF9G3BDJSGA", Request id "0HNF9G3BDJSGA:00000003": done reading request body.
2025-09-01 20:59:26.499 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 20:59:26.501 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:59:26.502 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 20:59:26.504 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 20:59:26.505 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 20:59:26.506 +03:00 [DBG] Connection id "0HNF9G3BDJSG8", Request id "0HNF9G3BDJSG8:00000004": started reading request body.
2025-09-01 20:59:26.507 +03:00 [DBG] Connection id "0HNF9G3BDJSG8", Request id "0HNF9G3BDJSG8:00000004": done reading request body.
2025-09-01 20:59:26.508 +03:00 [DBG] Creating DbConnection.
2025-09-01 20:59:26.509 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 20:59:26.510 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:59:26.511 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:26.512 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:59:26.512 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:59:26.513 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:59:26.514 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:26.515 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:26.518 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:59:26.519 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:59:26.520 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 20:59:26.521 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:26.522 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 20:59:26.523 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:26.524 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:59:26.526 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:59:26.526 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:59:26.527 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:26.528 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:59:26.529 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:59:26.530 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:59:26.530 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:26.532 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:26.533 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:26.534 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 20:59:26.535 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:26.536 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 20:59:26.537 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 20:59:26.538 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 20:59:26.539 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 20:59:26.540 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 20:59:26.540 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:59:26.542 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 20:59:32.356 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 20:59:32.359 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:59:32.360 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 20:59:32.373 +03:00 [INF] Loaded 3 tables
2025-09-01 20:59:32.483 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 20:59:32.489 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 20:59:32.489 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 20:59:32.491 +03:00 [INF] Non-query execution finished in 5815 ms, affected 1 rows
2025-09-01 20:59:37.507 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 20:59:37.508 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:37.509 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 20:59:37.510 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 20:59:37.511 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 20:59:37.511 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:37.520 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 20:59:37.523 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:37.525 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 20:59:37.537 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 20:59:37.539 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:08:21.935 +03:00 [INF] This is a test log to file!
2025-09-01 21:08:22.200 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 21:08:22.208 +03:00 [INF] API configured successfully.
2025-09-01 21:08:22.292 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 21:08:22.343 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 21:08:22.773 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:08:22.824 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:08:22.832 +03:00 [INF] Registered 13 endpoints in 801 milliseconds.
2025-09-01 21:08:22.839 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:08:22.872 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:08:22.942 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:08:22.954 +03:00 [DBG] Created DbConnection. (8ms).
2025-09-01 21:08:22.957 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:22.961 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:08:22.963 +03:00 [DBG] Created DbConnection. (2ms).
2025-09-01 21:08:22.965 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:22.972 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:22.974 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:22.978 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:08:22.979 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:22.981 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:22.983 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 21:08:22.987 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:08:22.991 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 21:08:22.992 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-09-01 21:08:22.998 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 21:08:23.018 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 21:08:23.021 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:08:23.022 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 21:08:23.024 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-09-01 21:08:23.025 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 18:08:23.0213468+00:00');
SELECT changes();
2025-09-01 21:08:23.031 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 18:08:23.0213468+00:00');
SELECT changes();
2025-09-01 21:08:23.070 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 21:08:23.073 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 21:08:23.074 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 21:08:23.075 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 21:08:23.076 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-01 21:08:23.077 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 21:08:23.080 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 21:08:23.082 +03:00 [DBG] Committing transaction.
2025-09-01 21:08:23.083 +03:00 [DBG] Committed transaction.
2025-09-01 21:08:23.084 +03:00 [DBG] Disposing transaction.
2025-09-01 21:08:23.086 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 21:08:23.087 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 21:08:23.089 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:08:23.089 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:08:23.090 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:23.092 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:23.093 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:23.094 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:08:23.095 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:08:23.096 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 21:08:23.097 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 21:08:23.098 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 21:08:23.100 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 21:08:23.103 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:08:23.104 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:08:23.105 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:08:23.106 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 21:08:23.108 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 21:08:23.112 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:23.114 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 21:08:23.119 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 21:08:23.121 +03:00 [DBG] Committing transaction.
2025-09-01 21:08:23.121 +03:00 [DBG] Committed transaction.
2025-09-01 21:08:23.122 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:08:23.123 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 21:08:23.124 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 21:08:23.125 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 21:08:23.133 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 21:08:23.135 +03:00 [DBG] Disposing transaction.
2025-09-01 21:08:23.136 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:23.139 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 21:08:23.141 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:08:23.141 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:23.142 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:08:23.143 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 21:08:23.144 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 21:08:23.167 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 21:08:23.189 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 21:08:23.191 +03:00 [DBG] Hosting starting
2025-09-01 21:08:23.201 +03:00 [DBG] Middleware loaded
2025-09-01 21:08:23.204 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 21:08:23.206 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 21:08:23.264 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 21:08:23.267 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 21:08:23.268 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 21:08:23.291 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 21:08:23.331 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 21:08:23.332 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 21:08:23.333 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 21:08:23.334 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 21:08:23.334 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 21:08:23.335 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 21:08:23.340 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 21:08:23.346 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 21:08:23.377 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 21:08:23.378 +03:00 [INF] Hosting environment: Development
2025-09-01 21:08:23.380 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 21:08:23.381 +03:00 [DBG] Hosting started
2025-09-01 21:08:30.361 +03:00 [DBG] Connection id "0HNF9GA799H0P" received FIN.
2025-09-01 21:08:30.366 +03:00 [DBG] Connection id "0HNF9GA799H0P" accepted.
2025-09-01 21:08:30.367 +03:00 [DBG] Connection id "0HNF9GA799H0P" started.
2025-09-01 21:08:30.369 +03:00 [DBG] Connection id "0HNF9GA799H0Q" accepted.
2025-09-01 21:08:30.370 +03:00 [DBG] Connection id "0HNF9GA799H0Q" started.
2025-09-01 21:08:30.374 +03:00 [DBG] Connection id "0HNF9GA799H0P" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 21:08:30.378 +03:00 [DBG] Connection id "0HNF9GA799H0P" disconnecting.
2025-09-01 21:08:30.380 +03:00 [DBG] Connection id "0HNF9GA799H0P" stopped.
2025-09-01 21:08:30.401 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:08:30.450 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:08:30.453 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:08:30.455 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:08:30.481 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 21:08:30.483 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 21:08:30.495 +03:00 [DBG] Connection id "0HNF9GA799H0Q" completed keep alive response.
2025-09-01 21:08:30.498 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 101.4479ms
2025-09-01 21:08:30.498 +03:00 [DBG] Connection id "0HNF9GA799H0R" accepted.
2025-09-01 21:08:30.498 +03:00 [DBG] Connection id "0HNF9GA799H0R" received FIN.
2025-09-01 21:08:30.498 +03:00 [DBG] Connection id "0HNF9GA799H0S" accepted.
2025-09-01 21:08:30.512 +03:00 [DBG] Connection id "0HNF9GA799H0R" started.
2025-09-01 21:08:30.513 +03:00 [DBG] Connection id "0HNF9GA799H0Q", Request id "0HNF9GA799H0Q:00000001": started reading request body.
2025-09-01 21:08:30.514 +03:00 [DBG] Connection id "0HNF9GA799H0S" started.
2025-09-01 21:08:30.515 +03:00 [DBG] Connection id "0HNF9GA799H0R" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 21:08:30.516 +03:00 [DBG] Connection id "0HNF9GA799H0Q", Request id "0HNF9GA799H0Q:00000001": done reading request body.
2025-09-01 21:08:30.518 +03:00 [DBG] Connection id "0HNF9GA799H0R" disconnecting.
2025-09-01 21:08:30.520 +03:00 [DBG] Connection id "0HNF9GA799H0R" stopped.
2025-09-01 21:08:30.550 +03:00 [DBG] Connection 0HNF9GA799H0S established using the following protocol: "Tls13"
2025-09-01 21:08:30.554 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:08:30.558 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:08:30.559 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:08:30.560 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:08:30.564 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:08:30.576 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:08:30.579 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:08:30.615 +03:00 [DBG] Connection id "0HNF9GA799H0S", Request id "0HNF9GA799H0S:00000001": started reading request body.
2025-09-01 21:08:30.616 +03:00 [DBG] Connection id "0HNF9GA799H0S", Request id "0HNF9GA799H0S:00000001": done reading request body.
2025-09-01 21:08:30.691 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 21:08:30.730 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 21:08:30.992 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 21:08:31.032 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:08:31.032 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:08:31.034 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:31.036 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:31.038 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:08:31.038 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:08:31.041 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:08:31.044 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:08:31.051 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:08:31.088 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:08:31.140 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:08:31.150 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:08:31.154 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:31.156 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 101ms reading results.
2025-09-01 21:08:31.159 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:31.162 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 21:08:31.172 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:08:31.183 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:31.184 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:31.185 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:08:31.185 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:08:31.186 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:08:31.200 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:08:31.202 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:08:31.204 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:31.204 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:08:31.206 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:31.207 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:08:31.215 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:08:31.229 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 21:08:31.232 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 21:08:31.233 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 21:08:31.235 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:08:31.445 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 21:08:40.219 +03:00 [ERR] SQL execution failed after 8983 ms: Violation of PRIMARY KEY constraint 'PK_Products'. Cannot insert duplicate key in object 'dbo.Products'. The duplicate key value is (e905e9df-89d3-4256-8489-69d57bb8af19).
The statement has been terminated.
2025-09-01 21:08:40.278 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:40.279 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:40.280 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:08:40.281 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:08:40.283 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:08:40.284 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:08:40.286 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:08:40.289 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:40.290 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:08:40.291 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:08:40.292 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:08:52.698 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 21:08:52.920 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:08:53.049 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_Products'. Cannot insert duplicate key in object 'dbo.Products'. The duplicate key value is (e905e9df-89d3-4256-8489-69d57bb8af19).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
ClientConnectionId:53452440-166e-468c-abf7-b1e7844ba418
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 21:08:53.087 +03:00 [ERR] Error occurred.
2025-09-01 21:08:53.097 +03:00 [DBG] Connection id "0HNF9GA799H0S" completed keep alive response.
2025-09-01 21:08:53.099 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:08:53.102 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:08:53.104 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:08:53.106 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 22551.6751ms
2025-09-01 21:09:19.584 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:09:19.586 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:09:19.587 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:09:19.588 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:09:19.590 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 21:09:19.591 +03:00 [DBG] Connection id "0HNF9GA799H0Q" completed keep alive response.
2025-09-01 21:09:19.593 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 9.0097ms
2025-09-01 21:09:19.598 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:09:19.599 +03:00 [DBG] Connection id "0HNF9GA799H0Q", Request id "0HNF9GA799H0Q:00000002": started reading request body.
2025-09-01 21:09:19.601 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:09:19.602 +03:00 [DBG] Connection id "0HNF9GA799H0Q", Request id "0HNF9GA799H0Q:00000002": done reading request body.
2025-09-01 21:09:19.602 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:09:19.604 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:09:19.605 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:09:19.615 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:09:19.618 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:09:19.619 +03:00 [DBG] Connection id "0HNF9GA799H0S", Request id "0HNF9GA799H0S:00000002": started reading request body.
2025-09-01 21:09:19.620 +03:00 [DBG] Connection id "0HNF9GA799H0S", Request id "0HNF9GA799H0S:00000002": done reading request body.
2025-09-01 21:09:19.622 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:09:19.623 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:09:19.624 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:09:19.625 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:19.626 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:09:19.627 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:09:19.628 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:09:19.629 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:09:19.631 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:09:19.633 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:09:19.634 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:09:19.636 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:09:19.637 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:19.638 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 21:09:19.639 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:19.641 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:09:19.642 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:09:19.643 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:09:19.644 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:19.645 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:09:19.646 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:09:19.647 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:09:19.648 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:09:19.650 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:09:19.651 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:19.653 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:09:19.654 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:19.655 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:09:19.656 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:09:19.657 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 21:09:19.658 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 21:09:19.659 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 21:09:19.660 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:09:19.662 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 21:09:27.759 +03:00 [ERR] SQL execution failed after 8099 ms: Violation of PRIMARY KEY constraint 'PK_Products'. Cannot insert duplicate key in object 'dbo.Products'. The duplicate key value is (e905e9df-89d3-4256-8489-69d57bb8af19).
The statement has been terminated.
2025-09-01 21:09:27.803 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:09:27.805 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:27.806 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:09:27.806 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:09:27.807 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:09:27.809 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:09:27.810 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:09:27.812 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:27.813 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:09:27.815 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:09:27.816 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:08.868 +03:00 [INF] This is a test log to file!
2025-09-01 21:10:09.186 +03:00 [INF] Shared Kernal configured successfully.
2025-09-01 21:10:09.194 +03:00 [INF] API configured successfully.
2025-09-01 21:10:09.303 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-01 21:10:09.362 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-01 21:10:09.902 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:10:09.936 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:10:09.953 +03:00 [INF] Registered 13 endpoints in 968 milliseconds.
2025-09-01 21:10:09.960 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:10:10.004 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:10:10.092 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:10:10.109 +03:00 [DBG] Created DbConnection. (13ms).
2025-09-01 21:10:10.115 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:10.120 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:10:10.123 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-01 21:10:10.126 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:10.153 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:10.157 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:10.167 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (6ms).
2025-09-01 21:10:10.168 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:10.171 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:10.174 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-01 21:10:10.180 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:10:10.184 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 21:10:10.187 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-09-01 21:10:10.199 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 21:10:10.225 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-01 21:10:10.228 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:10:10.229 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 21:10:10.230 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 21:10:10.231 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 18:10:10.2283916+00:00');
SELECT changes();
2025-09-01 21:10:10.250 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-01 18:10:10.2283916+00:00');
SELECT changes();
2025-09-01 21:10:10.309 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 21:10:10.313 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 21:10:10.315 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-01 21:10:10.316 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-01 21:10:10.318 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-01 21:10:10.319 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 21:10:10.321 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-01 21:10:10.325 +03:00 [DBG] Committing transaction.
2025-09-01 21:10:10.329 +03:00 [DBG] Committed transaction.
2025-09-01 21:10:10.331 +03:00 [DBG] Disposing transaction.
2025-09-01 21:10:10.333 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-01 21:10:10.334 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-01 21:10:10.337 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:10:10.338 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:10:10.338 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:10.351 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:10.352 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:10.354 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:10.356 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:10:10.357 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-01 21:10:10.358 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 21:10:10.364 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 21:10:10.371 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-01 21:10:10.380 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:10.381 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:10.383 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:10:10.384 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 21:10:10.387 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-01 21:10:10.391 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:10.393 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 21:10:10.397 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-01 21:10:10.398 +03:00 [DBG] Committing transaction.
2025-09-01 21:10:10.399 +03:00 [DBG] Committed transaction.
2025-09-01 21:10:10.400 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-01 21:10:10.401 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-01 21:10:10.402 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-01 21:10:10.404 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 21:10:10.409 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-01 21:10:10.412 +03:00 [DBG] Disposing transaction.
2025-09-01 21:10:10.414 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:10.418 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-09-01 21:10:10.420 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:10:10.421 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:10.428 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (6ms).
2025-09-01 21:10:10.433 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 21:10:10.435 +03:00 [INF] Infrastructure configured successfully.
2025-09-01 21:10:10.463 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-01 21:10:10.503 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-01 21:10:10.505 +03:00 [DBG] Hosting starting
2025-09-01 21:10:10.517 +03:00 [DBG] Middleware loaded
2025-09-01 21:10:10.521 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-01 21:10:10.531 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-01 21:10:10.621 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-01 21:10:10.622 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-01 21:10:10.625 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-01 21:10:10.654 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-01 21:10:10.714 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-01 21:10:10.714 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-01 21:10:10.715 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-01 21:10:10.715 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-01 21:10:10.716 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-01 21:10:10.716 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-01 21:10:10.723 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 21:10:10.730 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-01 21:10:10.813 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-01 21:10:10.814 +03:00 [INF] Hosting environment: Development
2025-09-01 21:10:10.815 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-01 21:10:10.816 +03:00 [DBG] Hosting started
2025-09-01 21:10:22.296 +03:00 [DBG] Connection id "0HNF9GB8KPD82" received FIN.
2025-09-01 21:10:22.300 +03:00 [DBG] Connection id "0HNF9GB8KPD82" accepted.
2025-09-01 21:10:22.302 +03:00 [DBG] Connection id "0HNF9GB8KPD82" started.
2025-09-01 21:10:22.302 +03:00 [DBG] Connection id "0HNF9GB8KPD83" accepted.
2025-09-01 21:10:22.303 +03:00 [DBG] Connection id "0HNF9GB8KPD83" started.
2025-09-01 21:10:22.307 +03:00 [DBG] Connection id "0HNF9GB8KPD82" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 21:10:22.309 +03:00 [DBG] Connection id "0HNF9GB8KPD82" disconnecting.
2025-09-01 21:10:22.311 +03:00 [DBG] Connection id "0HNF9GB8KPD82" stopped.
2025-09-01 21:10:22.324 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:10:22.353 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:22.355 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:22.357 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:22.376 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-01 21:10:22.378 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 21:10:22.380 +03:00 [DBG] Connection id "0HNF9GB8KPD83" completed keep alive response.
2025-09-01 21:10:22.382 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 60.9913ms
2025-09-01 21:10:22.382 +03:00 [DBG] Connection id "0HNF9GB8KPD84" received FIN.
2025-09-01 21:10:22.382 +03:00 [DBG] Connection id "0HNF9GB8KPD84" accepted.
2025-09-01 21:10:22.382 +03:00 [DBG] Connection id "0HNF9GB8KPD85" accepted.
2025-09-01 21:10:22.390 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000001": started reading request body.
2025-09-01 21:10:22.391 +03:00 [DBG] Connection id "0HNF9GB8KPD84" started.
2025-09-01 21:10:22.391 +03:00 [DBG] Connection id "0HNF9GB8KPD85" started.
2025-09-01 21:10:22.393 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000001": done reading request body.
2025-09-01 21:10:22.393 +03:00 [DBG] Connection id "0HNF9GB8KPD84" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-01 21:10:22.395 +03:00 [DBG] Connection id "0HNF9GB8KPD84" disconnecting.
2025-09-01 21:10:22.397 +03:00 [DBG] Connection id "0HNF9GB8KPD84" stopped.
2025-09-01 21:10:22.422 +03:00 [DBG] Connection 0HNF9GB8KPD85 established using the following protocol: "Tls13"
2025-09-01 21:10:22.426 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:10:22.429 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:22.430 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:22.431 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:22.435 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:22.447 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:10:22.449 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:10:22.484 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000001": started reading request body.
2025-09-01 21:10:22.485 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000001": done reading request body.
2025-09-01 21:10:22.560 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-01 21:10:22.598 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-01 21:10:22.769 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-01 21:10:22.794 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:10:22.795 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:10:22.796 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:22.798 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:22.799 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:22.800 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:10:22.802 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:10:22.805 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:22.810 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:22.842 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:22.877 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:22.884 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:22.887 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:22.888 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 77ms reading results.
2025-09-01 21:10:22.891 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:22.892 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:22.900 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:22.903 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:22.904 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:22.904 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:22.906 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:22.907 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:10:22.908 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:22.909 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:22.911 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:22.912 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:10:22.914 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:22.915 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:22.923 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:22.935 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 21:10:22.938 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 21:10:22.939 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 21:10:22.941 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:10:23.101 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 21:10:26.274 +03:00 [ERR] SQL execution failed after 3333 ms: Violation of PRIMARY KEY constraint 'PK_Products'. Cannot insert duplicate key in object 'dbo.Products'. The duplicate key value is (e905e9df-89d3-4256-8489-69d57bb8af19).
The statement has been terminated.
2025-09-01 21:10:26.329 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:26.331 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:26.332 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:26.333 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:10:26.334 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:26.335 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:26.337 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:26.339 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:26.340 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:10:26.342 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:26.345 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-01 21:10:31.332 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:31.338 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:31.345 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 21:10:31.368 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:31.372 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 21:10:31.379 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-09-01 21:10:31.381 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 21:10:31.383 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 21:10:31.429 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:31.431 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:31.433 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:31.434 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:31.435 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:10:31.438 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 342), @p3='?' (Size = 118), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 21:10:31.443 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 342), @p3='?' (Size = 118), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 21:10:31.446 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:31.448 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-01 21:10:31.449 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:31.454 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-09-01 21:10:31.464 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:31.466 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-09-01 21:10:31.471 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-01T18:10:28.6493187Z","$type":"QueryAddedEvent"}
2025-09-01 21:10:31.474 +03:00 [INF] Saved query to DB for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:31.705 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:31.825 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_Products'. Cannot insert duplicate key in object 'dbo.Products'. The duplicate key value is (e905e9df-89d3-4256-8489-69d57bb8af19).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_1(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, IDictionary`2 parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 829
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 762
ClientConnectionId:daacb532-0391-4fad-9a3d-5e7829114d46
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, IDictionary`2 parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 779
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 269
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 274
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 57
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-01 21:10:31.839 +03:00 [ERR] Error occurred.
2025-09-01 21:10:31.847 +03:00 [DBG] Connection id "0HNF9GB8KPD85" completed keep alive response.
2025-09-01 21:10:31.848 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:10:31.851 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:31.853 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:31.854 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 500 null application/json; charset=utf-8 9428.019ms
2025-09-01 21:10:38.319 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 21:10:38.322 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:10:38.323 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:10:38.324 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:10:38.329 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'.
2025-09-01 21:10:38.330 +03:00 [DBG] Connection id "0HNF9GB8KPD83" completed keep alive response.
2025-09-01 21:10:38.331 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 307 0 null 11.9875ms
2025-09-01 21:10:38.332 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 21:10:38.335 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:10:38.336 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:10:38.338 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:10:38.339 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:10:38.349 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:10:38.356 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:10:38.357 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:10:38.358 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:38.359 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:38.360 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:38.361 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:38.362 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:10:38.363 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:38.364 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:38.366 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:38.367 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:38.369 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:38.369 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:38.370 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:38.371 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-01 21:10:38.373 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:38.374 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:38.375 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:38.376 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:38.377 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:38.379 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:38.379 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:10:38.380 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:38.381 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:38.382 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:38.384 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:38.385 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:10:38.386 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:38.387 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:10:38.389 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:38.399 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:10:38.401 +03:00 [DBG] Connection id "0HNF9GB8KPD85" completed keep alive response.
2025-09-01 21:10:38.402 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:10:38.403 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:38.404 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:38.405 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 200 null application/json; charset=utf-8 73.3766ms
2025-09-01 21:10:49.942 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:10:49.944 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:49.945 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:49.946 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:49.948 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 21:10:49.949 +03:00 [DBG] Connection id "0HNF9GB8KPD83" completed keep alive response.
2025-09-01 21:10:49.950 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 8.1023ms
2025-09-01 21:10:49.950 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 569
2025-09-01 21:10:49.953 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000003": started reading request body.
2025-09-01 21:10:49.954 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:49.955 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000003": done reading request body.
2025-09-01 21:10:49.956 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:10:49.958 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:49.959 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:49.960 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:10:49.962 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:10:49.963 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000003": started reading request body.
2025-09-01 21:10:49.964 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000003": done reading request body.
2025-09-01 21:10:49.967 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:10:49.967 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:10:49.968 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:49.969 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:49.970 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:49.970 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:10:49.971 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:49.972 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:49.974 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:49.975 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:49.976 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:49.977 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:49.978 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:49.979 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:49.980 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-01 21:10:49.981 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:49.981 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:10:49.983 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:49.984 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:49.984 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:49.985 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:49.986 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:10:49.987 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:49.987 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:49.989 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:49.991 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:49.992 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 21:10:49.992 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:49.993 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:10:49.995 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:49.995 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 21:10:49.996 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 21:10:49.997 +03:00 [DBG] SQL: INSERT INTO Products (Id, Name, StockQuantity, Price, CategoryId) VALUES (@param1, @param2, @param3, @param4,@param5);
2025-09-01 21:10:49.998 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:10:50.000 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 21:10:53.837 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-09-01 21:10:53.846 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:10:53.854 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:10:53.913 +03:00 [INF] Loaded 3 tables
2025-09-01 21:10:54.055 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-09-01 21:10:54.152 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 21:10:54.154 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-09-01 21:10:54.155 +03:00 [INF] Non-query execution finished in 3838 ms, affected 1 rows
2025-09-01 21:10:54.156 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:54.157 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:54.158 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:54.159 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:10:54.160 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:54.161 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:54.162 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:10:54.164 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:54.165 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:10:54.166 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:54.167 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:10:56.360 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:56.364 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:56.366 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 21:10:56.367 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:56.369 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 21:10:56.370 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-09-01 21:10:56.381 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 21:10:56.382 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 21:10:56.384 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:56.385 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:56.386 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:10:56.387 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:10:56.387 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:10:56.388 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 256), @p3='?' (Size = 118), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 21:10:56.407 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 256), @p3='?' (Size = 118), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 21:10:56.409 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:56.410 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 21:10:56.411 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:10:56.413 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-01 21:10:56.415 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:10:56.417 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-09-01 21:10:56.418 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-01T18:10:56.3588749Z","$type":"QueryAddedEvent"}
2025-09-01 21:10:56.419 +03:00 [INF] Saved query to DB for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:10:56.422 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:10:56.423 +03:00 [DBG] Connection id "0HNF9GB8KPD85" completed keep alive response.
2025-09-01 21:10:56.424 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:10:56.425 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:10:56.426 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:10:56.427 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 200 null application/json; charset=utf-8 6476.6308ms
2025-09-01 21:11:01.187 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 21:11:01.197 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:11:01.198 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:11:01.199 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:11:01.200 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'.
2025-09-01 21:11:01.201 +03:00 [DBG] Connection id "0HNF9GB8KPD83" completed keep alive response.
2025-09-01 21:11:01.202 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 307 0 null 14.9128ms
2025-09-01 21:11:01.203 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - null null
2025-09-01 21:11:01.217 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:11:01.217 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed'
2025-09-01 21:11:01.218 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:11:01.219 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:11:01.221 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:11:01.225 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:11:01.225 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:11:01.226 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:01.228 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:01.229 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:11:01.229 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:11:01.230 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:11:01.231 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:01.234 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:01.242 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:01.244 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:01.245 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:01.246 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:01.248 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:01.249 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:01.249 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 7ms reading results.
2025-09-01 21:11:01.251 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:01.252 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:11:01.253 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:11:01.254 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:01.255 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:01.256 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:11:01.271 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (14ms).
2025-09-01 21:11:01.272 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (15ms).
2025-09-01 21:11:01.273 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:01.274 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:01.276 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:01.277 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:11:01.279 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:01.280 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:11:01.297 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:11:01.300 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-09-01 21:11:01.301 +03:00 [DBG] Connection id "0HNF9GB8KPD85" completed keep alive response.
2025-09-01 21:11:01.302 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:11:01.303 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:01.304 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:11:01.305 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/773c7d30-609c-442f-ad98-0546699311ed - 200 null application/json; charset=utf-8 102.6247ms
2025-09-01 21:11:51.149 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 300
2025-09-01 21:11:51.155 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:11:51.157 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:11:51.158 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:11:51.159 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 21:11:51.160 +03:00 [DBG] Connection id "0HNF9GB8KPD83" completed keep alive response.
2025-09-01 21:11:51.160 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 34.7744ms
2025-09-01 21:11:51.205 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 300
2025-09-01 21:11:51.208 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000005": started reading request body.
2025-09-01 21:11:51.210 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:11:51.210 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000005": done reading request body.
2025-09-01 21:11:51.211 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:11:51.213 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:11:51.214 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:11:51.215 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:11:51.217 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:11:51.218 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000005": started reading request body.
2025-09-01 21:11:51.219 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000005": done reading request body.
2025-09-01 21:11:51.221 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:11:51.221 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-01 21:11:51.222 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:51.223 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.225 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:11:51.225 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:11:51.226 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:11:51.227 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:51.229 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:51.231 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:51.232 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:51.233 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:51.235 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:51.236 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:51.237 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.238 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 7ms reading results.
2025-09-01 21:11:51.240 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.241 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:11:51.243 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:11:51.244 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:51.244 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.245 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:11:51.246 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:11:51.247 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:11:51.248 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:51.250 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:51.252 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.253 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:11:51.254 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.255 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:11:51.257 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:11:51.258 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 21:11:51.259 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 21:11:51.260 +03:00 [DBG] SQL: Select * From Products
2025-09-01 21:11:51.261 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:11:51.262 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 21:11:51.268 +03:00 [INF] Query execution finished in 6 ms, returned 10 rows
2025-09-01 21:11:51.269 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:51.270 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.271 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:11:51.272 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:11:51.273 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:11:51.274 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:51.275 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:11:51.277 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.278 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:11:51.279 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:51.280 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:11:54.143 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:54.145 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:54.146 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 21:11:54.149 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:54.151 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 21:11:54.152 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-09-01 21:11:54.153 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-09-01 21:11:54.154 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-09-01 21:11:54.155 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:54.156 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:54.157 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:11:54.157 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:11:54.161 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-09-01 21:11:54.162 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 1159), @p3='?' (Size = 22), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 21:11:54.175 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 1159), @p3='?' (Size = 22), @p4='?' (DbType = DateTime), @p5='?' (Size = 129)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-01 21:11:54.176 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:54.177 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 21:11:54.178 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:11:54.179 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:11:54.180 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:11:54.181 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-09-01 21:11:54.182 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-01T18:11:54.1435665Z","$type":"QueryAddedEvent"}
2025-09-01 21:11:54.184 +03:00 [INF] Saved query to DB for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:11:54.186 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:11:54.187 +03:00 [DBG] Connection id "0HNF9GB8KPD85" completed keep alive response.
2025-09-01 21:11:54.187 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:11:54.188 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:11:54.189 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:11:54.190 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 200 null application/json; charset=utf-8 3028.6514ms
2025-09-01 21:12:02.870 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 300
2025-09-01 21:12:02.873 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:12:02.874 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:12:02.875 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:12:02.876 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'.
2025-09-01 21:12:02.877 +03:00 [DBG] Connection id "0HNF9GB8KPD83" completed keep alive response.
2025-09-01 21:12:02.878 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 307 0 null 8.1753ms
2025-09-01 21:12:02.878 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - application/json 300
2025-09-01 21:12:02.881 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000006": started reading request body.
2025-09-01 21:12:02.883 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:12:02.884 +03:00 [DBG] Connection id "0HNF9GB8KPD83", Request id "0HNF9GB8KPD83:00000006": done reading request body.
2025-09-01 21:12:02.885 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute'
2025-09-01 21:12:02.887 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:12:02.888 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:12:02.889 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-01 21:12:02.890 +03:00 [INF] Groq API key configured for HttpClient
2025-09-01 21:12:02.891 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000006": started reading request body.
2025-09-01 21:12:02.892 +03:00 [DBG] Connection id "0HNF9GB8KPD85", Request id "0HNF9GB8KPD85:00000006": done reading request body.
2025-09-01 21:12:02.894 +03:00 [DBG] Creating DbConnection.
2025-09-01 21:12:02.895 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-01 21:12:02.896 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:12:02.897 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.899 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:12:02.900 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:12:02.901 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-01 21:12:02.902 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:12:02.904 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:12:02.906 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:12:02.908 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:12:02.909 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:12:02.910 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:12:02.911 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:12:02.912 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-01 21:12:02.913 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.914 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 7ms reading results.
2025-09-01 21:12:02.915 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.916 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:12:02.917 +03:00 [INF] Fetching connection string for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:12:02.918 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:12:02.919 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.920 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:12:02.921 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:12:02.922 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-01 21:12:02.930 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:12:02.931 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:12:02.933 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.934 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-01 21:12:02.935 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.935 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:12:02.937 +03:00 [DBG] Fetched secret for profile "773c7d30-609c-442f-ad98-0546699311ed"
2025-09-01 21:12:02.937 +03:00 [INF] Executing SQL for Profile "773c7d30-609c-442f-ad98-0546699311ed", Mode="Write"
2025-09-01 21:12:02.938 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-09-01 21:12:02.939 +03:00 [DBG] SQL: Select * From Products
2025-09-01 21:12:02.939 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-01 21:12:02.940 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-01 21:12:02.942 +03:00 [INF] Query execution finished in 2 ms, returned 10 rows
2025-09-01 21:12:02.943 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:12:02.943 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.944 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-01 21:12:02.945 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-01 21:12:02.955 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-09-01 21:12:02.956 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:12:02.958 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-01 21:12:02.960 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.961 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-01 21:12:02.962 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-01 21:12:02.963 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-01 21:12:06.187 +03:00 [INF] Query not saved due to profile rules for profile "773c7d30-609c-442f-ad98-0546699311ed", Query already existed
2025-09-01 21:12:06.212 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-01 21:12:06.217 +03:00 [DBG] Connection id "0HNF9GB8KPD85" completed keep alive response.
2025-09-01 21:12:06.226 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-09-01 21:12:06.252 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-01 21:12:06.253 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-01 21:12:06.256 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/773c7d30-609c-442f-ad98-0546699311ed/execute - 200 null application/json; charset=utf-8 3377.8203ms
