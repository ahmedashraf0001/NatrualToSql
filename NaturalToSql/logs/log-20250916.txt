2025-09-16 22:52:27.967 +03:00 [INF] This is a test log to file!
2025-09-16 22:52:28.465 +03:00 [INF] Shared Kernal configured successfully.
2025-09-16 22:52:28.479 +03:00 [INF] API configured successfully.
2025-09-16 22:52:28.601 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-16 22:52:28.852 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-16 22:52:30.308 +03:00 [WRN] The foreign key property 'Profile.UserInfoId1' was created in shadow state because a conflicting property with the simple name 'UserInfoId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-16 22:52:30.432 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:52:30.488 +03:00 [INF] Registered 23 endpoints in 2,305 milliseconds.
2025-09-16 22:52:30.497 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:52:30.540 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:52:30.677 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:52:30.691 +03:00 [DBG] Created DbConnection. (13ms).
2025-09-16 22:52:30.694 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:30.714 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:52:30.717 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-16 22:52:30.720 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:30.769 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:30.774 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:30.779 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-16 22:52:30.782 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:30.786 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:30.789 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-16 22:52:30.796 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:52:30.804 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (5ms).
2025-09-16 22:52:30.806 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (11ms).
2025-09-16 22:52:30.813 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-16 22:52:30.851 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-16 22:52:30.855 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:52:30.856 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-16 22:52:30.857 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-16 22:52:30.858 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-16 19:52:30.8554792+00:00');
SELECT changes();
2025-09-16 22:52:30.872 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-16 19:52:30.8554792+00:00');
SELECT changes();
2025-09-16 22:52:30.928 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-16 22:52:30.933 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-16 22:52:30.936 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-16 22:52:30.937 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-16 22:52:30.941 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (5ms).
2025-09-16 22:52:30.944 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-16 22:52:30.947 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-16 22:52:30.950 +03:00 [DBG] Committing transaction.
2025-09-16 22:52:30.952 +03:00 [DBG] Committed transaction.
2025-09-16 22:52:30.954 +03:00 [DBG] Disposing transaction.
2025-09-16 22:52:30.957 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-16 22:52:30.959 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-16 22:52:30.962 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:52:30.963 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-16 22:52:30.964 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:30.966 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:30.968 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:30.970 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:52:30.973 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:52:30.975 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-16 22:52:30.977 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-09-16 22:52:30.978 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-16 22:52:30.981 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-16 22:52:30.986 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:52:30.988 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:52:30.989 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-16 22:52:30.992 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-16 22:52:30.995 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-16 22:52:31.001 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:31.005 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-09-16 22:52:31.013 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-16 22:52:31.015 +03:00 [DBG] Committing transaction.
2025-09-16 22:52:31.016 +03:00 [DBG] Committed transaction.
2025-09-16 22:52:31.017 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:52:31.018 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-16 22:52:31.019 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:52:31.020 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-16 22:52:31.027 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-16 22:52:31.030 +03:00 [DBG] Disposing transaction.
2025-09-16 22:52:31.032 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:31.035 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-09-16 22:52:31.037 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:52:31.038 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:31.039 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:52:31.040 +03:00 [INF] Infrastructure configured successfully.
2025-09-16 22:52:31.041 +03:00 [INF] Infrastructure configured successfully.
2025-09-16 22:52:31.087 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-16 22:52:31.136 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-16 22:52:31.141 +03:00 [DBG] Hosting starting
2025-09-16 22:52:31.174 +03:00 [DBG] Middleware loaded
2025-09-16 22:52:31.178 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-16 22:52:31.186 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-16 22:52:31.325 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-16 22:52:31.328 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-16 22:52:31.333 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-16 22:52:31.433 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-16 22:52:31.504 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-16 22:52:31.506 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-16 22:52:31.513 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-16 22:52:31.517 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-16 22:52:31.518 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-16 22:52:31.519 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-16 22:52:31.524 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-16 22:52:31.539 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-16 22:52:31.573 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-16 22:52:31.574 +03:00 [INF] Hosting environment: Development
2025-09-16 22:52:31.575 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-16 22:52:31.576 +03:00 [DBG] Hosting started
2025-09-16 22:52:35.414 +03:00 [DBG] Connection id "0HNFLBAAHSVEL" received FIN.
2025-09-16 22:52:35.420 +03:00 [DBG] Connection id "0HNFLBAAHSVEL" accepted.
2025-09-16 22:52:35.422 +03:00 [DBG] Connection id "0HNFLBAAHSVEL" started.
2025-09-16 22:52:35.423 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" accepted.
2025-09-16 22:52:35.424 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" started.
2025-09-16 22:52:35.428 +03:00 [DBG] Connection id "0HNFLBAAHSVEL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-16 22:52:35.432 +03:00 [DBG] Connection id "0HNFLBAAHSVEL" disconnecting.
2025-09-16 22:52:35.434 +03:00 [DBG] Connection id "0HNFLBAAHSVEL" stopped.
2025-09-16 22:52:35.487 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - application/json 190
2025-09-16 22:52:35.554 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:52:35.559 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:52:35.562 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:52:35.591 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-16 22:52:35.597 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'.
2025-09-16 22:52:35.600 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:52:35.610 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - 307 0 null 134.0496ms
2025-09-16 22:52:35.612 +03:00 [DBG] Connection id "0HNFLBAAHSVEN" received FIN.
2025-09-16 22:52:35.612 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" accepted.
2025-09-16 22:52:35.611 +03:00 [DBG] Connection id "0HNFLBAAHSVEN" accepted.
2025-09-16 22:52:35.622 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000001": started reading request body.
2025-09-16 22:52:35.622 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" started.
2025-09-16 22:52:35.623 +03:00 [DBG] Connection id "0HNFLBAAHSVEN" started.
2025-09-16 22:52:35.624 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000001": done reading request body.
2025-09-16 22:52:35.625 +03:00 [DBG] Connection id "0HNFLBAAHSVEN" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-16 22:52:35.627 +03:00 [DBG] Connection id "0HNFLBAAHSVEN" disconnecting.
2025-09-16 22:52:35.628 +03:00 [DBG] Connection id "0HNFLBAAHSVEN" stopped.
2025-09-16 22:52:35.690 +03:00 [DBG] Connection 0HNFLBAAHSVEO established using the following protocol: "Tls13"
2025-09-16 22:52:35.694 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - application/json 190
2025-09-16 22:52:35.697 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:52:35.698 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:52:35.699 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:52:35.703 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:52:35.724 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:52:35.772 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000001": started reading request body.
2025-09-16 22:52:35.773 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000001": done reading request body.
2025-09-16 22:52:35.845 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-16 22:52:35.879 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-16 22:52:36.087 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
                3 -> 9
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, p0.UserInfoId, p0.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
                3 -> 9
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, p0.UserInfoId, p0.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    shadowSnapshot1 = (ISnapshot)new Snapshot<Guid?>(dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8));
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        instance.<UserInfoId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(9) ? default(Guid?) : (Guid?)dataReader.GetGuid(9) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetGuid(9) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(9) ? default(Guid) : dataReader.GetGuid(9);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(10) ? default(Guid) : dataReader.GetGuid(10);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime) : dataReader.GetDateTime(13);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ContextDB, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-16 22:52:36.120 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:52:36.121 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-16 22:52:36.123 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:36.125 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:36.126 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:52:36.127 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:52:36.129 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:52:36.131 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:52:36.136 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:52:36.162 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:52:36.206 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:52:36.218 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:36.219 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 80ms reading results.
2025-09-16 22:52:36.222 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:36.224 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-09-16 22:52:36.233 +03:00 [INF] Fetching connection string for profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:52:36.237 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:36.238 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:36.239 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:52:36.240 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:52:36.242 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:52:36.243 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:52:36.245 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:52:36.247 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:36.249 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:52:36.250 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:36.251 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:52:36.270 +03:00 [DBG] Fetched secret for profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:52:36.458 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:52:36.529 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No connection string for Profile 17b4d629-6bfa-4574-bef7-f1e0ebe16b08
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 29
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 76
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 48
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-16 22:52:36.542 +03:00 [ERR] Unhandled exception occurred.
2025-09-16 22:52:36.551 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:52:36.552 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:52:36.555 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:36.556 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:52:36.558 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - 500 null application/json; charset=utf-8 864.5096ms
2025-09-16 22:52:47.505 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-09-16 22:52:47.508 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-16 22:52:47.509 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:52:47.513 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-09-16 22:52:47.514 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:52:47.515 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 10.0878ms
2025-09-16 22:52:47.516 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-09-16 22:52:47.519 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-16 22:52:47.520 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:52:47.521 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:52:47.522 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:52:47.532 +03:00 [INF] Listing all profiles
2025-09-16 22:52:47.535 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()'
2025-09-16 22:52:47.536 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-16 22:52:47.549 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Profile>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
            3 -> 9
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
            3 -> 9
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Profile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Profile instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Profile);
                (object)dataReader.GetGuid(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                            {
                                return 
                                {
                                    Profile instance;
                                    instance = new Profile();
                                    instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                    instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                    instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                    instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                    instance.<UserInfoId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Profile)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetGuid(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (Profile)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(9) ? default(Guid?) : (Guid?)dataReader.GetGuid(9) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                Query entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    Query instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(Query);
                    dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetGuid(9) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                {
                                    return 
                                    {
                                        Query instance;
                                        instance = new Query();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(9) ? default(Guid) : dataReader.GetGuid(9);
                                        instance.<ProfileId>k__BackingField = dataReader.IsDBNull(10) ? default(Guid) : dataReader.GetGuid(10);
                                        instance.<ResultJson>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                        instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime) : dataReader.GetDateTime(13);
                                        instance.<UserQuery>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Query)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                    entity: namelessParameter{11}, 
                    value: namelessParameter{12}, 
                    forMaterialization: True);
                return namelessParameter{12}.<Profile>k__BackingField = namelessParameter{11};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (Profile)(resultContext.Values[0]) : default(Profile);
    }, 
    contextType: NaturalToQuery.Infrastructure.Persistence.ContextDB, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-09-16 22:52:47.555 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:52:47.556 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:52:47.557 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:47.558 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:47.558 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:52:47.559 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:52:47.560 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:52:47.560 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-16 22:52:47.562 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-16 22:52:47.565 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:47.566 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-16 22:52:47.567 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:47.568 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:52:47.570 +03:00 [INF] Fetching connection string for profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:52:47.570 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:47.571 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:47.572 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:52:47.573 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:52:47.574 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:52:47.575 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:52:47.577 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:52:47.578 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:52:47.579 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:52:47.580 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:47.581 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-16 22:52:47.582 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:52:47.583 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:52:47.584 +03:00 [DBG] Fetched secret for profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:52:47.597 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:52:47.598 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:52:47.599 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:52:47.600 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:52:47.601 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:52:47.602 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 85.443ms
2025-09-16 22:53:28.224 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5000/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - null null
2025-09-16 22:53:28.249 +03:00 [DBG] 1 candidate(s) found for the request path '/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:53:28.250 +03:00 [DBG] Endpoint 'HTTP: DELETE api/userinfo/{id}' with route pattern 'api/userinfo/{id}' is valid for the request path '/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:53:28.252 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/userinfo/{id}'
2025-09-16 22:53:28.252 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'.
2025-09-16 22:53:28.253 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:53:28.254 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5000/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - 307 0 null 53.3499ms
2025-09-16 22:53:28.279 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - null null
2025-09-16 22:53:28.281 +03:00 [DBG] 1 candidate(s) found for the request path '/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:53:28.282 +03:00 [DBG] Endpoint 'HTTP: DELETE api/userinfo/{id}' with route pattern 'api/userinfo/{id}' is valid for the request path '/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:53:28.284 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/userinfo/{id}'
2025-09-16 22:53:28.285 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/userinfo/{id}'
2025-09-16 22:53:28.286 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:53:28.292 +03:00 [INF] Deleting user with ID: "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:53:28.295 +03:00 [DBG] Compiling query expression: 
'DbSet<UserInfo>()
    .Include(p => p.Profiles)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-16 22:53:28.297 +03:00 [DBG] Including navigation: 'UserInfo.Profiles'.
2025-09-16 22:53:28.313 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<UserInfo>(
    asyncEnumerable: SingleQueryingEnumerable.Create<UserInfo>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserInfo.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserInfo.ApiKey (string) Required MaxLength(200), 1], [Property: UserInfo.CreatedUtc (DateTime) Required, 2], [Property: UserInfo.LastUpdatedUtc (DateTime) Required, 3], [Property: UserInfo.Mode (AIMode) Required, 4] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: Profile.CacheFile (string) MaxLength(500), 6], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 7], [Property: Profile.DatabaseName (string) Required, 8], [Property: Profile.Name (string) Required MaxLength(200), 9], [Property: Profile.Provider (ProviderType) Required, 10], [Property: Profile.SecretRef (string) Required, 11], [Property: Profile.UserInfoId (Guid?) FK Index, 12], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 13] }
                3 -> 5
            SELECT u0.Id, u0.ApiKey, u0.CreatedUtc, u0.LastUpdatedUtc, u0.Mode, p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
            FROM 
            (
                SELECT TOP(1) u.Id, u.ApiKey, u.CreatedUtc, u.LastUpdatedUtc, u.Mode
                FROM UserInfos AS u
                WHERE u.Id == @__id_0
            ) AS u0
            LEFT JOIN Profiles AS p ON u0.Id == p.UserInfoId
            ORDER BY u0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: UserInfo.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserInfo.ApiKey (string) Required MaxLength(200), 1], [Property: UserInfo.CreatedUtc (DateTime) Required, 2], [Property: UserInfo.LastUpdatedUtc (DateTime) Required, 3], [Property: UserInfo.Mode (AIMode) Required, 4] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 5], [Property: Profile.CacheFile (string) MaxLength(500), 6], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 7], [Property: Profile.DatabaseName (string) Required, 8], [Property: Profile.Name (string) Required MaxLength(200), 9], [Property: Profile.Provider (ProviderType) Required, 10], [Property: Profile.SecretRef (string) Required, 11], [Property: Profile.UserInfoId (Guid?) FK Index, 12], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 13] }
                3 -> 5
            SELECT u0.Id, u0.ApiKey, u0.CreatedUtc, u0.LastUpdatedUtc, u0.Mode, p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
            FROM 
            (
                SELECT TOP(1) u.Id, u.ApiKey, u.CreatedUtc, u.LastUpdatedUtc, u.Mode
                FROM UserInfos AS u
                WHERE u.Id == @__id_0
            ) AS u0
            LEFT JOIN Profiles AS p ON u0.Id == p.UserInfoId
            ORDER BY u0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                UserInfo entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    UserInfo instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(UserInfo);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: UserInfo.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (UserInfo)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: UserInfo | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: UserInfo | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo")]: 
                                {
                                    return 
                                    {
                                        UserInfo instance;
                                        instance = new UserInfo();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<ApiKey>k__BackingField = dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetDateTime(2);
                                        instance.<LastUpdatedUtc>k__BackingField = dataReader.GetDateTime(3);
                                        instance.<Mode>k__BackingField = Invoke(((EnumToNumberConverter<AIMode, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: UserInfo.Mode (AIMode) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo").FindProperty("Mode")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: UserInfo | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(UserInfo)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<UserInfo, UserInfo>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (UserInfo)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: UserInfo.Profiles (List<Profile>) Collection ToDependent Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo").FindNavigation("Profiles")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<UserInfo, List<Profile>, Profile> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo").FindNavigation("Profiles").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<UserInfo, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(5) ? default(Guid?) : (Guid?)dataReader.GetGuid(5) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Profile entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Profile instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Profile);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(5) ? default(object) : (object)dataReader.GetGuid(5) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Profile)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                    {
                                        shadowSnapshot2 = (ISnapshot)new Snapshot<Guid?>(dataReader.IsDBNull(13) ? default(Guid?) : (Guid?)dataReader.GetGuid(13));
                                        return 
                                        {
                                            Profile instance;
                                            instance = new Profile();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(5) ? default(Guid) : dataReader.GetGuid(5);
                                            instance.<CacheFile>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                            instance.<CreatedUtc>k__BackingField = dataReader.IsDBNull(7) ? default(DateTimeOffset) : dataReader.GetFieldValue<DateTimeOffset>(7);
                                            instance.<DatabaseName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<Name>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<Provider>k__BackingField = dataReader.IsDBNull(10) ? default(ProviderType) : Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(10));
                                            instance.<SecretRef>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            instance.<UserInfoId>k__BackingField = dataReader.IsDBNull(12) ? default(Guid?) : (Guid?)dataReader.GetGuid(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Profile)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: default(INavigationBase), 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    return [LIFTABLE Constant: ClrICollectionAccessor<UserInfo, List<Profile>, Profile> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.UserInfos.UserInfo").FindNavigation("Profiles").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (UserInfo)(resultContext.Values[0]) : default(UserInfo);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ContextDB, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-16 22:53:28.319 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:53:28.320 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:53:28.320 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:53:28.322 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:53:28.322 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:53:28.323 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:53:28.325 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:53:28.326 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u0"."Id", "u0"."ApiKey", "u0"."CreatedUtc", "u0"."LastUpdatedUtc", "u0"."Mode", "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
FROM (
    SELECT "u"."Id", "u"."ApiKey", "u"."CreatedUtc", "u"."LastUpdatedUtc", "u"."Mode"
    FROM "UserInfos" AS "u"
    WHERE "u"."Id" = @__id_0
    LIMIT 1
) AS "u0"
LEFT JOIN "Profiles" AS "p" ON "u0"."Id" = "p"."UserInfoId"
ORDER BY "u0"."Id"
2025-09-16 22:53:28.327 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u0"."Id", "u0"."ApiKey", "u0"."CreatedUtc", "u0"."LastUpdatedUtc", "u0"."Mode", "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
FROM (
    SELECT "u"."Id", "u"."ApiKey", "u"."CreatedUtc", "u"."LastUpdatedUtc", "u"."Mode"
    FROM "UserInfos" AS "u"
    WHERE "u"."Id" = @__id_0
    LIMIT 1
) AS "u0"
LEFT JOIN "Profiles" AS "p" ON "u0"."Id" = "p"."UserInfoId"
ORDER BY "u0"."Id"
2025-09-16 22:53:28.329 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:53:28.330 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:53:28.332 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:53:28.333 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:53:28.334 +03:00 [WRN] User with ID "17b4d629-6bfa-4574-bef7-f1e0ebe16b08" not found for deletion
2025-09-16 22:53:28.361 +03:00 [ERR] Error deleting user with ID: "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:53:28.439 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/userinfo/{id}'
2025-09-16 22:53:28.478 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Error Occured: User with ID 17b4d629-6bfa-4574-bef7-f1e0ebe16b08 not found for deletion
   at NaturalToQuery.Application.Services.UserInfoService.DeleteAsync(Guid id, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\UserInfoService.cs:line 187
   at NaturalToQuery.Api.Controllers.UserInfo.DeleteUser.HandleAsync(DeleteUserRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\UserInfo\DeleteUser.cs:line 25
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-16 22:53:28.481 +03:00 [ERR] Unhandled exception occurred.
2025-09-16 22:53:28.482 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:53:28.483 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:53:28.484 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:53:28.485 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:53:28.486 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/userinfo/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - 500 null application/json; charset=utf-8 207.1308ms
2025-09-16 22:53:37.400 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 244
2025-09-16 22:53:37.402 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-16 22:53:37.403 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:53:37.404 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-09-16 22:53:37.405 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:53:37.406 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 6.1623ms
2025-09-16 22:53:37.407 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 244
2025-09-16 22:53:37.409 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000004": started reading request body.
2025-09-16 22:53:37.411 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-16 22:53:37.412 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000004": done reading request body.
2025-09-16 22:53:37.413 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:53:37.415 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:53:37.417 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:53:37.430 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000004": started reading request body.
2025-09-16 22:53:37.431 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000004": done reading request body.
2025-09-16 22:53:37.460 +03:00 [INF] Creating profile for provider "SqlServer"
2025-09-16 22:53:37.463 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:53:37.720 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:53:37.729 +03:00 [DBG] Saved secret profile-f80fcdd9-2e7e-4b21-962e-6396b5714f5d for provider "SqlServer"
2025-09-16 22:53:37.730 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-09-16 22:53:37.739 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => p.DatabaseName.Equals(__profile_DatabaseName_0))'
2025-09-16 22:53:37.746 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ContextDB, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-16 22:53:37.752 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:53:37.752 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:53:37.753 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:53:37.754 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:53:37.755 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:53:37.756 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:53:37.757 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:53:37.758 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-16 22:53:37.760 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-16 22:53:37.762 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:53:37.763 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:53:37.764 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:53:37.765 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:53:37.917 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:53:38.023 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A profile for SqlServer - ProductInventory already exists.
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 28
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(Guid UserId, ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 55
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 23
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-16 22:53:38.026 +03:00 [ERR] Unhandled exception occurred.
2025-09-16 22:53:38.029 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:53:38.030 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:53:38.030 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:53:38.031 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:53:38.033 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 626.1507ms
2025-09-16 22:54:08.336 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5000/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - null null
2025-09-16 22:54:08.340 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:54:08.342 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:54:08.343 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-09-16 22:54:08.344 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'.
2025-09-16 22:54:08.345 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:54:08.346 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5000/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - 307 0 null 11.5659ms
2025-09-16 22:54:08.370 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - null null
2025-09-16 22:54:08.374 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:54:08.375 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08'
2025-09-16 22:54:08.376 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-09-16 22:54:08.376 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-09-16 22:54:08.378 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:54:08.382 +03:00 [INF] Deleting profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:54:08.384 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:08.385 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:54:08.385 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:08.386 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:08.387 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:08.388 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:54:08.389 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:08.390 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:08.391 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:08.393 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.394 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.396 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:08.397 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-16 22:54:08.398 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:08.400 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:08.464 +03:00 [WRN] Failed to delete secret profile-6e77434c-b352-4437-8d4b-aaade94e8235 for profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:54:08.467 +03:00 [DBG] Deleted cache directory C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer for profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08"
2025-09-16 22:54:08.478 +03:00 [DBG] An entity of type 'Profile' tracked by 'ContextDB' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.504 +03:00 [DBG] A cascade state change of an entity of type 'Query' to '"Deleted"' occurred due to deletion of its parent entity of type 'Profile'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.506 +03:00 [DBG] An entity of type 'Query' tracked by 'ContextDB' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.510 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:54:08.513 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:54:08.516 +03:00 [DBG] SaveChanges starting for 'ContextDB'.
2025-09-16 22:54:08.518 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:54:08.519 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:54:08.564 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:08.566 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:08.568 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-16 22:54:08.570 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-16 22:54:08.572 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:08.573 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:08.574 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:54:08.575 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-09-16 22:54:08.576 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-09-16 22:54:08.581 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:08.582 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-16 22:54:08.585 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:08.586 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:08.587 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:54:08.587 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-09-16 22:54:08.589 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-09-16 22:54:08.591 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:08.592 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:54:08.594 +03:00 [DBG] Committing transaction.
2025-09-16 22:54:08.599 +03:00 [DBG] Committed transaction.
2025-09-16 22:54:08.601 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:08.602 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:08.604 +03:00 [DBG] Disposing transaction.
2025-09-16 22:54:08.614 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.616 +03:00 [DBG] An entity of type 'Profile' tracked by 'ContextDB' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.617 +03:00 [DBG] An entity of type 'Query' tracked by 'ContextDB' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:08.620 +03:00 [DBG] SaveChanges completed for 'ContextDB' with 2 entities written to the database.
2025-09-16 22:54:08.621 +03:00 [INF] Profile "17b4d629-6bfa-4574-bef7-f1e0ebe16b08" deleted successfully
2025-09-16 22:54:08.624 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-09-16 22:54:08.625 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:54:08.626 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:54:08.627 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:08.628 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:08.629 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/17b4d629-6bfa-4574-bef7-f1e0ebe16b08 - 200 null application/json; charset=utf-8 280.1129ms
2025-09-16 22:54:12.247 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 244
2025-09-16 22:54:12.250 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-16 22:54:12.251 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:54:12.253 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-09-16 22:54:12.254 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:54:12.255 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 7.8893ms
2025-09-16 22:54:12.255 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 244
2025-09-16 22:54:12.258 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000006": started reading request body.
2025-09-16 22:54:12.260 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-09-16 22:54:12.261 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000006": done reading request body.
2025-09-16 22:54:12.262 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:54:12.264 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:54:12.266 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:54:12.267 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000006": started reading request body.
2025-09-16 22:54:12.268 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000006": done reading request body.
2025-09-16 22:54:12.269 +03:00 [INF] Creating profile for provider "SqlServer"
2025-09-16 22:54:12.271 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:54:12.273 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:54:12.276 +03:00 [DBG] Saved secret profile-042e8acb-f872-4b90-bcfb-a27f31c08175 for provider "SqlServer"
2025-09-16 22:54:12.277 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-09-16 22:54:12.278 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:12.279 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:54:12.280 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:12.281 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:12.282 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:12.282 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:54:12.283 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:12.284 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-16 22:54:12.286 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-09-16 22:54:12.288 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:12.289 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:54:12.290 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:12.291 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:12.308 +03:00 [DBG] 'ContextDB' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:12.313 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:12.314 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:54:12.315 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:54:12.316 +03:00 [DBG] SaveChanges starting for 'ContextDB'.
2025-09-16 22:54:12.317 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:54:12.318 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:54:12.326 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:12.327 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:12.328 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:12.329 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:12.332 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-16 22:54:12.333 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 16), @p4='?' (Size = 28), @p5='?' (DbType = Int32), @p6='?' (Size = 44), @p7='?' (DbType = Guid), @p8='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef", "UserInfoId", "UserInfoId1")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-09-16 22:54:12.339 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 16), @p4='?' (Size = 28), @p5='?' (DbType = Int32), @p6='?' (Size = 44), @p7='?' (DbType = Guid), @p8='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef", "UserInfoId", "UserInfoId1")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-09-16 22:54:12.341 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:12.342 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:54:12.343 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:12.344 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:12.346 +03:00 [DBG] An entity of type 'Profile' tracked by 'ContextDB' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:12.347 +03:00 [DBG] SaveChanges completed for 'ContextDB' with 1 entities written to the database.
2025-09-16 22:54:12.349 +03:00 [INF] Profile created successfully with Id "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:54:12.351 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-09-16 22:54:12.352 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:54:12.353 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:54:12.353 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:12.354 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:12.355 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 100.2852ms
2025-09-16 22:54:17.316 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-09-16 22:54:17.319 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-16 22:54:17.320 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:54:17.320 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-09-16 22:54:17.321 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:54:17.322 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 6.9524ms
2025-09-16 22:54:17.323 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-09-16 22:54:17.326 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-09-16 22:54:17.327 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:54:17.328 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:54:17.329 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:54:17.331 +03:00 [INF] Listing all profiles
2025-09-16 22:54:17.332 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:17.333 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:54:17.333 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:17.335 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:17.336 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:17.337 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:17.339 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:54:17.340 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-16 22:54:17.341 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-09-16 22:54:17.343 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:17.345 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:54:17.346 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:17.347 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:17.349 +03:00 [INF] Fetching connection string for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:54:17.350 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:17.351 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:17.353 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:17.354 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:17.355 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:54:17.357 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:17.358 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:17.360 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:17.361 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:17.362 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-16 22:54:17.363 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:17.364 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:17.376 +03:00 [DBG] Fetched secret for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:54:17.378 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-09-16 22:54:17.379 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:54:17.380 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:54:17.381 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:17.382 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:17.383 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 60.606ms
2025-09-16 22:54:22.073 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - application/json 190
2025-09-16 22:54:22.076 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:54:22.077 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:54:22.078 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:22.079 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'.
2025-09-16 22:54:22.080 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:54:22.081 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - 307 0 null 7.9373ms
2025-09-16 22:54:22.081 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - application/json 190
2025-09-16 22:54:22.083 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000008": started reading request body.
2025-09-16 22:54:22.085 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:54:22.086 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000008": done reading request body.
2025-09-16 22:54:22.087 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute'
2025-09-16 22:54:22.089 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:22.090 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:22.091 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:54:22.093 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000008": started reading request body.
2025-09-16 22:54:22.094 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000008": done reading request body.
2025-09-16 22:54:22.095 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:22.096 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:54:22.097 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:22.098 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:22.099 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:22.100 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:54:22.100 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:22.102 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:22.103 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:22.105 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:22.106 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:54:22.107 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:22.108 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:22.248 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:22.288 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: No profile found with id: 17b4d629-6bfa-4574-bef7-f1e0ebe16b08
   at NaturalToQuery.Application.Services.ProfileService.GetProviderTypeAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 199
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 61
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 29
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, IDictionary`2 parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 76
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 48
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-16 22:54:22.292 +03:00 [ERR] Unhandled exception occurred.
2025-09-16 22:54:22.293 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:54:22.294 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:54:22.295 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:22.296 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:22.297 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/17b4d629-6bfa-4574-bef7-f1e0ebe16b08/execute - 500 null application/json; charset=utf-8 215.6861ms
2025-09-16 22:54:39.801 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 190
2025-09-16 22:54:39.803 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:54:39.804 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:54:39.806 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:39.806 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'.
2025-09-16 22:54:39.807 +03:00 [DBG] Connection id "0HNFLBAAHSVEM" completed keep alive response.
2025-09-16 22:54:39.808 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - 307 0 null 6.8656ms
2025-09-16 22:54:39.808 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 190
2025-09-16 22:54:39.810 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000009": started reading request body.
2025-09-16 22:54:39.813 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:54:39.813 +03:00 [DBG] Connection id "0HNFLBAAHSVEM", Request id "0HNFLBAAHSVEM:00000009": done reading request body.
2025-09-16 22:54:39.815 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:54:39.817 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:39.818 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:39.820 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:54:39.821 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000009": started reading request body.
2025-09-16 22:54:39.822 +03:00 [DBG] Connection id "0HNFLBAAHSVEO", Request id "0HNFLBAAHSVEO:00000009": done reading request body.
2025-09-16 22:54:39.824 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:39.825 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:54:39.825 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:39.826 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.827 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:39.829 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:39.830 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:54:39.831 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:39.833 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:39.835 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:39.836 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.837 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-16 22:54:39.838 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.839 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:39.841 +03:00 [INF] Fetching connection string for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:54:39.842 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:39.843 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.844 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:39.845 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:39.847 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:54:39.848 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:39.850 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:39.851 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.852 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:54:39.854 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.855 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:39.857 +03:00 [DBG] Fetched secret for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:54:39.860 +03:00 [INF] Executing SQL for Profile "30b552f7-aa91-4203-9dbd-82c937636b5c", Mode="ReadOnly"
2025-09-16 22:54:39.868 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-09-16 22:54:39.870 +03:00 [DBG] SQL: SELECT P.* FROM Products P WHERE P.StockQuantity < @param1;
2025-09-16 22:54:39.872 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:54:39.874 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-16 22:54:39.963 +03:00 [INF] Query execution finished in 90 ms, returned 0 rows
2025-09-16 22:54:39.968 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:39.969 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.970 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:39.971 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:54:39.972 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:39.973 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:39.975 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:54:39.976 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.977 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:54:39.979 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:39.980 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:39.987 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:39.988 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:39.990 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:54:39.994 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:39.997 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:54:39.998 +03:00 [DBG] SaveChanges starting for 'ContextDB'.
2025-09-16 22:54:39.999 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:54:40.000 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:54:40.001 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:40.002 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:40.003 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:40.004 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:54:40.005 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:40.006 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 159), @p3='?' (Size = 59), @p4='?' (DbType = DateTime), @p5='?' (Size = 32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-16 22:54:40.011 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 159), @p3='?' (Size = 59), @p4='?' (DbType = DateTime), @p5='?' (Size = 32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-16 22:54:40.013 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:40.014 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-09-16 22:54:40.015 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:40.016 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:54:40.017 +03:00 [DBG] An entity of type 'Query' tracked by 'ContextDB' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:54:40.019 +03:00 [DBG] SaveChanges completed for 'ContextDB' with 1 entities written to the database.
2025-09-16 22:54:40.024 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-16T19:54:39.9859874Z","$type":"QueryAddedEvent"}
2025-09-16 22:54:40.027 +03:00 [INF] Saved query to DB for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:54:40.028 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:54:40.029 +03:00 [DBG] Connection id "0HNFLBAAHSVEO" completed keep alive response.
2025-09-16 22:54:40.030 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:54:40.031 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:40.032 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:40.034 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - 200 null application/json; charset=utf-8 225.1903ms
2025-09-16 22:54:52.190 +03:00 [INF] This is a test log to file!
2025-09-16 22:54:52.596 +03:00 [INF] Shared Kernal configured successfully.
2025-09-16 22:54:52.604 +03:00 [INF] API configured successfully.
2025-09-16 22:54:52.737 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-16 22:54:52.800 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-16 22:54:53.364 +03:00 [WRN] The foreign key property 'Profile.UserInfoId1' was created in shadow state because a conflicting property with the simple name 'UserInfoId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-16 22:54:53.457 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:54:53.484 +03:00 [INF] Registered 23 endpoints in 1,150 milliseconds.
2025-09-16 22:54:53.490 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:54:53.547 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:54:53.705 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:53.719 +03:00 [DBG] Created DbConnection. (11ms).
2025-09-16 22:54:53.722 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:53.728 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:53.731 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-16 22:54:53.733 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:53.742 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:53.745 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:53.749 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:53.750 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:53.753 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:53.755 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-16 22:54:53.759 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:54:53.763 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:54:53.766 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-09-16 22:54:53.771 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-16 22:54:53.790 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-16 22:54:53.793 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:54:53.793 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-16 22:54:53.794 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-09-16 22:54:53.796 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-16 19:54:53.7928121+00:00');
SELECT changes();
2025-09-16 22:54:53.800 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-16 19:54:53.7928121+00:00');
SELECT changes();
2025-09-16 22:54:53.843 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-16 22:54:53.847 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-16 22:54:53.849 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-16 22:54:53.850 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-16 22:54:53.852 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-09-16 22:54:53.853 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-16 22:54:53.855 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-16 22:54:53.858 +03:00 [DBG] Committing transaction.
2025-09-16 22:54:53.860 +03:00 [DBG] Committed transaction.
2025-09-16 22:54:53.861 +03:00 [DBG] Disposing transaction.
2025-09-16 22:54:53.863 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-16 22:54:53.864 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-16 22:54:53.866 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:54:53.867 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:54:53.868 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:53.869 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:53.870 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:53.871 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:53.872 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:54:53.873 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-16 22:54:53.874 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:54:53.876 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-16 22:54:53.878 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-16 22:54:53.882 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:54:53.883 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:54:53.884 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:54:53.886 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-16 22:54:53.888 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-16 22:54:53.892 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:53.894 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-16 22:54:53.899 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-16 22:54:53.900 +03:00 [DBG] Committing transaction.
2025-09-16 22:54:53.901 +03:00 [DBG] Committed transaction.
2025-09-16 22:54:53.902 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:54:53.903 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-16 22:54:53.904 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:54:53.905 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-16 22:54:53.908 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-16 22:54:53.910 +03:00 [DBG] Disposing transaction.
2025-09-16 22:54:53.912 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:54:53.915 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-16 22:54:53.917 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:54:53.918 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:54:53.920 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:54:53.922 +03:00 [INF] Infrastructure configured successfully.
2025-09-16 22:54:53.923 +03:00 [INF] Infrastructure configured successfully.
2025-09-16 22:54:53.950 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-16 22:54:53.978 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-16 22:54:53.979 +03:00 [DBG] Hosting starting
2025-09-16 22:54:53.990 +03:00 [DBG] Middleware loaded
2025-09-16 22:54:53.993 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-16 22:54:53.994 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-16 22:54:54.059 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-16 22:54:54.061 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-16 22:54:54.064 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-16 22:54:54.104 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-16 22:54:54.184 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-16 22:54:54.186 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-16 22:54:54.187 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-16 22:54:54.188 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-16 22:54:54.189 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-16 22:54:54.189 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-16 22:54:54.194 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-16 22:54:54.200 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-16 22:54:54.225 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-16 22:54:54.226 +03:00 [INF] Hosting environment: Development
2025-09-16 22:54:54.226 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-16 22:54:54.227 +03:00 [DBG] Hosting started
2025-09-16 22:55:14.980 +03:00 [DBG] Connection id "0HNFLBBQ3KM2O" received FIN.
2025-09-16 22:55:14.992 +03:00 [DBG] Connection id "0HNFLBBQ3KM2O" accepted.
2025-09-16 22:55:14.999 +03:00 [DBG] Connection id "0HNFLBBQ3KM2O" started.
2025-09-16 22:55:15.001 +03:00 [DBG] Connection id "0HNFLBBQ3KM2P" accepted.
2025-09-16 22:55:15.002 +03:00 [DBG] Connection id "0HNFLBBQ3KM2P" started.
2025-09-16 22:55:15.006 +03:00 [DBG] Connection id "0HNFLBBQ3KM2O" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-16 22:55:15.009 +03:00 [DBG] Connection id "0HNFLBBQ3KM2O" disconnecting.
2025-09-16 22:55:15.011 +03:00 [DBG] Connection id "0HNFLBBQ3KM2O" stopped.
2025-09-16 22:55:15.028 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 190
2025-09-16 22:55:15.082 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:55:15.084 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:55:15.086 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:55:15.110 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-16 22:55:15.112 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'.
2025-09-16 22:55:15.115 +03:00 [DBG] Connection id "0HNFLBBQ3KM2P" completed keep alive response.
2025-09-16 22:55:15.117 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - 307 0 null 93.4237ms
2025-09-16 22:55:15.118 +03:00 [DBG] Connection id "0HNFLBBQ3KM2Q" accepted.
2025-09-16 22:55:15.118 +03:00 [DBG] Connection id "0HNFLBBQ3KM2Q" received FIN.
2025-09-16 22:55:15.118 +03:00 [DBG] Connection id "0HNFLBBQ3KM2R" accepted.
2025-09-16 22:55:15.129 +03:00 [DBG] Connection id "0HNFLBBQ3KM2Q" started.
2025-09-16 22:55:15.129 +03:00 [DBG] Connection id "0HNFLBBQ3KM2P", Request id "0HNFLBBQ3KM2P:00000001": started reading request body.
2025-09-16 22:55:15.130 +03:00 [DBG] Connection id "0HNFLBBQ3KM2R" started.
2025-09-16 22:55:15.131 +03:00 [DBG] Connection id "0HNFLBBQ3KM2Q" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-16 22:55:15.132 +03:00 [DBG] Connection id "0HNFLBBQ3KM2P", Request id "0HNFLBBQ3KM2P:00000001": done reading request body.
2025-09-16 22:55:15.134 +03:00 [DBG] Connection id "0HNFLBBQ3KM2Q" disconnecting.
2025-09-16 22:55:15.136 +03:00 [DBG] Connection id "0HNFLBBQ3KM2Q" stopped.
2025-09-16 22:55:15.167 +03:00 [DBG] Connection 0HNFLBBQ3KM2R established using the following protocol: "Tls13"
2025-09-16 22:55:15.172 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 190
2025-09-16 22:55:15.176 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:55:15.177 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:55:15.178 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:55:15.182 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:55:15.195 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:55:15.239 +03:00 [DBG] Connection id "0HNFLBBQ3KM2R", Request id "0HNFLBBQ3KM2R:00000001": started reading request body.
2025-09-16 22:55:15.240 +03:00 [DBG] Connection id "0HNFLBBQ3KM2R", Request id "0HNFLBBQ3KM2R:00000001": done reading request body.
2025-09-16 22:55:15.316 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-16 22:55:15.362 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-16 22:55:15.569 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
                3 -> 9
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, p0.UserInfoId, p0.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
                3 -> 9
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, p0.UserInfoId, p0.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    shadowSnapshot1 = (ISnapshot)new Snapshot<Guid?>(dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8));
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        instance.<UserInfoId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(9) ? default(Guid?) : (Guid?)dataReader.GetGuid(9) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetGuid(9) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(9) ? default(Guid) : dataReader.GetGuid(9);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(10) ? default(Guid) : dataReader.GetGuid(10);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime) : dataReader.GetDateTime(13);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ContextDB, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-16 22:55:15.600 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:55:15.601 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-16 22:55:15.604 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:55:15.607 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:55:15.608 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:55:15.609 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:55:15.612 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-09-16 22:55:15.616 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:55:15.622 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:55:15.651 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:55:15.692 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:55:15.705 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:55:15.708 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 82ms reading results.
2025-09-16 22:55:15.711 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:55:15.713 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:55:15.723 +03:00 [INF] Fetching connection string for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:55:15.726 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:55:15.728 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:55:15.729 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:55:15.730 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:55:15.732 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:55:15.733 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:55:15.735 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:55:15.737 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:55:15.739 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:55:15.741 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:55:15.742 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:55:15.753 +03:00 [DBG] Fetched secret for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:55:15.765 +03:00 [INF] Executing SQL for Profile "30b552f7-aa91-4203-9dbd-82c937636b5c", Mode="ReadOnly"
2025-09-16 22:55:24.840 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-09-16 22:55:25.321 +03:00 [DBG] SQL: SELECT P.* FROM Products P WHERE P.StockQuantity < @param1;
2025-09-16 22:55:35.897 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:55:36.648 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-16 22:56:24.670 +03:00 [INF] This is a test log to file!
2025-09-16 22:56:25.106 +03:00 [INF] Shared Kernal configured successfully.
2025-09-16 22:56:25.122 +03:00 [INF] API configured successfully.
2025-09-16 22:56:25.221 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-09-16 22:56:25.266 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-16 22:56:25.723 +03:00 [WRN] The foreign key property 'Profile.UserInfoId1' was created in shadow state because a conflicting property with the simple name 'UserInfoId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-09-16 22:56:25.789 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:56:25.811 +03:00 [INF] Registered 23 endpoints in 991 milliseconds.
2025-09-16 22:56:25.818 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:56:25.854 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:56:25.929 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:56:25.942 +03:00 [DBG] Created DbConnection. (11ms).
2025-09-16 22:56:25.945 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-09-16 22:56:25.949 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:56:25.952 +03:00 [DBG] Created DbConnection. (3ms).
2025-09-16 22:56:25.955 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:56:25.963 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:56:25.967 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:56:25.971 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:56:25.972 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:56:25.977 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:56:25.979 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-16 22:56:25.982 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:56:25.986 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:56:25.988 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-09-16 22:56:25.994 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-16 22:56:26.011 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-09-16 22:56:26.015 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:56:26.016 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-16 22:56:26.017 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:56:26.019 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-16 19:56:26.0148505+00:00');
SELECT changes();
2025-09-16 22:56:26.024 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-09-16 19:56:26.0148505+00:00');
SELECT changes();
2025-09-16 22:56:26.065 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-16 22:56:26.071 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-16 22:56:26.073 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-16 22:56:26.074 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-09-16 22:56:26.076 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-09-16 22:56:26.078 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-16 22:56:26.080 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-09-16 22:56:26.082 +03:00 [DBG] Committing transaction.
2025-09-16 22:56:26.084 +03:00 [DBG] Committed transaction.
2025-09-16 22:56:26.086 +03:00 [DBG] Disposing transaction.
2025-09-16 22:56:26.088 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-16 22:56:26.089 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-09-16 22:56:26.091 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:56:26.091 +03:00 [DBG] Created DbConnection. (0ms).
2025-09-16 22:56:26.092 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:56:26.093 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:56:26.095 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:56:26.097 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:56:26.099 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:56:26.100 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-09-16 22:56:26.101 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:56:26.102 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-16 22:56:26.104 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-09-16 22:56:26.107 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:56:26.108 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:56:26.110 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:56:26.112 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-16 22:56:26.114 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-16 22:56:26.119 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:56:26.121 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-09-16 22:56:26.125 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-09-16 22:56:26.126 +03:00 [DBG] Committing transaction.
2025-09-16 22:56:26.127 +03:00 [DBG] Committed transaction.
2025-09-16 22:56:26.129 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-16 22:56:26.131 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-09-16 22:56:26.133 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (4ms).
2025-09-16 22:56:26.135 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-16 22:56:26.140 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-09-16 22:56:26.141 +03:00 [DBG] Disposing transaction.
2025-09-16 22:56:26.143 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:56:26.147 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-09-16 22:56:26.149 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:56:26.150 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:56:26.151 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:56:26.159 +03:00 [INF] Infrastructure configured successfully.
2025-09-16 22:56:26.159 +03:00 [INF] Infrastructure configured successfully.
2025-09-16 22:56:26.196 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-09-16 22:56:26.239 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-09-16 22:56:26.242 +03:00 [DBG] Hosting starting
2025-09-16 22:56:26.256 +03:00 [DBG] Middleware loaded
2025-09-16 22:56:26.258 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-09-16 22:56:26.260 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-09-16 22:56:26.367 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-09-16 22:56:26.376 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-09-16 22:56:26.382 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-09-16 22:56:26.429 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-09-16 22:56:26.489 +03:00 [INF] Now listening on: https://localhost:7202
2025-09-16 22:56:26.495 +03:00 [INF] Now listening on: http://localhost:5000
2025-09-16 22:56:26.497 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-09-16 22:56:26.498 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-09-16 22:56:26.499 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-09-16 22:56:26.500 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-09-16 22:56:26.507 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-16 22:56:26.515 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-09-16 22:56:26.550 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-16 22:56:26.559 +03:00 [INF] Hosting environment: Development
2025-09-16 22:56:26.559 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-09-16 22:56:26.560 +03:00 [DBG] Hosting started
2025-09-16 22:57:10.736 +03:00 [DBG] Connection id "0HNFLBCSJIGCN" received FIN.
2025-09-16 22:57:10.748 +03:00 [DBG] Connection id "0HNFLBCSJIGCN" accepted.
2025-09-16 22:57:10.776 +03:00 [DBG] Connection id "0HNFLBCSJIGCN" started.
2025-09-16 22:57:10.777 +03:00 [DBG] Connection id "0HNFLBCSJIGCO" accepted.
2025-09-16 22:57:10.779 +03:00 [DBG] Connection id "0HNFLBCSJIGCO" started.
2025-09-16 22:57:10.782 +03:00 [DBG] Connection id "0HNFLBCSJIGCN" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-16 22:57:10.784 +03:00 [DBG] Connection id "0HNFLBCSJIGCN" disconnecting.
2025-09-16 22:57:10.787 +03:00 [DBG] Connection id "0HNFLBCSJIGCN" stopped.
2025-09-16 22:57:10.806 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 114
2025-09-16 22:57:10.853 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:10.855 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:10.857 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:57:10.878 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-09-16 22:57:10.880 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'.
2025-09-16 22:57:10.882 +03:00 [DBG] Connection id "0HNFLBCSJIGCO" completed keep alive response.
2025-09-16 22:57:10.884 +03:00 [DBG] Connection id "0HNFLBCSJIGCP" accepted.
2025-09-16 22:57:10.885 +03:00 [DBG] Connection id "0HNFLBCSJIGCP" received FIN.
2025-09-16 22:57:10.885 +03:00 [DBG] Connection id "0HNFLBCSJIGCQ" accepted.
2025-09-16 22:57:10.912 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - 307 0 null 83.42ms
2025-09-16 22:57:10.912 +03:00 [DBG] Connection id "0HNFLBCSJIGCP" started.
2025-09-16 22:57:10.913 +03:00 [DBG] Connection id "0HNFLBCSJIGCQ" started.
2025-09-16 22:57:10.917 +03:00 [DBG] Connection id "0HNFLBCSJIGCP" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-09-16 22:57:10.917 +03:00 [DBG] Connection id "0HNFLBCSJIGCO", Request id "0HNFLBCSJIGCO:00000001": started reading request body.
2025-09-16 22:57:10.919 +03:00 [DBG] Connection id "0HNFLBCSJIGCP" disconnecting.
2025-09-16 22:57:10.921 +03:00 [DBG] Connection id "0HNFLBCSJIGCO", Request id "0HNFLBCSJIGCO:00000001": done reading request body.
2025-09-16 22:57:10.921 +03:00 [DBG] Connection id "0HNFLBCSJIGCP" stopped.
2025-09-16 22:57:10.947 +03:00 [DBG] Connection 0HNFLBCSJIGCQ established using the following protocol: "Tls13"
2025-09-16 22:57:10.951 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 114
2025-09-16 22:57:10.954 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:10.955 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:10.956 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:57:10.960 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:57:10.972 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:57:11.011 +03:00 [DBG] Connection id "0HNFLBCSJIGCQ", Request id "0HNFLBCSJIGCQ:00000001": started reading request body.
2025-09-16 22:57:11.013 +03:00 [DBG] Connection id "0HNFLBCSJIGCQ", Request id "0HNFLBCSJIGCQ:00000001": done reading request body.
2025-09-16 22:57:11.083 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-09-16 22:57:11.118 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-09-16 22:57:11.410 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
                3 -> 9
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, p0.UserInfoId, p0.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6], [Property: Profile.UserInfoId (Guid?) FK Index, 7], [Property: Profile.UserInfoId1 (no field, Guid?) Shadow FK Index, 8] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Query.ProfileId (Guid) Required FK Index, 10], [Property: Query.ResultJson (string) Required, 11], [Property: Query.SqlQuery (string) Required, 12], [Property: Query.TimestampUtc (DateTime) Required, 13], [Property: Query.UserQuery (string) Required, 14] }
                3 -> 9
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, p0.UserInfoId, p0.UserInfoId1, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, p.UserInfoId, p.UserInfoId1
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    shadowSnapshot1 = (ISnapshot)new Snapshot<Guid?>(dataReader.IsDBNull(8) ? default(Guid?) : (Guid?)dataReader.GetGuid(8));
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        instance.<UserInfoId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(9) ? default(Guid?) : (Guid?)dataReader.GetGuid(9) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(9) ? default(object) : (object)dataReader.GetGuid(9) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(9) ? default(Guid) : dataReader.GetGuid(9);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(10) ? default(Guid) : dataReader.GetGuid(10);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(13) ? default(DateTime) : dataReader.GetDateTime(13);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ContextDB, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-09-16 22:57:11.438 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:57:11.440 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-16 22:57:11.443 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:57:11.445 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:11.447 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:57:11.448 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:57:11.450 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-09-16 22:57:11.455 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:11.461 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:11.488 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:11.528 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:11.538 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:11.539 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 76ms reading results.
2025-09-16 22:57:11.542 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:11.544 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:57:11.553 +03:00 [INF] Fetching connection string for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:57:11.556 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:57:11.557 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:11.558 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:57:11.559 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:57:11.561 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:57:11.562 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:11.564 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:11.566 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:11.568 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:57:11.570 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:11.571 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:57:11.581 +03:00 [DBG] Fetched secret for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:57:11.593 +03:00 [INF] Executing SQL for Profile "30b552f7-aa91-4203-9dbd-82c937636b5c", Mode="ReadOnly"
2025-09-16 22:57:15.680 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-09-16 22:57:16.008 +03:00 [DBG] SQL: Select * from categories
2025-09-16 22:57:20.632 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:57:21.443 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-09-16 22:57:35.213 +03:00 [INF] Query execution finished in 14945 ms, returned 16 rows
2025-09-16 22:57:35.221 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:57:35.223 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:35.224 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:57:35.225 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:57:35.226 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:57:35.227 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:35.230 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:35.231 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:35.232 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:57:35.234 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:35.235 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:57:35.268 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:35.272 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:35.277 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:57:35.298 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:35.303 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:57:35.307 +03:00 [DBG] SaveChanges starting for 'ContextDB'.
2025-09-16 22:57:35.309 +03:00 [DBG] DetectChanges starting for 'ContextDB'.
2025-09-16 22:57:35.310 +03:00 [DBG] DetectChanges completed for 'ContextDB'.
2025-09-16 22:57:35.350 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:57:35.352 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:35.355 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:57:35.355 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:57:35.357 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-09-16 22:57:35.358 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 1556), @p3='?' (Size = 24), @p4='?' (DbType = DateTime), @p5='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-16 22:57:35.366 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 1556), @p3='?' (Size = 24), @p4='?' (DbType = DateTime), @p5='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-09-16 22:57:35.369 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:35.370 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-09-16 22:57:35.372 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:35.373 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:57:35.379 +03:00 [DBG] An entity of type 'Query' tracked by 'ContextDB' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:35.381 +03:00 [DBG] SaveChanges completed for 'ContextDB' with 1 entities written to the database.
2025-09-16 22:57:35.386 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-09-16T19:57:35.2497569Z","$type":"QueryAddedEvent"}
2025-09-16 22:57:35.389 +03:00 [INF] Saved query to DB for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:57:35.397 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:57:35.401 +03:00 [DBG] Connection id "0HNFLBCSJIGCQ" completed keep alive response.
2025-09-16 22:57:35.403 +03:00 [DBG] 'ContextDB' disposed.
2025-09-16 22:57:35.406 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:57:35.407 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:57:35.408 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - 200 null application/json; charset=utf-8 24457.593ms
2025-09-16 22:57:45.932 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 190
2025-09-16 22:57:45.935 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:45.935 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:45.937 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:57:45.939 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'.
2025-09-16 22:57:45.940 +03:00 [DBG] Connection id "0HNFLBCSJIGCO" completed keep alive response.
2025-09-16 22:57:45.941 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - 307 0 null 8.7138ms
2025-09-16 22:57:45.942 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute - application/json 190
2025-09-16 22:57:45.944 +03:00 [DBG] Connection id "0HNFLBCSJIGCO", Request id "0HNFLBCSJIGCO:00000002": started reading request body.
2025-09-16 22:57:45.945 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:45.947 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/30b552f7-aa91-4203-9dbd-82c937636b5c/execute'
2025-09-16 22:57:45.946 +03:00 [DBG] Connection id "0HNFLBCSJIGCO", Request id "0HNFLBCSJIGCO:00000002": done reading request body.
2025-09-16 22:57:45.948 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:57:45.950 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-09-16 22:57:45.962 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ContextDB' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-09-16 22:57:45.964 +03:00 [DBG] Connection id "0HNFLBCSJIGCQ", Request id "0HNFLBCSJIGCQ:00000002": started reading request body.
2025-09-16 22:57:45.965 +03:00 [DBG] Connection id "0HNFLBCSJIGCQ", Request id "0HNFLBCSJIGCQ:00000002": done reading request body.
2025-09-16 22:57:45.968 +03:00 [DBG] Creating DbConnection.
2025-09-16 22:57:45.969 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-16 22:57:45.970 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:57:45.972 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:45.973 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:57:45.974 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:57:45.975 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:57:45.975 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:45.977 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:45.978 +03:00 [DBG] Context 'ContextDB' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:45.980 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:45.981 +03:00 [DBG] Context 'ContextDB' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-09-16 22:57:45.982 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:45.983 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-09-16 22:57:45.984 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:45.985 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-09-16 22:57:45.986 +03:00 [INF] Fetching connection string for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:57:45.987 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-09-16 22:57:45.988 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:45.989 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-16 22:57:45.990 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-16 22:57:45.990 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-09-16 22:57:45.992 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:45.993 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "p0"."UserInfoId", "p0"."UserInfoId1", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "p"."UserInfoId", "p"."UserInfoId1"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-09-16 22:57:45.995 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:45.996 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-09-16 22:57:45.997 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-09-16 22:57:45.998 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-09-16 22:57:46.000 +03:00 [DBG] Fetched secret for profile "30b552f7-aa91-4203-9dbd-82c937636b5c"
2025-09-16 22:57:46.001 +03:00 [INF] Executing SQL for Profile "30b552f7-aa91-4203-9dbd-82c937636b5c", Mode="ReadOnly"
2025-09-16 22:57:57.050 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-09-16 22:57:57.466 +03:00 [DBG] SQL: SELECT P.* FROM Products P WHERE P.StockQuantity < @param1;
2025-09-16 22:58:11.983 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-09-16 22:58:12.826 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
