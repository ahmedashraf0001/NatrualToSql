2025-08-31 06:02:38.883 +03:00 [INF] This is a test log to file!
2025-08-31 06:02:39.577 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:02:39.597 +03:00 [INF] API configured successfully.
2025-08-31 06:02:39.861 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:02:40.595 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:02:40.651 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:02:40.661 +03:00 [INF] Registered 11 endpoints in 1,548 milliseconds.
2025-08-31 06:02:40.670 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:02:40.673 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:02:40.674 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:02:40.706 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:02:40.749 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:02:40.751 +03:00 [DBG] Hosting starting
2025-08-31 06:02:40.762 +03:00 [DBG] Middleware loaded
2025-08-31 06:02:40.765 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:02:40.768 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:02:40.866 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:02:40.868 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:02:40.872 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:02:40.912 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:02:40.969 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:02:40.971 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:02:40.973 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:02:40.974 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:02:40.975 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:02:40.976 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:02:40.984 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:02:40.993 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:02:41.026 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:02:41.027 +03:00 [INF] Hosting environment: Development
2025-08-31 06:02:41.028 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:02:41.029 +03:00 [DBG] Hosting started
2025-08-31 06:04:02.310 +03:00 [INF] This is a test log to file!
2025-08-31 06:04:02.688 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:04:02.703 +03:00 [INF] API configured successfully.
2025-08-31 06:04:02.867 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:04:03.440 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:04:03.469 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:04:03.478 +03:00 [INF] Registered 11 endpoints in 1,031 milliseconds.
2025-08-31 06:04:03.485 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:04:03.487 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:04:03.488 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:04:03.511 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:04:03.538 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:04:03.540 +03:00 [DBG] Hosting starting
2025-08-31 06:04:03.551 +03:00 [DBG] Middleware loaded
2025-08-31 06:04:03.553 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:04:03.555 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:04:03.644 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:04:03.646 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:04:03.648 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:04:03.677 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:04:03.753 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:04:03.754 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:04:03.755 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:04:03.755 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:04:03.756 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:04:03.757 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:04:03.763 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:04:03.772 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:04:03.876 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:04:03.877 +03:00 [INF] Hosting environment: Development
2025-08-31 06:04:03.878 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:04:03.880 +03:00 [DBG] Hosting started
2025-08-31 06:05:51.816 +03:00 [DBG] Connection id "0HNF87D5IHIRJ" received FIN.
2025-08-31 06:05:51.829 +03:00 [DBG] Connection id "0HNF87D5IHIRJ" accepted.
2025-08-31 06:05:51.859 +03:00 [DBG] Connection id "0HNF87D5IHIRJ" started.
2025-08-31 06:05:51.861 +03:00 [DBG] Connection id "0HNF87D5IHIRK" accepted.
2025-08-31 06:05:51.862 +03:00 [DBG] Connection id "0HNF87D5IHIRK" started.
2025-08-31 06:05:51.981 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:05:51.996 +03:00 [DBG] Connection id "0HNF87D5IHIRJ" stopped.
2025-08-31 06:05:52.002 +03:00 [DBG] Connection id "0HNF87D5IHIRJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:05:52.006 +03:00 [DBG] Connection 0HNF87D5IHIRK established using the following protocol: "Tls13"
2025-08-31 06:05:52.045 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - application/json 144
2025-08-31 06:05:52.086 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-08-31 06:05:52.088 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-08-31 06:05:52.091 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 06:05:52.134 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 06:05:52.179 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:05:52.216 +03:00 [DBG] Connection id "0HNF87D5IHIRK", Request id "0HNF87D5IHIRK:00000001": started reading request body.
2025-08-31 06:05:52.218 +03:00 [DBG] Connection id "0HNF87D5IHIRK", Request id "0HNF87D5IHIRK:00000001": done reading request body.
2025-08-31 06:05:52.265 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:05:52.570 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:05:52.583 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 06:05:52.588 +03:00 [DBG] Connection id "0HNF87D5IHIRK" completed keep alive response.
2025-08-31 06:05:52.592 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:05:52.597 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 556.0915ms
2025-08-31 06:05:57.289 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - application/json 142
2025-08-31 06:05:57.294 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-08-31 06:05:57.296 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-08-31 06:05:57.298 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 06:05:57.300 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 06:05:57.319 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:05:57.323 +03:00 [DBG] Connection id "0HNF87D5IHIRK", Request id "0HNF87D5IHIRK:00000002": started reading request body.
2025-08-31 06:05:57.324 +03:00 [DBG] Connection id "0HNF87D5IHIRK", Request id "0HNF87D5IHIRK:00000002": done reading request body.
2025-08-31 06:05:57.326 +03:00 [INF] Creating connection (Server=DESKTOP-QCKI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:06:12.352 +03:00 [DBG] Failed to connect ConnectionString: Data Source=DESKTOP-QCKI5\SQLEXPRESS;Initial Catalog=ProductInventory;Integrated Security=True;Trust Server Certificate=True
2025-08-31 06:06:12.354 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 06:06:12.356 +03:00 [DBG] Connection id "0HNF87D5IHIRK" completed keep alive response.
2025-08-31 06:06:12.358 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:06:12.359 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 15070.312ms
2025-08-31 06:10:36.616 +03:00 [DBG] Connection id "0HNF87D5IHIRL" received FIN.
2025-08-31 06:10:36.619 +03:00 [DBG] Connection id "0HNF87D5IHIRL" accepted.
2025-08-31 06:10:36.627 +03:00 [DBG] Connection id "0HNF87D5IHIRL" started.
2025-08-31 06:10:36.628 +03:00 [DBG] Connection id "0HNF87D5IHIRM" accepted.
2025-08-31 06:10:36.679 +03:00 [DBG] Connection id "0HNF87D5IHIRM" started.
2025-08-31 06:10:36.722 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:10:36.726 +03:00 [DBG] Connection id "0HNF87D5IHIRL" stopped.
2025-08-31 06:10:36.727 +03:00 [DBG] Connection 0HNF87D5IHIRM established using the following protocol: "Tls13"
2025-08-31 06:10:36.727 +03:00 [DBG] Connection id "0HNF87D5IHIRL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:10:36.731 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-31 06:10:36.734 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 06:10:36.736 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 06:10:36.739 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 06:10:36.740 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:10:36.751 +03:00 [DBG] Connection id "0HNF87D5IHIRM", Request id "0HNF87D5IHIRM:00000001": started reading request body.
2025-08-31 06:10:36.754 +03:00 [DBG] Connection id "0HNF87D5IHIRM", Request id "0HNF87D5IHIRM:00000001": done reading request body.
2025-08-31 06:10:36.762 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 06:10:36.763 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:10:36.774 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:10:36.827 +03:00 [DBG] Saved secret profile-ea080101-33ab-4c9d-b5b3-d16906545c1b for provider "SqlServer"
2025-08-31 06:10:36.829 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 06:10:36.918 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0)'
2025-08-31 06:10:37.222 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:10:37.253 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:10:37.266 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-31 06:10:37.269 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:37.288 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:37.291 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:10:37.297 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:10:37.302 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-08-31 06:10:37.310 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 06:10:37.331 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 06:10:37.339 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:37.345 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 8ms reading results.
2025-08-31 06:10:37.348 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:37.351 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 06:10:37.529 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 06:10:37.657 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A profile for SqlServer already exists.
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 27
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 54
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 06:10:37.669 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 06:10:37.676 +03:00 [DBG] Connection id "0HNF87D5IHIRM" completed keep alive response.
2025-08-31 06:10:37.677 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:10:37.680 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:37.683 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:10:37.684 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 953.7802ms
2025-08-31 06:10:55.944 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/3d0cdaa1-a28f-48b0-a256-e9e404e13caa - null null
2025-08-31 06:10:55.946 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/3d0cdaa1-a28f-48b0-a256-e9e404e13caa'
2025-08-31 06:10:55.947 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/3d0cdaa1-a28f-48b0-a256-e9e404e13caa'
2025-08-31 06:10:55.950 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 06:10:55.951 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 06:10:55.953 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:10:55.961 +03:00 [INF] Deleting profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-08-31 06:10:55.969 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:10:55.982 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:10:56.097 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:10:56.109 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:10:56.110 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:10:56.111 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:56.112 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:56.114 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:10:56.117 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:10:56.118 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:10:56.119 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:10:56.123 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:10:56.161 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:10:56.187 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:56.188 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 63ms reading results.
2025-08-31 06:10:56.190 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:56.192 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:10:56.207 +03:00 [DBG] Deleted secret profile-88f13218-68c7-45ee-8329-1ce7bb12e51f for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-08-31 06:10:56.211 +03:00 [DBG] Deleted cache directory C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer for profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa"
2025-08-31 06:10:56.221 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:10:56.231 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:10:56.249 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:10:56.255 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:10:56.258 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:10:56.259 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:10:56.306 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:56.308 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:56.312 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:10:56.313 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:10:56.316 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:10:56.318 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 06:10:56.319 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 06:10:56.333 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:56.334 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 12ms reading results.
2025-08-31 06:10:56.336 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:56.337 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:10:56.342 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:10:56.344 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 06:10:56.345 +03:00 [INF] Profile "3d0cdaa1-a28f-48b0-a256-e9e404e13caa" deleted successfully
2025-08-31 06:10:56.348 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 06:10:56.349 +03:00 [DBG] Connection id "0HNF87D5IHIRM" completed keep alive response.
2025-08-31 06:10:56.350 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:10:56.351 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:56.352 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:10:56.353 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/3d0cdaa1-a28f-48b0-a256-e9e404e13caa - 200 null application/json; charset=utf-8 409.735ms
2025-08-31 06:10:58.831 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-31 06:10:58.834 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 06:10:58.836 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 06:10:58.838 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 06:10:58.840 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:10:58.843 +03:00 [DBG] Connection id "0HNF87D5IHIRM", Request id "0HNF87D5IHIRM:00000003": started reading request body.
2025-08-31 06:10:58.844 +03:00 [DBG] Connection id "0HNF87D5IHIRM", Request id "0HNF87D5IHIRM:00000003": done reading request body.
2025-08-31 06:10:58.846 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 06:10:58.847 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:10:58.851 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:10:58.864 +03:00 [DBG] Saved secret profile-c2197495-3dfa-4f0d-8210-d5c7e4384df3 for provider "SqlServer"
2025-08-31 06:10:58.866 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 06:10:58.873 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:10:58.875 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 06:10:58.876 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:58.878 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:58.879 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:10:58.880 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:10:58.881 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:10:58.882 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 06:10:58.884 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 06:10:58.885 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:58.886 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:10:58.887 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:58.888 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:10:58.907 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:10:58.914 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:10:58.915 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:10:58.916 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:10:58.917 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:10:58.918 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:10:58.919 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:10:58.926 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:58.928 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:58.929 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:10:58.930 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:10:58.931 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:10:58.932 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:10:58.940 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:10:58.942 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:58.943 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:10:58.944 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:10:58.945 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:10:58.948 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:10:58.949 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 06:10:58.951 +03:00 [INF] Profile created successfully with Id "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:10:58.955 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 06:10:58.956 +03:00 [DBG] Connection id "0HNF87D5IHIRM" completed keep alive response.
2025-08-31 06:10:58.957 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:10:58.958 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:10:58.960 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:10:58.961 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 130.3361ms
2025-08-31 06:35:40.638 +03:00 [INF] This is a test log to file!
2025-08-31 06:35:41.096 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:35:41.118 +03:00 [INF] API configured successfully.
2025-08-31 06:35:41.287 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:35:41.956 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:35:41.998 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:35:42.024 +03:00 [INF] Registered 12 endpoints in 1,238 milliseconds.
2025-08-31 06:35:42.039 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:35:42.041 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:35:42.044 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:35:42.088 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:35:42.130 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:35:42.138 +03:00 [DBG] Hosting starting
2025-08-31 06:35:42.155 +03:00 [DBG] Middleware loaded
2025-08-31 06:35:42.160 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:35:42.162 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:35:42.258 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:35:42.259 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:35:42.262 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:35:42.295 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:35:42.338 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:35:42.341 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:35:42.342 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:35:42.342 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:35:42.343 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:35:42.343 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:35:42.348 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:35:42.353 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:35:42.436 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:35:42.438 +03:00 [INF] Hosting environment: Development
2025-08-31 06:35:42.439 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:35:42.440 +03:00 [DBG] Hosting started
2025-08-31 06:35:58.710 +03:00 [DBG] Connection id "0HNF87U02E4RB" received FIN.
2025-08-31 06:35:58.718 +03:00 [DBG] Connection id "0HNF87U02E4RB" accepted.
2025-08-31 06:35:58.720 +03:00 [DBG] Connection id "0HNF87U02E4RB" started.
2025-08-31 06:35:58.722 +03:00 [DBG] Connection id "0HNF87U02E4RC" accepted.
2025-08-31 06:35:58.724 +03:00 [DBG] Connection id "0HNF87U02E4RC" started.
2025-08-31 06:35:58.794 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:35:58.802 +03:00 [DBG] Connection id "0HNF87U02E4RB" stopped.
2025-08-31 06:35:58.808 +03:00 [DBG] Connection id "0HNF87U02E4RB" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:35:58.828 +03:00 [DBG] Connection 0HNF87U02E4RC established using the following protocol: "Tls13"
2025-08-31 06:35:58.859 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - null null
2025-08-31 06:35:58.900 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 06:35:58.902 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 06:35:58.905 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 06:35:58.936 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 06:35:58.979 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:35:59.079 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:35:59.122 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:35:59.381 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:35:59.415 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:35:59.428 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-31 06:35:59.431 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:35:59.444 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:35:59.449 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:35:59.457 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2025-08-31 06:35:59.462 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-08-31 06:35:59.470 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:35:59.490 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:35:59.526 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:35:59.555 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:35:59.563 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 63ms reading results.
2025-08-31 06:35:59.569 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:35:59.575 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (6ms).
2025-08-31 06:35:59.580 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:35:59.584 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:35:59.585 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:35:59.587 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:35:59.588 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:35:59.591 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 06:35:59.593 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:35:59.597 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:35:59.601 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:35:59.603 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 06:35:59.605 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:35:59.607 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:35:59.628 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:35:59.644 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 06:35:59.646 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:35:59.649 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:35:59.658 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:35:59.661 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (6ms).
2025-08-31 06:35:59.665 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - 200 null application/json; charset=utf-8 809.8576ms
2025-08-31 06:36:12.442 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/convert - application/json 73
2025-08-31 06:36:12.448 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/convert'
2025-08-31 06:36:12.450 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/convert'
2025-08-31 06:36:12.452 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 06:36:12.455 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 06:36:12.481 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:36:12.484 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:36:12.496 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000002": started reading request body.
2025-08-31 06:36:12.499 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000002": done reading request body.
2025-08-31 06:36:12.540 +03:00 [INF] Converting NL to SQL for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:36:12.544 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:36:12.546 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 06:36:12.547 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:12.549 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:12.550 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:12.552 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:12.553 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:36:12.555 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:12.556 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:12.558 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:36:12.560 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:12.561 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 06:36:12.562 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:12.563 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:12.573 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:36:12.574 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:12.575 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:12.576 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:12.577 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:36:12.578 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:36:12.579 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:12.581 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:12.582 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:12.584 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:36:12.585 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:12.587 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:12.589 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:36:12.603 +03:00 [DBG] Fetching schema for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", ForceRefresh=false
2025-08-31 06:36:12.606 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-31 06:36:12.631 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:36:12.871 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:36:12.993 +03:00 [INF] Loaded 3 tables
2025-08-31 06:36:13.181 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-31 06:36:13.270 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-31 06:36:13.272 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-31 06:36:13.275 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-31 06:36:13.277 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-31 06:36:13.278 +03:00 [DBG] Generated prompt with 6 messages
2025-08-31 06:36:13.285 +03:00 [DBG] Request payload prepared for Groq API
2025-08-31 06:36:14.412 +03:00 [INF] Groq API responded with status: "OK"
2025-08-31 06:36:14.422 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-31 06:36:14.428 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 06:36:14.433 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:36:14.439 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:36:14.440 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:14.442 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:14.445 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/convert - 200 null application/json; charset=utf-8 2003.0673ms
2025-08-31 06:36:23.676 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute - application/json 306
2025-08-31 06:36:23.680 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute'
2025-08-31 06:36:23.681 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute'
2025-08-31 06:36:23.683 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:36:23.687 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:36:23.689 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:36:23.692 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:36:23.706 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000003": started reading request body.
2025-08-31 06:36:23.708 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000003": done reading request body.
2025-08-31 06:36:23.720 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:36:23.721 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:36:23.722 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:23.723 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:23.725 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:23.725 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:36:23.726 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:23.727 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:23.729 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:23.731 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:23.732 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:36:23.734 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:23.736 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:23.945 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:36:23.995 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: No profile found with id: 3d0cdaa1-a28f-48b0-a256-e9e404e13caa
   at NaturalToQuery.Application.Services.ProfileService.GetProviderTypeAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 200
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 61
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 29
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 49
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 06:36:24.006 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 06:36:24.014 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:36:24.015 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:36:24.016 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:24.018 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:24.021 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/3d0cdaa1-a28f-48b0-a256-e9e404e13caa/execute - 500 null application/json; charset=utf-8 344.908ms
2025-08-31 06:36:30.504 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 306
2025-08-31 06:36:30.507 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:36:30.508 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:36:30.510 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:36:30.511 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:36:30.513 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:36:30.515 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:36:30.515 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000004": started reading request body.
2025-08-31 06:36:30.516 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000004": done reading request body.
2025-08-31 06:36:30.518 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:36:30.519 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:36:30.520 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:30.520 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.521 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:30.522 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:36:30.523 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:30.524 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:30.525 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:30.526 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:36:30.527 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.528 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:36:30.529 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.530 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:30.531 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:36:30.532 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:30.533 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.534 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:30.534 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:36:30.535 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:30.537 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:30.538 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:30.539 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.540 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 06:36:30.541 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.542 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:36:30.543 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:36:30.544 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:36:30.551 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:36:30.552 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.Price, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:36:30.554 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:36:30.556 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:36:30.578 +03:00 [INF] Query execution finished in 23 ms, returned 1 rows
2025-08-31 06:36:30.581 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:30.582 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.583 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:30.584 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:30.585 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:36:30.586 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:30.587 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:30.590 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.591 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:36:30.593 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.594 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:36:30.621 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0 && p.Id != __profile_Id_1)'
2025-08-31 06:36:30.631 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1))) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1)), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:36:30.638 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:30.639 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.641 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:30.642 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:30.645 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 06:36:30.646 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:36:30.648 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:36:30.650 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.651 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:36:30.652 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.653 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:36:30.662 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:36:30.667 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:36:30.682 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:36:30.708 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:36:30.715 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:36:30.719 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:36:30.725 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:36:30.728 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:36:30.730 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:36:30.791 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:30.794 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.797 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 06:36:30.803 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 06:36:30.807 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:30.809 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:30.811 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:36:30.813 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:36:30.815 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:36:30.819 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.820 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 06:36:30.826 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:30.827 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:30.828 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:30.829 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 274), @p2='?' (Size = 147), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:36:30.830 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 274), @p2='?' (Size = 147), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:36:30.835 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:36:30.935 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.936 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 104ms reading results.
2025-08-31 06:36:30.991 +03:00 [DBG] Disposing transaction.
2025-08-31 06:36:30.993 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:30.996 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:36:31.161 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:36:31.166 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:36:31.167 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:36:31.169 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:36:31.170 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:31.172 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:31.173 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 669.6387ms
2025-08-31 06:36:37.183 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - null null
2025-08-31 06:36:37.187 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 06:36:37.188 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 06:36:37.190 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 06:36:37.192 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 06:36:37.193 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:36:37.195 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:36:37.195 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:36:37.196 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:37.197 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:37.198 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:37.199 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:36:37.200 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:36:37.201 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:37.203 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:37.204 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:36:37.206 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:37.207 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:36:37.209 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:37.210 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:37.211 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:36:37.212 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:37.213 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:37.214 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:36:37.215 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:36:37.216 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:36:37.217 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:37.218 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:36:37.220 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:37.221 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 06:36:37.222 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:36:37.223 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:36:37.225 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:36:37.226 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 06:36:37.227 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:36:37.228 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:36:37.229 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:36:37.230 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:36:37.231 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - 200 null application/json; charset=utf-8 47.9049ms
2025-08-31 06:37:35.644 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 306
2025-08-31 06:37:35.646 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:37:35.647 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:37:35.649 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:35.650 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:35.651 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:37:35.657 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:37:35.669 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000006": started reading request body.
2025-08-31 06:37:35.670 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000006": done reading request body.
2025-08-31 06:37:35.672 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:35.677 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:37:35.678 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:37:35.679 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 35.3279ms
2025-08-31 06:37:50.259 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 306
2025-08-31 06:37:50.262 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:37:50.264 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:37:50.265 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:50.266 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:50.269 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:37:50.270 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:37:50.272 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000007": started reading request body.
2025-08-31 06:37:50.275 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000007": done reading request body.
2025-08-31 06:37:50.277 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:50.278 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:37:50.280 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:37:50.281 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 22.2819ms
2025-08-31 06:37:59.397 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 309
2025-08-31 06:37:59.401 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:37:59.402 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:37:59.403 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:59.405 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:59.407 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:37:59.409 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:37:59.410 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000008": started reading request body.
2025-08-31 06:37:59.412 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000008": done reading request body.
2025-08-31 06:37:59.413 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:37:59.415 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:37:59.416 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:37:59.417 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 20.3981ms
2025-08-31 06:38:34.295 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 06:38:34.299 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:38:34.300 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:38:34.301 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:38:34.304 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:38:34.305 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:38:34.311 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:38:34.312 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000009": started reading request body.
2025-08-31 06:38:34.314 +03:00 [DBG] Connection id "0HNF87U02E4RC", Request id "0HNF87U02E4RC:00000009": done reading request body.
2025-08-31 06:38:34.316 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:38:34.317 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:38:34.319 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:38:34.321 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:38:34.322 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:38:34.324 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:38:34.326 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:38:34.328 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:38:34.330 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:38:34.333 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:38:34.334 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:38:34.335 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:38:34.336 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:38:34.337 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:38:34.339 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:38:34.340 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:38:34.342 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:38:34.343 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:38:34.344 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:38:34.345 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:38:34.346 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:38:34.348 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:38:34.351 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:38:34.352 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:38:34.354 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:38:34.355 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:38:34.357 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:38:34.358 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:38:34.359 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:38:34.360 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:38:38.957 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:38:38.959 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:38:38.979 +03:00 [INF] Query execution finished in 21 ms, returned 1 rows
2025-08-31 06:39:00.443 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:39:00.462 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:00.464 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:39:00.464 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:39:00.465 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:39:00.466 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:39:00.468 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:39:00.469 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:00.470 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 06:39:00.472 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:00.473 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:39:18.022 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:39:18.024 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:18.027 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:39:18.032 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2025-08-31 06:39:18.035 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-31 06:39:18.036 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:39:18.038 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:39:18.039 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:18.040 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:39:18.042 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:18.052 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (10ms).
2025-08-31 06:39:18.053 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:39:18.408 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:39:18.410 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:39:18.413 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:39:18.415 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:39:18.417 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:39:18.418 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:39:18.420 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:39:18.421 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:39:18.423 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:39:18.425 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:18.426 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 06:39:18.427 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 06:39:18.431 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:39:18.433 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:39:18.434 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:39:18.435 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:39:18.437 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:39:18.439 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:18.440 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 06:39:18.446 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:39:18.447 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:39:18.448 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:39:18.449 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 258), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:39:18.450 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 258), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:39:18.452 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:39:18.530 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:18.538 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 86ms reading results.
2025-08-31 06:39:18.583 +03:00 [DBG] Disposing transaction.
2025-08-31 06:39:18.584 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:39:18.586 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:40:39.105 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:40:40.954 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:40:40.956 +03:00 [DBG] Connection id "0HNF87U02E4RC" completed keep alive response.
2025-08-31 06:40:40.958 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:40:40.960 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:40:40.962 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:40:40.965 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 126692.2813ms
2025-08-31 06:40:47.013 +03:00 [DBG] Connection id "0HNF87U02E4RD" received FIN.
2025-08-31 06:40:47.015 +03:00 [DBG] Connection id "0HNF87U02E4RD" accepted.
2025-08-31 06:40:47.015 +03:00 [DBG] Connection id "0HNF87U02E4RD" started.
2025-08-31 06:40:47.016 +03:00 [DBG] Connection id "0HNF87U02E4RE" accepted.
2025-08-31 06:40:47.043 +03:00 [DBG] Connection id "0HNF87U02E4RE" started.
2025-08-31 06:40:47.059 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:40:47.062 +03:00 [DBG] Connection id "0HNF87U02E4RD" stopped.
2025-08-31 06:40:47.063 +03:00 [DBG] Connection id "0HNF87U02E4RD" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:40:47.063 +03:00 [DBG] Connection 0HNF87U02E4RE established using the following protocol: "Tls13"
2025-08-31 06:40:47.064 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 280
2025-08-31 06:40:47.066 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:40:47.067 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:40:47.068 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:40:47.069 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:40:47.070 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:40:47.071 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:40:47.072 +03:00 [DBG] Connection id "0HNF87U02E4RE", Request id "0HNF87U02E4RE:00000001": started reading request body.
2025-08-31 06:40:47.073 +03:00 [DBG] Connection id "0HNF87U02E4RE", Request id "0HNF87U02E4RE:00000001": done reading request body.
2025-08-31 06:40:47.074 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:40:47.075 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:40:47.075 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:40:47.076 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:47.077 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:40:47.077 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:40:47.078 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:40:47.079 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:40:47.080 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:40:47.082 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:40:47.083 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:47.084 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:40:47.085 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:47.086 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:40:47.087 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:40:47.088 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:40:47.089 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:47.089 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:40:47.090 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:40:47.091 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:40:47.092 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:40:47.093 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:40:47.095 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:47.095 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 06:40:47.096 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:47.097 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:40:47.098 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:40:47.099 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:40:47.100 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:40:47.101 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:40:50.497 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:40:50.506 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:40:50.531 +03:00 [INF] Query execution finished in 33 ms, returned 1 rows
2025-08-31 06:40:55.733 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:40:55.740 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:55.742 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:40:55.744 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:40:55.745 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:40:55.746 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:40:55.751 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:40:55.753 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:55.754 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:40:55.756 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:40:55.757 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:43:56.970 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:43:56.978 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:43:56.981 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:43:56.987 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:43:56.988 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:43:56.991 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:43:56.992 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:43:56.994 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:43:56.995 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:43:56.997 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:43:56.999 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:43:57.000 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:43:57.002 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:43:57.009 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 238), @p2='?' (Size = 121), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:43:57.011 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 238), @p2='?' (Size = 121), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:43:57.015 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:43:57.083 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:43:57.086 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 70ms reading results.
2025-08-31 06:43:57.130 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:43:57.132 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:43:57.338 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:43:57.343 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:43:57.344 +03:00 [DBG] Connection id "0HNF87U02E4RE" completed keep alive response.
2025-08-31 06:43:57.346 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:43:57.347 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:43:57.349 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:43:57.351 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 190286.7556ms
2025-08-31 06:43:57.830 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:44:01.940 +03:00 [INF] This is a test log to file!
2025-08-31 06:44:02.414 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:44:02.423 +03:00 [INF] API configured successfully.
2025-08-31 06:44:02.608 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:44:03.125 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:44:03.158 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:44:03.167 +03:00 [INF] Registered 12 endpoints in 1,056 milliseconds.
2025-08-31 06:44:03.173 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:44:03.175 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:44:03.176 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:44:03.199 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:44:03.224 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:44:03.226 +03:00 [DBG] Hosting starting
2025-08-31 06:44:03.237 +03:00 [DBG] Middleware loaded
2025-08-31 06:44:03.240 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:44:03.242 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:44:03.309 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:44:03.312 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:44:03.315 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:44:03.341 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:44:03.403 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:44:03.405 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:44:03.406 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:44:03.407 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:44:03.407 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:44:03.408 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:44:03.413 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:44:03.419 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:44:03.504 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:44:03.505 +03:00 [INF] Hosting environment: Development
2025-08-31 06:44:03.506 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:44:03.507 +03:00 [DBG] Hosting started
2025-08-31 06:44:12.672 +03:00 [DBG] Connection id "0HNF882J97ARC" received FIN.
2025-08-31 06:44:12.678 +03:00 [DBG] Connection id "0HNF882J97ARC" accepted.
2025-08-31 06:44:12.680 +03:00 [DBG] Connection id "0HNF882J97ARC" started.
2025-08-31 06:44:12.681 +03:00 [DBG] Connection id "0HNF882J97ARD" accepted.
2025-08-31 06:44:12.683 +03:00 [DBG] Connection id "0HNF882J97ARD" started.
2025-08-31 06:44:12.740 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:44:12.747 +03:00 [DBG] Connection id "0HNF882J97ARC" stopped.
2025-08-31 06:44:12.751 +03:00 [DBG] Connection id "0HNF882J97ARC" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:44:12.765 +03:00 [DBG] Connection 0HNF882J97ARD established using the following protocol: "Tls13"
2025-08-31 06:44:12.791 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 266
2025-08-31 06:44:12.822 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:44:12.825 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:44:12.828 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:44:12.849 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:44:12.887 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:44:12.891 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:44:12.928 +03:00 [DBG] Connection id "0HNF882J97ARD", Request id "0HNF882J97ARD:00000001": started reading request body.
2025-08-31 06:44:12.931 +03:00 [DBG] Connection id "0HNF882J97ARD", Request id "0HNF882J97ARD:00000001": done reading request body.
2025-08-31 06:44:13.009 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:44:13.046 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:44:13.282 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:44:13.314 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:44:13.325 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-31 06:44:13.329 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:44:13.341 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:13.344 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:44:13.349 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:44:13.353 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-31 06:44:13.359 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:44:13.375 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:44:13.407 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:44:13.435 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:13.442 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 61ms reading results.
2025-08-31 06:44:13.446 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:13.450 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 06:44:13.458 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:44:13.461 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:44:13.462 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:13.463 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:44:13.463 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:44:13.465 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:44:13.466 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:44:13.467 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:44:13.469 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:13.470 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:44:13.472 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:13.473 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:44:13.480 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:44:13.491 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:44:13.501 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:44:13.503 +03:00 [DBG] SQL: SELECT P.Id, P.Name, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:44:13.505 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:44:13.752 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:44:13.817 +03:00 [INF] Query execution finished in 312 ms, returned 1 rows
2025-08-31 06:44:16.236 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:44:16.238 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:16.240 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:44:16.241 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:44:16.242 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:44:16.244 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:44:16.247 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:44:16.250 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:16.252 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:44:16.253 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:16.255 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:44:18.086 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:44:18.139 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:44:18.186 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:44:18.194 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:44:18.197 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:44:18.205 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:44:18.207 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:44:18.208 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:44:18.261 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:44:18.263 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:18.265 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:44:18.267 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:44:18.268 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:44:18.269 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 187), @p2='?' (Size = 107), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:44:18.271 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 187), @p2='?' (Size = 107), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:44:18.277 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:44:18.344 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:18.347 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 74ms reading results.
2025-08-31 06:44:18.387 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:44:18.389 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:45:37.972 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:45:38.034 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:45:38.040 +03:00 [DBG] Connection id "0HNF882J97ARD" completed keep alive response.
2025-08-31 06:45:38.044 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:45:38.048 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:45:38.052 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 06:45:38.059 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 85270.8221ms
2025-08-31 06:47:23.037 +03:00 [INF] This is a test log to file!
2025-08-31 06:47:23.417 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:47:23.426 +03:00 [INF] API configured successfully.
2025-08-31 06:47:23.584 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:47:24.098 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:47:24.160 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:47:24.172 +03:00 [INF] Registered 12 endpoints in 963 milliseconds.
2025-08-31 06:47:24.181 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:47:24.185 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:47:24.194 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:47:24.225 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:47:24.272 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:47:24.275 +03:00 [DBG] Hosting starting
2025-08-31 06:47:24.289 +03:00 [DBG] Middleware loaded
2025-08-31 06:47:24.294 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:47:24.297 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:47:24.394 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:47:24.398 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:47:24.401 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:47:24.436 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:47:24.553 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:47:24.556 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:47:24.557 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:47:24.558 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:47:24.558 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:47:24.559 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:47:24.574 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:47:24.589 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:47:24.622 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:47:24.624 +03:00 [INF] Hosting environment: Development
2025-08-31 06:47:24.625 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:47:24.626 +03:00 [DBG] Hosting started
2025-08-31 06:48:26.087 +03:00 [DBG] Connection id "0HNF884UPVB5M" received FIN.
2025-08-31 06:48:26.097 +03:00 [DBG] Connection id "0HNF884UPVB5M" accepted.
2025-08-31 06:48:26.124 +03:00 [DBG] Connection id "0HNF884UPVB5M" started.
2025-08-31 06:48:26.125 +03:00 [DBG] Connection id "0HNF884UPVB5N" accepted.
2025-08-31 06:48:26.128 +03:00 [DBG] Connection id "0HNF884UPVB5N" started.
2025-08-31 06:48:26.251 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:48:26.269 +03:00 [DBG] Connection id "0HNF884UPVB5M" stopped.
2025-08-31 06:48:26.273 +03:00 [DBG] Connection id "0HNF884UPVB5M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:48:26.288 +03:00 [DBG] Connection 0HNF884UPVB5N established using the following protocol: "Tls13"
2025-08-31 06:48:26.312 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 280
2025-08-31 06:48:26.352 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:48:26.354 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:48:26.357 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:48:26.381 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:48:26.418 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:48:26.422 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:48:26.457 +03:00 [DBG] Connection id "0HNF884UPVB5N", Request id "0HNF884UPVB5N:00000001": started reading request body.
2025-08-31 06:48:26.460 +03:00 [DBG] Connection id "0HNF884UPVB5N", Request id "0HNF884UPVB5N:00000001": done reading request body.
2025-08-31 06:48:26.532 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:48:26.584 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:48:26.902 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:48:26.942 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:48:26.955 +03:00 [DBG] Created DbConnection. (12ms).
2025-08-31 06:48:26.968 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:48:26.989 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:26.996 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:48:27.004 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-31 06:48:27.010 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (14ms).
2025-08-31 06:48:27.021 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:48:27.048 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:48:27.095 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:48:27.127 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:27.134 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 73ms reading results.
2025-08-31 06:48:27.139 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:27.144 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 06:48:27.157 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:48:27.162 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:48:27.165 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:27.173 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:48:27.175 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:48:27.177 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:48:27.178 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:48:27.179 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:48:27.182 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:27.183 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:48:27.184 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:27.185 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:48:27.197 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:48:27.215 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:48:27.233 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:48:27.236 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:48:27.240 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:48:27.520 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:48:27.584 +03:00 [INF] Query execution finished in 345 ms, returned 1 rows
2025-08-31 06:48:34.359 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:48:34.361 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:34.362 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:48:34.363 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:48:34.383 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (20ms).
2025-08-31 06:48:34.384 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:48:34.386 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:48:34.389 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:34.390 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:48:34.391 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:48:34.392 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:51:13.042 +03:00 [INF] This is a test log to file!
2025-08-31 06:51:13.357 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:51:13.367 +03:00 [INF] API configured successfully.
2025-08-31 06:51:13.577 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:51:14.201 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:51:14.241 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:51:14.251 +03:00 [INF] Registered 12 endpoints in 1,074 milliseconds.
2025-08-31 06:51:14.260 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:51:14.263 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:51:14.264 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:51:14.296 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:51:14.326 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:51:14.328 +03:00 [DBG] Hosting starting
2025-08-31 06:51:14.340 +03:00 [DBG] Middleware loaded
2025-08-31 06:51:14.343 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:51:14.344 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:51:14.411 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:51:14.413 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:51:14.416 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:51:14.445 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:51:14.502 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:51:14.504 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:51:14.507 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:51:14.508 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:51:14.509 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:51:14.511 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:51:14.521 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:51:14.529 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:51:14.573 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:51:14.583 +03:00 [INF] Hosting environment: Development
2025-08-31 06:51:14.584 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:51:14.630 +03:00 [DBG] Hosting started
2025-08-31 06:51:14.722 +03:00 [DBG] Connection id "0HNF886H26JNL" received FIN.
2025-08-31 06:51:14.735 +03:00 [DBG] Connection id "0HNF886H26JNL" accepted.
2025-08-31 06:51:14.737 +03:00 [DBG] Connection id "0HNF886H26JNL" started.
2025-08-31 06:51:14.739 +03:00 [DBG] Connection id "0HNF886H26JNM" accepted.
2025-08-31 06:51:14.740 +03:00 [DBG] Connection id "0HNF886H26JNM" started.
2025-08-31 06:51:14.844 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:51:14.852 +03:00 [DBG] Connection id "0HNF886H26JNL" stopped.
2025-08-31 06:51:14.855 +03:00 [DBG] Connection id "0HNF886H26JNL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:51:14.865 +03:00 [DBG] Connection 0HNF886H26JNM established using the following protocol: "Tls13"
2025-08-31 06:51:14.897 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 280
2025-08-31 06:51:14.978 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:51:14.980 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:51:14.992 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:51:15.033 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:51:15.084 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:51:15.087 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:51:15.126 +03:00 [DBG] Connection id "0HNF886H26JNM", Request id "0HNF886H26JNM:00000001": started reading request body.
2025-08-31 06:51:15.128 +03:00 [DBG] Connection id "0HNF886H26JNM", Request id "0HNF886H26JNM:00000001": done reading request body.
2025-08-31 06:51:15.215 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:51:15.261 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:51:15.635 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:51:15.684 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:51:15.700 +03:00 [DBG] Created DbConnection. (15ms).
2025-08-31 06:51:15.705 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:51:15.718 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:15.723 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:51:15.729 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:51:15.733 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-08-31 06:51:15.739 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:51:15.758 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:51:15.799 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:51:15.838 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:15.845 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 80ms reading results.
2025-08-31 06:51:15.851 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:15.856 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (5ms).
2025-08-31 06:51:15.866 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:51:15.871 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:51:15.877 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:15.879 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:51:15.881 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:51:15.882 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:51:15.887 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:51:15.888 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:51:15.891 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:15.893 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:51:15.895 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:15.897 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:51:15.916 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:51:15.932 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:51:15.944 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:51:15.946 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:51:15.949 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:51:16.228 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:51:16.308 +03:00 [INF] Query execution finished in 359 ms, returned 1 rows
2025-08-31 06:51:18.603 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:51:18.605 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:18.606 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:51:18.607 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:51:18.609 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:51:18.610 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:51:18.611 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:51:18.613 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:18.614 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:51:18.615 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:18.616 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:51:20.392 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:51:20.429 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:51:20.462 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:51:20.467 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:51:20.470 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:51:20.478 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:51:20.481 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:51:20.482 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:51:20.554 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:51:20.557 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:20.560 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:51:20.562 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:51:20.567 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-08-31 06:51:20.568 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 239), @p2='?' (Size = 121), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:51:20.570 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 239), @p2='?' (Size = 121), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:51:20.582 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:51:20.669 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:20.672 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 100ms reading results.
2025-08-31 06:51:20.720 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:51:20.722 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:51:24.932 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:51:24.945 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:51:24.950 +03:00 [DBG] Connection id "0HNF886H26JNM" completed keep alive response.
2025-08-31 06:51:24.954 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:51:24.958 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:51:24.961 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:51:24.965 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 10072.3689ms
2025-08-31 06:52:12.801 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 06:52:12.806 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:52:12.807 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:52:12.810 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:52:12.812 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:52:12.851 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:52:12.855 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:52:12.856 +03:00 [DBG] Connection id "0HNF886H26JNM", Request id "0HNF886H26JNM:00000002": started reading request body.
2025-08-31 06:52:12.857 +03:00 [DBG] Connection id "0HNF886H26JNM", Request id "0HNF886H26JNM:00000002": done reading request body.
2025-08-31 06:52:12.860 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:52:12.861 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:52:12.862 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:52:12.863 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:12.864 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:52:12.864 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:52:12.865 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:52:12.866 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:12.868 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:12.870 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:52:12.871 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:12.876 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-08-31 06:52:12.878 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:12.879 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:52:12.881 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:52:12.882 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:52:12.883 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:12.883 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:52:12.884 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:52:12.885 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:52:12.886 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:12.888 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:12.889 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:12.891 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:52:12.892 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:12.893 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:52:12.894 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:52:12.895 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:52:12.896 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:52:12.897 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:52:12.898 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:52:12.900 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:52:12.904 +03:00 [INF] Query execution finished in 6 ms, returned 1 rows
2025-08-31 06:52:15.971 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:52:15.973 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:15.974 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:52:15.975 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:52:15.976 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:52:15.977 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:15.988 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:15.990 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:15.995 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 06:52:16.001 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:16.002 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:52:42.956 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:52:42.967 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:52:42.971 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:52:42.972 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:52:42.973 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:52:42.974 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:52:42.974 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:52:42.975 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:52:42.977 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:52:42.978 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:42.979 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:52:42.979 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:52:42.980 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:52:42.981 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 257), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:52:43.001 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 257), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:52:43.003 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:52:43.088 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:43.094 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 90ms reading results.
2025-08-31 06:52:43.140 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:43.141 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:52:43.370 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:52:43.373 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:52:43.375 +03:00 [DBG] Connection id "0HNF886H26JNM" completed keep alive response.
2025-08-31 06:52:43.377 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:52:43.378 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:52:43.380 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:52:43.382 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 30580.9409ms
2025-08-31 06:52:54.985 +03:00 [INF] This is a test log to file!
2025-08-31 06:52:55.234 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:52:55.242 +03:00 [INF] API configured successfully.
2025-08-31 06:52:55.395 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:52:56.191 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:52:56.227 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:52:56.238 +03:00 [INF] Registered 12 endpoints in 1,172 milliseconds.
2025-08-31 06:52:56.257 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:52:56.260 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:52:56.261 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:52:56.300 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:52:56.333 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:52:56.335 +03:00 [DBG] Hosting starting
2025-08-31 06:52:56.357 +03:00 [DBG] Middleware loaded
2025-08-31 06:52:56.361 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:52:56.364 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:52:56.435 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:52:56.437 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:52:56.439 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:52:56.466 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:52:56.533 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:52:56.536 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:52:56.538 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:52:56.539 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:52:56.541 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:52:56.543 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:52:56.549 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:52:56.557 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:52:56.667 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:52:56.667 +03:00 [INF] Hosting environment: Development
2025-08-31 06:52:56.668 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:52:56.669 +03:00 [DBG] Hosting started
2025-08-31 06:52:58.189 +03:00 [DBG] Connection id "0HNF887FSUBTG" received FIN.
2025-08-31 06:52:58.195 +03:00 [DBG] Connection id "0HNF887FSUBTG" accepted.
2025-08-31 06:52:58.197 +03:00 [DBG] Connection id "0HNF887FSUBTG" started.
2025-08-31 06:52:58.198 +03:00 [DBG] Connection id "0HNF887FSUBTH" accepted.
2025-08-31 06:52:58.199 +03:00 [DBG] Connection id "0HNF887FSUBTH" started.
2025-08-31 06:52:58.262 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:52:58.269 +03:00 [DBG] Connection id "0HNF887FSUBTG" stopped.
2025-08-31 06:52:58.272 +03:00 [DBG] Connection id "0HNF887FSUBTG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:52:58.285 +03:00 [DBG] Connection 0HNF887FSUBTH established using the following protocol: "Tls13"
2025-08-31 06:52:58.311 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 06:52:58.343 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:52:58.347 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:52:58.349 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:52:58.373 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:52:58.413 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:52:58.416 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:52:58.454 +03:00 [DBG] Connection id "0HNF887FSUBTH", Request id "0HNF887FSUBTH:00000001": started reading request body.
2025-08-31 06:52:58.457 +03:00 [DBG] Connection id "0HNF887FSUBTH", Request id "0HNF887FSUBTH:00000001": done reading request body.
2025-08-31 06:52:58.534 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:52:58.574 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:52:58.805 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:52:58.838 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:52:58.850 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-31 06:52:58.854 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:52:58.866 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:58.869 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:52:58.875 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:52:58.879 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-31 06:52:58.886 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:58.903 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:58.937 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:52:58.963 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:58.970 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 62ms reading results.
2025-08-31 06:52:58.975 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:58.978 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 06:52:58.987 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:52:58.990 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:52:58.991 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:58.992 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:52:58.993 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:52:58.995 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:52:58.996 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:58.998 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:52:59.002 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:59.003 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:52:59.005 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:52:59.006 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:52:59.015 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:52:59.028 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:52:59.041 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:52:59.044 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:52:59.046 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:52:59.285 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:52:59.346 +03:00 [INF] Query execution finished in 300 ms, returned 1 rows
2025-08-31 06:53:01.996 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:53:01.998 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:53:01.999 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:53:02.000 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:53:02.001 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:53:02.002 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:53:02.004 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:53:02.006 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:53:02.007 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:53:02.008 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:53:02.009 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:53:03.533 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:53:03.554 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:53:03.583 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:53:03.591 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:53:03.594 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:53:03.599 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:53:03.603 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:53:03.605 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:53:03.652 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:53:03.655 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:53:03.658 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:53:03.659 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:53:03.660 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:53:03.661 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 259), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:53:03.662 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 259), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:53:03.670 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:53:03.739 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:53:03.743 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 79ms reading results.
2025-08-31 06:53:03.785 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:53:03.787 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:55:16.619 +03:00 [INF] This is a test log to file!
2025-08-31 06:55:16.963 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:55:16.976 +03:00 [INF] API configured successfully.
2025-08-31 06:55:17.134 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:55:17.625 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:55:17.656 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:55:17.666 +03:00 [INF] Registered 12 endpoints in 966 milliseconds.
2025-08-31 06:55:17.674 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:55:17.677 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:55:17.678 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:55:17.701 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:55:17.731 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:55:17.733 +03:00 [DBG] Hosting starting
2025-08-31 06:55:17.744 +03:00 [DBG] Middleware loaded
2025-08-31 06:55:17.747 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:55:17.750 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:55:17.823 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:55:17.825 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:55:17.828 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:55:17.865 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:55:17.929 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:55:17.931 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:55:17.932 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:55:17.948 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:55:17.950 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:55:17.951 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:55:17.959 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:55:17.972 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:55:18.118 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:55:18.119 +03:00 [INF] Hosting environment: Development
2025-08-31 06:55:18.120 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:55:18.120 +03:00 [DBG] Hosting started
2025-08-31 06:55:19.879 +03:00 [DBG] Connection id "0HNF888Q46OE6" received FIN.
2025-08-31 06:55:19.887 +03:00 [DBG] Connection id "0HNF888Q46OE6" accepted.
2025-08-31 06:55:19.891 +03:00 [DBG] Connection id "0HNF888Q46OE6" started.
2025-08-31 06:55:19.898 +03:00 [DBG] Connection id "0HNF888Q46OE7" accepted.
2025-08-31 06:55:19.903 +03:00 [DBG] Connection id "0HNF888Q46OE7" started.
2025-08-31 06:55:20.004 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:55:20.020 +03:00 [DBG] Connection id "0HNF888Q46OE6" stopped.
2025-08-31 06:55:20.026 +03:00 [DBG] Connection id "0HNF888Q46OE6" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:55:20.036 +03:00 [DBG] Connection 0HNF888Q46OE7 established using the following protocol: "Tls13"
2025-08-31 06:55:20.067 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 06:55:20.120 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:55:20.123 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:55:20.126 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:20.159 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:20.217 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:55:20.221 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:55:20.261 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000001": started reading request body.
2025-08-31 06:55:20.264 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000001": done reading request body.
2025-08-31 06:55:20.348 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:55:20.412 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:55:20.715 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:55:20.757 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:55:20.769 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-31 06:55:20.773 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:20.785 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:20.789 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:20.795 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:55:20.798 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-31 06:55:20.805 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:20.821 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:20.853 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:20.880 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:20.886 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 59ms reading results.
2025-08-31 06:55:20.892 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:20.896 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 06:55:20.906 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:55:20.909 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:20.910 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:20.911 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:20.912 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:55:20.913 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:55:20.914 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:20.916 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:20.920 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:20.921 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:55:20.922 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:20.923 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:55:20.933 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:55:20.946 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:55:20.958 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:55:20.960 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:55:20.963 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:55:21.206 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:55:21.269 +03:00 [INF] Query execution finished in 306 ms, returned 1 rows
2025-08-31 06:55:24.163 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:24.165 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:24.167 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:24.168 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:55:24.169 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:55:24.172 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:24.176 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:24.177 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:24.178 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:55:24.180 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:24.180 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:55:25.651 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:55:25.690 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:25.720 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:25.726 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:25.729 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:55:25.737 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:55:25.742 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:55:25.744 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:55:25.791 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:25.794 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:25.796 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:25.798 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:55:25.799 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:55:25.800 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 259), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:55:25.801 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 259), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:55:25.808 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:55:25.877 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:25.879 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 76ms reading results.
2025-08-31 06:55:25.923 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:25.925 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:55:32.098 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:55:32.110 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:32.114 +03:00 [DBG] Connection id "0HNF888Q46OE7" completed keep alive response.
2025-08-31 06:55:32.116 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:55:32.120 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:32.122 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:55:32.126 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 12063.013ms
2025-08-31 06:55:36.859 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 306
2025-08-31 06:55:36.865 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:55:36.866 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:55:36.867 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:36.891 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:36.931 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:55:36.935 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:55:36.936 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000002": started reading request body.
2025-08-31 06:55:36.937 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000002": done reading request body.
2025-08-31 06:55:36.939 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:55:36.940 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:55:36.941 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:36.942 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:36.943 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:36.944 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:55:36.945 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:55:36.946 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:36.947 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:36.949 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:36.950 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:36.951 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:55:36.953 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:36.954 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:55:36.955 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:55:36.956 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:36.957 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:36.958 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:36.959 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:55:36.960 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:55:36.961 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:36.962 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:36.964 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:36.965 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 06:55:36.966 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:36.967 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:55:36.968 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:55:36.969 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:55:36.970 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:55:36.971 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.Price, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:55:36.972 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:55:36.974 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:55:36.978 +03:00 [INF] Query execution finished in 6 ms, returned 1 rows
2025-08-31 06:55:39.542 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:39.545 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:39.546 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:39.547 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:55:39.549 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:55:39.550 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:39.551 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:55:39.553 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:39.554 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:55:39.555 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:39.556 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:55:47.089 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:55:47.091 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:47.094 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:47.096 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:55:47.098 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:55:47.099 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:55:47.100 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:55:47.102 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:55:47.105 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:47.106 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:47.109 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:55:47.110 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:55:47.111 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:55:47.112 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 273), @p2='?' (Size = 147), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:55:47.114 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 273), @p2='?' (Size = 147), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:55:47.115 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:55:47.177 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:47.178 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 62ms reading results.
2025-08-31 06:55:47.226 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:55:47.227 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:55:47.380 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:55:47.384 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:47.385 +03:00 [DBG] Connection id "0HNF888Q46OE7" completed keep alive response.
2025-08-31 06:55:47.387 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:55:47.388 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:55:47.389 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:55:47.391 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 10532.1391ms
2025-08-31 06:55:56.974 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 06:55:56.982 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:55:56.984 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:55:56.985 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:56.987 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:56.989 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:55:56.991 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:55:56.992 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000003": started reading request body.
2025-08-31 06:55:56.993 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000003": done reading request body.
2025-08-31 06:55:56.994 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:55:56.995 +03:00 [DBG] Connection id "0HNF888Q46OE7" completed keep alive response.
2025-08-31 06:55:56.996 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:55:56.997 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 23.2489ms
2025-08-31 06:56:03.017 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 280
2025-08-31 06:56:03.020 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:56:03.022 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:56:03.024 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:56:03.025 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:56:03.028 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:56:03.030 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:56:03.031 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000004": started reading request body.
2025-08-31 06:56:03.031 +03:00 [DBG] Connection id "0HNF888Q46OE7", Request id "0HNF888Q46OE7:00000004": done reading request body.
2025-08-31 06:56:03.034 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:56:03.035 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 06:56:03.037 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:03.038 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:03.039 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:03.040 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:56:03.041 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:56:03.042 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:03.044 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:03.045 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:03.047 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:03.048 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:56:03.050 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:03.051 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:56:03.053 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:56:03.055 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:03.056 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:03.057 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:03.058 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:56:03.060 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:56:03.061 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:03.063 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:03.065 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:03.066 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:56:03.068 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:03.069 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:56:03.070 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:56:03.071 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:56:03.072 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:56:03.074 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:56:03.075 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:56:03.076 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:56:03.079 +03:00 [INF] Query execution finished in 4 ms, returned 1 rows
2025-08-31 06:56:06.655 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:06.657 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:06.658 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:06.659 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:56:06.660 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:56:06.661 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:06.663 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:06.665 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:06.666 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:56:06.667 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:06.668 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:56:21.145 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:56:21.147 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:21.148 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:21.149 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:21.151 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:56:21.153 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:56:21.154 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:56:21.154 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:56:21.156 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:21.158 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:21.159 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:21.159 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:56:21.160 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:56:21.162 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 237), @p2='?' (Size = 121), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:56:21.164 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 237), @p2='?' (Size = 121), @p3='?' (DbType = DateTime), @p4='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:56:21.166 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:56:21.232 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:21.235 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 68ms reading results.
2025-08-31 06:56:21.284 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:21.286 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:56:21.502 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 06:56:21.504 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:56:21.505 +03:00 [DBG] Connection id "0HNF888Q46OE7" completed keep alive response.
2025-08-31 06:56:21.506 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:56:21.507 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:21.507 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:56:21.508 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 18491.2626ms
2025-08-31 06:56:49.433 +03:00 [INF] This is a test log to file!
2025-08-31 06:56:49.822 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:56:49.832 +03:00 [INF] API configured successfully.
2025-08-31 06:56:49.997 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:56:50.617 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:56:50.671 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:56:50.690 +03:00 [INF] Registered 12 endpoints in 1,114 milliseconds.
2025-08-31 06:56:50.698 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:56:50.701 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:56:50.702 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:56:50.749 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:56:50.815 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:56:50.817 +03:00 [DBG] Hosting starting
2025-08-31 06:56:50.835 +03:00 [DBG] Middleware loaded
2025-08-31 06:56:50.841 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:56:50.843 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:56:50.931 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:56:50.933 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:56:50.937 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:56:50.969 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:56:51.076 +03:00 [DBG] Connection id "0HNF889L9TR4J" received FIN.
2025-08-31 06:56:51.082 +03:00 [DBG] Connection id "0HNF889L9TR4J" accepted.
2025-08-31 06:56:51.084 +03:00 [DBG] Connection id "0HNF889L9TR4J" started.
2025-08-31 06:56:51.086 +03:00 [DBG] Connection id "0HNF889L9TR4K" accepted.
2025-08-31 06:56:51.087 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:56:51.087 +03:00 [DBG] Connection id "0HNF889L9TR4K" started.
2025-08-31 06:56:51.088 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:56:51.090 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:56:51.091 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:56:51.092 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:56:51.092 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:56:51.204 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:56:51.207 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:56:51.230 +03:00 [DBG] Connection id "0HNF889L9TR4J" stopped.
2025-08-31 06:56:51.233 +03:00 [DBG] Connection id "0HNF889L9TR4J" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:56:51.234 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:56:51.237 +03:00 [DBG] Connection 0HNF889L9TR4K established using the following protocol: "Tls13"
2025-08-31 06:56:51.266 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 280
2025-08-31 06:56:51.273 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:56:51.275 +03:00 [INF] Hosting environment: Development
2025-08-31 06:56:51.280 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:56:51.281 +03:00 [DBG] Hosting started
2025-08-31 06:56:51.367 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:56:51.371 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:56:51.374 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:56:51.398 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:56:51.443 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:56:51.447 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:56:51.485 +03:00 [DBG] Connection id "0HNF889L9TR4K", Request id "0HNF889L9TR4K:00000001": started reading request body.
2025-08-31 06:56:51.489 +03:00 [DBG] Connection id "0HNF889L9TR4K", Request id "0HNF889L9TR4K:00000001": done reading request body.
2025-08-31 06:56:51.563 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:56:51.604 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:56:51.852 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:56:51.888 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:56:51.901 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-31 06:56:51.906 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:51.919 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:51.923 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:51.929 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:56:51.932 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-31 06:56:51.940 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:51.959 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:51.992 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:52.020 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:52.028 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 60ms reading results.
2025-08-31 06:56:52.033 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:52.036 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 06:56:52.047 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:56:52.051 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:52.053 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:52.055 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:52.056 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:56:52.058 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:56:52.061 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:52.064 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:52.068 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:52.069 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 06:56:52.070 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:52.072 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:56:52.094 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:56:52.119 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:56:52.131 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:56:52.146 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:56:52.149 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:56:52.455 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:56:52.520 +03:00 [INF] Query execution finished in 371 ms, returned 1 rows
2025-08-31 06:56:54.465 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:54.470 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:54.471 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:54.473 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:56:54.475 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 06:56:54.477 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:54.480 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:56:54.484 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:54.486 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:56:54.488 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:54.490 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:56:56.392 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0 && p.Id != __profile_Id_1)'
2025-08-31 06:56:56.401 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1))) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1)), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:56:56.408 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:56.410 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:56.410 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:56.411 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:56:56.414 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:56:56.415 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:56:56.418 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:56:56.420 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:56.421 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:56:56.422 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:56.423 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:56:56.461 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:56.469 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:56.479 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:56.727 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:56:56.743 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:56.750 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:56:56.756 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:56:56.759 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:56:56.761 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:56:56.823 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:56:56.825 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:56.828 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 06:56:56.833 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 06:56:56.836 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:56.837 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:56:56.838 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:56:56.839 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:56:56.840 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:56:56.844 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:56.845 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 06:56:56.848 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:56:56.848 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:56:56.849 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:56:56.850 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 121), @p4='?' (DbType = DateTime), @p5='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:56:56.852 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 121), @p4='?' (DbType = DateTime), @p5='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:56:56.853 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:56.854 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 06:56:56.857 +03:00 [DBG] Committing transaction.
2025-08-31 06:56:56.867 +03:00 [DBG] Committed transaction.
2025-08-31 06:56:56.869 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:56:56.870 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:56:56.872 +03:00 [DBG] Disposing transaction.
2025-08-31 06:56:56.875 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:56.876 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:56:56.878 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 2 entities written to the database.
2025-08-31 06:57:09.511 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: Object reference not set to an instance of an object.
2025-08-31 06:57:09.524 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:57:09.529 +03:00 [DBG] Connection id "0HNF889L9TR4K" completed keep alive response.
2025-08-31 06:57:09.531 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:57:09.536 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:57:09.539 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:57:09.543 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 18281.7751ms
2025-08-31 06:58:12.882 +03:00 [DBG] Connection id "0HNF889L9TR4L" received FIN.
2025-08-31 06:58:12.883 +03:00 [DBG] Connection id "0HNF889L9TR4L" accepted.
2025-08-31 06:58:12.889 +03:00 [DBG] Connection id "0HNF889L9TR4L" started.
2025-08-31 06:58:12.890 +03:00 [DBG] Connection id "0HNF889L9TR4M" accepted.
2025-08-31 06:58:12.951 +03:00 [DBG] Connection id "0HNF889L9TR4M" started.
2025-08-31 06:58:12.974 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:58:12.978 +03:00 [DBG] Connection id "0HNF889L9TR4L" stopped.
2025-08-31 06:58:12.979 +03:00 [DBG] Connection id "0HNF889L9TR4L" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:58:12.980 +03:00 [DBG] Connection 0HNF889L9TR4M established using the following protocol: "Tls13"
2025-08-31 06:58:12.983 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 06:58:12.989 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:58:12.990 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:58:12.991 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:58:13.018 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:58:13.028 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:58:13.030 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:58:13.031 +03:00 [DBG] Connection id "0HNF889L9TR4M", Request id "0HNF889L9TR4M:00000001": started reading request body.
2025-08-31 06:58:13.033 +03:00 [DBG] Connection id "0HNF889L9TR4M", Request id "0HNF889L9TR4M:00000001": done reading request body.
2025-08-31 06:58:13.036 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:58:13.037 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 06:58:13.038 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:58:13.039 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:13.041 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:58:13.042 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:58:13.043 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:58:13.045 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:58:13.048 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:58:13.053 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:58:13.057 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:58:13.060 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:13.062 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 9ms reading results.
2025-08-31 06:58:13.064 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:13.067 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:58:13.069 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:58:13.071 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:58:13.073 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:13.074 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:58:13.076 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:58:13.078 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:58:13.081 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:58:13.083 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:58:13.088 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:13.091 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 06:58:13.093 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:13.096 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:58:13.098 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:58:13.099 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:58:13.102 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:58:13.104 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:58:13.105 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:58:13.109 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:58:13.115 +03:00 [INF] Query execution finished in 9 ms, returned 1 rows
2025-08-31 06:58:15.533 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:58:15.535 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:15.536 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:58:15.537 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:58:15.539 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:58:15.540 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:58:15.541 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:58:15.543 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:15.544 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:58:15.545 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:15.547 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:58:16.781 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:58:16.783 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:16.784 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:58:16.785 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:58:16.786 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:58:16.787 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:58:16.790 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:58:16.791 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:16.792 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:58:16.793 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:16.795 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:58:16.796 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Added"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:58:16.798 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:58:17.365 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:58:17.366 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:58:17.369 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:58:17.370 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:58:17.371 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:58:17.372 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:58:17.374 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:17.375 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 06:58:17.376 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 06:58:17.377 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:58:17.379 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:58:17.380 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:58:17.382 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:58:17.384 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:58:17.387 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:17.388 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:58:17.390 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:58:17.390 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:58:17.391 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:58:17.392 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 121), @p4='?' (DbType = DateTime), @p5='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:58:17.462 +03:00 [ERR] Failed executing DbCommand (69ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 121), @p4='?' (DbType = DateTime), @p5='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:58:17.545 +03:00 [DBG] Disposing transaction.
2025-08-31 06:58:17.547 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:58:17.549 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 06:58:17.643 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'UNIQUE constraint failed: Queries.Id'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'UNIQUE constraint failed: Queries.Id'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-31 06:58:41.211 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: An error occurred while saving the entity changes. See the inner exception for details.
2025-08-31 06:58:41.226 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:58:41.227 +03:00 [DBG] Connection id "0HNF889L9TR4M" completed keep alive response.
2025-08-31 06:58:41.230 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:58:41.231 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:58:41.232 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:58:41.234 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 28250.1275ms
2025-08-31 06:59:10.314 +03:00 [INF] This is a test log to file!
2025-08-31 06:59:10.638 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 06:59:10.651 +03:00 [INF] API configured successfully.
2025-08-31 06:59:10.862 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 06:59:11.443 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:59:11.469 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:59:11.478 +03:00 [INF] Registered 12 endpoints in 1,075 milliseconds.
2025-08-31 06:59:11.485 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 06:59:11.488 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:59:11.489 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 06:59:11.509 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 06:59:11.534 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 06:59:11.535 +03:00 [DBG] Hosting starting
2025-08-31 06:59:11.545 +03:00 [DBG] Middleware loaded
2025-08-31 06:59:11.547 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 06:59:11.549 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 06:59:11.615 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 06:59:11.618 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 06:59:11.621 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 06:59:11.647 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 06:59:11.721 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 06:59:11.723 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 06:59:11.725 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 06:59:11.726 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 06:59:11.727 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 06:59:11.727 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 06:59:11.732 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:59:11.738 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 06:59:11.830 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 06:59:11.831 +03:00 [INF] Hosting environment: Development
2025-08-31 06:59:11.833 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 06:59:11.834 +03:00 [DBG] Hosting started
2025-08-31 06:59:12.166 +03:00 [DBG] Connection id "0HNF88AVBF2V4" received FIN.
2025-08-31 06:59:12.172 +03:00 [DBG] Connection id "0HNF88AVBF2V4" accepted.
2025-08-31 06:59:12.180 +03:00 [DBG] Connection id "0HNF88AVBF2V4" started.
2025-08-31 06:59:12.181 +03:00 [DBG] Connection id "0HNF88AVBF2V5" accepted.
2025-08-31 06:59:12.182 +03:00 [DBG] Connection id "0HNF88AVBF2V5" started.
2025-08-31 06:59:12.277 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 06:59:12.284 +03:00 [DBG] Connection id "0HNF88AVBF2V4" stopped.
2025-08-31 06:59:12.289 +03:00 [DBG] Connection id "0HNF88AVBF2V4" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 06:59:12.301 +03:00 [DBG] Connection 0HNF88AVBF2V5 established using the following protocol: "Tls13"
2025-08-31 06:59:12.329 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 06:59:12.395 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:59:12.398 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 06:59:12.401 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:59:12.433 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 06:59:12.482 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 06:59:12.485 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 06:59:12.530 +03:00 [DBG] Connection id "0HNF88AVBF2V5", Request id "0HNF88AVBF2V5:00000001": started reading request body.
2025-08-31 06:59:12.532 +03:00 [DBG] Connection id "0HNF88AVBF2V5", Request id "0HNF88AVBF2V5:00000001": done reading request body.
2025-08-31 06:59:12.633 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 06:59:12.671 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 06:59:12.954 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:59:13.000 +03:00 [DBG] Creating DbConnection.
2025-08-31 06:59:13.015 +03:00 [DBG] Created DbConnection. (14ms).
2025-08-31 06:59:13.020 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:59:13.037 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:13.042 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:59:13.049 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-31 06:59:13.054 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-08-31 06:59:13.063 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:59:13.081 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:59:13.119 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:59:13.154 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:59:13.167 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:13.173 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 85ms reading results.
2025-08-31 06:59:13.177 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:13.181 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 06:59:13.190 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:59:13.194 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:59:13.195 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:13.196 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:59:13.197 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:59:13.199 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:59:13.200 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:59:13.202 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:59:13.204 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:13.205 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:59:13.207 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:13.208 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:59:13.241 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 06:59:13.253 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 06:59:13.265 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 06:59:13.267 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 06:59:13.269 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 06:59:13.547 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 06:59:13.609 +03:00 [INF] Query execution finished in 339 ms, returned 1 rows
2025-08-31 06:59:16.549 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:59:16.553 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:16.554 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:59:16.557 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 06:59:16.558 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 06:59:16.560 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:59:16.561 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 06:59:16.563 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:16.588 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 25ms reading results.
2025-08-31 06:59:16.590 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:16.591 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:59:22.468 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0 && p.Id != __profile_Id_1)'
2025-08-31 06:59:22.478 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1))) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1)), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 06:59:22.486 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:59:22.488 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:22.489 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:59:22.490 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:59:22.493 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 06:59:22.495 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:59:22.497 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 06:59:22.500 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:22.501 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 06:59:22.502 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:22.503 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 06:59:22.526 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Added"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:59:22.529 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 06:59:23.083 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:59:23.106 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:59:23.111 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 06:59:23.115 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 06:59:23.116 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 06:59:23.194 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 06:59:23.196 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:23.199 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 06:59:23.204 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 06:59:23.208 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:59:23.208 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 06:59:23.210 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:59:23.211 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:59:23.213 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 06:59:23.217 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:23.218 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 06:59:23.221 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 06:59:23.222 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 06:59:23.223 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 06:59:23.224 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 121), @p4='?' (DbType = DateTime), @p5='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:59:23.279 +03:00 [ERR] Failed executing DbCommand (55ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 121), @p4='?' (DbType = DateTime), @p5='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 06:59:23.357 +03:00 [DBG] Disposing transaction.
2025-08-31 06:59:23.361 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 06:59:23.363 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 06:59:23.441 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'UNIQUE constraint failed: Queries.Id'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'UNIQUE constraint failed: Queries.Id'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-31 07:01:17.644 +03:00 [INF] This is a test log to file!
2025-08-31 07:01:17.994 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:01:18.015 +03:00 [INF] API configured successfully.
2025-08-31 07:01:18.197 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:01:18.818 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:01:18.863 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:01:18.875 +03:00 [INF] Registered 12 endpoints in 1,124 milliseconds.
2025-08-31 07:01:18.885 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:01:18.895 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:01:18.897 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:01:18.938 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:01:18.969 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:01:18.972 +03:00 [DBG] Hosting starting
2025-08-31 07:01:18.987 +03:00 [DBG] Middleware loaded
2025-08-31 07:01:18.990 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:01:18.992 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:01:19.097 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:01:19.100 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:01:19.103 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:01:19.140 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:01:19.211 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:01:19.213 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:01:19.215 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:01:19.215 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:01:19.216 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:01:19.217 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:01:19.223 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:01:19.229 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:01:19.316 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:01:19.317 +03:00 [INF] Hosting environment: Development
2025-08-31 07:01:19.318 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:01:19.319 +03:00 [DBG] Hosting started
2025-08-31 07:01:19.345 +03:00 [DBG] Connection id "0HNF88C58B1P7" received FIN.
2025-08-31 07:01:19.351 +03:00 [DBG] Connection id "0HNF88C58B1P7" accepted.
2025-08-31 07:01:19.356 +03:00 [DBG] Connection id "0HNF88C58B1P7" started.
2025-08-31 07:01:19.359 +03:00 [DBG] Connection id "0HNF88C58B1P8" accepted.
2025-08-31 07:01:19.363 +03:00 [DBG] Connection id "0HNF88C58B1P8" started.
2025-08-31 07:01:19.439 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:01:19.448 +03:00 [DBG] Connection id "0HNF88C58B1P7" stopped.
2025-08-31 07:01:19.453 +03:00 [DBG] Connection id "0HNF88C58B1P7" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:01:19.468 +03:00 [DBG] Connection 0HNF88C58B1P8 established using the following protocol: "Tls13"
2025-08-31 07:01:19.498 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 07:01:19.550 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:19.553 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:19.556 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:19.581 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:19.626 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:01:19.631 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:01:19.666 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000001": started reading request body.
2025-08-31 07:01:19.668 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000001": done reading request body.
2025-08-31 07:01:19.743 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:01:19.810 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:01:20.112 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:01:20.152 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:01:20.169 +03:00 [DBG] Created DbConnection. (15ms).
2025-08-31 07:01:20.174 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:20.187 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:20.192 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:01:20.197 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:01:20.201 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-31 07:01:20.209 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:20.241 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:20.305 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:01:20.348 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:01:20.364 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:20.371 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 122ms reading results.
2025-08-31 07:01:20.383 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:20.387 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 07:01:20.398 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:01:20.401 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:20.403 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:20.404 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:01:20.405 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:01:20.406 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:01:20.408 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:20.410 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:20.414 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:20.425 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 11ms reading results.
2025-08-31 07:01:20.427 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:20.428 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:01:20.441 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:01:20.453 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:01:20.464 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:01:20.465 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:01:20.468 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:01:20.728 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:01:20.787 +03:00 [INF] Query execution finished in 319 ms, returned 1 rows
2025-08-31 07:01:23.204 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:23.206 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:23.207 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:01:23.208 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:01:23.210 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:01:23.212 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:23.214 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:23.217 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:23.219 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 07:01:23.221 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:23.223 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:01:24.741 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0 && p.Id != __profile_Id_1)'
2025-08-31 07:01:24.749 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1))) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE (p.Provider == @__profile_Provider_0) && (p.Id != @__profile_Id_1)), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:01:24.756 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:24.758 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:24.759 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:01:24.760 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:01:24.763 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:01:24.765 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:01:24.767 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:01:24.769 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:24.770 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:01:24.772 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:24.773 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:01:24.785 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:01:25.067 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:01:25.089 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:01:25.096 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:01:25.100 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:01:25.111 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:01:25.165 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:25.167 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:25.170 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:01:25.171 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:01:25.172 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:01:25.173 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:01:25.175 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:01:25.181 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:25.182 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 07:01:25.183 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:25.185 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:01:25.187 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:01:25.189 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 07:01:26.145 +03:00 [INF] Saved query to DB for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:01:27.038 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:27.043 +03:00 [DBG] Connection id "0HNF88C58B1P8" completed keep alive response.
2025-08-31 07:01:27.046 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:01:27.051 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:27.054 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:01:27.057 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 7563.1565ms
2025-08-31 07:01:46.985 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 07:01:46.996 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:46.998 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:46.999 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:47.001 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:47.047 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:01:47.049 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:01:47.050 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000002": started reading request body.
2025-08-31 07:01:47.051 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000002": done reading request body.
2025-08-31 07:01:47.052 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:47.053 +03:00 [DBG] Connection id "0HNF88C58B1P8" completed keep alive response.
2025-08-31 07:01:47.054 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:01:47.055 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 69.9306ms
2025-08-31 07:01:47.879 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 297
2025-08-31 07:01:47.884 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:47.887 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:47.889 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:47.892 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:47.894 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:01:47.898 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:01:47.900 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000003": started reading request body.
2025-08-31 07:01:47.901 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000003": done reading request body.
2025-08-31 07:01:47.902 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:47.903 +03:00 [DBG] Connection id "0HNF88C58B1P8" completed keep alive response.
2025-08-31 07:01:47.904 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:01:47.905 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 25.487ms
2025-08-31 07:01:59.343 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 273
2025-08-31 07:01:59.346 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:59.347 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:01:59.348 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:59.349 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:01:59.351 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:01:59.353 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:01:59.353 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000004": started reading request body.
2025-08-31 07:01:59.354 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000004": done reading request body.
2025-08-31 07:01:59.356 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:01:59.357 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 07:01:59.358 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:59.360 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:59.361 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:01:59.361 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:01:59.362 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:01:59.363 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:59.364 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:59.366 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:01:59.367 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:01:59.368 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:59.369 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 07:01:59.370 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:59.371 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:01:59.372 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:01:59.373 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:01:59.374 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:59.375 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:01:59.376 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:01:59.377 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:01:59.378 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:59.379 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:01:59.381 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:59.382 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:01:59.383 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:01:59.384 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:01:59.385 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:01:59.386 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:01:59.387 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:01:59.388 +03:00 [DBG] SQL: SELECT P.Id, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:01:59.389 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:01:59.391 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:01:59.397 +03:00 [INF] Query execution finished in 8 ms, returned 1 rows
2025-08-31 07:02:01.163 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:01.168 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.174 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:01.177 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:02:01.178 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:02:01.179 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:01.181 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:01.182 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.183 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:02:01.184 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.185 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:02:01.187 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:01.188 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.189 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:01.190 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:01.191 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:01.193 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:02:01.195 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:02:01.196 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.197 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 07:02:01.198 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.198 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:02:01.200 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:01.201 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:02:01.205 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:01.216 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:01.219 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:01.220 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:02:01.221 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:02:01.222 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:02:01.223 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:02:01.235 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:01.236 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.238 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 07:02:01.242 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 07:02:01.244 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:01.245 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:01.247 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:02:01.248 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:01.249 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:01.251 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.252 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:02:01.253 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:01.254 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:01.255 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:01.256 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 240), @p2='?' (Size = 130), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:01.258 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 240), @p2='?' (Size = 130), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:01.263 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:02:01.326 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.329 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 69ms reading results.
2025-08-31 07:02:01.373 +03:00 [DBG] Disposing transaction.
2025-08-31 07:02:01.375 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:01.376 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:02:01.513 +03:00 [ERR] Failed to persist query to DB for userQuery=tits: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:02:01.514 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:02:01.515 +03:00 [DBG] Connection id "0HNF88C58B1P8" completed keep alive response.
2025-08-31 07:02:01.516 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:02:01.517 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:01.518 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:02:01.519 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 2176.0782ms
2025-08-31 07:02:17.651 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 256
2025-08-31 07:02:17.655 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:02:17.656 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:02:17.659 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:02:17.661 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:02:17.671 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:02:17.674 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:02:17.675 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000005": started reading request body.
2025-08-31 07:02:17.676 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000005": done reading request body.
2025-08-31 07:02:17.680 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:02:17.681 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 07:02:17.683 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:17.684 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:17.685 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:17.686 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:17.687 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:17.688 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:17.689 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:17.690 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:17.692 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:17.693 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:17.694 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 07:02:17.695 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:17.696 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:02:17.698 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:02:17.699 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:17.700 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:17.701 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:17.701 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:17.702 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:17.703 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:17.705 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:17.707 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:17.707 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 07:02:17.709 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:17.710 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:02:17.711 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:02:17.712 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:02:17.712 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:02:17.713 +03:00 [DBG] SQL: SELECT P.Id, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:02:17.714 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:02:17.715 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:02:17.719 +03:00 [INF] Query execution finished in 5 ms, returned 1 rows
2025-08-31 07:02:20.306 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:20.307 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:20.309 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:20.310 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:20.311 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:02:20.312 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:20.313 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:20.314 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:20.315 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:02:20.316 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:20.317 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:02:21.888 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:21.890 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:21.891 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:21.892 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:21.893 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:21.894 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:02:21.895 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:02:21.896 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:21.897 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:02:21.898 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:21.899 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:02:21.900 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:22.457 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:02:22.459 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:22.462 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:22.465 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:22.467 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:02:22.468 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:02:22.470 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:02:22.471 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:02:22.472 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:22.473 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:22.474 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 07:02:22.475 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 07:02:22.475 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:22.476 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:22.477 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:22.478 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:22.479 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:22.481 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:22.482 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 07:02:22.483 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:22.483 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:22.485 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:22.486 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 220), @p2='?' (Size = 113), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:22.487 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 220), @p2='?' (Size = 113), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:02:22.489 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:02:22.543 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:22.545 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 56ms reading results.
2025-08-31 07:02:22.593 +03:00 [DBG] Disposing transaction.
2025-08-31 07:02:22.601 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:22.602 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:02:31.384 +03:00 [ERR] Failed to persist query to DB for userQuery=tits: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:02:31.386 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:02:31.388 +03:00 [DBG] Connection id "0HNF88C58B1P8" completed keep alive response.
2025-08-31 07:02:31.389 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:02:31.390 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:31.392 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:02:31.394 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 13742.5492ms
2025-08-31 07:02:38.652 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 242
2025-08-31 07:02:38.656 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:02:38.658 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:02:38.660 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:02:38.661 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:02:38.662 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:02:38.664 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:02:38.664 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000006": started reading request body.
2025-08-31 07:02:38.666 +03:00 [DBG] Connection id "0HNF88C58B1P8", Request id "0HNF88C58B1P8:00000006": done reading request body.
2025-08-31 07:02:38.667 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:02:38.668 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 07:02:38.669 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:38.670 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:38.671 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:38.672 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:38.673 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:38.674 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:38.675 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:38.677 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:38.679 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:02:38.680 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:38.681 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 07:02:38.682 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:38.683 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:02:38.685 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:02:38.685 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:38.687 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:38.687 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:38.688 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:02:38.689 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:02:38.690 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:38.692 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:38.694 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:38.695 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:02:38.696 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:38.698 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:02:38.700 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:02:38.701 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:02:38.702 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:02:38.704 +03:00 [DBG] SQL: SELECT P.Id, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:02:38.706 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:02:38.707 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:02:38.711 +03:00 [INF] Query execution finished in 5 ms, returned 1 rows
2025-08-31 07:02:41.116 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:02:41.121 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:41.127 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:02:41.131 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-31 07:02:41.133 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-08-31 07:02:41.135 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:41.136 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:02:41.137 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:41.138 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 07:02:41.139 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:02:41.141 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:03:22.995 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:03:22.996 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:03:22.997 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:03:23.000 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:03:23.001 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:03:23.003 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:03:23.005 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:03:23.006 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:03:23.008 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:03:23.009 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:03:23.012 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 07:03:29.250 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:03:40.894 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:03:40.904 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:03:40.907 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:03:40.908 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:03:40.909 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:03:40.911 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:03:40.912 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:03:40.913 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:03:40.914 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:03:40.915 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:03:40.916 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 07:03:40.917 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 07:03:40.918 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:03:40.918 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:03:40.919 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:03:40.920 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:03:40.921 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:03:40.923 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:03:40.924 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:03:40.926 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:03:40.926 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:03:40.927 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:03:40.928 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 168), @p2='?' (Size = 99), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:03:40.930 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 168), @p2='?' (Size = 99), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:03:40.932 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:03:40.994 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:03:40.998 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 66ms reading results.
2025-08-31 07:03:41.044 +03:00 [DBG] Disposing transaction.
2025-08-31 07:03:41.046 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:03:41.048 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:03:41.202 +03:00 [ERR] Failed to persist query to DB for userQuery=tits: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:03:41.204 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:03:41.205 +03:00 [DBG] Connection id "0HNF88C58B1P8" completed keep alive response.
2025-08-31 07:03:41.206 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:03:41.207 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:03:41.208 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:03:41.211 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 62558.8735ms
2025-08-31 07:04:03.080 +03:00 [DBG] Connection id "0HNF88C58B1P9" received FIN.
2025-08-31 07:04:03.081 +03:00 [DBG] Connection id "0HNF88C58B1P9" accepted.
2025-08-31 07:04:03.097 +03:00 [DBG] Connection id "0HNF88C58B1P9" started.
2025-08-31 07:04:03.098 +03:00 [DBG] Connection id "0HNF88C58B1PA" accepted.
2025-08-31 07:04:03.133 +03:00 [DBG] Connection id "0HNF88C58B1PA" started.
2025-08-31 07:04:03.190 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:04:03.193 +03:00 [DBG] Connection id "0HNF88C58B1P9" stopped.
2025-08-31 07:04:03.194 +03:00 [DBG] Connection id "0HNF88C58B1P9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:04:03.194 +03:00 [DBG] Connection 0HNF88C58B1PA established using the following protocol: "Tls13"
2025-08-31 07:04:03.196 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 273
2025-08-31 07:04:03.198 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:04:03.198 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:04:03.199 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:04:03.200 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:04:03.202 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:04:03.203 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:04:03.203 +03:00 [DBG] Connection id "0HNF88C58B1PA", Request id "0HNF88C58B1PA:00000001": started reading request body.
2025-08-31 07:04:03.204 +03:00 [DBG] Connection id "0HNF88C58B1PA", Request id "0HNF88C58B1PA:00000001": done reading request body.
2025-08-31 07:04:03.206 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:04:03.206 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 07:04:03.207 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:04:03.208 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:03.209 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:04:03.209 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:04:03.210 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:04:03.211 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:04:03.212 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:04:03.214 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:04:03.214 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:04:03.215 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:03.216 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 07:04:03.217 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:03.218 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:04:03.220 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:04:03.220 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:04:03.221 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:03.222 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:04:03.223 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:04:03.224 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:04:03.224 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:04:03.226 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:04:03.227 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:03.228 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 07:04:03.229 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:03.230 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:04:03.231 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:04:03.231 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:04:03.232 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:04:03.233 +03:00 [DBG] SQL: SELECT P.Id, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:04:03.233 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:04:03.234 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:04:03.237 +03:00 [INF] Query execution finished in 4 ms, returned 1 rows
2025-08-31 07:04:15.288 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:04:15.290 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:15.292 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:04:15.293 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:04:15.295 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:04:15.296 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:04:15.298 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:04:15.303 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:15.304 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:04:15.307 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:15.308 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:04:42.735 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:04:42.736 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:42.737 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:04:42.738 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:04:42.739 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:04:42.740 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:04:42.741 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32), @__profile_Id_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0 AND "p"."Id" <> @__profile_Id_1)
2025-08-31 07:04:42.743 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:42.744 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:04:42.745 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:42.746 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:04:46.070 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:04:51.358 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:04:51.362 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:04:51.366 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:04:51.367 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:04:51.368 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:04:51.369 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:04:51.370 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:04:51.370 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:04:51.372 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:04:51.373 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:51.374 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 07:04:51.375 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 07:04:51.376 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:04:51.377 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:04:51.378 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:04:51.379 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:04:51.381 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (Size = 49), @p1='?' (DbType = DateTimeOffset), @p2='?' (Size = 28), @p3='?' (DbType = Int32), @p4='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Profiles" SET "CacheFile" = @p0, "CreatedUtc" = @p1, "Name" = @p2, "Provider" = @p3, "SecretRef" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:04:51.383 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:51.384 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:04:51.391 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:04:51.392 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:04:51.393 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:04:51.394 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 240), @p2='?' (Size = 130), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:04:51.395 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 240), @p2='?' (Size = 130), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:04:51.397 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:04:51.458 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:51.460 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 63ms reading results.
2025-08-31 07:04:51.504 +03:00 [DBG] Disposing transaction.
2025-08-31 07:04:51.506 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:04:51.507 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:07:58.442 +03:00 [INF] This is a test log to file!
2025-08-31 07:07:58.918 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:07:58.929 +03:00 [INF] API configured successfully.
2025-08-31 07:07:59.153 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:07:59.707 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:07:59.740 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:07:59.753 +03:00 [INF] Registered 12 endpoints in 1,119 milliseconds.
2025-08-31 07:07:59.762 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:07:59.766 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:07:59.767 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:07:59.792 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:07:59.818 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:07:59.820 +03:00 [DBG] Hosting starting
2025-08-31 07:07:59.832 +03:00 [DBG] Middleware loaded
2025-08-31 07:07:59.835 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:07:59.837 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:07:59.945 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:07:59.946 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:07:59.949 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:07:59.973 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:08:00.013 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:08:00.015 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:08:00.016 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:08:00.017 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:08:00.018 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:08:00.019 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:08:00.024 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:08:00.029 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:08:00.108 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:08:00.109 +03:00 [INF] Hosting environment: Development
2025-08-31 07:08:00.110 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:08:00.110 +03:00 [DBG] Hosting started
2025-08-31 07:08:02.076 +03:00 [DBG] Connection id "0HNF88FT92PD7" received FIN.
2025-08-31 07:08:02.091 +03:00 [DBG] Connection id "0HNF88FT92PD7" accepted.
2025-08-31 07:08:02.094 +03:00 [DBG] Connection id "0HNF88FT92PD7" started.
2025-08-31 07:08:02.097 +03:00 [DBG] Connection id "0HNF88FT92PD8" accepted.
2025-08-31 07:08:02.098 +03:00 [DBG] Connection id "0HNF88FT92PD8" started.
2025-08-31 07:08:02.197 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:08:02.207 +03:00 [DBG] Connection id "0HNF88FT92PD7" stopped.
2025-08-31 07:08:02.212 +03:00 [DBG] Connection id "0HNF88FT92PD7" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:08:02.235 +03:00 [DBG] Connection 0HNF88FT92PD8 established using the following protocol: "Tls13"
2025-08-31 07:08:02.267 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 273
2025-08-31 07:08:02.300 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:08:02.302 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:08:02.306 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:08:02.330 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:08:02.372 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:08:02.385 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:08:02.442 +03:00 [DBG] Connection id "0HNF88FT92PD8", Request id "0HNF88FT92PD8:00000001": started reading request body.
2025-08-31 07:08:02.444 +03:00 [DBG] Connection id "0HNF88FT92PD8", Request id "0HNF88FT92PD8:00000001": done reading request body.
2025-08-31 07:08:02.552 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:08:02.592 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:08:02.827 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:08:02.860 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:08:02.873 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-31 07:08:02.878 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:02.889 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:02.893 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:08:02.898 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:08:02.902 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-31 07:08:02.908 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:02.924 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:03.010 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:08:03.044 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:08:03.057 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:03.063 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 132ms reading results.
2025-08-31 07:08:03.066 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:03.070 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 07:08:03.080 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:08:03.082 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:03.084 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:03.085 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:08:03.086 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:08:03.087 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:08:03.088 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:03.090 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:03.092 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:03.093 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:08:03.094 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:03.094 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:08:03.103 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:08:03.135 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:08:03.148 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:08:03.150 +03:00 [DBG] SQL: SELECT P.Id, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:08:03.152 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:08:03.376 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:08:03.436 +03:00 [INF] Query execution finished in 283 ms, returned 1 rows
2025-08-31 07:08:05.670 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:05.672 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:05.674 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:08:05.674 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:08:05.676 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:08:05.677 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:05.679 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:05.682 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:05.683 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:08:05.685 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:05.686 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:08:07.567 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:08:07.584 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:08:07.601 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:08:07.606 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:08:07.615 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:08:07.624 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:08:07.627 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:08:07.627 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:08:07.672 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:07.675 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:07.677 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:08:07.678 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:08:07.679 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:08:07.680 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 242), @p2='?' (Size = 130), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:08:07.681 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 242), @p2='?' (Size = 130), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:08:07.687 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:08:07.748 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:07.751 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 68ms reading results.
2025-08-31 07:08:07.795 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:07.797 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:08:12.607 +03:00 [ERR] Failed to persist query to DB for userQuery=tits: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:08:12.619 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:08:12.625 +03:00 [DBG] Connection id "0HNF88FT92PD8" completed keep alive response.
2025-08-31 07:08:12.628 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:08:12.632 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:12.634 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:08:12.637 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 10374.6101ms
2025-08-31 07:08:16.644 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 281
2025-08-31 07:08:16.650 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:08:16.657 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:08:16.659 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:08:16.709 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:08:16.731 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:08:16.734 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:08:16.736 +03:00 [DBG] Connection id "0HNF88FT92PD8", Request id "0HNF88FT92PD8:00000002": started reading request body.
2025-08-31 07:08:16.737 +03:00 [DBG] Connection id "0HNF88FT92PD8", Request id "0HNF88FT92PD8:00000002": done reading request body.
2025-08-31 07:08:16.740 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:08:16.740 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 07:08:16.741 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:16.742 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:16.743 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:08:16.744 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:08:16.745 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:08:16.749 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:16.752 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:16.755 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:08:16.759 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:08:16.760 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:16.761 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-08-31 07:08:16.763 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:16.764 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:08:16.765 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:08:16.766 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:16.767 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:16.768 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:08:16.769 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:08:16.770 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:08:16.771 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:16.773 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:16.775 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:16.776 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:08:16.777 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:16.779 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:08:16.781 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:08:16.782 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:08:16.783 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:08:16.784 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:08:16.784 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:08:16.787 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:08:16.792 +03:00 [INF] Query execution finished in 7 ms, returned 1 rows
2025-08-31 07:08:19.138 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:08:19.140 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:19.142 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:08:19.143 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:08:19.145 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:08:19.146 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:19.149 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:08:19.152 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:19.154 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 07:08:19.156 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:08:19.158 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:09:22.845 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:09:22.851 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:09:22.854 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:09:22.855 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:09:22.857 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:09:22.858 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:09:22.859 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:09:22.860 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:09:22.862 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:09:22.863 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:22.864 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:09:22.865 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:09:22.866 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:09:22.867 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 257), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:09:22.869 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 257), @p2='?' (Size = 138), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:09:22.871 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:09:22.933 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:22.935 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 63ms reading results.
2025-08-31 07:09:22.980 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:22.982 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:09:23.208 +03:00 [ERR] Failed to persist query to DB for userQuery=tits: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:09:23.211 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:09:23.218 +03:00 [DBG] Connection id "0HNF88FT92PD8" completed keep alive response.
2025-08-31 07:09:23.219 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:09:23.221 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:09:23.223 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:09:23.225 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 66581.4566ms
2025-08-31 07:09:23.697 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:09:31.731 +03:00 [DBG] Connection id "0HNF88FT92PD9" accepted.
2025-08-31 07:09:31.731 +03:00 [DBG] Connection id "0HNF88FT92PD9" received FIN.
2025-08-31 07:09:31.732 +03:00 [DBG] Connection id "0HNF88FT92PD9" started.
2025-08-31 07:09:31.732 +03:00 [DBG] Connection id "0HNF88FT92PDA" accepted.
2025-08-31 07:09:31.827 +03:00 [DBG] Connection id "0HNF88FT92PDA" started.
2025-08-31 07:09:31.852 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:09:31.855 +03:00 [DBG] Connection id "0HNF88FT92PD9" stopped.
2025-08-31 07:09:31.856 +03:00 [DBG] Connection 0HNF88FT92PDA established using the following protocol: "Tls13"
2025-08-31 07:09:31.857 +03:00 [DBG] Connection id "0HNF88FT92PD9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:09:31.859 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 281
2025-08-31 07:09:31.867 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:09:31.868 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:09:31.870 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:09:31.872 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:09:31.874 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:09:31.876 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:09:31.879 +03:00 [DBG] Connection id "0HNF88FT92PDA", Request id "0HNF88FT92PDA:00000001": started reading request body.
2025-08-31 07:09:31.880 +03:00 [DBG] Connection id "0HNF88FT92PDA", Request id "0HNF88FT92PDA:00000001": done reading request body.
2025-08-31 07:09:31.886 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:09:31.887 +03:00 [DBG] Connection id "0HNF88FT92PDA" completed keep alive response.
2025-08-31 07:09:31.888 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:09:31.889 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 30.4011ms
2025-08-31 07:09:36.377 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 263
2025-08-31 07:09:36.381 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:09:36.382 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:09:36.385 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:09:36.386 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:09:36.387 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:09:36.390 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:09:36.390 +03:00 [DBG] Connection id "0HNF88FT92PDA", Request id "0HNF88FT92PDA:00000002": started reading request body.
2025-08-31 07:09:36.392 +03:00 [DBG] Connection id "0HNF88FT92PDA", Request id "0HNF88FT92PDA:00000002": done reading request body.
2025-08-31 07:09:36.395 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:09:36.396 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 07:09:36.397 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:09:36.399 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:36.399 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:09:36.400 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:09:36.401 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:09:36.402 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:09:36.404 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:09:36.405 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:09:36.407 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:09:36.407 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:36.409 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 07:09:36.410 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:36.411 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:09:36.412 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:09:36.413 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:09:36.414 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:36.415 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:09:36.416 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:09:36.417 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:09:36.417 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:09:36.419 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:09:36.420 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:36.421 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:09:36.423 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:36.423 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:09:36.425 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:09:36.426 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:09:36.427 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:09:36.428 +03:00 [DBG] SQL: SELECT P.Id, P.Name,P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:09:36.428 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:09:36.429 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:09:36.433 +03:00 [INF] Query execution finished in 4 ms, returned 1 rows
2025-08-31 07:09:44.446 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:09:44.448 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:44.451 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:09:44.452 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:09:44.453 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:09:44.455 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:09:44.457 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:09:44.458 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:44.459 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:09:44.461 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:09:44.461 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:10:21.534 +03:00 [INF] This is a test log to file!
2025-08-31 07:10:21.867 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:10:21.878 +03:00 [INF] API configured successfully.
2025-08-31 07:10:22.037 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:10:22.564 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:10:22.598 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:10:22.609 +03:00 [INF] Registered 12 endpoints in 955 milliseconds.
2025-08-31 07:10:22.617 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:10:22.621 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:10:22.623 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:10:22.661 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:10:22.824 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:10:22.830 +03:00 [DBG] Hosting starting
2025-08-31 07:10:22.852 +03:00 [DBG] Middleware loaded
2025-08-31 07:10:22.863 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:10:22.868 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:10:22.970 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:10:22.971 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:10:22.986 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:10:23.020 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:10:23.069 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:10:23.072 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:10:23.073 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:10:23.074 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:10:23.075 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:10:23.076 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:10:23.086 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:10:23.096 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:10:23.228 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:10:23.229 +03:00 [INF] Hosting environment: Development
2025-08-31 07:10:23.230 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:10:23.231 +03:00 [DBG] Hosting started
2025-08-31 07:10:23.891 +03:00 [DBG] Connection id "0HNF88H7HHBBG" received FIN.
2025-08-31 07:10:23.897 +03:00 [DBG] Connection id "0HNF88H7HHBBG" accepted.
2025-08-31 07:10:23.909 +03:00 [DBG] Connection id "0HNF88H7HHBBG" started.
2025-08-31 07:10:23.910 +03:00 [DBG] Connection id "0HNF88H7HHBBH" accepted.
2025-08-31 07:10:23.912 +03:00 [DBG] Connection id "0HNF88H7HHBBH" started.
2025-08-31 07:10:23.993 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:10:24.001 +03:00 [DBG] Connection id "0HNF88H7HHBBG" stopped.
2025-08-31 07:10:24.006 +03:00 [DBG] Connection id "0HNF88H7HHBBG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:10:24.019 +03:00 [DBG] Connection 0HNF88H7HHBBH established using the following protocol: "Tls13"
2025-08-31 07:10:24.046 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 263
2025-08-31 07:10:24.088 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:10:24.090 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:10:24.094 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:10:24.128 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:10:24.184 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:10:24.189 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:10:24.227 +03:00 [DBG] Connection id "0HNF88H7HHBBH", Request id "0HNF88H7HHBBH:00000001": started reading request body.
2025-08-31 07:10:24.229 +03:00 [DBG] Connection id "0HNF88H7HHBBH", Request id "0HNF88H7HHBBH:00000001": done reading request body.
2025-08-31 07:10:24.323 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:10:24.370 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:10:24.689 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:10:24.730 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:10:24.743 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-31 07:10:24.749 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:10:24.769 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:24.781 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:10:24.792 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2025-08-31 07:10:24.804 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (23ms).
2025-08-31 07:10:24.818 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:10:24.838 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:10:24.879 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:10:24.931 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:10:24.944 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:24.950 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 105ms reading results.
2025-08-31 07:10:24.954 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:24.958 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 07:10:24.968 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:10:24.972 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:10:24.974 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:24.975 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:10:24.976 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:10:24.977 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:10:24.978 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:10:24.981 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:10:24.982 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:24.991 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 9ms reading results.
2025-08-31 07:10:24.993 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:24.994 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:10:25.013 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:10:25.030 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:10:25.048 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:10:25.050 +03:00 [DBG] SQL: SELECT P.Id, P.Name,P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:10:25.054 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:10:25.365 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:10:25.458 +03:00 [INF] Query execution finished in 404 ms, returned 1 rows
2025-08-31 07:10:26.790 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:10:26.792 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:26.793 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:10:26.794 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:10:26.795 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:10:26.796 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:10:26.798 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:10:26.801 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:26.802 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:10:26.804 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:26.805 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:10:36.909 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:10:36.933 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:10:36.952 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:10:36.957 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:10:36.966 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:10:36.975 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:10:36.978 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:10:36.981 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:10:36.984 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:10:37.031 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:10:37.033 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:37.037 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:10:37.038 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:10:37.039 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:10:37.040 +03:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 239), @p2='?' (Size = 120), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:10:37.042 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (Size = 239), @p2='?' (Size = 120), @p3='?' (DbType = DateTime), @p4='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Queries" SET "ProfileId" = @p0, "ResultJson" = @p1, "SqlQuery" = @p2, "TimestampUtc" = @p3, "UserQuery" = @p4
WHERE "Id" = @p5
RETURNING 1;
2025-08-31 07:10:37.049 +03:00 [DBG] Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
2025-08-31 07:10:37.122 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:37.124 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 79ms reading results.
2025-08-31 07:10:37.175 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:10:37.178 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:11:16.650 +03:00 [INF] This is a test log to file!
2025-08-31 07:11:17.167 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:11:17.176 +03:00 [INF] API configured successfully.
2025-08-31 07:11:17.337 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:11:17.917 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:11:17.963 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:11:17.973 +03:00 [INF] Registered 12 endpoints in 1,104 milliseconds.
2025-08-31 07:11:17.983 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:11:17.986 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:11:17.987 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:11:18.009 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:11:18.039 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:11:18.042 +03:00 [DBG] Hosting starting
2025-08-31 07:11:18.058 +03:00 [DBG] Middleware loaded
2025-08-31 07:11:18.063 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:11:18.071 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:11:18.165 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:11:18.168 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:11:18.171 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:11:18.212 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:11:18.290 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:11:18.297 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:11:18.299 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:11:18.300 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:11:18.300 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:11:18.301 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:11:18.306 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:11:18.313 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:11:18.436 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:11:18.437 +03:00 [INF] Hosting environment: Development
2025-08-31 07:11:18.438 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:11:18.439 +03:00 [DBG] Hosting started
2025-08-31 07:11:49.965 +03:00 [INF] This is a test log to file!
2025-08-31 07:11:50.260 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:11:50.270 +03:00 [INF] API configured successfully.
2025-08-31 07:11:50.443 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:11:50.927 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:11:50.958 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:11:50.968 +03:00 [INF] Registered 12 endpoints in 911 milliseconds.
2025-08-31 07:11:50.975 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:11:50.977 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:11:50.978 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:11:51.004 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:11:51.036 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:11:51.038 +03:00 [DBG] Hosting starting
2025-08-31 07:11:51.050 +03:00 [DBG] Middleware loaded
2025-08-31 07:11:51.053 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:11:51.055 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:11:51.135 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:11:51.137 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:11:51.140 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:11:51.174 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:11:51.240 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:11:51.243 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:11:51.245 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:11:51.245 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:11:51.246 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:11:51.247 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:11:51.252 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:11:51.262 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:11:51.316 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:11:51.321 +03:00 [INF] Hosting environment: Development
2025-08-31 07:11:51.322 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:11:51.324 +03:00 [DBG] Hosting started
2025-08-31 07:11:54.026 +03:00 [DBG] Connection id "0HNF88I2D42T9" received FIN.
2025-08-31 07:11:54.037 +03:00 [DBG] Connection id "0HNF88I2D42T9" accepted.
2025-08-31 07:11:54.046 +03:00 [DBG] Connection id "0HNF88I2D42T9" started.
2025-08-31 07:11:54.047 +03:00 [DBG] Connection id "0HNF88I2D42TA" accepted.
2025-08-31 07:11:54.058 +03:00 [DBG] Connection id "0HNF88I2D42TA" started.
2025-08-31 07:11:54.162 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:11:54.170 +03:00 [DBG] Connection id "0HNF88I2D42T9" stopped.
2025-08-31 07:11:54.174 +03:00 [DBG] Connection id "0HNF88I2D42T9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:11:54.187 +03:00 [DBG] Connection 0HNF88I2D42TA established using the following protocol: "Tls13"
2025-08-31 07:11:54.217 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 263
2025-08-31 07:11:54.253 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:11:54.255 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:11:54.257 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:11:54.282 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:11:54.318 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:11:54.323 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:11:54.363 +03:00 [DBG] Connection id "0HNF88I2D42TA", Request id "0HNF88I2D42TA:00000001": started reading request body.
2025-08-31 07:11:54.365 +03:00 [DBG] Connection id "0HNF88I2D42TA", Request id "0HNF88I2D42TA:00000001": done reading request body.
2025-08-31 07:11:54.458 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:11:54.497 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:11:54.759 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:11:54.803 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:11:54.816 +03:00 [DBG] Created DbConnection. (12ms).
2025-08-31 07:11:54.820 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:11:54.832 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:54.836 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:11:54.842 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:11:54.847 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-08-31 07:11:54.854 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:11:54.871 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:11:54.907 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:11:54.947 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:11:54.959 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:54.967 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 89ms reading results.
2025-08-31 07:11:54.973 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:54.978 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (5ms).
2025-08-31 07:11:54.988 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:11:54.991 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:11:54.992 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:54.993 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:11:54.994 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:11:54.995 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:11:54.996 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:11:54.998 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:11:55.000 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:55.002 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:11:55.003 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:55.004 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:11:55.014 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:11:55.027 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:11:55.039 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:11:55.040 +03:00 [DBG] SQL: SELECT P.Id, P.Name,P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:11:55.043 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:11:55.286 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:11:55.345 +03:00 [INF] Query execution finished in 302 ms, returned 1 rows
2025-08-31 07:11:57.719 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:11:57.722 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:57.732 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:11:57.739 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2025-08-31 07:11:57.741 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-31 07:11:57.742 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:11:57.746 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:11:57.749 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:57.750 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:11:57.753 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:11:57.755 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:11:59.619 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:11:59.625 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:11:59.939 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:11:59.961 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:11:59.967 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:11:59.976 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:11:59.979 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:11:59.981 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:12:00.038 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:12:00.040 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:12:00.044 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:12:00.046 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:12:00.047 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:12:00.049 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 120), @p4='?' (DbType = DateTime), @p5='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:12:00.058 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 239), @p3='?' (Size = 120), @p4='?' (DbType = DateTime), @p5='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:12:00.064 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:12:00.066 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 07:12:00.074 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:12:00.077 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 07:12:00.085 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:12:00.088 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 07:14:13.057 +03:00 [INF] This is a test log to file!
2025-08-31 07:14:28.117 +03:00 [INF] This is a test log to file!
2025-08-31 07:14:51.977 +03:00 [INF] This is a test log to file!
2025-08-31 07:14:52.398 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:14:52.407 +03:00 [INF] API configured successfully.
2025-08-31 07:14:52.613 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:14:53.244 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:14:53.288 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:14:53.304 +03:00 [INF] Registered 12 endpoints in 1,136 milliseconds.
2025-08-31 07:14:53.314 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:14:53.317 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:14:53.318 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:14:53.348 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:14:53.385 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:14:53.389 +03:00 [DBG] Hosting starting
2025-08-31 07:14:53.406 +03:00 [DBG] Middleware loaded
2025-08-31 07:14:53.409 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:14:53.411 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:14:53.490 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:14:53.497 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:14:53.500 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:14:53.539 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:14:53.606 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:14:53.610 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:14:53.612 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:14:53.614 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:14:53.615 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:14:53.616 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:14:53.623 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:14:53.633 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:14:53.738 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:14:53.739 +03:00 [INF] Hosting environment: Development
2025-08-31 07:14:53.740 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:14:53.741 +03:00 [DBG] Hosting started
2025-08-31 07:15:41.700 +03:00 [INF] This is a test log to file!
2025-08-31 07:16:34.474 +03:00 [INF] This is a test log to file!
2025-08-31 07:16:34.756 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:16:34.764 +03:00 [INF] API configured successfully.
2025-08-31 07:16:34.876 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 07:16:34.982 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:16:35.480 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:16:35.511 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:16:35.519 +03:00 [INF] Registered 12 endpoints in 930 milliseconds.
2025-08-31 07:16:35.525 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:16:35.528 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:16:35.528 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:16:35.550 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:16:35.575 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:16:35.577 +03:00 [DBG] Hosting starting
2025-08-31 07:16:35.588 +03:00 [DBG] Middleware loaded
2025-08-31 07:16:35.591 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:16:35.593 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:16:35.663 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:16:35.665 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:16:35.667 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:16:35.693 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:16:35.754 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:16:35.757 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:16:35.758 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:16:35.758 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:16:35.759 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:16:35.759 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:16:35.764 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:16:35.770 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:16:35.875 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:16:35.876 +03:00 [INF] Hosting environment: Development
2025-08-31 07:16:35.877 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:16:35.878 +03:00 [DBG] Hosting started
2025-08-31 07:17:21.300 +03:00 [DBG] Connection id "0HNF88L3U896I" received FIN.
2025-08-31 07:17:21.311 +03:00 [DBG] Connection id "0HNF88L3U896I" accepted.
2025-08-31 07:17:21.338 +03:00 [DBG] Connection id "0HNF88L3U896I" started.
2025-08-31 07:17:21.340 +03:00 [DBG] Connection id "0HNF88L3U896J" accepted.
2025-08-31 07:17:21.341 +03:00 [DBG] Connection id "0HNF88L3U896J" started.
2025-08-31 07:17:21.411 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:17:21.418 +03:00 [DBG] Connection id "0HNF88L3U896I" stopped.
2025-08-31 07:17:21.423 +03:00 [DBG] Connection id "0HNF88L3U896I" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:17:21.443 +03:00 [DBG] Connection 0HNF88L3U896J established using the following protocol: "Tls13"
2025-08-31 07:17:21.470 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 257
2025-08-31 07:17:21.510 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:17:21.513 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:17:21.516 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:17:21.545 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:17:21.598 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:17:21.601 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:17:21.651 +03:00 [DBG] Connection id "0HNF88L3U896J", Request id "0HNF88L3U896J:00000001": started reading request body.
2025-08-31 07:17:21.654 +03:00 [DBG] Connection id "0HNF88L3U896J", Request id "0HNF88L3U896J:00000001": done reading request body.
2025-08-31 07:17:21.741 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:17:21.780 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:17:22.119 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:17:22.153 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:17:22.166 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-31 07:17:22.171 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:22.184 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:22.188 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:22.192 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:17:22.197 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-31 07:17:22.205 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:22.222 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:22.257 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:22.299 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:22.308 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:22.312 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:22.317 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 89ms reading results.
2025-08-31 07:17:22.321 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:22.325 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 07:17:22.334 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:17:22.337 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:22.338 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:22.339 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:22.340 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:17:22.341 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:17:22.342 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:22.344 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:22.346 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:22.347 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:17:22.348 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:22.348 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:17:22.358 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:17:22.371 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:17:22.384 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:17:22.385 +03:00 [DBG] SQL: SELECT P.Id,P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:17:22.387 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:17:22.644 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:17:22.698 +03:00 [INF] Query execution finished in 311 ms, returned 1 rows
2025-08-31 07:17:24.536 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:24.537 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:24.539 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:24.540 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:17:24.542 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:17:24.544 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:24.546 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:24.548 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:24.549 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:17:24.550 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:24.552 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:17:25.407 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:25.414 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:25.723 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:17:25.752 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:25.758 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:17:25.768 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:17:25.771 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:17:25.772 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:17:25.841 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:25.843 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:25.846 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:25.846 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:17:25.848 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:17:25.849 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 222), @p3='?' (Size = 112), @p4='?' (DbType = DateTime), @p5='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:17:25.857 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 222), @p3='?' (Size = 112), @p4='?' (DbType = DateTime), @p5='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:17:25.861 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:25.863 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 07:17:25.865 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:25.866 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:17:25.875 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:25.878 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 07:17:25.884 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-08-31T04:17:25.0362399Z","$type":"QueryAddedEvent"}
2025-08-31 07:17:26.438 +03:00 [INF] Saved query to DB for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:17:29.680 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:17:29.685 +03:00 [DBG] Connection id "0HNF88L3U896J" completed keep alive response.
2025-08-31 07:17:29.687 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:17:29.692 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:29.694 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:17:29.696 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 8228.8599ms
2025-08-31 07:17:39.872 +03:00 [INF] This is a test log to file!
2025-08-31 07:17:40.429 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:17:40.439 +03:00 [INF] API configured successfully.
2025-08-31 07:17:40.561 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 07:17:40.622 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:17:41.157 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:17:41.186 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:17:41.194 +03:00 [INF] Registered 12 endpoints in 1,094 milliseconds.
2025-08-31 07:17:41.201 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:17:41.204 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:17:41.205 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:17:41.225 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:17:41.253 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:17:41.255 +03:00 [DBG] Hosting starting
2025-08-31 07:17:41.272 +03:00 [DBG] Middleware loaded
2025-08-31 07:17:41.275 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:17:41.276 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:17:41.363 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:17:41.366 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:17:41.369 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:17:41.400 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:17:41.467 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:17:41.469 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:17:41.470 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:17:41.471 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:17:41.472 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:17:41.472 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:17:41.478 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:17:41.484 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:17:41.573 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:17:41.574 +03:00 [INF] Hosting environment: Development
2025-08-31 07:17:41.575 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:17:41.575 +03:00 [DBG] Hosting started
2025-08-31 07:17:42.776 +03:00 [DBG] Connection id "0HNF88LAB273U" received FIN.
2025-08-31 07:17:42.782 +03:00 [DBG] Connection id "0HNF88LAB273U" accepted.
2025-08-31 07:17:42.785 +03:00 [DBG] Connection id "0HNF88LAB273U" started.
2025-08-31 07:17:42.787 +03:00 [DBG] Connection id "0HNF88LAB273V" accepted.
2025-08-31 07:17:42.788 +03:00 [DBG] Connection id "0HNF88LAB273V" started.
2025-08-31 07:17:42.871 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:17:42.878 +03:00 [DBG] Connection id "0HNF88LAB273U" stopped.
2025-08-31 07:17:42.883 +03:00 [DBG] Connection id "0HNF88LAB273U" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:17:42.895 +03:00 [DBG] Connection 0HNF88LAB273V established using the following protocol: "Tls13"
2025-08-31 07:17:42.922 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 257
2025-08-31 07:17:42.962 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:17:42.964 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:17:42.968 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:17:42.992 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:17:43.036 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:17:43.040 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:17:43.129 +03:00 [DBG] Connection id "0HNF88LAB273V", Request id "0HNF88LAB273V:00000001": started reading request body.
2025-08-31 07:17:43.134 +03:00 [DBG] Connection id "0HNF88LAB273V", Request id "0HNF88LAB273V:00000001": done reading request body.
2025-08-31 07:17:43.262 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:17:43.305 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:17:43.657 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:17:43.705 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:17:43.718 +03:00 [DBG] Created DbConnection. (19ms).
2025-08-31 07:17:43.722 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:43.735 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:43.742 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:43.748 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:17:43.753 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-08-31 07:17:43.761 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:43.778 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:43.815 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:43.859 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:43.869 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:43.872 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:43.877 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:43.883 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 97ms reading results.
2025-08-31 07:17:43.888 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:43.892 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 07:17:43.900 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:17:43.904 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:43.905 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:43.907 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:43.908 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:17:43.909 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:17:43.910 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:43.912 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:43.914 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:43.916 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:17:43.917 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:43.918 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:17:43.930 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:17:43.949 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:17:43.968 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:17:43.970 +03:00 [DBG] SQL: SELECT P.Id,P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:17:43.974 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:17:44.246 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:17:44.306 +03:00 [INF] Query execution finished in 332 ms, returned 1 rows
2025-08-31 07:17:46.418 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:46.420 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:46.422 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:46.423 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:17:46.424 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:17:46.425 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:46.426 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:17:46.428 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:46.429 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:17:46.430 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:46.431 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:17:47.319 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:47.326 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:47.595 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:17:47.616 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:17:47.626 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:17:47.629 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:17:47.630 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:17:47.689 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:47.691 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:47.696 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:17:47.700 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-31 07:17:47.702 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-08-31 07:17:47.705 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 222), @p3='?' (Size = 112), @p4='?' (DbType = DateTime), @p5='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:17:47.713 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 222), @p3='?' (Size = 112), @p4='?' (DbType = DateTime), @p5='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:17:47.717 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:47.718 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 07:17:47.720 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:17:47.722 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:17:47.732 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:17:47.737 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 07:17:48.358 +03:00 [INF] Saved query to DB for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:17:53.352 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:17:53.358 +03:00 [DBG] Connection id "0HNF88LAB273V" completed keep alive response.
2025-08-31 07:17:53.363 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:17:53.367 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:17:53.370 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:17:53.379 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 10460.747ms
2025-08-31 07:18:04.299 +03:00 [INF] This is a test log to file!
2025-08-31 07:18:04.815 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:18:04.826 +03:00 [INF] API configured successfully.
2025-08-31 07:18:04.958 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 07:18:05.019 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:18:05.553 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:18:05.587 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:18:05.596 +03:00 [INF] Registered 12 endpoints in 1,107 milliseconds.
2025-08-31 07:18:05.605 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:18:05.608 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:18:05.608 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:18:05.633 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:18:05.662 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:18:05.664 +03:00 [DBG] Hosting starting
2025-08-31 07:18:05.679 +03:00 [DBG] Middleware loaded
2025-08-31 07:18:05.683 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:18:05.685 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:18:05.795 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:18:05.796 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:18:05.798 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:18:05.837 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:18:05.896 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:18:05.898 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:18:05.899 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:18:05.900 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:18:05.900 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:18:05.901 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:18:05.906 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:18:05.912 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:18:05.993 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:18:05.993 +03:00 [INF] Hosting environment: Development
2025-08-31 07:18:05.994 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:18:05.995 +03:00 [DBG] Hosting started
2025-08-31 07:18:06.607 +03:00 [DBG] Connection id "0HNF88LHEB3CO" received FIN.
2025-08-31 07:18:06.614 +03:00 [DBG] Connection id "0HNF88LHEB3CO" accepted.
2025-08-31 07:18:06.617 +03:00 [DBG] Connection id "0HNF88LHEB3CO" started.
2025-08-31 07:18:06.619 +03:00 [DBG] Connection id "0HNF88LHEB3CP" accepted.
2025-08-31 07:18:06.621 +03:00 [DBG] Connection id "0HNF88LHEB3CP" started.
2025-08-31 07:18:06.684 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:18:06.692 +03:00 [DBG] Connection id "0HNF88LHEB3CO" stopped.
2025-08-31 07:18:06.697 +03:00 [DBG] Connection id "0HNF88LHEB3CO" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:18:06.710 +03:00 [DBG] Connection 0HNF88LHEB3CP established using the following protocol: "Tls13"
2025-08-31 07:18:06.738 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 257
2025-08-31 07:18:06.774 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:18:06.776 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:18:06.779 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:18:06.804 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:18:06.849 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:18:06.854 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:18:06.897 +03:00 [DBG] Connection id "0HNF88LHEB3CP", Request id "0HNF88LHEB3CP:00000001": started reading request body.
2025-08-31 07:18:06.900 +03:00 [DBG] Connection id "0HNF88LHEB3CP", Request id "0HNF88LHEB3CP:00000001": done reading request body.
2025-08-31 07:18:06.972 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:18:07.013 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:18:07.319 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:18:07.357 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:18:07.371 +03:00 [DBG] Created DbConnection. (13ms).
2025-08-31 07:18:07.376 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:18:07.389 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:07.394 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:18:07.401 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-31 07:18:07.406 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-08-31 07:18:07.414 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:18:07.432 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:18:07.524 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:18:07.563 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:18:07.571 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:18:07.572 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:18:07.574 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:18:07.579 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:07.584 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 112ms reading results.
2025-08-31 07:18:07.588 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:07.593 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 07:18:07.602 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:18:07.605 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:18:07.606 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:07.607 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:18:07.608 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:18:07.609 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:18:07.610 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:18:07.612 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:18:07.614 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:07.615 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:18:07.617 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:07.618 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:18:07.626 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:18:07.637 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:18:07.648 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:18:07.649 +03:00 [DBG] SQL: SELECT P.Id,P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:18:07.651 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:18:07.901 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:18:07.960 +03:00 [INF] Query execution finished in 309 ms, returned 1 rows
2025-08-31 07:18:11.405 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:18:11.406 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:11.407 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:18:11.408 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:18:11.409 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:18:11.410 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:18:11.411 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:18:11.413 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:11.414 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:18:11.415 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:18:11.416 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:21:52.233 +03:00 [INF] This is a test log to file!
2025-08-31 07:21:52.611 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:21:52.622 +03:00 [INF] API configured successfully.
2025-08-31 07:21:52.716 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 07:21:52.771 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:21:53.470 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:21:53.509 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:21:53.519 +03:00 [INF] Registered 12 endpoints in 1,152 milliseconds.
2025-08-31 07:21:53.528 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:21:53.531 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:21:53.532 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:21:53.568 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:21:53.601 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:21:53.606 +03:00 [DBG] Hosting starting
2025-08-31 07:21:53.625 +03:00 [DBG] Middleware loaded
2025-08-31 07:21:53.629 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:21:53.639 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:21:53.738 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:21:53.741 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:21:53.745 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:21:53.776 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:21:53.844 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:21:53.846 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:21:53.848 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:21:53.849 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:21:53.850 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:21:53.851 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:21:53.867 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:21:53.876 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:21:53.973 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:21:53.975 +03:00 [INF] Hosting environment: Development
2025-08-31 07:21:53.976 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:21:53.976 +03:00 [DBG] Hosting started
2025-08-31 07:22:32.967 +03:00 [DBG] Connection id "0HNF88O0QHFLD" received FIN.
2025-08-31 07:22:32.979 +03:00 [DBG] Connection id "0HNF88O0QHFLD" accepted.
2025-08-31 07:22:32.987 +03:00 [DBG] Connection id "0HNF88O0QHFLD" started.
2025-08-31 07:22:32.989 +03:00 [DBG] Connection id "0HNF88O0QHFLE" accepted.
2025-08-31 07:22:32.991 +03:00 [DBG] Connection id "0HNF88O0QHFLE" started.
2025-08-31 07:22:33.058 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:22:33.065 +03:00 [DBG] Connection id "0HNF88O0QHFLD" stopped.
2025-08-31 07:22:33.071 +03:00 [DBG] Connection id "0HNF88O0QHFLD" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:22:33.086 +03:00 [DBG] Connection 0HNF88O0QHFLE established using the following protocol: "Tls13"
2025-08-31 07:22:33.117 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 257
2025-08-31 07:22:33.180 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:22:33.183 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:22:33.187 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:22:33.214 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:22:33.252 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:22:33.256 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:22:33.300 +03:00 [DBG] Connection id "0HNF88O0QHFLE", Request id "0HNF88O0QHFLE:00000001": started reading request body.
2025-08-31 07:22:33.303 +03:00 [DBG] Connection id "0HNF88O0QHFLE", Request id "0HNF88O0QHFLE:00000001": done reading request body.
2025-08-31 07:22:33.402 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:22:33.445 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:22:33.684 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:22:33.718 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:22:33.731 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-31 07:22:33.735 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:33.750 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:33.757 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:22:33.764 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-31 07:22:33.770 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-08-31 07:22:33.779 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:33.797 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:33.832 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:33.888 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:33.900 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:33.902 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:33.904 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:33.911 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:33.918 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 112ms reading results.
2025-08-31 07:22:33.923 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:33.929 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (5ms).
2025-08-31 07:22:33.939 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:22:33.943 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:33.944 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:33.945 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:22:33.946 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:22:33.948 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:22:33.949 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:33.951 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:33.953 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:33.955 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:22:33.956 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:33.957 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:22:33.969 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:22:33.984 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:22:33.994 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:22:33.996 +03:00 [DBG] SQL: SELECT P.Id,P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:22:34.000 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:22:34.221 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:22:34.278 +03:00 [INF] Query execution finished in 278 ms, returned 1 rows
2025-08-31 07:22:37.227 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:37.229 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:37.232 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:22:37.233 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:22:37.234 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:22:37.235 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:37.236 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:37.238 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:37.239 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:22:37.242 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:37.244 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:22:39.551 +03:00 [INF] Query not saved due to profile rules for profile "b4be75ee-37e6-4e39-9593-766e259f5729", Query already existed
2025-08-31 07:22:40.678 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:22:40.683 +03:00 [DBG] Connection id "0HNF88O0QHFLE" completed keep alive response.
2025-08-31 07:22:40.686 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:22:40.690 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:40.693 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:22:40.696 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 7583.3691ms
2025-08-31 07:22:49.137 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - application/json 241
2025-08-31 07:22:49.143 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:22:49.144 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute'
2025-08-31 07:22:49.146 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:22:49.150 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:22:49.270 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:22:49.286 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:22:49.288 +03:00 [DBG] Connection id "0HNF88O0QHFLE", Request id "0HNF88O0QHFLE:00000002": started reading request body.
2025-08-31 07:22:49.290 +03:00 [DBG] Connection id "0HNF88O0QHFLE", Request id "0HNF88O0QHFLE:00000002": done reading request body.
2025-08-31 07:22:49.293 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:22:49.294 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 07:22:49.295 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:49.296 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:49.298 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:22:49.299 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:22:49.300 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:22:49.301 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:49.303 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:49.305 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:49.308 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:49.309 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:49.311 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:49.315 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:49.316 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:49.317 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 12ms reading results.
2025-08-31 07:22:49.319 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:49.320 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:22:49.322 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:22:49.324 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:49.325 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:49.327 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:22:49.328 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:22:49.329 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:22:49.330 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:49.331 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:49.334 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:49.335 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:22:49.336 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:49.338 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:22:49.340 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:22:49.341 +03:00 [INF] Executing SQL for Profile "b4be75ee-37e6-4e39-9593-766e259f5729", Mode="ReadOnly"
2025-08-31 07:22:49.342 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-31 07:22:49.343 +03:00 [DBG] SQL: SELECT P.Id, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-31 07:22:49.344 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:22:49.346 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 07:22:49.350 +03:00 [INF] Query execution finished in 5 ms, returned 1 rows
2025-08-31 07:22:51.342 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:51.344 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:51.345 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:22:51.347 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:22:51.347 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:22:51.348 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:51.350 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:22:51.352 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:51.354 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:22:51.357 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:51.359 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:22:52.932 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:52.938 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:53.882 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:22:53.905 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:53.912 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:22:53.918 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 07:22:53.921 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 07:22:53.924 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 07:22:53.988 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:53.991 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:53.995 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:22:53.997 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:22:53.999 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:22:54.000 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 168), @p3='?' (Size = 99), @p4='?' (DbType = DateTime), @p5='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:22:54.009 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 168), @p3='?' (Size = 99), @p4='?' (DbType = DateTime), @p5='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 07:22:54.014 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:54.016 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 07:22:54.018 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:22:54.020 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 07:22:54.031 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:22:54.035 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 07:22:54.043 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-08-31T04:22:51.9123088Z","$type":"QueryAddedEvent"}
2025-08-31 07:22:54.049 +03:00 [INF] Saved query to DB for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:22:54.052 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 07:22:54.053 +03:00 [DBG] Connection id "0HNF88O0QHFLE" completed keep alive response.
2025-08-31 07:22:54.054 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:22:54.056 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:22:54.057 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:22:54.066 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/b4be75ee-37e6-4e39-9593-766e259f5729/execute - 200 null application/json; charset=utf-8 4928.6973ms
2025-08-31 07:23:04.948 +03:00 [INF] This is a test log to file!
2025-08-31 07:23:05.540 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 07:23:05.548 +03:00 [INF] API configured successfully.
2025-08-31 07:23:05.670 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 07:23:05.740 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 07:23:06.386 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:23:06.431 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 07:23:06.446 +03:00 [INF] Registered 12 endpoints in 1,291 milliseconds.
2025-08-31 07:23:06.455 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:23:06.459 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:23:06.461 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 07:23:06.493 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 07:23:06.544 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 07:23:06.547 +03:00 [DBG] Hosting starting
2025-08-31 07:23:06.569 +03:00 [DBG] Middleware loaded
2025-08-31 07:23:06.578 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 07:23:06.581 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 07:23:06.682 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 07:23:06.686 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 07:23:06.690 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 07:23:06.735 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 07:23:06.793 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 07:23:06.795 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 07:23:06.796 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 07:23:06.797 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 07:23:06.797 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 07:23:06.798 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 07:23:06.807 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:23:06.819 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 07:23:06.922 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 07:23:06.922 +03:00 [INF] Hosting environment: Development
2025-08-31 07:23:06.923 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 07:23:06.924 +03:00 [DBG] Hosting started
2025-08-31 07:26:47.887 +03:00 [DBG] Connection id "0HNF88QCPKUEK" received FIN.
2025-08-31 07:26:47.901 +03:00 [DBG] Connection id "0HNF88QCPKUEK" accepted.
2025-08-31 07:26:47.951 +03:00 [DBG] Connection id "0HNF88QCPKUEK" started.
2025-08-31 07:26:47.953 +03:00 [DBG] Connection id "0HNF88QCPKUEL" accepted.
2025-08-31 07:26:47.954 +03:00 [DBG] Connection id "0HNF88QCPKUEL" started.
2025-08-31 07:26:48.012 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:26:48.020 +03:00 [DBG] Connection id "0HNF88QCPKUEK" stopped.
2025-08-31 07:26:48.026 +03:00 [DBG] Connection id "0HNF88QCPKUEK" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:26:48.046 +03:00 [DBG] Connection 0HNF88QCPKUEL established using the following protocol: "Tls13"
2025-08-31 07:26:48.079 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - null null
2025-08-31 07:26:48.134 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 07:26:48.137 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 07:26:48.140 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 07:26:48.173 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 07:26:48.218 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:26:48.312 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 07:26:48.356 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 07:26:48.588 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:26:48.622 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:26:48.635 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-31 07:26:48.640 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:26:48.654 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:26:48.658 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:26:48.666 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2025-08-31 07:26:48.671 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (13ms).
2025-08-31 07:26:48.680 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:26:48.700 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:26:48.739 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:26:48.779 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:26:48.789 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:26:48.791 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:26:48.793 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:26:48.796 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 07:26:48.802 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:26:48.810 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 101ms reading results.
2025-08-31 07:26:48.815 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:26:48.819 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 07:26:48.822 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:26:48.825 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:26:48.827 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:26:48.828 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:26:48.829 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:26:48.830 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 07:26:48.831 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:26:48.833 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 07:26:48.835 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:26:48.836 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:26:48.838 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:26:48.839 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:26:48.848 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 07:26:48.864 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 07:26:48.866 +03:00 [DBG] Connection id "0HNF88QCPKUEL" completed keep alive response.
2025-08-31 07:26:48.869 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:26:48.873 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:26:48.876 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 07:26:48.881 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - 200 null application/json; charset=utf-8 805.3133ms
2025-08-31 07:28:55.525 +03:00 [DBG] Connection id "0HNF88QCPKUEM" received FIN.
2025-08-31 07:28:55.531 +03:00 [DBG] Connection id "0HNF88QCPKUEM" accepted.
2025-08-31 07:28:55.534 +03:00 [DBG] Connection id "0HNF88QCPKUEM" started.
2025-08-31 07:28:55.534 +03:00 [DBG] Connection id "0HNF88QCPKUEN" accepted.
2025-08-31 07:28:55.608 +03:00 [DBG] Connection id "0HNF88QCPKUEN" started.
2025-08-31 07:28:55.644 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 07:28:55.648 +03:00 [DBG] Connection id "0HNF88QCPKUEM" stopped.
2025-08-31 07:28:55.648 +03:00 [DBG] Connection id "0HNF88QCPKUEM" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 07:28:55.649 +03:00 [DBG] Connection 0HNF88QCPKUEN established using the following protocol: "Tls13"
2025-08-31 07:28:55.651 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 279
2025-08-31 07:28:55.654 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 07:28:55.655 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:28:55.656 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:28:55.679 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:28:55.700 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000001": started reading request body.
2025-08-31 07:28:55.702 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000001": done reading request body.
2025-08-31 07:28:55.724 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 07:28:55.733 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:28:56.018 +03:00 [DBG] Failed to connect ConnectionString: Data Source=DESKTOP-QCK8UI5\SQLEXPRESS;Initial Catalog=ProductInventory;User ID=yourUsername;Password=yourPassword;Trust Server Certificate=True
2025-08-31 07:28:56.021 +03:00 [DBG] failed to connect to the configured connection string NaturalToQuery.Infrastructure.Providers.ProviderConnectionConfig
2025-08-31 07:28:56.157 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:28:56.252 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: failed to connect to the configured connection string Data Source=DESKTOP-QCK8UI5\SQLEXPRESS;Initial Catalog=ProductInventory;User ID=yourUsername;Password=yourPassword;Trust Server Certificate=True
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 41
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 07:28:56.262 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 07:28:56.271 +03:00 [DBG] Connection id "0HNF88QCPKUEN" completed keep alive response.
2025-08-31 07:28:56.272 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:28:56.273 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 622.1927ms
2025-08-31 07:29:06.850 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 236
2025-08-31 07:29:06.855 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 07:29:06.856 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:06.859 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:06.861 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:29:06.863 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000002": started reading request body.
2025-08-31 07:29:06.865 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000002": done reading request body.
2025-08-31 07:29:06.867 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 07:29:06.868 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:29:06.984 +03:00 [DBG] Failed to connect ConnectionString: Data Source=DESKTOP-QCK8UI5\SQLEXPRESS;Initial Catalog=ProductInventory;Trust Server Certificate=True
2025-08-31 07:29:06.985 +03:00 [DBG] failed to connect to the configured connection string NaturalToQuery.Infrastructure.Providers.ProviderConnectionConfig
2025-08-31 07:29:07.188 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:07.267 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: failed to connect to the configured connection string Data Source=DESKTOP-QCK8UI5\SQLEXPRESS;Initial Catalog=ProductInventory;Trust Server Certificate=True
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 41
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 07:29:07.270 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 07:29:07.271 +03:00 [DBG] Connection id "0HNF88QCPKUEN" completed keep alive response.
2025-08-31 07:29:07.272 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:29:07.273 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 422.646ms
2025-08-31 07:29:41.560 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 260
2025-08-31 07:29:41.564 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 07:29:41.565 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:41.567 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:41.569 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:29:41.572 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000003": started reading request body.
2025-08-31 07:29:41.574 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000003": done reading request body.
2025-08-31 07:29:41.576 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 07:29:41.578 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:29:41.684 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:29:41.694 +03:00 [DBG] Saved secret profile-7d1333cf-61bd-4c0c-a47a-52eb153d836e for provider "SqlServer"
2025-08-31 07:29:41.696 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 07:29:41.707 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0)'
2025-08-31 07:29:41.716 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 07:29:41.722 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:29:41.724 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 07:29:41.726 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:29:41.727 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:29:41.728 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:29:41.729 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:29:41.731 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 07:29:41.733 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 07:29:41.735 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 07:29:41.737 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:29:41.738 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:29:41.739 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:29:41.740 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 07:29:41.901 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:41.994 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A profile for SqlServer already exists.
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 27
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 56
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 07:29:41.998 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 07:29:41.999 +03:00 [DBG] Connection id "0HNF88QCPKUEN" completed keep alive response.
2025-08-31 07:29:42.000 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:29:42.001 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:29:42.002 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:29:42.004 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 443.7116ms
2025-08-31 07:29:49.988 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-31 07:29:49.991 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 07:29:49.992 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:49.993 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:49.996 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 07:29:49.998 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000004": started reading request body.
2025-08-31 07:29:50.000 +03:00 [DBG] Connection id "0HNF88QCPKUEN", Request id "0HNF88QCPKUEN:00000004": done reading request body.
2025-08-31 07:29:50.003 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 07:29:50.004 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:29:50.036 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 07:29:50.051 +03:00 [DBG] Saved secret profile-ad0eefd5-6c51-4e97-a30c-815d44bf28d4 for provider "SqlServer"
2025-08-31 07:29:50.052 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 07:29:50.054 +03:00 [DBG] Creating DbConnection.
2025-08-31 07:29:50.055 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 07:29:50.056 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:29:50.057 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:29:50.058 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 07:29:50.059 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 07:29:50.060 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 07:29:50.061 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 07:29:50.062 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-31 07:29:50.064 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:29:50.065 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 07:29:50.066 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 07:29:50.067 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:29:50.217 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 07:29:50.306 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A profile for SqlServer already exists.
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 27
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 56
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 07:29:50.308 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 07:29:50.309 +03:00 [DBG] Connection id "0HNF88QCPKUEN" completed keep alive response.
2025-08-31 07:29:50.310 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 07:29:50.311 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 07:29:50.312 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 07:29:50.314 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 325.7203ms
2025-08-31 09:04:07.488 +03:00 [INF] This is a test log to file!
2025-08-31 09:04:08.044 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 09:04:08.057 +03:00 [INF] API configured successfully.
2025-08-31 09:04:08.197 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 09:04:08.285 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 09:04:08.994 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 09:04:09.047 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 09:04:09.067 +03:00 [INF] Registered 12 endpoints in 1,338 milliseconds.
2025-08-31 09:04:09.074 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 09:04:09.078 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:04:09.079 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:04:09.135 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 09:04:09.188 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 09:04:09.189 +03:00 [DBG] Hosting starting
2025-08-31 09:04:09.209 +03:00 [DBG] Middleware loaded
2025-08-31 09:04:09.214 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 09:04:09.216 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 09:04:09.331 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 09:04:09.333 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 09:04:09.336 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 09:04:09.374 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 09:04:09.456 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 09:04:09.458 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 09:04:09.459 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 09:04:09.460 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 09:04:09.461 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 09:04:09.463 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 09:04:09.471 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:04:09.481 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:04:09.669 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 09:04:09.669 +03:00 [INF] Hosting environment: Development
2025-08-31 09:04:09.670 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 09:04:09.671 +03:00 [DBG] Hosting started
2025-08-31 09:06:00.636 +03:00 [DBG] Connection id "0HNF8AHQRFT5F" received FIN.
2025-08-31 09:06:00.648 +03:00 [DBG] Connection id "0HNF8AHQRFT5F" accepted.
2025-08-31 09:06:00.676 +03:00 [DBG] Connection id "0HNF8AHQRFT5F" started.
2025-08-31 09:06:00.678 +03:00 [DBG] Connection id "0HNF8AHQRFT5G" accepted.
2025-08-31 09:06:00.679 +03:00 [DBG] Connection id "0HNF8AHQRFT5G" started.
2025-08-31 09:06:00.688 +03:00 [DBG] Connection id "0HNF8AHQRFT5F" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:06:00.691 +03:00 [DBG] Connection id "0HNF8AHQRFT5F" disconnecting.
2025-08-31 09:06:00.694 +03:00 [DBG] Connection id "0HNF8AHQRFT5F" stopped.
2025-08-31 09:06:00.718 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-08-31 09:06:00.761 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:06:00.764 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:06:00.795 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 09:06:00.799 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-08-31 09:06:00.804 +03:00 [DBG] Connection id "0HNF8AHQRFT5G" completed keep alive response.
2025-08-31 09:06:00.806 +03:00 [DBG] Connection id "0HNF8AHQRFT5H" accepted.
2025-08-31 09:06:00.806 +03:00 [DBG] Connection id "0HNF8AHQRFT5I" accepted.
2025-08-31 09:06:00.857 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 95.4862ms
2025-08-31 09:06:00.857 +03:00 [DBG] Connection id "0HNF8AHQRFT5H" received FIN.
2025-08-31 09:06:00.857 +03:00 [DBG] Connection id "0HNF8AHQRFT5H" started.
2025-08-31 09:06:00.863 +03:00 [DBG] Connection id "0HNF8AHQRFT5I" started.
2025-08-31 09:06:00.868 +03:00 [DBG] Connection id "0HNF8AHQRFT5H" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:06:00.870 +03:00 [DBG] Connection id "0HNF8AHQRFT5H" disconnecting.
2025-08-31 09:06:00.871 +03:00 [DBG] Connection id "0HNF8AHQRFT5H" stopped.
2025-08-31 09:06:00.901 +03:00 [DBG] Connection 0HNF8AHQRFT5I established using the following protocol: "Tls13"
2025-08-31 09:06:00.906 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/health - null null
2025-08-31 09:06:00.910 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:06:00.911 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:06:00.916 +03:00 [INF] Executing endpoint 'HTTP: GET api/health'
2025-08-31 09:06:00.952 +03:00 [INF] Health check sent.
2025-08-31 09:06:00.955 +03:00 [INF] Executed endpoint 'HTTP: GET api/health'
2025-08-31 09:06:00.957 +03:00 [DBG] Connection id "0HNF8AHQRFT5I" completed keep alive response.
2025-08-31 09:06:00.958 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/health - 200 null application/json; charset=utf-8 52.2786ms
2025-08-31 09:06:25.365 +03:00 [INF] This is a test log to file!
2025-08-31 09:06:25.738 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 09:06:25.748 +03:00 [INF] API configured successfully.
2025-08-31 09:06:25.849 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 09:06:25.900 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 09:06:26.447 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 09:06:26.477 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 09:06:26.486 +03:00 [INF] Registered 12 endpoints in 941 milliseconds.
2025-08-31 09:06:26.492 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 09:06:26.495 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:06:26.495 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:06:26.517 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 09:06:26.542 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 09:06:26.544 +03:00 [DBG] Hosting starting
2025-08-31 09:06:26.556 +03:00 [DBG] Middleware loaded
2025-08-31 09:06:26.559 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 09:06:26.562 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 09:06:26.633 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 09:06:26.635 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 09:06:26.637 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 09:06:26.665 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 09:06:26.722 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 09:06:26.724 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 09:06:26.725 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 09:06:26.726 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 09:06:26.727 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 09:06:26.728 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 09:06:26.733 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:06:26.738 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:06:26.767 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 09:06:26.768 +03:00 [INF] Hosting environment: Development
2025-08-31 09:06:26.769 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 09:06:26.770 +03:00 [DBG] Hosting started
2025-08-31 09:12:52.182 +03:00 [INF] This is a test log to file!
2025-08-31 09:12:52.447 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 09:12:52.456 +03:00 [INF] API configured successfully.
2025-08-31 09:12:52.581 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 09:12:52.631 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 09:12:53.249 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 09:12:53.280 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 09:12:53.289 +03:00 [INF] Registered 12 endpoints in 1,004 milliseconds.
2025-08-31 09:12:53.295 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 09:12:53.299 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:12:53.300 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:12:53.322 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 09:12:53.349 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 09:12:53.350 +03:00 [DBG] Hosting starting
2025-08-31 09:12:53.361 +03:00 [DBG] Middleware loaded
2025-08-31 09:12:53.363 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 09:12:53.365 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 09:12:53.428 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 09:12:53.431 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 09:12:53.433 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 09:12:53.458 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 09:12:53.526 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 09:12:53.529 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 09:12:53.530 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 09:12:53.531 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 09:12:53.532 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 09:12:53.533 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 09:12:53.538 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:12:53.544 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:12:53.626 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 09:12:53.627 +03:00 [INF] Hosting environment: Development
2025-08-31 09:12:53.629 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 09:12:53.630 +03:00 [DBG] Hosting started
2025-08-31 09:12:55.023 +03:00 [DBG] Connection id "0HNF8ALMBCNTG" received FIN.
2025-08-31 09:12:55.029 +03:00 [DBG] Connection id "0HNF8ALMBCNTG" accepted.
2025-08-31 09:12:55.032 +03:00 [DBG] Connection id "0HNF8ALMBCNTG" started.
2025-08-31 09:12:55.033 +03:00 [DBG] Connection id "0HNF8ALMBCNTH" accepted.
2025-08-31 09:12:55.034 +03:00 [DBG] Connection id "0HNF8ALMBCNTH" started.
2025-08-31 09:12:55.040 +03:00 [DBG] Connection id "0HNF8ALMBCNTG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:12:55.089 +03:00 [DBG] Connection id "0HNF8ALMBCNTG" disconnecting.
2025-08-31 09:12:55.089 +03:00 [DBG] Connection id "0HNF8ALMBCNTH" bad request data: "Detected a TLS handshake to an endpoint that does not have TLS enabled."
Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Detected a TLS handshake to an endpoint that does not have TLS enabled.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, SequenceReader`1& reader)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TakeStartLine(SequenceReader`1& reader)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.ParseRequest(SequenceReader`1& reader)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TryParseRequest(ReadResult result, Boolean& endConnection)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application)
2025-08-31 09:12:55.091 +03:00 [DBG] Connection id "0HNF8ALMBCNTG" stopped.
2025-08-31 09:12:55.096 +03:00 [DBG] Connection id "0HNF8ALMBCNTH" disconnecting.
2025-08-31 09:12:55.097 +03:00 [DBG] Connection id "0HNF8ALMBCNTH" received FIN.
2025-08-31 09:12:55.097 +03:00 [DBG] Connection id "0HNF8ALMBCNTH" stopped.
2025-08-31 09:12:55.099 +03:00 [DBG] Connection id "0HNF8ALMBCNTH" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:13:03.437 +03:00 [DBG] Connection id "0HNF8ALMBCNTI" received FIN.
2025-08-31 09:13:03.439 +03:00 [DBG] Connection id "0HNF8ALMBCNTI" accepted.
2025-08-31 09:13:03.440 +03:00 [DBG] Connection id "0HNF8ALMBCNTI" started.
2025-08-31 09:13:03.440 +03:00 [DBG] Connection id "0HNF8ALMBCNTJ" accepted.
2025-08-31 09:13:03.441 +03:00 [DBG] Connection id "0HNF8ALMBCNTI" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:13:03.441 +03:00 [DBG] Connection id "0HNF8ALMBCNTJ" started.
2025-08-31 09:13:03.442 +03:00 [DBG] Connection id "0HNF8ALMBCNTI" disconnecting.
2025-08-31 09:13:03.498 +03:00 [DBG] Connection id "0HNF8ALMBCNTJ" bad request data: "Detected a TLS handshake to an endpoint that does not have TLS enabled."
Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Detected a TLS handshake to an endpoint that does not have TLS enabled.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpParser`1.ParseRequestLine(TRequestHandler handler, SequenceReader`1& reader)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TakeStartLine(SequenceReader`1& reader)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.ParseRequest(SequenceReader`1& reader)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.TryParseRequest(ReadResult result, Boolean& endConnection)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application)
2025-08-31 09:13:03.498 +03:00 [DBG] Connection id "0HNF8ALMBCNTI" stopped.
2025-08-31 09:13:03.502 +03:00 [DBG] Connection id "0HNF8ALMBCNTJ" disconnecting.
2025-08-31 09:13:03.503 +03:00 [DBG] Connection id "0HNF8ALMBCNTJ" received FIN.
2025-08-31 09:13:03.503 +03:00 [DBG] Connection id "0HNF8ALMBCNTJ" stopped.
2025-08-31 09:13:03.505 +03:00 [DBG] Connection id "0HNF8ALMBCNTJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:13:13.140 +03:00 [DBG] Connection id "0HNF8ALMBCNTK" accepted.
2025-08-31 09:13:13.141 +03:00 [DBG] Connection id "0HNF8ALMBCNTK" received FIN.
2025-08-31 09:13:13.142 +03:00 [DBG] Connection id "0HNF8ALMBCNTK" started.
2025-08-31 09:13:13.142 +03:00 [DBG] Connection id "0HNF8ALMBCNTL" accepted.
2025-08-31 09:13:13.145 +03:00 [DBG] Connection id "0HNF8ALMBCNTL" started.
2025-08-31 09:13:13.209 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 09:13:13.215 +03:00 [DBG] Connection id "0HNF8ALMBCNTK" stopped.
2025-08-31 09:13:13.217 +03:00 [DBG] Connection id "0HNF8ALMBCNTK" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:13:13.235 +03:00 [DBG] Connection 0HNF8ALMBCNTL established using the following protocol: "Tls13"
2025-08-31 09:13:13.256 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/health - null null
2025-08-31 09:13:13.289 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:13:13.292 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:13:13.323 +03:00 [INF] Executing endpoint 'HTTP: GET api/health'
2025-08-31 09:13:13.355 +03:00 [INF] Health check sent.
2025-08-31 09:13:13.357 +03:00 [INF] Executed endpoint 'HTTP: GET api/health'
2025-08-31 09:13:13.360 +03:00 [DBG] Connection id "0HNF8ALMBCNTL" completed keep alive response.
2025-08-31 09:13:13.363 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/health - 200 null application/json; charset=utf-8 110.6016ms
2025-08-31 09:35:35.264 +03:00 [INF] This is a test log to file!
2025-08-31 09:35:35.719 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 09:35:35.728 +03:00 [INF] API configured successfully.
2025-08-31 09:35:35.837 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 09:35:35.891 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 09:35:36.498 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 09:35:36.529 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 09:35:36.537 +03:00 [INF] Registered 12 endpoints in 1,050 milliseconds.
2025-08-31 09:35:36.544 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 09:35:36.546 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:35:36.547 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 09:35:36.571 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 09:35:36.599 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 09:35:36.601 +03:00 [DBG] Hosting starting
2025-08-31 09:35:36.615 +03:00 [DBG] Middleware loaded
2025-08-31 09:35:36.618 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 09:35:36.620 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 09:35:36.698 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 09:35:36.700 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 09:35:36.702 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 09:35:36.731 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 09:35:36.773 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 09:35:36.775 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 09:35:36.776 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 09:35:36.777 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 09:35:36.778 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 09:35:36.778 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 09:35:36.784 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:35:36.789 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 09:35:36.872 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 09:35:36.873 +03:00 [INF] Hosting environment: Development
2025-08-31 09:35:36.874 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 09:35:36.875 +03:00 [DBG] Hosting started
2025-08-31 09:35:44.692 +03:00 [DBG] Connection id "0HNF8B2EHIG9I" received FIN.
2025-08-31 09:35:44.699 +03:00 [DBG] Connection id "0HNF8B2EHIG9I" accepted.
2025-08-31 09:35:44.700 +03:00 [DBG] Connection id "0HNF8B2EHIG9I" started.
2025-08-31 09:35:44.702 +03:00 [DBG] Connection id "0HNF8B2EHIG9J" accepted.
2025-08-31 09:35:44.703 +03:00 [DBG] Connection id "0HNF8B2EHIG9J" started.
2025-08-31 09:35:44.708 +03:00 [DBG] Connection id "0HNF8B2EHIG9I" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:35:44.710 +03:00 [DBG] Connection id "0HNF8B2EHIG9I" disconnecting.
2025-08-31 09:35:44.713 +03:00 [DBG] Connection id "0HNF8B2EHIG9I" stopped.
2025-08-31 09:35:44.727 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/providers - null null
2025-08-31 09:35:44.761 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-31 09:35:44.763 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-31 09:35:44.791 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 09:35:44.793 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/providers'.
2025-08-31 09:35:44.795 +03:00 [DBG] Connection id "0HNF8B2EHIG9J" completed keep alive response.
2025-08-31 09:35:44.797 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/providers - 307 0 null 74.6974ms
2025-08-31 09:35:44.798 +03:00 [DBG] Connection id "0HNF8B2EHIG9K" received FIN.
2025-08-31 09:35:44.798 +03:00 [DBG] Connection id "0HNF8B2EHIG9K" accepted.
2025-08-31 09:35:44.798 +03:00 [DBG] Connection id "0HNF8B2EHIG9L" accepted.
2025-08-31 09:35:44.807 +03:00 [DBG] Connection id "0HNF8B2EHIG9K" started.
2025-08-31 09:35:44.807 +03:00 [DBG] Connection id "0HNF8B2EHIG9L" started.
2025-08-31 09:35:44.808 +03:00 [DBG] Connection id "0HNF8B2EHIG9K" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:35:44.810 +03:00 [DBG] Connection id "0HNF8B2EHIG9K" disconnecting.
2025-08-31 09:35:44.811 +03:00 [DBG] Connection id "0HNF8B2EHIG9K" stopped.
2025-08-31 09:35:44.838 +03:00 [DBG] Connection 0HNF8B2EHIG9L established using the following protocol: "Tls13"
2025-08-31 09:35:44.842 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-31 09:35:44.846 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-31 09:35:44.848 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-31 09:35:44.852 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-31 09:35:44.888 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 09:35:44.917 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-31 09:35:44.919 +03:00 [DBG] Connection id "0HNF8B2EHIG9L" completed keep alive response.
2025-08-31 09:35:44.921 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 09:35:44.926 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 83.4533ms
2025-08-31 09:37:04.537 +03:00 [DBG] Connection id "0HNF8B2EHIG9M" received FIN.
2025-08-31 09:37:04.539 +03:00 [DBG] Connection id "0HNF8B2EHIG9M" accepted.
2025-08-31 09:37:04.566 +03:00 [DBG] Connection id "0HNF8B2EHIG9M" started.
2025-08-31 09:37:04.566 +03:00 [DBG] Connection id "0HNF8B2EHIG9N" accepted.
2025-08-31 09:37:04.567 +03:00 [DBG] Connection id "0HNF8B2EHIG9M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:37:04.569 +03:00 [DBG] Connection id "0HNF8B2EHIG9N" started.
2025-08-31 09:37:04.573 +03:00 [DBG] Connection id "0HNF8B2EHIG9M" disconnecting.
2025-08-31 09:37:04.574 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/servers/SqlServer - null null
2025-08-31 09:37:04.575 +03:00 [DBG] Connection id "0HNF8B2EHIG9M" stopped.
2025-08-31 09:37:04.577 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-31 09:37:04.579 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-31 09:37:04.580 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-31 09:37:04.581 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/servers/SqlServer'.
2025-08-31 09:37:04.583 +03:00 [DBG] Connection id "0HNF8B2EHIG9N" completed keep alive response.
2025-08-31 09:37:04.584 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/servers/SqlServer - 307 0 null 9.4363ms
2025-08-31 09:37:04.585 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-31 09:37:04.588 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-31 09:37:04.589 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-31 09:37:04.590 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-31 09:37:04.591 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-31 09:37:04.609 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 09:37:04.636 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-31 09:37:04.638 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-31 09:37:04.670 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-31 09:37:04.901 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-31 09:37:04.908 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-31 09:37:04.976 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-31 09:37:05.079 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-31 09:37:05.080 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-31 09:37:05.086 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-31 09:37:05.090 +03:00 [DBG] Connection id "0HNF8B2EHIG9L" completed keep alive response.
2025-08-31 09:37:05.091 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 09:37:05.092 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 506.727ms
2025-08-31 09:42:54.538 +03:00 [DBG] Connection id "0HNF8B2EHIG9O" accepted.
2025-08-31 09:42:54.620 +03:00 [DBG] Connection id "0HNF8B2EHIG9O" started.
2025-08-31 09:42:54.645 +03:00 [DBG] Connection id "0HNF8B2EHIG9P" accepted.
2025-08-31 09:42:54.646 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-08-31 09:42:54.647 +03:00 [DBG] Connection id "0HNF8B2EHIG9P" started.
2025-08-31 09:42:54.650 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:42:54.651 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-08-31 09:42:54.653 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:42:54.656 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:42:54.657 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-08-31 09:42:54.658 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:42:54.658 +03:00 [DBG] Connection id "0HNF8B2EHIG9O" completed keep alive response.
2025-08-31 09:42:54.660 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-08-31 09:42:54.661 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 15.3002ms
2025-08-31 09:42:54.662 +03:00 [DBG] Connection id "0HNF8B2EHIG9P" completed keep alive response.
2025-08-31 09:42:54.666 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 14.1633ms
2025-08-31 09:42:54.713 +03:00 [DBG] Connection id "0HNF8B2EHIG9Q" accepted.
2025-08-31 09:42:54.714 +03:00 [DBG] Connection id "0HNF8B2EHIG9Q" started.
2025-08-31 09:42:54.714 +03:00 [DBG] Connection id "0HNF8B2EHIG9R" accepted.
2025-08-31 09:42:54.717 +03:00 [DBG] Connection id "0HNF8B2EHIG9R" started.
2025-08-31 09:42:54.725 +03:00 [DBG] Connection id "0HNF8B2EHIG9Q" received FIN.
2025-08-31 09:42:54.772 +03:00 [DBG] Connection id "0HNF8B2EHIG9R" received FIN.
2025-08-31 09:42:54.933 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 09:42:54.993 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 09:42:54.999 +03:00 [DBG] Connection id "0HNF8B2EHIG9R" stopped.
2025-08-31 09:42:54.999 +03:00 [DBG] Connection id "0HNF8B2EHIG9Q" stopped.
2025-08-31 09:42:55.000 +03:00 [DBG] Connection id "0HNF8B2EHIG9R" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:42:55.001 +03:00 [DBG] Connection id "0HNF8B2EHIG9Q" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:42:56.103 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-08-31 09:42:56.104 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-08-31 09:42:56.107 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:42:56.111 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:42:56.112 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:42:56.113 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:42:56.114 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-08-31 09:42:56.116 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-08-31 09:42:56.116 +03:00 [DBG] Connection id "0HNF8B2EHIG9P" completed keep alive response.
2025-08-31 09:42:56.117 +03:00 [DBG] Connection id "0HNF8B2EHIG9O" completed keep alive response.
2025-08-31 09:42:56.118 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 14.2967ms
2025-08-31 09:42:56.118 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 14.8569ms
2025-08-31 09:42:56.123 +03:00 [DBG] Connection id "0HNF8B2EHIG9S" accepted.
2025-08-31 09:42:56.129 +03:00 [DBG] Connection id "0HNF8B2EHIG9S" started.
2025-08-31 09:42:56.130 +03:00 [DBG] Connection id "0HNF8B2EHIG9T" accepted.
2025-08-31 09:42:56.131 +03:00 [DBG] Connection id "0HNF8B2EHIG9T" started.
2025-08-31 09:42:56.134 +03:00 [DBG] Connection id "0HNF8B2EHIG9S" received FIN.
2025-08-31 09:42:56.138 +03:00 [DBG] Connection id "0HNF8B2EHIG9T" received FIN.
2025-08-31 09:42:56.296 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 09:42:56.349 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 09:42:56.350 +03:00 [DBG] Connection id "0HNF8B2EHIG9S" stopped.
2025-08-31 09:42:56.351 +03:00 [DBG] Connection id "0HNF8B2EHIG9T" stopped.
2025-08-31 09:42:56.351 +03:00 [DBG] Connection id "0HNF8B2EHIG9S" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:42:56.352 +03:00 [DBG] Connection id "0HNF8B2EHIG9T" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:42:57.139 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-08-31 09:42:57.140 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/health - null null
2025-08-31 09:42:57.145 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:42:57.142 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-31 09:42:57.146 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:42:57.147 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-31 09:42:57.148 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-08-31 09:42:57.149 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/health'.
2025-08-31 09:42:57.150 +03:00 [DBG] Connection id "0HNF8B2EHIG9P" completed keep alive response.
2025-08-31 09:42:57.151 +03:00 [DBG] Connection id "0HNF8B2EHIG9O" completed keep alive response.
2025-08-31 09:42:57.152 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 12.5872ms
2025-08-31 09:42:57.153 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/health - 307 0 null 13.8656ms
2025-08-31 09:42:57.153 +03:00 [DBG] Connection id "0HNF8B2EHIG9U" accepted.
2025-08-31 09:42:57.162 +03:00 [DBG] Connection id "0HNF8B2EHIG9U" started.
2025-08-31 09:42:57.163 +03:00 [DBG] Connection id "0HNF8B2EHIG9V" accepted.
2025-08-31 09:42:57.164 +03:00 [DBG] Connection id "0HNF8B2EHIG9V" started.
2025-08-31 09:42:57.165 +03:00 [DBG] Connection id "0HNF8B2EHIG9U" received FIN.
2025-08-31 09:42:57.237 +03:00 [DBG] Connection id "0HNF8B2EHIG9V" received FIN.
2025-08-31 09:42:57.287 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 09:42:57.398 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 09:42:57.399 +03:00 [DBG] Connection id "0HNF8B2EHIG9U" stopped.
2025-08-31 09:42:57.400 +03:00 [DBG] Connection id "0HNF8B2EHIG9V" stopped.
2025-08-31 09:42:57.400 +03:00 [DBG] Connection id "0HNF8B2EHIG9U" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 09:42:57.401 +03:00 [DBG] Connection id "0HNF8B2EHIG9V" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:10:00.580 +03:00 [INF] This is a test log to file!
2025-08-31 10:10:01.041 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 10:10:01.055 +03:00 [INF] API configured successfully.
2025-08-31 10:10:01.186 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 10:10:01.285 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 10:10:01.899 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:10:01.933 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 10:10:01.942 +03:00 [INF] Registered 13 endpoints in 1,168 milliseconds.
2025-08-31 10:10:01.949 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:10:01.984 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:10:02.070 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:10:02.081 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-31 10:10:02.084 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 10:10:02.088 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:10:02.091 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 10:10:02.092 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:10:02.109 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:10:02.112 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:10:02.117 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:10:02.118 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:10:02.120 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:10:02.123 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 10:10:02.128 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:10:02.133 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:10:02.135 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-08-31 10:10:02.142 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:10:02.166 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:10:02.170 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:10:02.171 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:10:02.172 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:10:02.173 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:10:02.1706085+00:00');
SELECT changes();
2025-08-31 10:10:02.186 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:10:02.1706085+00:00');
SELECT changes();
2025-08-31 10:10:02.232 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:10:02.237 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:10:02.239 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 10:10:02.240 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 10:10:02.242 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 10:10:02.244 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:10:02.247 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:10:02.251 +03:00 [DBG] Committing transaction.
2025-08-31 10:10:02.254 +03:00 [DBG] Committed transaction.
2025-08-31 10:10:02.256 +03:00 [DBG] Disposing transaction.
2025-08-31 10:10:02.259 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:10:02.260 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:10:02.262 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:10:02.263 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 10:10:02.264 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:10:02.266 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:10:02.268 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:10:02.269 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:10:02.272 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:10:02.273 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:10:02.274 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:10:02.276 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:10:02.278 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:10:02.282 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:10:02.283 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 10:10:02.285 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 10:10:02.286 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:10:02.289 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:10:02.293 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:10:02.296 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 10:10:02.300 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 10:10:02.301 +03:00 [DBG] Committing transaction.
2025-08-31 10:10:02.302 +03:00 [DBG] Committed transaction.
2025-08-31 10:10:02.303 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:10:02.304 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:10:02.306 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:10:02.307 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:10:02.315 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:10:02.317 +03:00 [DBG] Disposing transaction.
2025-08-31 10:10:02.319 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:10:02.323 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 10:10:02.324 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:10:02.326 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:10:02.327 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:10:02.329 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:10:02.330 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:10:02.355 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 10:10:02.387 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 10:10:02.389 +03:00 [DBG] Hosting starting
2025-08-31 10:10:02.400 +03:00 [DBG] Middleware loaded
2025-08-31 10:10:02.403 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 10:10:02.406 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 10:10:02.505 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 10:10:02.507 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 10:10:02.510 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 10:10:02.545 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 10:10:02.617 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 10:10:02.618 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 10:10:02.619 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 10:10:02.620 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 10:10:02.621 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 10:10:02.622 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 10:10:02.629 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:10:02.637 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:10:02.746 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 10:10:02.747 +03:00 [INF] Hosting environment: Development
2025-08-31 10:10:02.748 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 10:10:02.750 +03:00 [DBG] Hosting started
2025-08-31 10:10:16.394 +03:00 [DBG] Connection id "0HNF8BLNURP11" received FIN.
2025-08-31 10:10:16.402 +03:00 [DBG] Connection id "0HNF8BLNURP11" accepted.
2025-08-31 10:10:16.404 +03:00 [DBG] Connection id "0HNF8BLNURP11" started.
2025-08-31 10:10:16.406 +03:00 [DBG] Connection id "0HNF8BLNURP12" accepted.
2025-08-31 10:10:16.408 +03:00 [DBG] Connection id "0HNF8BLNURP12" started.
2025-08-31 10:10:16.413 +03:00 [DBG] Connection id "0HNF8BLNURP11" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:10:16.420 +03:00 [DBG] Connection id "0HNF8BLNURP11" disconnecting.
2025-08-31 10:10:16.423 +03:00 [DBG] Connection id "0HNF8BLNURP11" stopped.
2025-08-31 10:10:16.446 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 10:10:16.501 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:10:16.503 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:16.541 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 10:10:16.543 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 10:10:16.546 +03:00 [DBG] Connection id "0HNF8BLNURP12" completed keep alive response.
2025-08-31 10:10:16.550 +03:00 [DBG] Connection id "0HNF8BLNURP13" accepted.
2025-08-31 10:10:16.550 +03:00 [DBG] Connection id "0HNF8BLNURP14" accepted.
2025-08-31 10:10:16.576 +03:00 [DBG] Connection id "0HNF8BLNURP13" received FIN.
2025-08-31 10:10:16.578 +03:00 [DBG] Connection id "0HNF8BLNURP13" started.
2025-08-31 10:10:16.578 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 136.5298ms
2025-08-31 10:10:16.578 +03:00 [DBG] Connection id "0HNF8BLNURP14" started.
2025-08-31 10:10:16.580 +03:00 [DBG] Connection id "0HNF8BLNURP13" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:10:16.586 +03:00 [DBG] Connection id "0HNF8BLNURP13" disconnecting.
2025-08-31 10:10:16.587 +03:00 [DBG] Connection id "0HNF8BLNURP13" stopped.
2025-08-31 10:10:16.617 +03:00 [DBG] Connection 0HNF8BLNURP14 established using the following protocol: "Tls13"
2025-08-31 10:10:16.620 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 10:10:16.624 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:10:16.625 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:16.629 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:16.642 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:10:16.667 +03:00 [INF] Listing all profiles
2025-08-31 10:10:16.712 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()
    .OrderByDescending(p => p.CreatedUtc)'
2025-08-31 10:10:16.775 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:10:17.012 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:17.069 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: SQLite does not support expressions of type 'DateTimeOffset' in ORDER BY clauses. Convert the values to a supported type, or use LINQ to Objects to order the results on the client side.
   at Microsoft.EntityFrameworkCore.Sqlite.Query.Internal.SqliteQueryableMethodTranslatingExpressionVisitor.TranslateOrderBy(ShapedQueryExpression source, LambdaExpression keySelector, Boolean ascending)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ProfileRepository.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 70
   at NaturalToQuery.Application.Services.ProfileService.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 228
   at NaturalToQuery.Api.Controllers.Setup.GetAllProfiles.HandleAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\GetAllProfiles.cs:line 21
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 10:10:17.092 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 10:10:17.103 +03:00 [DBG] Connection id "0HNF8BLNURP14" completed keep alive response.
2025-08-31 10:10:17.106 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:10:17.110 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 500 null application/json; charset=utf-8 489.9094ms
2025-08-31 10:10:23.303 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 10:10:23.307 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:10:23.309 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:23.311 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 10:10:23.312 +03:00 [DBG] Connection id "0HNF8BLNURP12" completed keep alive response.
2025-08-31 10:10:23.313 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 9.7922ms
2025-08-31 10:10:23.314 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 10:10:23.318 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:10:23.319 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:23.320 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:23.331 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:10:23.332 +03:00 [INF] Listing all profiles
2025-08-31 10:10:23.333 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()
    .OrderByDescending(p => p.CreatedUtc)'
2025-08-31 10:10:23.335 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:10:23.536 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:23.583 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: SQLite does not support expressions of type 'DateTimeOffset' in ORDER BY clauses. Convert the values to a supported type, or use LINQ to Objects to order the results on the client side.
   at Microsoft.EntityFrameworkCore.Sqlite.Query.Internal.SqliteQueryableMethodTranslatingExpressionVisitor.TranslateOrderBy(ShapedQueryExpression source, LambdaExpression keySelector, Boolean ascending)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ProfileRepository.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 70
   at NaturalToQuery.Application.Services.ProfileService.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 228
   at NaturalToQuery.Api.Controllers.Setup.GetAllProfiles.HandleAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\GetAllProfiles.cs:line 21
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 10:10:23.591 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 10:10:23.592 +03:00 [DBG] Connection id "0HNF8BLNURP14" completed keep alive response.
2025-08-31 10:10:23.593 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:10:23.594 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 500 null application/json; charset=utf-8 279.4074ms
2025-08-31 10:10:36.751 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 10:10:36.755 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:10:36.757 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:36.759 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 10:10:36.760 +03:00 [DBG] Connection id "0HNF8BLNURP12" completed keep alive response.
2025-08-31 10:10:36.762 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 10:10:36.762 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 11.1044ms
2025-08-31 10:10:36.766 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:10:36.773 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:36.775 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:36.778 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:10:36.781 +03:00 [INF] Listing all profiles
2025-08-31 10:10:36.784 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()
    .OrderByDescending(p => p.CreatedUtc)'
2025-08-31 10:10:36.785 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:10:36.932 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:10:36.975 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: SQLite does not support expressions of type 'DateTimeOffset' in ORDER BY clauses. Convert the values to a supported type, or use LINQ to Objects to order the results on the client side.
   at Microsoft.EntityFrameworkCore.Sqlite.Query.Internal.SqliteQueryableMethodTranslatingExpressionVisitor.TranslateOrderBy(ShapedQueryExpression source, LambdaExpression keySelector, Boolean ascending)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ProfileRepository.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 70
   at NaturalToQuery.Application.Services.ProfileService.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 228
   at NaturalToQuery.Api.Controllers.Setup.GetAllProfiles.HandleAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\GetAllProfiles.cs:line 21
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 10:10:36.984 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 10:10:36.985 +03:00 [DBG] Connection id "0HNF8BLNURP14" completed keep alive response.
2025-08-31 10:10:36.987 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:10:36.989 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 500 null application/json; charset=utf-8 227.0856ms
2025-08-31 10:10:59.107 +03:00 [INF] This is a test log to file!
2025-08-31 10:10:59.515 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 10:10:59.525 +03:00 [INF] API configured successfully.
2025-08-31 10:10:59.625 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 10:10:59.681 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 10:11:00.344 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:11:00.390 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 10:11:00.409 +03:00 [INF] Registered 13 endpoints in 1,144 milliseconds.
2025-08-31 10:11:00.429 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:11:00.511 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:11:00.597 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:11:00.608 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 10:11:00.610 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:00.614 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:11:00.616 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 10:11:00.617 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:00.626 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:00.629 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:00.633 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:11:00.634 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:00.636 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:00.638 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 10:11:00.642 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:11:00.646 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:11:00.648 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 10:11:00.653 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:11:00.672 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:11:00.677 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:11:00.678 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:11:00.678 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:11:00.679 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:11:00.6771408+00:00');
SELECT changes();
2025-08-31 10:11:00.686 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:11:00.6771408+00:00');
SELECT changes();
2025-08-31 10:11:00.728 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:11:00.732 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:11:00.735 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 10:11:00.735 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 10:11:00.737 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 10:11:00.737 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:11:00.739 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:11:00.741 +03:00 [DBG] Committing transaction.
2025-08-31 10:11:00.743 +03:00 [DBG] Committed transaction.
2025-08-31 10:11:00.744 +03:00 [DBG] Disposing transaction.
2025-08-31 10:11:00.747 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:11:00.748 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:11:00.750 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:11:00.750 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 10:11:00.751 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:00.753 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:00.754 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:00.755 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 10:11:00.756 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:11:00.757 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:11:00.758 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:11:00.759 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:11:00.761 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:11:00.764 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:11:00.765 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:11:00.766 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 10:11:00.767 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:11:00.769 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:11:00.773 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:00.775 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 10:11:00.779 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 10:11:00.779 +03:00 [DBG] Committing transaction.
2025-08-31 10:11:00.780 +03:00 [DBG] Committed transaction.
2025-08-31 10:11:00.781 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:11:00.781 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:11:00.782 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:11:00.783 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:11:00.786 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:11:00.788 +03:00 [DBG] Disposing transaction.
2025-08-31 10:11:00.790 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:00.793 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 10:11:00.795 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:11:00.796 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:00.797 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:11:00.799 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:11:00.800 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:11:00.821 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 10:11:00.849 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 10:11:00.851 +03:00 [DBG] Hosting starting
2025-08-31 10:11:00.862 +03:00 [DBG] Middleware loaded
2025-08-31 10:11:00.865 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 10:11:00.867 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 10:11:00.937 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 10:11:00.939 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 10:11:00.942 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 10:11:00.969 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 10:11:01.009 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 10:11:01.011 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 10:11:01.012 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 10:11:01.014 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 10:11:01.015 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 10:11:01.015 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 10:11:01.021 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:11:01.027 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:11:01.052 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 10:11:01.053 +03:00 [INF] Hosting environment: Development
2025-08-31 10:11:01.054 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 10:11:01.055 +03:00 [DBG] Hosting started
2025-08-31 10:11:05.640 +03:00 [DBG] Connection id "0HNF8BM6KG9UT" received FIN.
2025-08-31 10:11:05.657 +03:00 [DBG] Connection id "0HNF8BM6KG9UT" accepted.
2025-08-31 10:11:05.659 +03:00 [DBG] Connection id "0HNF8BM6KG9UT" started.
2025-08-31 10:11:05.661 +03:00 [DBG] Connection id "0HNF8BM6KG9UU" accepted.
2025-08-31 10:11:05.673 +03:00 [DBG] Connection id "0HNF8BM6KG9UU" started.
2025-08-31 10:11:05.679 +03:00 [DBG] Connection id "0HNF8BM6KG9UT" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:11:05.683 +03:00 [DBG] Connection id "0HNF8BM6KG9UT" disconnecting.
2025-08-31 10:11:05.688 +03:00 [DBG] Connection id "0HNF8BM6KG9UT" stopped.
2025-08-31 10:11:05.709 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 10:11:05.782 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:11:05.786 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:05.817 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 10:11:05.820 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 10:11:05.825 +03:00 [DBG] Connection id "0HNF8BM6KG9UU" completed keep alive response.
2025-08-31 10:11:05.827 +03:00 [DBG] Connection id "0HNF8BM6KG9UV" accepted.
2025-08-31 10:11:05.827 +03:00 [DBG] Connection id "0HNF8BM6KG9V0" accepted.
2025-08-31 10:11:05.827 +03:00 [DBG] Connection id "0HNF8BM6KG9UV" received FIN.
2025-08-31 10:11:05.854 +03:00 [DBG] Connection id "0HNF8BM6KG9UV" started.
2025-08-31 10:11:05.855 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 151.2163ms
2025-08-31 10:11:05.855 +03:00 [DBG] Connection id "0HNF8BM6KG9V0" started.
2025-08-31 10:11:05.858 +03:00 [DBG] Connection id "0HNF8BM6KG9UV" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:11:05.871 +03:00 [DBG] Connection id "0HNF8BM6KG9UV" disconnecting.
2025-08-31 10:11:05.872 +03:00 [DBG] Connection id "0HNF8BM6KG9UV" stopped.
2025-08-31 10:11:05.924 +03:00 [DBG] Connection 0HNF8BM6KG9V0 established using the following protocol: "Tls13"
2025-08-31 10:11:05.927 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 10:11:05.931 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:11:05.932 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:05.937 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:05.955 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:11:06.006 +03:00 [INF] Listing all profiles
2025-08-31 10:11:06.052 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()
    .OrderByDescending(p => p.CreatedUtc)'
2025-08-31 10:11:06.132 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:11:06.447 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:06.504 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: SQLite does not support expressions of type 'DateTimeOffset' in ORDER BY clauses. Convert the values to a supported type, or use LINQ to Objects to order the results on the client side.
   at Microsoft.EntityFrameworkCore.Sqlite.Query.Internal.SqliteQueryableMethodTranslatingExpressionVisitor.TranslateOrderBy(ShapedQueryExpression source, LambdaExpression keySelector, Boolean ascending)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ProfileRepository.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 70
   at NaturalToQuery.Application.Services.ProfileService.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 228
   at NaturalToQuery.Api.Controllers.Setup.GetAllProfiles.HandleAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\GetAllProfiles.cs:line 21
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 10:11:06.518 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 10:11:06.530 +03:00 [DBG] Connection id "0HNF8BM6KG9V0" completed keep alive response.
2025-08-31 10:11:06.533 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:11:06.536 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 500 null application/json; charset=utf-8 608.7837ms
2025-08-31 10:11:11.938 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 10:11:11.942 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:11:11.943 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:11.946 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 10:11:11.948 +03:00 [DBG] Connection id "0HNF8BM6KG9UU" completed keep alive response.
2025-08-31 10:11:11.950 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 12.4613ms
2025-08-31 10:11:11.951 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 10:11:11.957 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:11:11.958 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:11.959 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:11.969 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:11:13.978 +03:00 [INF] Listing all profiles
2025-08-31 10:11:13.981 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()
    .OrderByDescending(p => p.CreatedUtc)'
2025-08-31 10:11:13.986 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:11:31.114 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:11:31.154 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: SQLite does not support expressions of type 'DateTimeOffset' in ORDER BY clauses. Convert the values to a supported type, or use LINQ to Objects to order the results on the client side.
   at Microsoft.EntityFrameworkCore.Sqlite.Query.Internal.SqliteQueryableMethodTranslatingExpressionVisitor.TranslateOrderBy(ShapedQueryExpression source, LambdaExpression keySelector, Boolean ascending)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ProfileRepository.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 70
   at NaturalToQuery.Application.Services.ProfileService.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 228
   at NaturalToQuery.Api.Controllers.Setup.GetAllProfiles.HandleAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\GetAllProfiles.cs:line 21
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 10:11:31.163 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 10:11:31.165 +03:00 [DBG] Connection id "0HNF8BM6KG9V0" completed keep alive response.
2025-08-31 10:11:31.166 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:11:31.168 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 500 null application/json; charset=utf-8 19216.8033ms
2025-08-31 10:11:49.533 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - null null
2025-08-31 10:11:49.537 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 10:11:49.539 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 10:11:49.541 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 10:11:49.542 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 10:11:49.544 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:11:49.580 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 10:11:49.583 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:11:49.746 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 10:11:49.778 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:11:49.781 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 10:11:49.783 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:49.785 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:49.787 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:11:49.788 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:11:49.791 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 10:11:49.793 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:11:49.800 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:11:49.834 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:11:49.868 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:11:49.878 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:11:49.881 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:11:49.882 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:11:49.882 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:11:49.886 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:49.888 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 85ms reading results.
2025-08-31 10:11:49.890 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:49.892 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:11:49.894 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 10:11:49.897 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:49.898 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:49.899 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:11:49.900 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 10:11:49.901 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:11:49.902 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:11:49.904 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:11:49.906 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:49.906 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 10:11:49.908 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:11:49.909 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:11:49.935 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 10:11:49.948 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 10:11:49.949 +03:00 [DBG] Connection id "0HNF8BM6KG9V0" completed keep alive response.
2025-08-31 10:11:49.950 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:11:49.952 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:11:49.954 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:11:49.955 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - 200 null application/json; charset=utf-8 421.7153ms
2025-08-31 10:12:25.566 +03:00 [INF] This is a test log to file!
2025-08-31 10:12:25.904 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 10:12:25.912 +03:00 [INF] API configured successfully.
2025-08-31 10:12:26.003 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 10:12:26.054 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 10:12:26.626 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:12:26.661 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 10:12:26.680 +03:00 [INF] Registered 13 endpoints in 971 milliseconds.
2025-08-31 10:12:26.694 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:12:26.752 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:12:26.878 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:12:26.897 +03:00 [DBG] Created DbConnection. (17ms).
2025-08-31 10:12:26.902 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:26.907 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:12:26.910 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 10:12:26.912 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:26.924 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:26.936 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:26.952 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 10:12:26.956 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:26.960 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:26.964 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 10:12:26.970 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:12:26.976 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 10:12:26.978 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-08-31 10:12:26.984 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:12:27.007 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:12:27.011 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:12:27.012 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:12:27.013 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:12:27.014 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:12:27.0112483+00:00');
SELECT changes();
2025-08-31 10:12:27.019 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:12:27.0112483+00:00');
SELECT changes();
2025-08-31 10:12:27.078 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:12:27.084 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:12:27.087 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 10:12:27.089 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 10:12:27.092 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (4ms).
2025-08-31 10:12:27.095 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:12:27.098 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:12:27.102 +03:00 [DBG] Committing transaction.
2025-08-31 10:12:27.106 +03:00 [DBG] Committed transaction.
2025-08-31 10:12:27.108 +03:00 [DBG] Disposing transaction.
2025-08-31 10:12:27.111 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:12:27.113 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:12:27.116 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:12:27.117 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 10:12:27.118 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:27.120 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:27.122 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:27.124 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 10:12:27.127 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:12:27.129 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:12:27.130 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 10:12:27.132 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:12:27.134 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:12:27.138 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:12:27.140 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:12:27.141 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 10:12:27.143 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:12:27.146 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:12:27.153 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:27.158 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-08-31 10:12:27.164 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 10:12:27.165 +03:00 [DBG] Committing transaction.
2025-08-31 10:12:27.166 +03:00 [DBG] Committed transaction.
2025-08-31 10:12:27.167 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:12:27.168 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:12:27.169 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:12:27.170 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:12:27.177 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:12:27.179 +03:00 [DBG] Disposing transaction.
2025-08-31 10:12:27.182 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:27.186 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 10:12:27.188 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:12:27.190 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:27.191 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:12:27.193 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:12:27.194 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:12:27.234 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 10:12:27.279 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 10:12:27.282 +03:00 [DBG] Hosting starting
2025-08-31 10:12:27.302 +03:00 [DBG] Middleware loaded
2025-08-31 10:12:27.306 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 10:12:27.308 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 10:12:27.387 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 10:12:27.390 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 10:12:27.392 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 10:12:27.425 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 10:12:27.492 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 10:12:27.493 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 10:12:27.494 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 10:12:27.495 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 10:12:27.496 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 10:12:27.497 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 10:12:27.504 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:12:27.512 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:12:27.612 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 10:12:27.614 +03:00 [INF] Hosting environment: Development
2025-08-31 10:12:27.615 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 10:12:27.617 +03:00 [DBG] Hosting started
2025-08-31 10:12:28.094 +03:00 [DBG] Connection id "0HNF8BMV6R86U" received FIN.
2025-08-31 10:12:28.105 +03:00 [DBG] Connection id "0HNF8BMV6R86U" accepted.
2025-08-31 10:12:28.109 +03:00 [DBG] Connection id "0HNF8BMV6R86U" started.
2025-08-31 10:12:28.110 +03:00 [DBG] Connection id "0HNF8BMV6R86V" accepted.
2025-08-31 10:12:28.122 +03:00 [DBG] Connection id "0HNF8BMV6R86V" started.
2025-08-31 10:12:28.243 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-31 10:12:28.256 +03:00 [DBG] Connection id "0HNF8BMV6R86U" stopped.
2025-08-31 10:12:28.263 +03:00 [DBG] Connection id "0HNF8BMV6R86U" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:12:28.287 +03:00 [DBG] Connection 0HNF8BMV6R86V established using the following protocol: "Tls13"
2025-08-31 10:12:28.319 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - null null
2025-08-31 10:12:28.364 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 10:12:28.366 +03:00 [DBG] Endpoint 'HTTP: GET api/query/profile/{Id}' with route pattern 'api/query/profile/{Id}' is valid for the request path '/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 10:12:28.377 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 10:12:28.415 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 10:12:28.428 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:12:28.555 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 10:12:28.619 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:12:28.926 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 10:12:28.959 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:12:28.960 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 10:12:28.963 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:28.966 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:28.968 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:12:28.969 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:12:28.971 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 10:12:28.975 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:12:28.983 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:12:29.026 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:12:29.067 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:12:29.077 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:12:29.079 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:12:29.080 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:12:29.081 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:12:29.095 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:29.097 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 111ms reading results.
2025-08-31 10:12:29.106 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:29.113 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (13ms).
2025-08-31 10:12:29.116 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 10:12:29.119 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:29.123 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:29.124 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:12:29.125 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 10:12:29.127 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 10:12:29.128 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:12:29.131 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:12:29.134 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:29.135 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 10:12:29.137 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:12:29.139 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:12:29.154 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 10:12:29.182 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/profile/{Id}'
2025-08-31 10:12:29.194 +03:00 [DBG] Connection id "0HNF8BMV6R86V" completed keep alive response.
2025-08-31 10:12:29.197 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:12:29.201 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:12:29.218 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (17ms).
2025-08-31 10:12:29.221 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - 200 null application/json; charset=utf-8 907.4523ms
2025-08-31 10:12:32.915 +03:00 [DBG] Connection id "0HNF8BMV6R870" received FIN.
2025-08-31 10:12:32.918 +03:00 [DBG] Connection id "0HNF8BMV6R870" accepted.
2025-08-31 10:12:32.920 +03:00 [DBG] Connection id "0HNF8BMV6R870" started.
2025-08-31 10:12:32.921 +03:00 [DBG] Connection id "0HNF8BMV6R871" accepted.
2025-08-31 10:12:32.922 +03:00 [DBG] Connection id "0HNF8BMV6R870" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:12:32.923 +03:00 [DBG] Connection id "0HNF8BMV6R871" started.
2025-08-31 10:12:32.925 +03:00 [DBG] Connection id "0HNF8BMV6R870" disconnecting.
2025-08-31 10:12:32.927 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 10:12:32.928 +03:00 [DBG] Connection id "0HNF8BMV6R870" stopped.
2025-08-31 10:12:32.931 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:12:32.932 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:12:32.935 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 10:12:32.937 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 10:12:32.938 +03:00 [DBG] Connection id "0HNF8BMV6R871" completed keep alive response.
2025-08-31 10:12:32.939 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 12.7059ms
2025-08-31 10:12:32.942 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 10:12:32.945 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:12:32.946 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:12:32.948 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:12:32.959 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:12:32.973 +03:00 [INF] Listing all profiles
2025-08-31 10:12:32.979 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()
    .OrderByDescending(p => p.CreatedUtc)'
2025-08-31 10:12:32.983 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:12:33.134 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:12:33.177 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: SQLite does not support expressions of type 'DateTimeOffset' in ORDER BY clauses. Convert the values to a supported type, or use LINQ to Objects to order the results on the client side.
   at Microsoft.EntityFrameworkCore.Sqlite.Query.Internal.SqliteQueryableMethodTranslatingExpressionVisitor.TranslateOrderBy(ShapedQueryExpression source, LambdaExpression keySelector, Boolean ascending)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ProfileRepository.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 70
   at NaturalToQuery.Application.Services.ProfileService.ListAllAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 228
   at NaturalToQuery.Api.Controllers.Setup.GetAllProfiles.HandleAsync(CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\GetAllProfiles.cs:line 21
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 10:12:33.192 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 10:12:33.199 +03:00 [DBG] Connection id "0HNF8BMV6R86V" completed keep alive response.
2025-08-31 10:12:33.200 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:12:33.202 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 500 null application/json; charset=utf-8 260.1055ms
2025-08-31 10:13:13.030 +03:00 [INF] This is a test log to file!
2025-08-31 10:13:13.476 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 10:13:13.484 +03:00 [INF] API configured successfully.
2025-08-31 10:13:13.577 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 10:13:13.637 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 10:13:14.327 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:13:14.374 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 10:13:14.383 +03:00 [INF] Registered 13 endpoints in 1,136 milliseconds.
2025-08-31 10:13:14.390 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:13:14.432 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:13:14.532 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:13:14.543 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-31 10:13:14.547 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 10:13:14.550 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:13:14.552 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 10:13:14.554 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:13:14.563 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:13:14.566 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:13:14.570 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:13:14.571 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:13:14.573 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:13:14.575 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 10:13:14.579 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:13:14.584 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:13:14.585 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 10:13:14.591 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:13:14.609 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:13:14.613 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:13:14.613 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:13:14.614 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:13:14.615 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:13:14.612964+00:00');
SELECT changes();
2025-08-31 10:13:14.621 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:13:14.612964+00:00');
SELECT changes();
2025-08-31 10:13:14.664 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:13:14.669 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:13:14.672 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 10:13:14.673 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 10:13:14.674 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 10:13:14.675 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:13:14.677 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:13:14.679 +03:00 [DBG] Committing transaction.
2025-08-31 10:13:14.680 +03:00 [DBG] Committed transaction.
2025-08-31 10:13:14.682 +03:00 [DBG] Disposing transaction.
2025-08-31 10:13:14.684 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:13:14.685 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:13:14.687 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:13:14.688 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 10:13:14.689 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:13:14.690 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:13:14.691 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:13:14.692 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 10:13:14.693 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:13:14.694 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:13:14.695 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:13:14.696 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:13:14.698 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:13:14.700 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:13:14.701 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 10:13:14.702 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:13:14.703 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:13:14.705 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:13:14.709 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:13:14.711 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 10:13:14.715 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 10:13:14.716 +03:00 [DBG] Committing transaction.
2025-08-31 10:13:14.716 +03:00 [DBG] Committed transaction.
2025-08-31 10:13:14.717 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:13:14.717 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:13:14.718 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:13:14.719 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:13:14.724 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:13:14.725 +03:00 [DBG] Disposing transaction.
2025-08-31 10:13:14.727 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:13:14.729 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 10:13:14.730 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:13:14.731 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:13:14.732 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 10:13:14.733 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:13:14.733 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:13:14.754 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 10:13:14.779 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 10:13:14.780 +03:00 [DBG] Hosting starting
2025-08-31 10:13:14.792 +03:00 [DBG] Middleware loaded
2025-08-31 10:13:14.795 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 10:13:14.797 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 10:13:14.864 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 10:13:14.866 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 10:13:14.870 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 10:13:14.900 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 10:13:14.979 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 10:13:14.980 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 10:13:14.981 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 10:13:14.982 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 10:13:14.983 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 10:13:14.984 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 10:13:14.990 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:13:14.998 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:13:15.092 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 10:13:15.093 +03:00 [INF] Hosting environment: Development
2025-08-31 10:13:15.095 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 10:13:15.095 +03:00 [DBG] Hosting started
2025-08-31 10:14:17.430 +03:00 [DBG] Connection id "0HNF8BNVPI5AN" received FIN.
2025-08-31 10:14:17.441 +03:00 [DBG] Connection id "0HNF8BNVPI5AN" accepted.
2025-08-31 10:14:17.447 +03:00 [DBG] Connection id "0HNF8BNVPI5AN" started.
2025-08-31 10:14:17.449 +03:00 [DBG] Connection id "0HNF8BNVPI5AO" accepted.
2025-08-31 10:14:17.450 +03:00 [DBG] Connection id "0HNF8BNVPI5AO" started.
2025-08-31 10:14:17.454 +03:00 [DBG] Connection id "0HNF8BNVPI5AN" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:14:17.457 +03:00 [DBG] Connection id "0HNF8BNVPI5AN" disconnecting.
2025-08-31 10:14:17.459 +03:00 [DBG] Connection id "0HNF8BNVPI5AN" stopped.
2025-08-31 10:14:17.478 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 10:14:17.562 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:14:17.563 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:14:17.591 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 10:14:17.593 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 10:14:17.595 +03:00 [DBG] Connection id "0HNF8BNVPI5AO" completed keep alive response.
2025-08-31 10:14:17.597 +03:00 [DBG] Connection id "0HNF8BNVPI5AP" accepted.
2025-08-31 10:14:17.598 +03:00 [DBG] Connection id "0HNF8BNVPI5AP" received FIN.
2025-08-31 10:14:17.597 +03:00 [DBG] Connection id "0HNF8BNVPI5AQ" accepted.
2025-08-31 10:14:17.603 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 123.6111ms
2025-08-31 10:14:17.603 +03:00 [DBG] Connection id "0HNF8BNVPI5AP" started.
2025-08-31 10:14:17.604 +03:00 [DBG] Connection id "0HNF8BNVPI5AQ" started.
2025-08-31 10:14:17.609 +03:00 [DBG] Connection id "0HNF8BNVPI5AP" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:14:17.611 +03:00 [DBG] Connection id "0HNF8BNVPI5AP" disconnecting.
2025-08-31 10:14:17.612 +03:00 [DBG] Connection id "0HNF8BNVPI5AP" stopped.
2025-08-31 10:14:17.650 +03:00 [DBG] Connection 0HNF8BNVPI5AQ established using the following protocol: "Tls13"
2025-08-31 10:14:17.654 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 10:14:17.658 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 10:14:17.659 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:14:17.663 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:14:17.675 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:14:17.699 +03:00 [INF] Listing all profiles
2025-08-31 10:14:17.730 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()'
2025-08-31 10:14:17.781 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:14:17.974 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Profile>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
            3 -> 6
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
            3 -> 6
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Profile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Profile instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Profile);
                (object)dataReader.GetGuid(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                            {
                                return 
                                {
                                    Profile instance;
                                    instance = new Profile();
                                    instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                    instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                    instance.<Name>k__BackingField = dataReader.GetString(3);
                                    instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                    instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Profile)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetGuid(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (Profile)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                Query entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    Query instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(Query);
                    dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                {
                                    return 
                                    {
                                        Query instance;
                                        instance = new Query();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                        instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                        instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                        instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                        instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                        instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Query)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                    entity: namelessParameter{11}, 
                    value: namelessParameter{12}, 
                    forMaterialization: True);
                return namelessParameter{12}.<Profile>k__BackingField = namelessParameter{11};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (Profile)(resultContext.Values[0]) : default(Profile);
    }, 
    contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-08-31 10:14:18.002 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:14:18.004 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 10:14:18.007 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:14:18.009 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:14:18.011 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:14:18.012 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:14:18.013 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 10:14:18.015 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 10:14:18.019 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 10:14:18.039 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:14:18.041 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 19ms reading results.
2025-08-31 10:14:18.045 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:14:18.047 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 10:14:18.052 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 10:14:18.062 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 10:14:18.070 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 10:14:18.101 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 10:14:18.114 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:14:18.116 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:14:18.118 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:14:18.120 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-31 10:14:18.123 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-08-31 10:14:18.127 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:14:18.133 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 10:14:18.164 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:14:18.204 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:14:18.212 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:14:18.213 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:14:18.214 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:14:18.216 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 10:14:18.217 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:14:18.218 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 82ms reading results.
2025-08-31 10:14:18.219 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:14:18.220 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:14:18.230 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 10:14:18.255 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 10:14:18.256 +03:00 [DBG] Connection id "0HNF8BNVPI5AQ" completed keep alive response.
2025-08-31 10:14:18.258 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:14:18.262 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:14:18.264 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:14:18.267 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 612.4437ms
2025-08-31 10:40:31.126 +03:00 [INF] This is a test log to file!
2025-08-31 10:40:31.485 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 10:40:31.495 +03:00 [INF] API configured successfully.
2025-08-31 10:40:31.598 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 10:40:31.660 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 10:40:32.173 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:40:32.210 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 10:40:32.219 +03:00 [INF] Registered 13 endpoints in 943 milliseconds.
2025-08-31 10:40:32.226 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:40:32.260 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:40:32.389 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:40:32.431 +03:00 [DBG] Created DbConnection. (43ms).
2025-08-31 10:40:32.436 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 10:40:32.446 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:40:32.451 +03:00 [DBG] Created DbConnection. (6ms).
2025-08-31 10:40:32.455 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:40:32.473 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:40:32.477 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:40:32.482 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 10:40:32.484 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:40:32.486 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:40:32.488 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 10:40:32.492 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:40:32.497 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 10:40:32.499 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 10:40:32.505 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:40:32.529 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 10:40:32.533 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:40:32.534 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 10:40:32.535 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:40:32.537 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:40:32.5336444+00:00');
SELECT changes();
2025-08-31 10:40:32.542 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 07:40:32.5336444+00:00');
SELECT changes();
2025-08-31 10:40:32.592 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:40:32.598 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:40:32.602 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 10:40:32.604 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 10:40:32.606 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (4ms).
2025-08-31 10:40:32.609 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:40:32.613 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 10:40:32.618 +03:00 [DBG] Committing transaction.
2025-08-31 10:40:32.622 +03:00 [DBG] Committed transaction.
2025-08-31 10:40:32.627 +03:00 [DBG] Disposing transaction.
2025-08-31 10:40:32.632 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 10:40:32.634 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 10:40:32.639 +03:00 [DBG] Creating DbConnection.
2025-08-31 10:40:32.641 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 10:40:32.642 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:40:32.645 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:40:32.648 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:40:32.650 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:40:32.653 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:40:32.654 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:40:32.656 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 10:40:32.658 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:40:32.660 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 10:40:32.665 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 10:40:32.666 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 10:40:32.668 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 10:40:32.671 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:40:32.673 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 10:40:32.678 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:40:32.681 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 10:40:32.687 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 10:40:32.689 +03:00 [DBG] Committing transaction.
2025-08-31 10:40:32.690 +03:00 [DBG] Committed transaction.
2025-08-31 10:40:32.691 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 10:40:32.692 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 10:40:32.693 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 10:40:32.694 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:40:32.698 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 10:40:32.701 +03:00 [DBG] Disposing transaction.
2025-08-31 10:40:32.703 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 10:40:32.707 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (5ms).
2025-08-31 10:40:32.709 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:40:32.710 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 10:40:32.711 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 10:40:32.713 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:40:32.714 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 10:40:32.743 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 10:40:32.781 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 10:40:32.783 +03:00 [DBG] Hosting starting
2025-08-31 10:40:32.797 +03:00 [DBG] Middleware loaded
2025-08-31 10:40:32.801 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 10:40:32.803 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 10:40:32.892 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 10:40:32.894 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 10:40:32.898 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 10:40:32.932 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 10:40:32.974 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 10:40:32.975 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 10:40:32.976 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 10:40:32.977 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 10:40:32.978 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 10:40:32.979 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 10:40:32.986 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:40:32.995 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 10:40:33.120 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 10:40:33.121 +03:00 [INF] Hosting environment: Development
2025-08-31 10:40:33.122 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 10:40:33.123 +03:00 [DBG] Hosting started
2025-08-31 10:40:34.668 +03:00 [DBG] Connection id "0HNF8C6LR8QE3" received FIN.
2025-08-31 10:40:34.675 +03:00 [DBG] Connection id "0HNF8C6LR8QE3" accepted.
2025-08-31 10:40:34.678 +03:00 [DBG] Connection id "0HNF8C6LR8QE3" started.
2025-08-31 10:40:34.680 +03:00 [DBG] Connection id "0HNF8C6LR8QE4" accepted.
2025-08-31 10:40:34.685 +03:00 [DBG] Connection id "0HNF8C6LR8QE4" started.
2025-08-31 10:40:34.691 +03:00 [DBG] Connection id "0HNF8C6LR8QE3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:40:34.695 +03:00 [DBG] Connection id "0HNF8C6LR8QE3" disconnecting.
2025-08-31 10:40:34.699 +03:00 [DBG] Connection id "0HNF8C6LR8QE3" stopped.
2025-08-31 10:40:34.721 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/test/SqlServer - application/json 179
2025-08-31 10:40:34.772 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:34.779 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:34.782 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:34.829 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 10:40:34.843 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-08-31 10:40:34.846 +03:00 [DBG] Connection id "0HNF8C6LR8QE4" completed keep alive response.
2025-08-31 10:40:34.850 +03:00 [DBG] Connection id "0HNF8C6LR8QE5" received FIN.
2025-08-31 10:40:34.852 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/test/SqlServer - 307 0 null 134.8121ms
2025-08-31 10:40:34.850 +03:00 [DBG] Connection id "0HNF8C6LR8QE6" accepted.
2025-08-31 10:40:34.852 +03:00 [DBG] Connection id "0HNF8C6LR8QE5" accepted.
2025-08-31 10:40:34.859 +03:00 [DBG] Connection id "0HNF8C6LR8QE6" started.
2025-08-31 10:40:34.859 +03:00 [DBG] Connection id "0HNF8C6LR8QE4", Request id "0HNF8C6LR8QE4:00000001": started reading request body.
2025-08-31 10:40:34.860 +03:00 [DBG] Connection id "0HNF8C6LR8QE5" started.
2025-08-31 10:40:34.863 +03:00 [DBG] Connection id "0HNF8C6LR8QE4", Request id "0HNF8C6LR8QE4:00000001": done reading request body.
2025-08-31 10:40:34.864 +03:00 [DBG] Connection id "0HNF8C6LR8QE5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 10:40:34.867 +03:00 [DBG] Connection id "0HNF8C6LR8QE5" disconnecting.
2025-08-31 10:40:34.868 +03:00 [DBG] Connection id "0HNF8C6LR8QE5" stopped.
2025-08-31 10:40:34.902 +03:00 [DBG] Connection 0HNF8C6LR8QE6 established using the following protocol: "Tls13"
2025-08-31 10:40:34.911 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - application/json 179
2025-08-31 10:40:34.916 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:34.927 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:34.929 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:34.935 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:34.954 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:40:35.030 +03:00 [DBG] Connection id "0HNF8C6LR8QE6", Request id "0HNF8C6LR8QE6:00000001": started reading request body.
2025-08-31 10:40:35.032 +03:00 [DBG] Connection id "0HNF8C6LR8QE6", Request id "0HNF8C6LR8QE6:00000001": done reading request body.
2025-08-31 10:40:35.094 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\\SQLEXPRESS, Database=ProductInventory)
2025-08-31 10:40:35.414 +03:00 [DBG] Failed to connect ConnectionString: Data Source=DESKTOP-QCK8UI5\\SQLEXPRESS;Initial Catalog=ProductInventory;Integrated Security=True;Connect Timeout=15;Trust Server Certificate=True
2025-08-31 10:40:35.425 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:35.428 +03:00 [DBG] Connection id "0HNF8C6LR8QE6" completed keep alive response.
2025-08-31 10:40:35.431 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:40:35.434 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 522.5426ms
2025-08-31 10:40:41.794 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/test/SqlServer - application/json 177
2025-08-31 10:40:41.797 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:41.798 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:41.799 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:41.814 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/test/SqlServer'.
2025-08-31 10:40:41.816 +03:00 [DBG] Connection id "0HNF8C6LR8QE4" completed keep alive response.
2025-08-31 10:40:41.828 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/test/SqlServer - 307 0 null 23.3619ms
2025-08-31 10:40:41.829 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - application/json 177
2025-08-31 10:40:41.831 +03:00 [DBG] Connection id "0HNF8C6LR8QE4", Request id "0HNF8C6LR8QE4:00000002": started reading request body.
2025-08-31 10:40:41.838 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:41.840 +03:00 [DBG] Connection id "0HNF8C6LR8QE4", Request id "0HNF8C6LR8QE4:00000002": done reading request body.
2025-08-31 10:40:41.842 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/test/{ProviderType}' with route pattern 'api/setup/test/{ProviderType}' is valid for the request path '/api/setup/test/SqlServer'
2025-08-31 10:40:41.844 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:41.845 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:41.857 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 10:40:41.859 +03:00 [DBG] Connection id "0HNF8C6LR8QE6", Request id "0HNF8C6LR8QE6:00000002": started reading request body.
2025-08-31 10:40:41.861 +03:00 [DBG] Connection id "0HNF8C6LR8QE6", Request id "0HNF8C6LR8QE6:00000002": done reading request body.
2025-08-31 10:40:41.863 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 10:40:41.951 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 10:40:41.956 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/test/{ProviderType}'
2025-08-31 10:40:41.958 +03:00 [DBG] Connection id "0HNF8C6LR8QE6" completed keep alive response.
2025-08-31 10:40:41.959 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 10:40:41.961 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/test/SqlServer - 200 null application/json; charset=utf-8 131.3451ms
2025-08-31 11:54:33.894 +03:00 [INF] This is a test log to file!
2025-08-31 11:54:34.198 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 11:54:34.207 +03:00 [INF] API configured successfully.
2025-08-31 11:54:34.300 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 11:54:34.382 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 11:54:34.976 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 11:54:35.019 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 11:54:35.028 +03:00 [INF] Registered 13 endpoints in 1,009 milliseconds.
2025-08-31 11:54:35.036 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 11:54:35.087 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 11:54:35.205 +03:00 [DBG] Creating DbConnection.
2025-08-31 11:54:35.220 +03:00 [DBG] Created DbConnection. (12ms).
2025-08-31 11:54:35.230 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 11:54:35.235 +03:00 [DBG] Creating DbConnection.
2025-08-31 11:54:35.239 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 11:54:35.240 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 11:54:35.261 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 11:54:35.269 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 11:54:35.274 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 11:54:35.276 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 11:54:35.278 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 11:54:35.289 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 11:54:35.293 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 11:54:35.300 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 11:54:35.302 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-08-31 11:54:35.314 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 11:54:35.342 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 11:54:35.345 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 11:54:35.346 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 11:54:35.347 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 11:54:35.348 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 08:54:35.3455085+00:00');
SELECT changes();
2025-08-31 11:54:35.353 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 08:54:35.3455085+00:00');
SELECT changes();
2025-08-31 11:54:35.401 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 11:54:35.406 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 11:54:35.410 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 11:54:35.422 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (12ms).
2025-08-31 11:54:35.424 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (14ms).
2025-08-31 11:54:35.426 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 11:54:35.428 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 11:54:35.431 +03:00 [DBG] Committing transaction.
2025-08-31 11:54:35.434 +03:00 [DBG] Committed transaction.
2025-08-31 11:54:35.449 +03:00 [DBG] Disposing transaction.
2025-08-31 11:54:35.452 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 11:54:35.453 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 11:54:35.456 +03:00 [DBG] Creating DbConnection.
2025-08-31 11:54:35.457 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 11:54:35.474 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 11:54:35.476 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 11:54:35.477 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 11:54:35.479 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 11:54:35.480 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 11:54:35.481 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 11:54:35.482 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 11:54:35.483 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 11:54:35.488 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 11:54:35.495 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 11:54:35.496 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 11:54:35.498 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 11:54:35.499 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 11:54:35.502 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 11:54:35.507 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 11:54:35.510 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 11:54:35.515 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 11:54:35.516 +03:00 [DBG] Committing transaction.
2025-08-31 11:54:35.517 +03:00 [DBG] Committed transaction.
2025-08-31 11:54:35.518 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 11:54:35.519 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 11:54:35.520 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 11:54:35.521 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 11:54:35.530 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 11:54:35.532 +03:00 [DBG] Disposing transaction.
2025-08-31 11:54:35.534 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 11:54:35.541 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (7ms).
2025-08-31 11:54:35.543 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 11:54:35.544 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 11:54:35.546 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 11:54:35.548 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 11:54:35.549 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 11:54:35.580 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 11:54:35.618 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 11:54:35.620 +03:00 [DBG] Hosting starting
2025-08-31 11:54:35.635 +03:00 [DBG] Middleware loaded
2025-08-31 11:54:35.641 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 11:54:35.643 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 11:54:35.729 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 11:54:35.731 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 11:54:35.734 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 11:54:35.785 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 11:54:35.832 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 11:54:35.833 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 11:54:35.834 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 11:54:35.835 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 11:54:35.836 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 11:54:35.837 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 11:54:35.843 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 11:54:35.855 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 11:54:35.887 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 11:54:35.888 +03:00 [INF] Hosting environment: Development
2025-08-31 11:54:35.889 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 11:54:35.890 +03:00 [DBG] Hosting started
2025-08-31 11:55:12.294 +03:00 [DBG] Connection id "0HNF8DGC982FH" received FIN.
2025-08-31 11:55:12.305 +03:00 [DBG] Connection id "0HNF8DGC982FH" accepted.
2025-08-31 11:55:12.332 +03:00 [DBG] Connection id "0HNF8DGC982FH" started.
2025-08-31 11:55:12.333 +03:00 [DBG] Connection id "0HNF8DGC982FI" accepted.
2025-08-31 11:55:12.334 +03:00 [DBG] Connection id "0HNF8DGC982FI" started.
2025-08-31 11:55:12.338 +03:00 [DBG] Connection id "0HNF8DGC982FH" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 11:55:12.341 +03:00 [DBG] Connection id "0HNF8DGC982FH" disconnecting.
2025-08-31 11:55:12.342 +03:00 [DBG] Connection id "0HNF8DGC982FH" stopped.
2025-08-31 11:55:12.359 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 176
2025-08-31 11:55:12.416 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 11:55:12.419 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 11:55:12.440 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 11:55:12.441 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 11:55:12.443 +03:00 [DBG] Connection id "0HNF8DGC982FI" completed keep alive response.
2025-08-31 11:55:12.446 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 90.1271ms
2025-08-31 11:55:12.447 +03:00 [DBG] Connection id "0HNF8DGC982FJ" accepted.
2025-08-31 11:55:12.447 +03:00 [DBG] Connection id "0HNF8DGC982FK" accepted.
2025-08-31 11:55:12.448 +03:00 [DBG] Connection id "0HNF8DGC982FJ" received FIN.
2025-08-31 11:55:12.456 +03:00 [DBG] Connection id "0HNF8DGC982FJ" started.
2025-08-31 11:55:12.456 +03:00 [DBG] Connection id "0HNF8DGC982FI", Request id "0HNF8DGC982FI:00000001": started reading request body.
2025-08-31 11:55:12.457 +03:00 [DBG] Connection id "0HNF8DGC982FK" started.
2025-08-31 11:55:12.458 +03:00 [DBG] Connection id "0HNF8DGC982FJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 11:55:12.459 +03:00 [DBG] Connection id "0HNF8DGC982FI", Request id "0HNF8DGC982FI:00000001": done reading request body.
2025-08-31 11:55:12.461 +03:00 [DBG] Connection id "0HNF8DGC982FJ" disconnecting.
2025-08-31 11:55:12.462 +03:00 [DBG] Connection id "0HNF8DGC982FJ" stopped.
2025-08-31 11:55:12.491 +03:00 [DBG] Connection 0HNF8DGC982FK established using the following protocol: "Tls13"
2025-08-31 11:55:12.494 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 176
2025-08-31 11:55:12.496 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 11:55:12.498 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 11:55:12.501 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 11:55:12.519 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 11:55:12.565 +03:00 [DBG] Connection id "0HNF8DGC982FK", Request id "0HNF8DGC982FK:00000001": started reading request body.
2025-08-31 11:55:12.566 +03:00 [DBG] Connection id "0HNF8DGC982FK", Request id "0HNF8DGC982FK:00000001": done reading request body.
2025-08-31 11:55:14.833 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 11:55:16.765 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 11:55:17.107 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 11:55:25.070 +03:00 [DBG] Saved secret profile-356e25fc-5214-4b19-8414-0eeae292e246 for provider "SqlServer"
2025-08-31 11:55:27.612 +03:00 [DBG] Generated profile name SqlServer - MyAppDb with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 12:05:19.918 +03:00 [INF] This is a test log to file!
2025-08-31 12:05:20.217 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 12:05:20.226 +03:00 [INF] API configured successfully.
2025-08-31 12:05:20.341 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:05:20.493 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:05:21.179 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:05:21.210 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 12:05:21.221 +03:00 [INF] Registered 13 endpoints in 1,184 milliseconds.
2025-08-31 12:05:21.229 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:05:21.274 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:05:21.375 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:05:21.386 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-31 12:05:21.389 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 12:05:21.393 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:05:21.396 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 12:05:21.399 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:05:21.409 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:05:21.412 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:05:21.416 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:05:21.418 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:05:21.421 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:05:21.429 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 12:05:21.434 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:05:21.443 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (5ms).
2025-08-31 12:05:21.446 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (12ms).
2025-08-31 12:05:21.451 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:05:21.480 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:05:21.483 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:05:21.484 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:05:21.486 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:05:21.487 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:05:21.4834068+00:00');
SELECT changes();
2025-08-31 12:05:21.493 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:05:21.4834068+00:00');
SELECT changes();
2025-08-31 12:05:21.534 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:05:21.537 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:05:21.539 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 12:05:21.540 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:05:21.542 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 12:05:21.544 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:05:21.551 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:05:21.554 +03:00 [DBG] Committing transaction.
2025-08-31 12:05:21.555 +03:00 [DBG] Committed transaction.
2025-08-31 12:05:21.557 +03:00 [DBG] Disposing transaction.
2025-08-31 12:05:21.560 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:05:21.570 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:05:21.572 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:05:21.572 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:05:21.573 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:05:21.574 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:05:21.575 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:05:21.576 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:05:21.587 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:05:21.588 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:05:21.589 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:05:21.589 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:05:21.591 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:05:21.593 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:05:21.594 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:05:21.594 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:05:21.595 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:05:21.597 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:05:21.600 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:05:21.602 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 12:05:21.606 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 12:05:21.609 +03:00 [DBG] Committing transaction.
2025-08-31 12:05:21.611 +03:00 [DBG] Committed transaction.
2025-08-31 12:05:21.613 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:05:21.615 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:05:21.616 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 12:05:21.618 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:05:21.623 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:05:21.624 +03:00 [DBG] Disposing transaction.
2025-08-31 12:05:21.625 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:05:21.628 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 12:05:21.630 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:05:21.631 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:05:21.632 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:05:21.634 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:05:21.635 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:05:21.661 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 12:05:21.691 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 12:05:21.693 +03:00 [DBG] Hosting starting
2025-08-31 12:05:21.709 +03:00 [DBG] Middleware loaded
2025-08-31 12:05:21.712 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 12:05:21.713 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 12:05:21.796 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 12:05:21.798 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 12:05:21.801 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 12:05:21.832 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 12:05:21.870 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 12:05:21.872 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 12:05:21.872 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 12:05:21.873 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 12:05:21.873 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 12:05:21.874 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 12:05:21.882 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:05:21.890 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:05:22.001 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 12:05:22.002 +03:00 [INF] Hosting environment: Development
2025-08-31 12:05:22.003 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 12:05:22.004 +03:00 [DBG] Hosting started
2025-08-31 12:06:02.466 +03:00 [DBG] Connection id "0HNF8DME1ONO0" received FIN.
2025-08-31 12:06:02.478 +03:00 [DBG] Connection id "0HNF8DME1ONO0" accepted.
2025-08-31 12:06:02.526 +03:00 [DBG] Connection id "0HNF8DME1ONO0" started.
2025-08-31 12:06:02.527 +03:00 [DBG] Connection id "0HNF8DME1ONO1" accepted.
2025-08-31 12:06:02.529 +03:00 [DBG] Connection id "0HNF8DME1ONO1" started.
2025-08-31 12:06:02.532 +03:00 [DBG] Connection id "0HNF8DME1ONO0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:06:02.535 +03:00 [DBG] Connection id "0HNF8DME1ONO0" disconnecting.
2025-08-31 12:06:02.538 +03:00 [DBG] Connection id "0HNF8DME1ONO0" stopped.
2025-08-31 12:06:02.558 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 176
2025-08-31 12:06:02.602 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:06:02.603 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:02.622 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 12:06:02.625 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 12:06:02.628 +03:00 [DBG] Connection id "0HNF8DME1ONO1" completed keep alive response.
2025-08-31 12:06:02.631 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 77.2655ms
2025-08-31 12:06:02.631 +03:00 [DBG] Connection id "0HNF8DME1ONO2" accepted.
2025-08-31 12:06:02.632 +03:00 [DBG] Connection id "0HNF8DME1ONO2" received FIN.
2025-08-31 12:06:02.632 +03:00 [DBG] Connection id "0HNF8DME1ONO3" accepted.
2025-08-31 12:06:02.641 +03:00 [DBG] Connection id "0HNF8DME1ONO2" started.
2025-08-31 12:06:02.641 +03:00 [DBG] Connection id "0HNF8DME1ONO1", Request id "0HNF8DME1ONO1:00000001": started reading request body.
2025-08-31 12:06:02.642 +03:00 [DBG] Connection id "0HNF8DME1ONO3" started.
2025-08-31 12:06:02.643 +03:00 [DBG] Connection id "0HNF8DME1ONO2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:06:02.644 +03:00 [DBG] Connection id "0HNF8DME1ONO1", Request id "0HNF8DME1ONO1:00000001": done reading request body.
2025-08-31 12:06:02.645 +03:00 [DBG] Connection id "0HNF8DME1ONO2" disconnecting.
2025-08-31 12:06:02.647 +03:00 [DBG] Connection id "0HNF8DME1ONO2" stopped.
2025-08-31 12:06:02.673 +03:00 [DBG] Connection 0HNF8DME1ONO3 established using the following protocol: "Tls13"
2025-08-31 12:06:02.675 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 176
2025-08-31 12:06:02.678 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:06:02.679 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:02.682 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:02.693 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:06:02.727 +03:00 [DBG] Connection id "0HNF8DME1ONO3", Request id "0HNF8DME1ONO3:00000001": started reading request body.
2025-08-31 12:06:02.729 +03:00 [DBG] Connection id "0HNF8DME1ONO3", Request id "0HNF8DME1ONO3:00000001": done reading request body.
2025-08-31 12:06:04.866 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 12:06:04.876 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:06:05.151 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:06:05.184 +03:00 [DBG] Saved secret profile-f9571a2e-e53e-4558-9759-c4a5d31fc767 for provider "SqlServer"
2025-08-31 12:06:05.186 +03:00 [DBG] Generated profile name SqlServer - MyAppDb with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 12:06:05.248 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => ProfileRepository.ExtractDbName(p.Name) == __targetDbName_0)'
2025-08-31 12:06:05.505 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:05.635 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<Profile>()
    .Any(p => ProfileRepository.ExtractDbName(p.Name) == __targetDbName_0)' could not be translated. Additional information: Translation of method 'ProfileRepository.ExtractDbName' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.AnyAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 33
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 56
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 12:06:05.667 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 12:06:05.679 +03:00 [DBG] Connection id "0HNF8DME1ONO3" completed keep alive response.
2025-08-31 12:06:05.686 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:06:05.690 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 3014.535ms
2025-08-31 12:06:22.032 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 176
2025-08-31 12:06:22.034 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:06:22.035 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:22.037 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 12:06:22.038 +03:00 [DBG] Connection id "0HNF8DME1ONO1" completed keep alive response.
2025-08-31 12:06:22.039 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 7.199ms
2025-08-31 12:06:22.041 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 176
2025-08-31 12:06:22.042 +03:00 [DBG] Connection id "0HNF8DME1ONO1", Request id "0HNF8DME1ONO1:00000002": started reading request body.
2025-08-31 12:06:22.044 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:06:22.044 +03:00 [DBG] Connection id "0HNF8DME1ONO1", Request id "0HNF8DME1ONO1:00000002": done reading request body.
2025-08-31 12:06:22.045 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:22.047 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:22.057 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:06:22.060 +03:00 [DBG] Connection id "0HNF8DME1ONO3", Request id "0HNF8DME1ONO3:00000002": started reading request body.
2025-08-31 12:06:22.061 +03:00 [DBG] Connection id "0HNF8DME1ONO3", Request id "0HNF8DME1ONO3:00000002": done reading request body.
2025-08-31 12:06:22.062 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 12:06:25.707 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:06:25.710 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:06:26.787 +03:00 [DBG] Saved secret profile-4c31300f-60d9-47ae-8160-8e82501c2756 for provider "SqlServer"
2025-08-31 12:06:27.694 +03:00 [DBG] Generated profile name SqlServer - MyAppDb with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 12:06:35.217 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => ProfileRepository.ExtractDbName(p.Name) == __targetDbName_0)'
2025-08-31 12:06:38.584 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:06:38.644 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<Profile>()
    .Any(p => ProfileRepository.ExtractDbName(p.Name) == __targetDbName_0)' could not be translated. Additional information: Translation of method 'ProfileRepository.ExtractDbName' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.AnyAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 33
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 56
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 12:06:38.651 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 12:06:38.653 +03:00 [DBG] Connection id "0HNF8DME1ONO3" completed keep alive response.
2025-08-31 12:06:38.654 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:06:38.655 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 16614.4612ms
2025-08-31 12:07:17.091 +03:00 [INF] This is a test log to file!
2025-08-31 12:07:17.428 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 12:07:17.437 +03:00 [INF] API configured successfully.
2025-08-31 12:07:17.554 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:07:17.643 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:07:18.212 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:07:18.243 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 12:07:18.251 +03:00 [INF] Registered 13 endpoints in 1,035 milliseconds.
2025-08-31 12:07:18.260 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:07:18.322 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:07:18.419 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:07:18.430 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 12:07:18.436 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 12:07:18.443 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:07:18.446 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 12:07:18.450 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:07:18.468 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:07:18.472 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:07:18.482 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (7ms).
2025-08-31 12:07:18.483 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:07:18.486 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:07:18.490 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 12:07:18.504 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:07:18.510 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (4ms).
2025-08-31 12:07:18.512 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-08-31 12:07:18.518 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:07:18.548 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:07:18.552 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:07:18.552 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:07:18.554 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:07:18.556 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:07:18.5518826+00:00');
SELECT changes();
2025-08-31 12:07:18.562 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:07:18.5518826+00:00');
SELECT changes();
2025-08-31 12:07:18.623 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:07:18.629 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:07:18.649 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 12:07:18.651 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 12:07:18.653 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (4ms).
2025-08-31 12:07:18.656 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:07:18.661 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:07:18.665 +03:00 [DBG] Committing transaction.
2025-08-31 12:07:18.668 +03:00 [DBG] Committed transaction.
2025-08-31 12:07:18.670 +03:00 [DBG] Disposing transaction.
2025-08-31 12:07:18.672 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:07:18.673 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:07:18.683 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:07:18.687 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 12:07:18.688 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:07:18.690 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:07:18.693 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:07:18.696 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 12:07:18.698 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:07:18.699 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:07:18.701 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:07:18.702 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:07:18.704 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:07:18.709 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:07:18.711 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:07:18.714 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-08-31 12:07:18.716 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:07:18.719 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:07:18.724 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:07:18.727 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 12:07:18.733 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 12:07:18.734 +03:00 [DBG] Committing transaction.
2025-08-31 12:07:18.735 +03:00 [DBG] Committed transaction.
2025-08-31 12:07:18.736 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:07:18.737 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:07:18.738 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:07:18.739 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:07:18.750 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:07:18.753 +03:00 [DBG] Disposing transaction.
2025-08-31 12:07:18.755 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:07:18.758 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 12:07:18.759 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:07:18.760 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:07:18.772 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (12ms).
2025-08-31 12:07:18.774 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:07:18.775 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:07:18.799 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 12:07:18.836 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 12:07:18.837 +03:00 [DBG] Hosting starting
2025-08-31 12:07:18.857 +03:00 [DBG] Middleware loaded
2025-08-31 12:07:18.861 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 12:07:18.863 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 12:07:19.004 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 12:07:19.005 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 12:07:19.008 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 12:07:19.061 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 12:07:19.143 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 12:07:19.145 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 12:07:19.146 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 12:07:19.147 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 12:07:19.151 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 12:07:19.153 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 12:07:19.166 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:07:19.176 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:07:19.292 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 12:07:19.293 +03:00 [INF] Hosting environment: Development
2025-08-31 12:07:19.294 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 12:07:19.296 +03:00 [DBG] Hosting started
2025-08-31 12:07:31.625 +03:00 [DBG] Connection id "0HNF8DN8K217M" received FIN.
2025-08-31 12:07:31.631 +03:00 [DBG] Connection id "0HNF8DN8K217M" accepted.
2025-08-31 12:07:31.634 +03:00 [DBG] Connection id "0HNF8DN8K217M" started.
2025-08-31 12:07:31.635 +03:00 [DBG] Connection id "0HNF8DN8K217N" accepted.
2025-08-31 12:07:31.638 +03:00 [DBG] Connection id "0HNF8DN8K217N" started.
2025-08-31 12:07:31.641 +03:00 [DBG] Connection id "0HNF8DN8K217M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:07:31.644 +03:00 [DBG] Connection id "0HNF8DN8K217M" disconnecting.
2025-08-31 12:07:31.647 +03:00 [DBG] Connection id "0HNF8DN8K217M" stopped.
2025-08-31 12:07:31.663 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 176
2025-08-31 12:07:31.697 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:07:31.700 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:07:31.723 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 12:07:31.726 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 12:07:31.728 +03:00 [DBG] Connection id "0HNF8DN8K217N" completed keep alive response.
2025-08-31 12:07:31.731 +03:00 [DBG] Connection id "0HNF8DN8K217O" accepted.
2025-08-31 12:07:31.732 +03:00 [DBG] Connection id "0HNF8DN8K217O" received FIN.
2025-08-31 12:07:31.732 +03:00 [DBG] Connection id "0HNF8DN8K217P" accepted.
2025-08-31 12:07:31.731 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 72.0599ms
2025-08-31 12:07:31.737 +03:00 [DBG] Connection id "0HNF8DN8K217O" started.
2025-08-31 12:07:31.745 +03:00 [DBG] Connection id "0HNF8DN8K217P" started.
2025-08-31 12:07:31.751 +03:00 [DBG] Connection id "0HNF8DN8K217O" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:07:31.751 +03:00 [DBG] Connection id "0HNF8DN8K217N", Request id "0HNF8DN8K217N:00000001": started reading request body.
2025-08-31 12:07:31.752 +03:00 [DBG] Connection id "0HNF8DN8K217O" disconnecting.
2025-08-31 12:07:31.754 +03:00 [DBG] Connection id "0HNF8DN8K217N", Request id "0HNF8DN8K217N:00000001": done reading request body.
2025-08-31 12:07:31.755 +03:00 [DBG] Connection id "0HNF8DN8K217O" stopped.
2025-08-31 12:07:31.786 +03:00 [DBG] Connection 0HNF8DN8K217P established using the following protocol: "Tls13"
2025-08-31 12:07:31.789 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 176
2025-08-31 12:07:31.793 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:07:31.794 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:07:31.800 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:07:31.813 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:07:31.856 +03:00 [DBG] Connection id "0HNF8DN8K217P", Request id "0HNF8DN8K217P:00000001": started reading request body.
2025-08-31 12:07:31.858 +03:00 [DBG] Connection id "0HNF8DN8K217P", Request id "0HNF8DN8K217P:00000001": done reading request body.
2025-08-31 12:07:31.886 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 12:07:31.895 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:07:32.112 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:07:32.144 +03:00 [DBG] Saved secret profile-4e908a41-82ac-4180-96ec-564d588b4394 for provider "SqlServer"
2025-08-31 12:07:32.147 +03:00 [DBG] Generated profile name SqlServer - MyAppDb with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 12:07:37.623 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => ProfileRepository.ExtractDbName(p.Name).Equals(__targetDbName_0))'
2025-08-31 12:07:40.041 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:07:40.149 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<Profile>()
    .Any(p => ProfileRepository.ExtractDbName(p.Name).Equals(__targetDbName_0))' could not be translated. Additional information: Translation of method 'ProfileRepository.ExtractDbName' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.AnyAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 33
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 56
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 12:07:40.167 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 12:07:40.180 +03:00 [DBG] Connection id "0HNF8DN8K217P" completed keep alive response.
2025-08-31 12:07:40.182 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:07:40.186 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 8396.4228ms
2025-08-31 12:08:54.697 +03:00 [INF] This is a test log to file!
2025-08-31 12:08:55.101 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 12:08:55.112 +03:00 [INF] API configured successfully.
2025-08-31 12:08:55.212 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:08:55.273 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:08:55.821 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:08:55.855 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 12:08:55.882 +03:00 [INF] Registered 13 endpoints in 1,072 milliseconds.
2025-08-31 12:08:55.889 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:08:55.936 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:08:56.032 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:08:56.041 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 12:08:56.044 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 12:08:56.048 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:08:56.050 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 12:08:56.051 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:08:56.059 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:08:56.063 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:08:56.066 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:08:56.067 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:08:56.070 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:08:56.072 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 12:08:56.076 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:08:56.080 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:08:56.082 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 12:08:56.087 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:08:56.109 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:08:56.112 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:08:56.113 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:08:56.114 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:08:56.115 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:08:56.1125961+00:00');
SELECT changes();
2025-08-31 12:08:56.120 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:08:56.1125961+00:00');
SELECT changes();
2025-08-31 12:08:56.157 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:08:56.161 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:08:56.163 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 12:08:56.164 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:08:56.166 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 12:08:56.167 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:08:56.168 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:08:56.171 +03:00 [DBG] Committing transaction.
2025-08-31 12:08:56.172 +03:00 [DBG] Committed transaction.
2025-08-31 12:08:56.173 +03:00 [DBG] Disposing transaction.
2025-08-31 12:08:56.175 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:08:56.175 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:08:56.177 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:08:56.178 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:08:56.178 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:08:56.179 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:08:56.180 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:08:56.181 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:08:56.182 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:08:56.183 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:08:56.184 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:08:56.184 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:08:56.185 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:08:56.188 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:08:56.188 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:08:56.189 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:08:56.190 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:08:56.192 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:08:56.196 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:08:56.197 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 12:08:56.201 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 12:08:56.201 +03:00 [DBG] Committing transaction.
2025-08-31 12:08:56.202 +03:00 [DBG] Committed transaction.
2025-08-31 12:08:56.203 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:08:56.203 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:08:56.204 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:08:56.205 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:08:56.208 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:08:56.209 +03:00 [DBG] Disposing transaction.
2025-08-31 12:08:56.210 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:08:56.212 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 12:08:56.214 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:08:56.215 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:08:56.215 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:08:56.216 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:08:56.217 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:08:56.237 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 12:08:56.260 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 12:08:56.261 +03:00 [DBG] Hosting starting
2025-08-31 12:08:56.272 +03:00 [DBG] Middleware loaded
2025-08-31 12:08:56.274 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 12:08:56.276 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 12:08:56.336 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 12:08:56.338 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 12:08:56.340 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 12:08:56.364 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 12:08:56.419 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 12:08:56.421 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 12:08:56.422 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 12:08:56.423 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 12:08:56.423 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 12:08:56.424 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 12:08:56.429 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:08:56.435 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:08:56.514 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 12:08:56.515 +03:00 [INF] Hosting environment: Development
2025-08-31 12:08:56.516 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 12:08:56.517 +03:00 [DBG] Hosting started
2025-08-31 12:08:58.376 +03:00 [DBG] Connection id "0HNF8DO2FC2E3" received FIN.
2025-08-31 12:08:58.381 +03:00 [DBG] Connection id "0HNF8DO2FC2E3" accepted.
2025-08-31 12:08:58.383 +03:00 [DBG] Connection id "0HNF8DO2FC2E3" started.
2025-08-31 12:08:58.385 +03:00 [DBG] Connection id "0HNF8DO2FC2E4" accepted.
2025-08-31 12:08:58.386 +03:00 [DBG] Connection id "0HNF8DO2FC2E4" started.
2025-08-31 12:08:58.391 +03:00 [DBG] Connection id "0HNF8DO2FC2E3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:08:58.395 +03:00 [DBG] Connection id "0HNF8DO2FC2E3" disconnecting.
2025-08-31 12:08:58.397 +03:00 [DBG] Connection id "0HNF8DO2FC2E3" stopped.
2025-08-31 12:08:58.419 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 176
2025-08-31 12:08:58.459 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:08:58.461 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:08:58.483 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 12:08:58.484 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 12:08:58.487 +03:00 [DBG] Connection id "0HNF8DO2FC2E4" completed keep alive response.
2025-08-31 12:08:58.489 +03:00 [DBG] Connection id "0HNF8DO2FC2E5" accepted.
2025-08-31 12:08:58.490 +03:00 [DBG] Connection id "0HNF8DO2FC2E6" accepted.
2025-08-31 12:08:58.490 +03:00 [DBG] Connection id "0HNF8DO2FC2E5" received FIN.
2025-08-31 12:08:58.490 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 77.5115ms
2025-08-31 12:08:58.514 +03:00 [DBG] Connection id "0HNF8DO2FC2E5" started.
2025-08-31 12:08:58.536 +03:00 [DBG] Connection id "0HNF8DO2FC2E6" started.
2025-08-31 12:08:58.541 +03:00 [DBG] Connection id "0HNF8DO2FC2E5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:08:58.542 +03:00 [DBG] Connection id "0HNF8DO2FC2E4", Request id "0HNF8DO2FC2E4:00000001": started reading request body.
2025-08-31 12:08:58.543 +03:00 [DBG] Connection id "0HNF8DO2FC2E5" disconnecting.
2025-08-31 12:08:58.544 +03:00 [DBG] Connection id "0HNF8DO2FC2E4", Request id "0HNF8DO2FC2E4:00000001": done reading request body.
2025-08-31 12:08:58.545 +03:00 [DBG] Connection id "0HNF8DO2FC2E5" stopped.
2025-08-31 12:08:58.572 +03:00 [DBG] Connection 0HNF8DO2FC2E6 established using the following protocol: "Tls13"
2025-08-31 12:08:58.575 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 176
2025-08-31 12:08:58.581 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:08:58.587 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:08:58.592 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:08:58.606 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:08:58.650 +03:00 [DBG] Connection id "0HNF8DO2FC2E6", Request id "0HNF8DO2FC2E6:00000001": started reading request body.
2025-08-31 12:08:58.651 +03:00 [DBG] Connection id "0HNF8DO2FC2E6", Request id "0HNF8DO2FC2E6:00000001": done reading request body.
2025-08-31 12:08:58.675 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 12:08:58.685 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:08:58.956 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:08:58.984 +03:00 [DBG] Saved secret profile-3dbdf962-56d1-4bfc-8029-fe9c6485ff6f for provider "SqlServer"
2025-08-31 12:08:58.985 +03:00 [DBG] Generated profile name SqlServer - MyAppDb with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 12:09:01.627 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => p.Name.Substring(p.Name.IndexOf(-) + 1).Trim() == __targetDbName_0)'
2025-08-31 12:09:04.482 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:09:04.577 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<Profile>()
    .Any(p => p.Name.Substring(p.Name.IndexOf(-) + 1).Trim() == __targetDbName_0)' could not be translated. Additional information: Translation of method 'string.IndexOf' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.AnyAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 33
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 56
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 38
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 12:09:04.589 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 12:09:04.600 +03:00 [DBG] Connection id "0HNF8DO2FC2E6" completed keep alive response.
2025-08-31 12:09:04.602 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:09:04.604 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 6028.8966ms
2025-08-31 12:13:46.930 +03:00 [INF] This is a test log to file!
2025-08-31 12:13:47.195 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 12:13:47.206 +03:00 [INF] API configured successfully.
2025-08-31 12:13:47.299 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:13:47.346 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:13:47.828 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:13:47.855 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 12:13:47.863 +03:00 [INF] Registered 13 endpoints in 838 milliseconds.
2025-08-31 12:13:47.868 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:13:47.899 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:17:18.234 +03:00 [INF] This is a test log to file!
2025-08-31 12:17:18.360 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:17:18.397 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:17:18.739 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:17:18.750 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:17:31.641 +03:00 [INF] This is a test log to file!
2025-08-31 12:17:31.755 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:17:31.787 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:17:32.152 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:17:32.836 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:17:43.151 +03:00 [INF] This is a test log to file!
2025-08-31 12:17:43.259 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:17:43.301 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:17:43.684 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:17:43.763 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:17:43.770 +03:00 [DBG] Created DbConnection. (6ms).
2025-08-31 12:17:43.773 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:43.775 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:17:43.776 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 12:17:43.777 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:43.784 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:43.789 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:43.791 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:17:43.791 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:43.792 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:43.802 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 12:17:43.806 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:43.812 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:17:43.813 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-08-31 12:17:43.818 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:17:43.835 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:17:43.836 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:43.836 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:17:43.836 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:17:43.836 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:17:43.8361109+00:00');
SELECT changes();
2025-08-31 12:17:43.845 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:17:43.8361109+00:00');
SELECT changes();
2025-08-31 12:17:43.893 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:17:43.896 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:17:43.897 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 12:17:43.897 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:17:43.897 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:17:43.897 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:17:43.897 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:17:43.898 +03:00 [DBG] Committing transaction.
2025-08-31 12:17:43.898 +03:00 [DBG] Committed transaction.
2025-08-31 12:17:43.899 +03:00 [DBG] Disposing transaction.
2025-08-31 12:17:43.901 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:17:43.901 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:17:43.903 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:17:43.903 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:17:43.903 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:43.904 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:43.904 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:43.904 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:17:43.904 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:43.904 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:17:43.904 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:17:43.904 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:17:43.904 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:17:43.906 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:17:43.981 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (75ms).
2025-08-31 12:17:43.981 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (75ms).
2025-08-31 12:17:43.982 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:17:43.982 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:17:43.984 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:43.984 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 12:17:43.987 +03:00 [INF] Applying migration '20250831091732_setdatabasenameinprofile'.
2025-08-31 12:17:43.990 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 12:17:43.990 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:17:43.990 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:17:43.990 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Profiles" ADD "DatabaseName" TEXT NOT NULL DEFAULT '';
2025-08-31 12:17:43.991 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Profiles" ADD "DatabaseName" TEXT NOT NULL DEFAULT '';
2025-08-31 12:17:43.991 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 12:17:43.991 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:17:43.991 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 12:17:43.991 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250831091732_setdatabasenameinprofile', '9.0.8');
2025-08-31 12:17:43.991 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250831091732_setdatabasenameinprofile', '9.0.8');
2025-08-31 12:17:43.991 +03:00 [DBG] Committing transaction.
2025-08-31 12:17:43.993 +03:00 [DBG] Committed transaction.
2025-08-31 12:17:43.994 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:43.994 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:17:43.994 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:17:43.994 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:17:43.996 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:17:43.996 +03:00 [DBG] Disposing transaction.
2025-08-31 12:17:43.996 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:43.998 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:17:43.999 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:17:43.999 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:43.999 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:17:56.629 +03:00 [INF] This is a test log to file!
2025-08-31 12:17:57.173 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 12:17:57.184 +03:00 [INF] API configured successfully.
2025-08-31 12:17:57.288 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 12:17:57.363 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 12:17:58.006 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:17:58.045 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 12:17:58.053 +03:00 [INF] Registered 13 endpoints in 1,225 milliseconds.
2025-08-31 12:17:58.059 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:17:58.092 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:17:58.166 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:17:58.178 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-31 12:17:58.180 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:58.185 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:17:58.189 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 12:17:58.195 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:58.204 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:58.215 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:58.220 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 12:17:58.229 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:58.233 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:58.235 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 12:17:58.239 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:58.243 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:17:58.245 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 12:17:58.250 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:17:58.269 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 12:17:58.273 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:58.274 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:17:58.275 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:17:58.276 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:17:58.2733329+00:00');
SELECT changes();
2025-08-31 12:17:58.283 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 09:17:58.2733329+00:00');
SELECT changes();
2025-08-31 12:17:58.333 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:17:58.336 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:17:58.347 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 12:17:58.348 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 12:17:58.349 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 12:17:58.350 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:17:58.352 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 12:17:58.354 +03:00 [DBG] Committing transaction.
2025-08-31 12:17:58.356 +03:00 [DBG] Committed transaction.
2025-08-31 12:17:58.362 +03:00 [DBG] Disposing transaction.
2025-08-31 12:17:58.368 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:17:58.369 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:17:58.371 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:17:58.372 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:17:58.372 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:58.376 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:58.378 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:58.380 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:17:58.381 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:58.382 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 12:17:58.384 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:17:58.385 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:17:58.386 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 12:17:58.390 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:17:58.391 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:17:58.392 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 12:17:58.394 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:17:58.396 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 12:17:58.399 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:58.402 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 12:17:58.407 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 12:17:58.409 +03:00 [DBG] Committing transaction.
2025-08-31 12:17:58.410 +03:00 [DBG] Committed transaction.
2025-08-31 12:17:58.411 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 12:17:58.412 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 12:17:58.413 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 12:17:58.415 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:17:58.424 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 12:17:58.426 +03:00 [DBG] Disposing transaction.
2025-08-31 12:17:58.427 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:17:58.430 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 12:17:58.432 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:17:58.432 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:17:58.434 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:17:58.435 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:17:58.436 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 12:17:58.461 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 12:17:58.487 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 12:17:58.489 +03:00 [DBG] Hosting starting
2025-08-31 12:17:58.501 +03:00 [DBG] Middleware loaded
2025-08-31 12:17:58.503 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 12:17:58.505 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 12:17:58.569 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 12:17:58.571 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 12:17:58.572 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 12:17:58.596 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 12:17:58.671 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 12:17:58.673 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 12:17:58.674 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 12:17:58.675 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 12:17:58.675 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 12:17:58.676 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 12:17:58.681 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:17:58.686 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 12:17:58.709 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 12:17:58.711 +03:00 [INF] Hosting environment: Development
2025-08-31 12:17:58.712 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 12:17:58.713 +03:00 [DBG] Hosting started
2025-08-31 12:18:10.490 +03:00 [DBG] Connection id "0HNF8DT70NVMN" received FIN.
2025-08-31 12:18:10.495 +03:00 [DBG] Connection id "0HNF8DT70NVMN" accepted.
2025-08-31 12:18:10.496 +03:00 [DBG] Connection id "0HNF8DT70NVMN" started.
2025-08-31 12:18:10.497 +03:00 [DBG] Connection id "0HNF8DT70NVMO" accepted.
2025-08-31 12:18:10.498 +03:00 [DBG] Connection id "0HNF8DT70NVMO" started.
2025-08-31 12:18:10.501 +03:00 [DBG] Connection id "0HNF8DT70NVMN" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:18:10.504 +03:00 [DBG] Connection id "0HNF8DT70NVMN" disconnecting.
2025-08-31 12:18:10.506 +03:00 [DBG] Connection id "0HNF8DT70NVMN" stopped.
2025-08-31 12:18:10.521 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 176
2025-08-31 12:18:10.552 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:18:10.554 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:18:10.574 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 12:18:10.576 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 12:18:10.578 +03:00 [DBG] Connection id "0HNF8DT70NVMO" completed keep alive response.
2025-08-31 12:18:10.580 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 61.7558ms
2025-08-31 12:18:10.580 +03:00 [DBG] Connection id "0HNF8DT70NVMQ" accepted.
2025-08-31 12:18:10.580 +03:00 [DBG] Connection id "0HNF8DT70NVMP" received FIN.
2025-08-31 12:18:10.580 +03:00 [DBG] Connection id "0HNF8DT70NVMP" accepted.
2025-08-31 12:18:10.589 +03:00 [DBG] Connection id "0HNF8DT70NVMQ" started.
2025-08-31 12:18:10.590 +03:00 [DBG] Connection id "0HNF8DT70NVMO", Request id "0HNF8DT70NVMO:00000001": started reading request body.
2025-08-31 12:18:10.591 +03:00 [DBG] Connection id "0HNF8DT70NVMP" started.
2025-08-31 12:18:10.593 +03:00 [DBG] Connection id "0HNF8DT70NVMO", Request id "0HNF8DT70NVMO:00000001": done reading request body.
2025-08-31 12:18:10.593 +03:00 [DBG] Connection id "0HNF8DT70NVMP" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 12:18:10.595 +03:00 [DBG] Connection id "0HNF8DT70NVMP" disconnecting.
2025-08-31 12:18:10.596 +03:00 [DBG] Connection id "0HNF8DT70NVMP" stopped.
2025-08-31 12:18:10.619 +03:00 [DBG] Connection 0HNF8DT70NVMQ established using the following protocol: "Tls13"
2025-08-31 12:18:10.623 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 176
2025-08-31 12:18:10.626 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 12:18:10.627 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:18:10.630 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:18:10.640 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:18:10.675 +03:00 [DBG] Connection id "0HNF8DT70NVMQ", Request id "0HNF8DT70NVMQ:00000001": started reading request body.
2025-08-31 12:18:10.677 +03:00 [DBG] Connection id "0HNF8DT70NVMQ", Request id "0HNF8DT70NVMQ:00000001": done reading request body.
2025-08-31 12:18:10.700 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 12:18:10.709 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:18:10.942 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 12:18:10.958 +03:00 [DBG] Saved secret profile-bda234d2-1836-4949-bda6-bda9b160e4c2 for provider "SqlServer"
2025-08-31 12:18:10.959 +03:00 [DBG] Generated profile name SqlServer - MyAppDb with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 12:18:14.363 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => p.DatabaseName.Equals(__profile_DatabaseName_0))'
2025-08-31 12:18:14.524 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 12:18:14.551 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:18:14.552 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:18:14.554 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:14.556 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:14.557 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:14.558 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:14.560 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 12:18:14.563 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_DatabaseName_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-08-31 12:18:14.569 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__profile_DatabaseName_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-08-31 12:18:14.574 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:14.575 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 12:18:14.578 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:14.579 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:18:14.610 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:14.665 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:14.671 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:14.684 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 12:18:14.690 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:14.692 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:14.694 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 12:18:14.736 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:14.737 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:14.739 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:14.740 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:14.743 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 12:18:14.744 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 7), @p4='?' (Size = 19), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-08-31 12:18:14.753 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 7), @p4='?' (Size = 19), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-08-31 12:18:14.756 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:14.757 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 12:18:14.759 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:14.760 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:18:14.767 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:14.769 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 12:18:14.770 +03:00 [INF] Profile created successfully with Id "45821c2a-7796-4d57-9fff-439149207d79"
2025-08-31 12:18:14.780 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 12:18:14.784 +03:00 [DBG] Connection id "0HNF8DT70NVMQ" completed keep alive response.
2025-08-31 12:18:14.786 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:18:14.789 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:14.791 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 12:18:14.793 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 4170.2578ms
2025-08-31 12:18:22.613 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/45821c2a-7796-4d57-9fff-439149207d79 - null null
2025-08-31 12:18:22.615 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/45821c2a-7796-4d57-9fff-439149207d79'
2025-08-31 12:18:22.617 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/45821c2a-7796-4d57-9fff-439149207d79'
2025-08-31 12:18:22.618 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 12:18:22.620 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 12:18:22.629 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:18:22.638 +03:00 [INF] Deleting profile "45821c2a-7796-4d57-9fff-439149207d79"
2025-08-31 12:18:22.644 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 12:18:22.653 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 12:18:22.727 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 12:18:22.736 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:18:22.737 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:18:22.738 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:22.738 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:22.739 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:22.740 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:22.742 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 12:18:22.742 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 12:18:22.746 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 12:18:22.752 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:22.756 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:22.758 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 9ms reading results.
2025-08-31 12:18:22.759 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:22.760 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:22.776 +03:00 [DBG] Deleted secret profile-bda234d2-1836-4949-bda6-bda9b160e4c2 for profile "45821c2a-7796-4d57-9fff-439149207d79"
2025-08-31 12:18:22.779 +03:00 [DBG] Deleted cache directory C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer for profile "45821c2a-7796-4d57-9fff-439149207d79"
2025-08-31 12:18:22.782 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:22.785 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:22.785 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 12:18:22.786 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:22.787 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:22.788 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 12:18:22.792 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:22.793 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:22.794 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:22.795 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:22.796 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 12:18:22.797 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:22.803 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:22.809 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:22.810 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-08-31 12:18:22.811 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:22.812 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:22.815 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:22.817 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 12:18:22.818 +03:00 [INF] Profile "45821c2a-7796-4d57-9fff-439149207d79" deleted successfully
2025-08-31 12:18:22.821 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 12:18:22.822 +03:00 [DBG] Connection id "0HNF8DT70NVMQ" completed keep alive response.
2025-08-31 12:18:22.823 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:18:22.824 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:22.826 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 12:18:22.829 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/45821c2a-7796-4d57-9fff-439149207d79 - 200 null application/json; charset=utf-8 215.4229ms
2025-08-31 12:18:27.619 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 12:18:27.621 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 12:18:27.622 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:27.628 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 12:18:27.629 +03:00 [DBG] Connection id "0HNF8DT70NVMO" completed keep alive response.
2025-08-31 12:18:27.630 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 11.7447ms
2025-08-31 12:18:27.631 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 12:18:27.635 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 12:18:27.637 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:27.639 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:27.640 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:18:27.651 +03:00 [INF] Listing all profiles
2025-08-31 12:18:27.655 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()'
2025-08-31 12:18:27.657 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 12:18:27.670 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Profile>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Profile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Profile instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Profile);
                (object)dataReader.GetGuid(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                            {
                                return 
                                {
                                    Profile instance;
                                    instance = new Profile();
                                    instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                    instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                    instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                    instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Profile)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetGuid(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (Profile)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                Query entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    Query instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(Query);
                    dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                {
                                    return 
                                    {
                                        Query instance;
                                        instance = new Query();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                        instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                        instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                        instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                        instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                        instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Query)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                    entity: namelessParameter{11}, 
                    value: namelessParameter{12}, 
                    forMaterialization: True);
                return namelessParameter{12}.<Profile>k__BackingField = namelessParameter{11};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (Profile)(resultContext.Values[0]) : default(Profile);
    }, 
    contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-08-31 12:18:27.674 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:18:27.675 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:18:27.676 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:27.677 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:27.677 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:27.678 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:27.679 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:27.680 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 12:18:27.681 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 12:18:27.688 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:27.689 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 5ms reading results.
2025-08-31 12:18:27.690 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:27.690 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:27.692 +03:00 [INF] Fetching connection string for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 12:18:27.695 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:27.696 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:27.696 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:27.697 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:27.698 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:27.699 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 12:18:27.700 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 12:18:27.702 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:27.708 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:27.714 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:27.715 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:27.716 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:27.717 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:27.718 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:27.718 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 16ms reading results.
2025-08-31 12:18:27.719 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:27.720 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:27.736 +03:00 [DBG] Fetched secret for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 12:18:27.747 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:27.748 +03:00 [DBG] Connection id "0HNF8DT70NVMQ" completed keep alive response.
2025-08-31 12:18:27.749 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:18:27.750 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:27.750 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:27.751 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 120.5675ms
2025-08-31 12:18:35.239 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - null null
2025-08-31 12:18:35.242 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 12:18:35.243 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/b4be75ee-37e6-4e39-9593-766e259f5729'
2025-08-31 12:18:35.244 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 12:18:35.245 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 12:18:35.246 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:18:35.247 +03:00 [INF] Deleting profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 12:18:35.248 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:18:35.249 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:18:35.250 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:35.250 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.251 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:35.252 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:35.253 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:35.254 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 12:18:35.256 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 12:18:35.257 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.258 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.259 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.260 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.261 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.262 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.263 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.264 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-08-31 12:18:35.265 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.265 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:35.267 +03:00 [DBG] Deleted secret profile-c2197495-3dfa-4f0d-8210-d5c7e4384df3 for profile "b4be75ee-37e6-4e39-9593-766e259f5729"
2025-08-31 12:18:35.268 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.277 +03:00 [DBG] A cascade state change of an entity of type 'Query' to '"Deleted"' occurred due to deletion of its parent entity of type 'Profile'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.278 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.280 +03:00 [DBG] A cascade state change of an entity of type 'Query' to '"Deleted"' occurred due to deletion of its parent entity of type 'Profile'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.281 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.282 +03:00 [DBG] A cascade state change of an entity of type 'Query' to '"Deleted"' occurred due to deletion of its parent entity of type 'Profile'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.283 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.284 +03:00 [DBG] A cascade state change of an entity of type 'Query' to '"Deleted"' occurred due to deletion of its parent entity of type 'Profile'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.285 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.286 +03:00 [DBG] A cascade state change of an entity of type 'Query' to '"Deleted"' occurred due to deletion of its parent entity of type 'Profile'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.287 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.288 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:35.289 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 12:18:35.290 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:35.290 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 12:18:35.291 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 12:18:35.297 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:35.298 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.299 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 12:18:35.301 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 12:18:35.301 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:35.302 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:35.303 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:35.303 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.305 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.306 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.307 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 12:18:35.309 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:35.310 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:35.311 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 12:18:35.312 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.313 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.314 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.315 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 12:18:35.316 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:35.317 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:35.318 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:35.319 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.320 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.321 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.322 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 12:18:35.323 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:35.324 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:35.324 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:35.325 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.326 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.327 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.328 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 12:18:35.329 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:35.330 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:35.331 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:35.331 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.332 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Queries"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.334 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.335 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 12:18:35.336 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:35.336 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:35.337 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:35.338 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.339 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-31 12:18:35.340 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.341 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 12:18:35.343 +03:00 [DBG] Committing transaction.
2025-08-31 12:18:35.348 +03:00 [DBG] Committed transaction.
2025-08-31 12:18:35.350 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:35.351 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:35.353 +03:00 [DBG] Disposing transaction.
2025-08-31 12:18:35.358 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.360 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.361 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.362 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.362 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.363 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.365 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.366 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.367 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.368 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.369 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 12:18:35.370 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 6 entities written to the database.
2025-08-31 12:18:35.371 +03:00 [INF] Profile "b4be75ee-37e6-4e39-9593-766e259f5729" deleted successfully
2025-08-31 12:18:35.372 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-31 12:18:35.372 +03:00 [DBG] Connection id "0HNF8DT70NVMQ" completed keep alive response.
2025-08-31 12:18:35.373 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:18:35.374 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:35.374 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:35.375 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/b4be75ee-37e6-4e39-9593-766e259f5729 - 200 null application/json; charset=utf-8 136.2128ms
2025-08-31 12:18:37.671 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 12:18:37.672 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 12:18:37.674 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:37.675 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 12:18:37.675 +03:00 [DBG] Connection id "0HNF8DT70NVMO" completed keep alive response.
2025-08-31 12:18:37.676 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 5.8854ms
2025-08-31 12:18:37.676 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 12:18:37.680 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 12:18:37.681 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:37.682 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:37.683 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 12:18:37.684 +03:00 [INF] Listing all profiles
2025-08-31 12:18:37.685 +03:00 [DBG] Creating DbConnection.
2025-08-31 12:18:37.686 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 12:18:37.686 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:37.687 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:37.688 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 12:18:37.689 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 12:18:37.689 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 12:18:37.690 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 12:18:37.692 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 12:18:37.693 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:37.694 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 12:18:37.695 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 12:18:37.696 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:37.697 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 12:18:37.698 +03:00 [DBG] Connection id "0HNF8DT70NVMQ" completed keep alive response.
2025-08-31 12:18:37.699 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 12:18:37.700 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 12:18:37.701 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 12:18:37.702 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 25.4052ms
2025-08-31 17:50:32.299 +03:00 [INF] This is a test log to file!
2025-08-31 17:50:32.662 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 17:50:32.697 +03:00 [INF] API configured successfully.
2025-08-31 17:50:32.938 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 17:50:33.032 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 17:50:33.571 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:50:33.602 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 17:50:33.609 +03:00 [INF] Registered 13 endpoints in 1,175 milliseconds.
2025-08-31 17:50:33.615 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:50:33.648 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:50:33.717 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:50:33.729 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-31 17:50:33.731 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:33.735 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:50:33.737 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 17:50:33.739 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:33.752 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:33.756 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:33.760 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:33.762 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:33.764 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:33.766 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 17:50:33.769 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:50:33.773 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 17:50:33.775 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-08-31 17:50:33.780 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 17:50:33.801 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 17:50:33.803 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:50:33.804 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 17:50:33.805 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 17:50:33.806 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 14:50:33.8036505+00:00');
SELECT changes();
2025-08-31 17:50:33.814 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 14:50:33.8036505+00:00');
SELECT changes();
2025-08-31 17:50:33.858 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 17:50:33.862 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 17:50:33.864 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 17:50:33.865 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 17:50:33.867 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 17:50:33.868 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 17:50:33.871 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 17:50:33.874 +03:00 [DBG] Committing transaction.
2025-08-31 17:50:33.875 +03:00 [DBG] Committed transaction.
2025-08-31 17:50:33.877 +03:00 [DBG] Disposing transaction.
2025-08-31 17:50:33.879 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 17:50:33.880 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 17:50:33.882 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:50:33.883 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:50:33.884 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:33.885 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:33.887 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:33.888 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:33.890 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:50:33.891 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 17:50:33.892 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 17:50:33.893 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 17:50:33.895 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 17:50:33.898 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:50:33.899 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 17:50:33.900 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:50:33.901 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 17:50:33.903 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 17:50:33.907 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:33.909 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 17:50:33.913 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 17:50:33.914 +03:00 [DBG] Committing transaction.
2025-08-31 17:50:33.915 +03:00 [DBG] Committed transaction.
2025-08-31 17:50:33.916 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:50:33.917 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 17:50:33.918 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 17:50:33.920 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 17:50:33.923 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 17:50:33.925 +03:00 [DBG] Disposing transaction.
2025-08-31 17:50:33.927 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:33.930 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 17:50:33.931 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:50:33.932 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:33.933 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:33.934 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 17:50:33.935 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 17:50:33.958 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 17:50:33.986 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 17:50:33.988 +03:00 [DBG] Hosting starting
2025-08-31 17:50:34.002 +03:00 [DBG] Middleware loaded
2025-08-31 17:50:34.006 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 17:50:34.008 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 17:50:34.078 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 17:50:34.080 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 17:50:34.083 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 17:50:34.120 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 17:50:34.208 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 17:50:34.209 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 17:50:34.210 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 17:50:34.211 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 17:50:34.212 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 17:50:34.214 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 17:50:34.221 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 17:50:34.231 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 17:50:34.333 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 17:50:34.334 +03:00 [INF] Hosting environment: Development
2025-08-31 17:50:34.335 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 17:50:34.335 +03:00 [DBG] Hosting started
2025-08-31 17:50:40.553 +03:00 [DBG] Connection id "0HNF8JN0JC3SK" received FIN.
2025-08-31 17:50:40.559 +03:00 [DBG] Connection id "0HNF8JN0JC3SK" accepted.
2025-08-31 17:50:40.560 +03:00 [DBG] Connection id "0HNF8JN0JC3SK" started.
2025-08-31 17:50:40.561 +03:00 [DBG] Connection id "0HNF8JN0JC3SL" accepted.
2025-08-31 17:50:40.562 +03:00 [DBG] Connection id "0HNF8JN0JC3SL" started.
2025-08-31 17:50:40.566 +03:00 [DBG] Connection id "0HNF8JN0JC3SK" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 17:50:40.570 +03:00 [DBG] Connection id "0HNF8JN0JC3SK" disconnecting.
2025-08-31 17:50:40.571 +03:00 [DBG] Connection id "0HNF8JN0JC3SK" stopped.
2025-08-31 17:50:40.585 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert - application/json 73
2025-08-31 17:50:40.619 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert'
2025-08-31 17:50:40.620 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert'
2025-08-31 17:50:40.623 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:50:40.648 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 17:50:40.650 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert'.
2025-08-31 17:50:40.654 +03:00 [DBG] Connection id "0HNF8JN0JC3SL" completed keep alive response.
2025-08-31 17:50:40.656 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert - 307 0 null 74.7094ms
2025-08-31 17:50:40.657 +03:00 [DBG] Connection id "0HNF8JN0JC3SM" received FIN.
2025-08-31 17:50:40.657 +03:00 [DBG] Connection id "0HNF8JN0JC3SM" accepted.
2025-08-31 17:50:40.657 +03:00 [DBG] Connection id "0HNF8JN0JC3SN" accepted.
2025-08-31 17:50:40.666 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000001": started reading request body.
2025-08-31 17:50:40.667 +03:00 [DBG] Connection id "0HNF8JN0JC3SM" started.
2025-08-31 17:50:40.667 +03:00 [DBG] Connection id "0HNF8JN0JC3SN" started.
2025-08-31 17:50:40.669 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000001": done reading request body.
2025-08-31 17:50:40.669 +03:00 [DBG] Connection id "0HNF8JN0JC3SM" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 17:50:40.672 +03:00 [DBG] Connection id "0HNF8JN0JC3SM" disconnecting.
2025-08-31 17:50:40.673 +03:00 [DBG] Connection id "0HNF8JN0JC3SM" stopped.
2025-08-31 17:50:40.702 +03:00 [DBG] Connection 0HNF8JN0JC3SN established using the following protocol: "Tls13"
2025-08-31 17:50:40.706 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert - application/json 73
2025-08-31 17:50:40.709 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert'
2025-08-31 17:50:40.710 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert'
2025-08-31 17:50:40.711 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:50:40.715 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:50:40.726 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:50:40.728 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 17:50:40.756 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000001": started reading request body.
2025-08-31 17:50:40.759 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000001": done reading request body.
2025-08-31 17:50:40.788 +03:00 [INF] Converting NL to SQL for profile "7576e9c9-83e8-40d8-8fbb-a886504d2b61"
2025-08-31 17:50:40.847 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 17:50:40.881 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 17:50:41.077 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 17:50:41.116 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:50:41.117 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:50:41.119 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:41.123 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:41.125 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:50:41.126 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:50:41.129 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 17:50:41.135 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:50:41.141 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:50:41.159 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:41.160 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-08-31 17:50:41.163 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:41.165 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:41.381 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:50:41.447 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: No profile found with id: 7576e9c9-83e8-40d8-8fbb-a886504d2b61
   at NaturalToQuery.Application.Services.ProfileService.GetProviderTypeAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 200
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 61
   at NaturalToQuery.Application.Services.ProfileDbService.GetSchemaAsync(Guid profileId, Boolean forceRefresh, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 45
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 29
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 17:50:41.462 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 17:50:41.473 +03:00 [DBG] Connection id "0HNF8JN0JC3SN" completed keep alive response.
2025-08-31 17:50:41.474 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:50:41.477 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:41.478 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:41.480 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/convert - 500 null application/json; charset=utf-8 773.6472ms
2025-08-31 17:50:48.372 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 176
2025-08-31 17:50:48.375 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 17:50:48.376 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:50:48.377 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 17:50:48.378 +03:00 [DBG] Connection id "0HNF8JN0JC3SL" completed keep alive response.
2025-08-31 17:50:48.379 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 6.9257ms
2025-08-31 17:50:48.380 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 176
2025-08-31 17:50:48.382 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000002": started reading request body.
2025-08-31 17:50:48.384 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 17:50:48.384 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000002": done reading request body.
2025-08-31 17:50:48.385 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:50:48.387 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:50:48.396 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:50:48.410 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000002": started reading request body.
2025-08-31 17:50:48.411 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000002": done reading request body.
2025-08-31 17:50:48.478 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 17:50:48.487 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 17:50:48.791 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=MyAppDb)
2025-08-31 17:50:48.816 +03:00 [DBG] Saved secret profile-e8f87e39-fce0-4feb-8696-d546f4a55053 for provider "SqlServer"
2025-08-31 17:50:48.817 +03:00 [DBG] Generated profile name SqlServer - MyAppDb with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 17:50:50.755 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => p.DatabaseName.Equals(__profile_DatabaseName_0))'
2025-08-31 17:50:50.763 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.DatabaseName == @__profile_DatabaseName_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 17:50:50.768 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:50:50.769 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:50:50.770 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:50.770 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:50.771 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:50:50.772 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 17:50:50.773 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 17:50:50.775 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_DatabaseName_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-08-31 17:50:50.777 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_DatabaseName_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-08-31 17:50:50.780 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:50.781 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 17:50:50.788 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:50.789 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:50.830 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:50:50.910 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:50:50.920 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 17:50:50.936 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 17:50:50.941 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 17:50:50.943 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 17:50:50.945 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 17:50:51.013 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:51.014 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:51.017 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:50:51.018 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:50:51.021 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 17:50:51.023 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 7), @p4='?' (Size = 19), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-08-31 17:50:51.029 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 7), @p4='?' (Size = 19), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-08-31 17:50:51.033 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:51.035 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 17:50:51.037 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:51.038 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:51.053 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:50:51.056 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 17:50:51.068 +03:00 [INF] Profile created successfully with Id "feaaa72e-cd81-4eb0-afcc-394ebb3cd245"
2025-08-31 17:50:51.078 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:50:51.084 +03:00 [DBG] Connection id "0HNF8JN0JC3SN" completed keep alive response.
2025-08-31 17:50:51.085 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:50:51.086 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:51.088 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:50:51.089 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 2708.8572ms
2025-08-31 17:50:59.832 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert - application/json 73
2025-08-31 17:50:59.835 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert'
2025-08-31 17:50:59.836 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert'
2025-08-31 17:50:59.838 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:50:59.839 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert'.
2025-08-31 17:50:59.840 +03:00 [DBG] Connection id "0HNF8JN0JC3SL" completed keep alive response.
2025-08-31 17:50:59.842 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert - 307 0 null 9.6467ms
2025-08-31 17:50:59.842 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert - application/json 73
2025-08-31 17:50:59.845 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000003": started reading request body.
2025-08-31 17:50:59.847 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert'
2025-08-31 17:50:59.848 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000003": done reading request body.
2025-08-31 17:50:59.850 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert'
2025-08-31 17:50:59.853 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:50:59.854 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:50:59.856 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:50:59.858 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 17:50:59.859 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000003": started reading request body.
2025-08-31 17:50:59.860 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000003": done reading request body.
2025-08-31 17:50:59.861 +03:00 [INF] Converting NL to SQL for profile "feaaa72e-cd81-4eb0-afcc-394ebb3cd245"
2025-08-31 17:50:59.866 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:50:59.867 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:50:59.867 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:59.868 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:59.869 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:50:59.871 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:50:59.872 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 17:50:59.873 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:50:59.874 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:50:59.883 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:50:59.890 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:59.894 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 17ms reading results.
2025-08-31 17:50:59.895 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:59.896 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 17:50:59.899 +03:00 [INF] Fetching connection string for profile "feaaa72e-cd81-4eb0-afcc-394ebb3cd245"
2025-08-31 17:50:59.900 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:50:59.901 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:59.914 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:50:59.915 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:50:59.916 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 17:50:59.917 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:50:59.919 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:50:59.921 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:59.922 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 17:50:59.924 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:50:59.937 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (13ms).
2025-08-31 17:50:59.964 +03:00 [DBG] Fetched secret for profile "feaaa72e-cd81-4eb0-afcc-394ebb3cd245"
2025-08-31 17:50:59.967 +03:00 [DBG] Fetching schema for Profile "feaaa72e-cd81-4eb0-afcc-394ebb3cd245", ForceRefresh=false
2025-08-31 17:50:59.969 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|MyAppDb (ForceRefresh=false)
2025-08-31 17:51:00.083 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|MyAppDb from cache file
2025-08-31 17:51:00.100 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-31 17:51:00.102 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-31 17:51:00.103 +03:00 [DBG] Generated prompt with 6 messages
2025-08-31 17:51:00.110 +03:00 [DBG] Request payload prepared for Groq API
2025-08-31 17:51:00.860 +03:00 [INF] Groq API responded with status: "OK"
2025-08-31 17:51:00.874 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-31 17:51:00.878 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:51:00.887 +03:00 [DBG] Connection id "0HNF8JN0JC3SN" completed keep alive response.
2025-08-31 17:51:00.898 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:51:00.900 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:51:00.901 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:51:00.902 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/feaaa72e-cd81-4eb0-afcc-394ebb3cd245/convert - 200 null application/json; charset=utf-8 1059.9217ms
2025-08-31 17:51:24.085 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/setup/profile - application/json 185
2025-08-31 17:51:24.089 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 17:51:24.090 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:51:24.090 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profile'.
2025-08-31 17:51:24.091 +03:00 [DBG] Connection id "0HNF8JN0JC3SL" completed keep alive response.
2025-08-31 17:51:24.092 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/setup/profile - 307 0 null 9.4229ms
2025-08-31 17:51:24.115 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-31 17:51:24.118 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000004": started reading request body.
2025-08-31 17:51:24.120 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-31 17:51:24.121 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000004": done reading request body.
2025-08-31 17:51:24.121 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:51:24.123 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:51:24.124 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:51:24.126 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000004": started reading request body.
2025-08-31 17:51:24.127 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000004": done reading request body.
2025-08-31 17:51:24.128 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-31 17:51:24.129 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 17:51:24.137 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 17:51:24.167 +03:00 [DBG] Saved secret profile-9d324dd4-76a5-4303-b7b5-ef7d4abe3a2c for provider "SqlServer"
2025-08-31 17:51:24.168 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-31 17:51:25.610 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:51:25.611 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:51:25.612 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:51:25.612 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:25.613 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:51:25.615 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:51:25.616 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 17:51:25.617 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-08-31 17:51:25.622 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__profile_DatabaseName_0='?' (Size = 16)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."DatabaseName" = @__profile_DatabaseName_0)
2025-08-31 17:51:25.625 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:25.626 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 17:51:25.628 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:25.629 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:51:25.632 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:51:25.634 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:51:25.635 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 17:51:25.636 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 17:51:25.637 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 17:51:25.638 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 17:51:25.639 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 17:51:25.641 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:51:25.642 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:25.643 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:51:25.644 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:51:25.646 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 17:51:25.647 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 16), @p4='?' (Size = 28), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-08-31 17:51:25.650 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 16), @p4='?' (Size = 28), @p5='?' (DbType = Int32), @p6='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "DatabaseName", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-08-31 17:51:25.653 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:25.654 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 17:51:25.655 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:25.656 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 17:51:25.658 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:51:25.659 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 17:51:25.661 +03:00 [INF] Profile created successfully with Id "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 17:51:25.662 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-31 17:51:25.663 +03:00 [DBG] Connection id "0HNF8JN0JC3SN" completed keep alive response.
2025-08-31 17:51:25.664 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:51:25.665 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:51:25.666 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 17:51:25.667 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 1574.4195ms
2025-08-31 17:51:33.809 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - application/json 73
2025-08-31 17:51:33.811 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:51:33.812 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:51:33.813 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:51:33.814 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'.
2025-08-31 17:51:33.815 +03:00 [DBG] Connection id "0HNF8JN0JC3SL" completed keep alive response.
2025-08-31 17:51:33.817 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - 307 0 null 7.116ms
2025-08-31 17:51:33.817 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - application/json 73
2025-08-31 17:51:33.819 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000005": started reading request body.
2025-08-31 17:51:33.820 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:51:33.821 +03:00 [DBG] Connection id "0HNF8JN0JC3SL", Request id "0HNF8JN0JC3SL:00000005": done reading request body.
2025-08-31 17:51:33.822 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:51:33.824 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:51:33.825 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:51:33.826 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:51:33.828 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 17:51:33.828 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000005": started reading request body.
2025-08-31 17:51:33.829 +03:00 [DBG] Connection id "0HNF8JN0JC3SN", Request id "0HNF8JN0JC3SN:00000005": done reading request body.
2025-08-31 17:51:33.830 +03:00 [INF] Converting NL to SQL for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 17:51:33.831 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:51:33.832 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:51:33.833 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:51:33.834 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:33.835 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:51:33.836 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 17:51:33.837 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:51:33.837 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:51:33.839 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:51:33.841 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:51:33.842 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:33.842 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 17:51:33.844 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:33.845 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:51:33.846 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 17:51:33.847 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:51:33.848 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:33.849 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:51:33.850 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 17:51:33.850 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:51:33.851 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:51:33.853 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:51:33.855 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:33.855 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 17:51:33.856 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:51:33.858 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:51:33.879 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 17:51:33.879 +03:00 [DBG] Fetching schema for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", ForceRefresh=false
2025-08-31 17:51:33.880 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-31 17:51:33.883 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-31 17:51:33.885 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-31 17:51:33.886 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-31 17:51:33.887 +03:00 [DBG] Generated prompt with 6 messages
2025-08-31 17:51:33.888 +03:00 [DBG] Request payload prepared for Groq API
2025-08-31 17:51:34.494 +03:00 [INF] Groq API responded with status: "OK"
2025-08-31 17:51:34.574 +03:00 [ERR] Failed to deserialize query result. Content: { "sql": null, "intent": null, "intent_components": null, "tables": null, "columns": null, "parameters": null, "confidence": null, "safe": false, "issues": [ "Destructive operations are not allowed." ], "explanation": "The user query does not include the ALLOW_DESTRUCTIVE flag or it is set to false." }
2025-08-31 17:51:34.854 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:51:35.003 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.GroqServiceException: Failed to parse Groq API response as valid JSON - the model may have returned malformed output
 ---> System.Text.Json.JsonException: The JSON value could not be converted to System.Int32. Path: $.confidence | LineNumber: 0 | BytePositionInLine: 129.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Null' as a number.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedNumber(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.TryGetInt32(Int32& value)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, T& value, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, T& value, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.Deserialize(Utf8JsonReader& reader, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at NaturalToQuery.Infrastructure.LLM.GroqService.DeserializeQueryResult(String content) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 160
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.LLM.GroqService.DeserializeQueryResult(String content) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 169
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 64
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 17:51:35.009 +03:00 [ERR] Error occurred.
2025-08-31 17:51:35.170 +03:00 [ERR] An exception was thrown attempting to execute the error handler.
System.ArgumentNullException: Value cannot be null. (Parameter 'json')
   at System.Text.Json.ThrowHelper.ThrowArgumentNullException(String parameterName)
   at System.Text.Json.JsonDocument.Parse(String json, JsonDocumentOptions options)
   at NaturalToQuery.Api.Middlewares.ExceptionMiddlewareHelper.ParseGroqApiError(String responseBody) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Middlewares\ExceptionMiddleware.Helper.cs:line 87
   at NaturalToQuery.Api.Middlewares.ExceptionMiddlewareHelper.<>c.<.cctor>b__3_4(Exception ex) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Middlewares\ExceptionMiddleware.Helper.cs:line 58
   at NaturalToQuery.Api.Middlewares.ExceptionMiddlewareExtensions.<>c__DisplayClass0_0.<<ConfigureExceptionHandler>b__1>d.MoveNext() in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Middlewares\ExceptionMiddleware.cs:line 29
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.HandleException(HttpContext context, ExceptionDispatchInfo edi)
2025-08-31 17:51:35.521 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.GroqServiceException: Failed to parse Groq API response as valid JSON - the model may have returned malformed output
 ---> System.Text.Json.JsonException: The JSON value could not be converted to System.Int32. Path: $.confidence | LineNumber: 0 | BytePositionInLine: 129.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Null' as a number.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedNumber(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.TryGetInt32(Int32& value)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, T& value, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, T& value, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.Deserialize(Utf8JsonReader& reader, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at NaturalToQuery.Infrastructure.LLM.GroqService.DeserializeQueryResult(String content) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 160
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.LLM.GroqService.DeserializeQueryResult(String content) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 169
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 64
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.HandleException(HttpContext context, ExceptionDispatchInfo edi)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-08-31 17:51:35.534 +03:00 [DBG] Connection id "0HNF8JN0JC3SN" completed keep alive response.
2025-08-31 17:51:35.536 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:51:35.538 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:51:35.539 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:51:35.541 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - 500 null text/plain; charset=utf-8 1723.8145ms
2025-08-31 17:54:52.278 +03:00 [INF] This is a test log to file!
2025-08-31 17:54:52.634 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 17:54:52.643 +03:00 [INF] API configured successfully.
2025-08-31 17:54:52.727 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 17:54:52.773 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 17:54:53.494 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:54:53.527 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 17:54:53.535 +03:00 [INF] Registered 13 endpoints in 1,096 milliseconds.
2025-08-31 17:54:53.542 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:54:53.576 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:54:53.657 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:54:53.667 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 17:54:53.670 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 17:54:53.674 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:54:53.676 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 17:54:53.678 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:54:53.686 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:54:53.690 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:54:53.693 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:54:53.695 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:54:53.697 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:54:53.699 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 17:54:53.703 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:54:53.708 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 17:54:53.710 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 17:54:53.715 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 17:54:53.733 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 17:54:53.736 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:54:53.737 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 17:54:53.738 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 17:54:53.739 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 14:54:53.736354+00:00');
SELECT changes();
2025-08-31 17:54:53.744 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 14:54:53.736354+00:00');
SELECT changes();
2025-08-31 17:54:53.784 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 17:54:53.786 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 17:54:53.788 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 17:54:53.789 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 17:54:53.790 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 17:54:53.791 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 17:54:53.793 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 17:54:53.795 +03:00 [DBG] Committing transaction.
2025-08-31 17:54:53.796 +03:00 [DBG] Committed transaction.
2025-08-31 17:54:53.797 +03:00 [DBG] Disposing transaction.
2025-08-31 17:54:53.800 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 17:54:53.800 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 17:54:53.802 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:54:53.803 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:54:53.803 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:54:53.805 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:54:53.806 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:54:53.806 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 17:54:53.807 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:54:53.808 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 17:54:53.809 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 17:54:53.809 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 17:54:53.811 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 17:54:53.813 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:54:53.814 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 17:54:53.815 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:54:53.816 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 17:54:53.818 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 17:54:53.821 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:54:53.823 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 17:54:53.827 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 17:54:53.827 +03:00 [DBG] Committing transaction.
2025-08-31 17:54:53.828 +03:00 [DBG] Committed transaction.
2025-08-31 17:54:53.829 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 17:54:53.830 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 17:54:53.831 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 17:54:53.832 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 17:54:53.836 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 17:54:53.837 +03:00 [DBG] Disposing transaction.
2025-08-31 17:54:53.838 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:54:53.840 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 17:54:53.842 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:54:53.842 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:54:53.843 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 17:54:53.844 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 17:54:53.845 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 17:54:53.866 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 17:54:53.901 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 17:54:53.903 +03:00 [DBG] Hosting starting
2025-08-31 17:54:53.920 +03:00 [DBG] Middleware loaded
2025-08-31 17:54:53.923 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 17:54:53.926 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 17:54:54.004 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 17:54:54.006 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 17:54:54.008 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 17:54:54.035 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 17:54:54.092 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 17:54:54.093 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 17:54:54.094 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 17:54:54.094 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 17:54:54.095 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 17:54:54.096 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 17:54:54.101 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 17:54:54.107 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 17:54:54.131 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 17:54:54.132 +03:00 [INF] Hosting environment: Development
2025-08-31 17:54:54.133 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 17:54:54.133 +03:00 [DBG] Hosting started
2025-08-31 17:55:04.907 +03:00 [DBG] Connection id "0HNF8JPFCEJ0L" received FIN.
2025-08-31 17:55:04.913 +03:00 [DBG] Connection id "0HNF8JPFCEJ0L" accepted.
2025-08-31 17:55:04.915 +03:00 [DBG] Connection id "0HNF8JPFCEJ0L" started.
2025-08-31 17:55:04.916 +03:00 [DBG] Connection id "0HNF8JPFCEJ0M" accepted.
2025-08-31 17:55:04.918 +03:00 [DBG] Connection id "0HNF8JPFCEJ0M" started.
2025-08-31 17:55:04.922 +03:00 [DBG] Connection id "0HNF8JPFCEJ0L" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 17:55:04.927 +03:00 [DBG] Connection id "0HNF8JPFCEJ0L" disconnecting.
2025-08-31 17:55:04.929 +03:00 [DBG] Connection id "0HNF8JPFCEJ0L" stopped.
2025-08-31 17:55:04.952 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - application/json 73
2025-08-31 17:55:05.012 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:55:05.014 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:55:05.016 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:55:05.040 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 17:55:05.042 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'.
2025-08-31 17:55:05.045 +03:00 [DBG] Connection id "0HNF8JPFCEJ0M" completed keep alive response.
2025-08-31 17:55:05.048 +03:00 [DBG] Connection id "0HNF8JPFCEJ0N" accepted.
2025-08-31 17:55:05.048 +03:00 [DBG] Connection id "0HNF8JPFCEJ0N" received FIN.
2025-08-31 17:55:05.048 +03:00 [DBG] Connection id "0HNF8JPFCEJ0O" accepted.
2025-08-31 17:55:05.048 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - 307 0 null 105.5649ms
2025-08-31 17:55:05.053 +03:00 [DBG] Connection id "0HNF8JPFCEJ0N" started.
2025-08-31 17:55:05.059 +03:00 [DBG] Connection id "0HNF8JPFCEJ0O" started.
2025-08-31 17:55:05.063 +03:00 [DBG] Connection id "0HNF8JPFCEJ0N" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 17:55:05.064 +03:00 [DBG] Connection id "0HNF8JPFCEJ0M", Request id "0HNF8JPFCEJ0M:00000001": started reading request body.
2025-08-31 17:55:05.066 +03:00 [DBG] Connection id "0HNF8JPFCEJ0N" disconnecting.
2025-08-31 17:55:05.068 +03:00 [DBG] Connection id "0HNF8JPFCEJ0M", Request id "0HNF8JPFCEJ0M:00000001": done reading request body.
2025-08-31 17:55:05.068 +03:00 [DBG] Connection id "0HNF8JPFCEJ0N" stopped.
2025-08-31 17:55:05.096 +03:00 [DBG] Connection 0HNF8JPFCEJ0O established using the following protocol: "Tls13"
2025-08-31 17:55:05.101 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - application/json 73
2025-08-31 17:55:05.106 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:55:05.107 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert'
2025-08-31 17:55:05.109 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:55:05.112 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:55:05.124 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 17:55:05.127 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 17:55:05.155 +03:00 [DBG] Connection id "0HNF8JPFCEJ0O", Request id "0HNF8JPFCEJ0O:00000001": started reading request body.
2025-08-31 17:55:05.157 +03:00 [DBG] Connection id "0HNF8JPFCEJ0O", Request id "0HNF8JPFCEJ0O:00000001": done reading request body.
2025-08-31 17:55:05.183 +03:00 [INF] Converting NL to SQL for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 17:55:05.243 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 17:55:05.282 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 17:55:05.535 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 17:55:05.567 +03:00 [DBG] Creating DbConnection.
2025-08-31 17:55:05.568 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 17:55:05.570 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:55:05.572 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:55:05.576 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:55:05.577 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:55:05.581 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 17:55:05.584 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:55:05.590 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:55:05.626 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 17:55:05.654 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:55:05.655 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 62ms reading results.
2025-08-31 17:55:05.658 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:55:05.659 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:55:05.668 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 17:55:05.671 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:55:05.673 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:55:05.674 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 17:55:05.674 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 17:55:05.675 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 17:55:05.676 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:55:05.678 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 17:55:05.681 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:55:05.682 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 17:55:05.683 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 17:55:05.685 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 17:55:05.693 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 17:55:05.706 +03:00 [DBG] Fetching schema for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", ForceRefresh=false
2025-08-31 17:55:05.709 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-31 17:55:05.794 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-31 17:55:05.811 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-31 17:55:05.813 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-31 17:55:05.814 +03:00 [DBG] Generated prompt with 6 messages
2025-08-31 17:55:05.827 +03:00 [DBG] Request payload prepared for Groq API
2025-08-31 17:55:06.618 +03:00 [INF] Groq API responded with status: "OK"
2025-08-31 17:55:06.633 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-31 17:55:06.649 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-31 17:55:06.661 +03:00 [DBG] Connection id "0HNF8JPFCEJ0O" completed keep alive response.
2025-08-31 17:55:06.666 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 17:55:06.671 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 17:55:06.686 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (15ms).
2025-08-31 17:55:06.688 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/convert - 200 null application/json; charset=utf-8 1586.6477ms
2025-08-31 19:05:36.625 +03:00 [INF] This is a test log to file!
2025-08-31 19:05:37.355 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:05:37.366 +03:00 [INF] API configured successfully.
2025-08-31 19:05:37.545 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:05:37.650 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:05:38.565 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:05:38.667 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:05:38.725 +03:00 [INF] Registered 13 endpoints in 1,622 milliseconds.
2025-08-31 19:05:38.752 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:05:38.816 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:05:38.905 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:05:38.917 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-31 19:05:38.920 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:38.925 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:05:38.928 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 19:05:38.930 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:38.944 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:38.948 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:38.952 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:05:38.953 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:38.956 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:38.959 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:05:38.963 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:05:38.968 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 19:05:38.970 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-08-31 19:05:38.977 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:05:39.007 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:05:39.018 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:05:39.020 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:05:39.021 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:05:39.022 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:05:39.0184361+00:00');
SELECT changes();
2025-08-31 19:05:39.028 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:05:39.0184361+00:00');
SELECT changes();
2025-08-31 19:05:39.099 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:05:39.104 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:05:39.107 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:05:39.110 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-08-31 19:05:39.112 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (5ms).
2025-08-31 19:05:39.114 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:05:39.117 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:05:39.120 +03:00 [DBG] Committing transaction.
2025-08-31 19:05:39.122 +03:00 [DBG] Committed transaction.
2025-08-31 19:05:39.124 +03:00 [DBG] Disposing transaction.
2025-08-31 19:05:39.127 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:05:39.128 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:05:39.131 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:05:39.132 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:05:39.133 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:39.134 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:39.135 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:39.136 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:05:39.138 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:05:39.139 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:05:39.140 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:05:39.141 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:05:39.143 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:05:39.147 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:05:39.148 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:05:39.149 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:05:39.151 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:05:39.153 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:05:39.158 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:39.160 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 19:05:39.165 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:05:39.167 +03:00 [DBG] Committing transaction.
2025-08-31 19:05:39.168 +03:00 [DBG] Committed transaction.
2025-08-31 19:05:39.171 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:05:39.172 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:05:39.173 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:05:39.175 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:05:39.182 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:05:39.185 +03:00 [DBG] Disposing transaction.
2025-08-31 19:05:39.187 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:39.190 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 19:05:39.192 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:05:39.194 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:39.195 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:05:39.197 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:05:39.198 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:05:39.242 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:05:39.275 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:05:39.277 +03:00 [DBG] Hosting starting
2025-08-31 19:05:39.313 +03:00 [DBG] Middleware loaded
2025-08-31 19:05:39.322 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:05:39.325 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:05:39.407 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:05:39.409 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:05:39.413 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:05:39.468 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:05:39.525 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:05:39.526 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:05:39.527 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:05:39.528 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:05:39.529 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:05:39.530 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:05:39.537 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:05:39.568 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:05:39.703 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:05:39.704 +03:00 [INF] Hosting environment: Development
2025-08-31 19:05:39.705 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:05:39.706 +03:00 [DBG] Hosting started
2025-08-31 19:05:40.622 +03:00 [DBG] Connection id "0HNF8L0TNC4R7" received FIN.
2025-08-31 19:05:40.630 +03:00 [DBG] Connection id "0HNF8L0TNC4R7" accepted.
2025-08-31 19:05:40.633 +03:00 [DBG] Connection id "0HNF8L0TNC4R7" started.
2025-08-31 19:05:40.635 +03:00 [DBG] Connection id "0HNF8L0TNC4R8" accepted.
2025-08-31 19:05:40.637 +03:00 [DBG] Connection id "0HNF8L0TNC4R8" started.
2025-08-31 19:05:40.642 +03:00 [DBG] Connection id "0HNF8L0TNC4R7" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:05:40.645 +03:00 [DBG] Connection id "0HNF8L0TNC4R7" disconnecting.
2025-08-31 19:05:40.647 +03:00 [DBG] Connection id "0HNF8L0TNC4R7" stopped.
2025-08-31 19:05:40.666 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute - application/json 275
2025-08-31 19:05:40.725 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute'
2025-08-31 19:05:40.728 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute'
2025-08-31 19:05:40.730 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:05:40.768 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:05:40.784 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute'.
2025-08-31 19:05:40.788 +03:00 [DBG] Connection id "0HNF8L0TNC4R8" completed keep alive response.
2025-08-31 19:05:40.791 +03:00 [DBG] Connection id "0HNF8L0TNC4R9" accepted.
2025-08-31 19:05:40.791 +03:00 [DBG] Connection id "0HNF8L0TNC4R9" received FIN.
2025-08-31 19:05:40.797 +03:00 [DBG] Connection id "0HNF8L0TNC4R9" started.
2025-08-31 19:05:40.791 +03:00 [DBG] Connection id "0HNF8L0TNC4RA" accepted.
2025-08-31 19:05:40.791 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute - 307 0 null 129.8627ms
2025-08-31 19:05:40.803 +03:00 [DBG] Connection id "0HNF8L0TNC4R9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:05:40.803 +03:00 [DBG] Connection id "0HNF8L0TNC4RA" started.
2025-08-31 19:05:40.809 +03:00 [DBG] Connection id "0HNF8L0TNC4R9" disconnecting.
2025-08-31 19:05:40.809 +03:00 [DBG] Connection id "0HNF8L0TNC4R8", Request id "0HNF8L0TNC4R8:00000001": started reading request body.
2025-08-31 19:05:40.811 +03:00 [DBG] Connection id "0HNF8L0TNC4R9" stopped.
2025-08-31 19:05:40.813 +03:00 [DBG] Connection id "0HNF8L0TNC4R8", Request id "0HNF8L0TNC4R8:00000001": done reading request body.
2025-08-31 19:05:40.849 +03:00 [DBG] Connection 0HNF8L0TNC4RA established using the following protocol: "Tls13"
2025-08-31 19:05:40.853 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute - application/json 275
2025-08-31 19:05:40.856 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute'
2025-08-31 19:05:40.857 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute'
2025-08-31 19:05:40.858 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:05:40.862 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:05:40.883 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:05:40.886 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:05:40.925 +03:00 [DBG] Connection id "0HNF8L0TNC4RA", Request id "0HNF8L0TNC4RA:00000001": started reading request body.
2025-08-31 19:05:40.927 +03:00 [DBG] Connection id "0HNF8L0TNC4RA", Request id "0HNF8L0TNC4RA:00000001": done reading request body.
2025-08-31 19:05:41.014 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:05:41.055 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:05:41.251 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:05:41.282 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:05:41.283 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:05:41.286 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:41.287 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:41.288 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:05:41.289 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:05:41.292 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 19:05:41.294 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:05:41.299 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:05:41.304 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:41.305 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 19:05:41.307 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:41.308 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:05:41.512 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:05:41.562 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: No profile found with id: 7576e9c9-83e8-40d8-8fbb-a886504d2b61
   at NaturalToQuery.Application.Services.ProfileService.GetProviderTypeAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 200
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 61
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 29
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:05:41.573 +03:00 [ERR] Unhandled exception occurred.
2025-08-31 19:05:41.581 +03:00 [DBG] Connection id "0HNF8L0TNC4RA" completed keep alive response.
2025-08-31 19:05:41.584 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:05:41.589 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:41.592 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:05:41.594 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/7576e9c9-83e8-40d8-8fbb-a886504d2b61/execute - 500 null application/json; charset=utf-8 741.6173ms
2025-08-31 19:05:54.219 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/setup/profiles - null null
2025-08-31 19:05:54.222 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 19:05:54.223 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 19:05:54.228 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/setup/profiles'.
2025-08-31 19:05:54.229 +03:00 [DBG] Connection id "0HNF8L0TNC4R8" completed keep alive response.
2025-08-31 19:05:54.231 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/setup/profiles - 307 0 null 11.5587ms
2025-08-31 19:05:54.232 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profiles - null null
2025-08-31 19:05:54.236 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profiles'
2025-08-31 19:05:54.237 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 19:05:54.239 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 19:05:54.241 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:05:54.252 +03:00 [INF] Listing all profiles
2025-08-31 19:05:54.259 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .AsNoTracking()'
2025-08-31 19:05:54.261 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:05:54.275 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Profile>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
            3 -> 7
        SELECT p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
        FROM Profiles AS p
        LEFT JOIN Queries AS q ON p.Id == q.ProfileId
        ORDER BY p.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            Profile entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Profile instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Profile);
                (object)dataReader.GetGuid(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                            {
                                return 
                                {
                                    Profile instance;
                                    instance = new Profile();
                                    instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                    instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                    instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                    instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Profile)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetGuid(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (Profile)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                Query entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    Query instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(Query);
                    dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                {
                                    return 
                                    {
                                        Query instance;
                                        instance = new Query();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                        instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                        instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                        instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                        instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                        instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Query)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
            fixup: (namelessParameter{11}, namelessParameter{12}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                    entity: namelessParameter{11}, 
                    value: namelessParameter{12}, 
                    forMaterialization: True);
                return namelessParameter{12}.<Profile>k__BackingField = namelessParameter{11};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (Profile)(resultContext.Values[0]) : default(Profile);
    }, 
    contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-08-31 19:05:54.280 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:05:54.281 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:05:54.281 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:54.282 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.284 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:05:54.285 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:05:54.286 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:05:54.287 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 19:05:54.289 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM "Profiles" AS "p"
LEFT JOIN "Queries" AS "q" ON "p"."Id" = "q"."ProfileId"
ORDER BY "p"."Id"
2025-08-31 19:05:54.300 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.301 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 10ms reading results.
2025-08-31 19:05:54.303 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.304 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:05:54.307 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:05:54.313 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:54.317 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.319 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:05:54.320 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:05:54.321 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:05:54.322 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:05:54.325 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:05:54.351 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:05:54.373 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.374 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 46ms reading results.
2025-08-31 19:05:54.375 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.376 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:05:54.400 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:05:54.401 +03:00 [INF] Fetching connection string for profile "feaaa72e-cd81-4eb0-afcc-394ebb3cd245"
2025-08-31 19:05:54.402 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:54.404 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.405 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:05:54.406 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:05:54.407 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:05:54.408 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:05:54.409 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:05:54.411 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:05:54.413 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.414 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:05:54.415 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:05:54.416 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:05:54.418 +03:00 [DBG] Fetched secret for profile "feaaa72e-cd81-4eb0-afcc-394ebb3cd245"
2025-08-31 19:05:54.431 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/profiles'
2025-08-31 19:05:54.432 +03:00 [DBG] Connection id "0HNF8L0TNC4RA" completed keep alive response.
2025-08-31 19:05:54.433 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:05:54.434 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:05:54.435 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:05:54.437 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profiles - 200 null application/json; charset=utf-8 204.9315ms
2025-08-31 19:06:07.004 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 275
2025-08-31 19:06:07.007 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:07.008 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:07.010 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:06:07.012 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:06:07.013 +03:00 [DBG] Connection id "0HNF8L0TNC4R8" completed keep alive response.
2025-08-31 19:06:07.014 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 10.3613ms
2025-08-31 19:06:07.016 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 275
2025-08-31 19:06:07.019 +03:00 [DBG] Connection id "0HNF8L0TNC4R8", Request id "0HNF8L0TNC4R8:00000003": started reading request body.
2025-08-31 19:06:07.022 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:07.023 +03:00 [DBG] Connection id "0HNF8L0TNC4R8", Request id "0HNF8L0TNC4R8:00000003": done reading request body.
2025-08-31 19:06:07.024 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:07.028 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:06:07.030 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:06:07.033 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:06:07.035 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:06:07.036 +03:00 [DBG] Connection id "0HNF8L0TNC4RA", Request id "0HNF8L0TNC4RA:00000003": started reading request body.
2025-08-31 19:06:07.037 +03:00 [DBG] Connection id "0HNF8L0TNC4RA", Request id "0HNF8L0TNC4RA:00000003": done reading request body.
2025-08-31 19:06:07.040 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:06:07.041 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:06:07.042 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:07.043 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:07.044 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:06:07.045 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:06:07.046 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:06:07.047 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:07.049 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:07.051 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:06:07.052 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:07.053 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:06:07.055 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:07.056 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:06:07.065 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:06:07.066 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:07.067 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:07.068 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:06:07.069 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:06:07.070 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:06:07.071 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:07.073 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:07.075 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:07.076 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 19:06:07.077 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:07.078 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:06:07.079 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:06:07.104 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:06:18.668 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:06:19.081 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:06:20.380 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:06:20.721 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:06:20.775 +03:00 [ERR] SQL execution failed after 397 ms: Parameter count mismatch.
2025-08-31 19:06:31.664 +03:00 [INF] This is a test log to file!
2025-08-31 19:06:32.064 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:06:32.076 +03:00 [INF] API configured successfully.
2025-08-31 19:06:32.171 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:06:32.224 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:06:32.666 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:06:32.701 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:06:32.715 +03:00 [INF] Registered 13 endpoints in 909 milliseconds.
2025-08-31 19:06:32.722 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:06:32.758 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:06:32.841 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:06:32.852 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-31 19:06:32.856 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:32.862 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:06:32.865 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 19:06:32.869 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:32.878 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:32.882 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:32.886 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:06:32.888 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:32.891 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:32.892 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:06:32.896 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:06:32.900 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:06:32.902 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (5ms).
2025-08-31 19:06:32.907 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:06:32.926 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:06:32.928 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:06:32.929 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:06:32.930 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:06:32.931 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:06:32.928547+00:00');
SELECT changes();
2025-08-31 19:06:32.935 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:06:32.928547+00:00');
SELECT changes();
2025-08-31 19:06:32.973 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:06:32.976 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:06:32.977 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:06:32.978 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 19:06:32.979 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 19:06:32.980 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:06:32.982 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:06:32.983 +03:00 [DBG] Committing transaction.
2025-08-31 19:06:32.985 +03:00 [DBG] Committed transaction.
2025-08-31 19:06:32.986 +03:00 [DBG] Disposing transaction.
2025-08-31 19:06:32.988 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:06:32.989 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:06:32.992 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:06:32.992 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:06:32.993 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:32.995 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:32.996 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:32.997 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:06:32.999 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:06:33.001 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:06:33.003 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 19:06:33.004 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:06:33.006 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:06:33.010 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:06:33.011 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:06:33.012 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:06:33.014 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:06:33.016 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:06:33.020 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:33.023 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:06:33.028 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:06:33.029 +03:00 [DBG] Committing transaction.
2025-08-31 19:06:33.030 +03:00 [DBG] Committed transaction.
2025-08-31 19:06:33.031 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:06:33.031 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:06:33.032 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:06:33.033 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:06:33.036 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:06:33.038 +03:00 [DBG] Disposing transaction.
2025-08-31 19:06:33.039 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:33.042 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 19:06:33.044 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:06:33.044 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:33.045 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:06:33.046 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:06:33.047 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:06:33.069 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:06:33.095 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:06:33.097 +03:00 [DBG] Hosting starting
2025-08-31 19:06:33.108 +03:00 [DBG] Middleware loaded
2025-08-31 19:06:33.111 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:06:33.112 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:06:33.181 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:06:33.182 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:06:33.184 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:06:33.211 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:06:33.250 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:06:33.251 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:06:33.251 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:06:33.252 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:06:33.252 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:06:33.253 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:06:33.258 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:06:33.265 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:06:33.356 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:06:33.357 +03:00 [INF] Hosting environment: Development
2025-08-31 19:06:33.357 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:06:33.358 +03:00 [DBG] Hosting started
2025-08-31 19:06:57.711 +03:00 [DBG] Connection id "0HNF8L1KMHSEM" received FIN.
2025-08-31 19:06:57.722 +03:00 [DBG] Connection id "0HNF8L1KMHSEM" accepted.
2025-08-31 19:06:57.725 +03:00 [DBG] Connection id "0HNF8L1KMHSEM" started.
2025-08-31 19:06:57.726 +03:00 [DBG] Connection id "0HNF8L1KMHSEN" accepted.
2025-08-31 19:06:57.729 +03:00 [DBG] Connection id "0HNF8L1KMHSEN" started.
2025-08-31 19:06:57.736 +03:00 [DBG] Connection id "0HNF8L1KMHSEM" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:06:57.740 +03:00 [DBG] Connection id "0HNF8L1KMHSEM" disconnecting.
2025-08-31 19:06:57.742 +03:00 [DBG] Connection id "0HNF8L1KMHSEM" stopped.
2025-08-31 19:06:57.766 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:06:57.805 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:57.807 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:57.810 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:06:57.832 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:06:57.834 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:06:57.837 +03:00 [DBG] Connection id "0HNF8L1KMHSEN" completed keep alive response.
2025-08-31 19:06:57.839 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 78.8791ms
2025-08-31 19:06:57.839 +03:00 [DBG] Connection id "0HNF8L1KMHSEO" received FIN.
2025-08-31 19:06:57.839 +03:00 [DBG] Connection id "0HNF8L1KMHSEP" accepted.
2025-08-31 19:06:57.839 +03:00 [DBG] Connection id "0HNF8L1KMHSEO" accepted.
2025-08-31 19:06:57.849 +03:00 [DBG] Connection id "0HNF8L1KMHSEN", Request id "0HNF8L1KMHSEN:00000001": started reading request body.
2025-08-31 19:06:57.850 +03:00 [DBG] Connection id "0HNF8L1KMHSEP" started.
2025-08-31 19:06:57.851 +03:00 [DBG] Connection id "0HNF8L1KMHSEO" started.
2025-08-31 19:06:57.852 +03:00 [DBG] Connection id "0HNF8L1KMHSEN", Request id "0HNF8L1KMHSEN:00000001": done reading request body.
2025-08-31 19:06:57.854 +03:00 [DBG] Connection id "0HNF8L1KMHSEO" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:06:57.857 +03:00 [DBG] Connection id "0HNF8L1KMHSEO" disconnecting.
2025-08-31 19:06:57.858 +03:00 [DBG] Connection id "0HNF8L1KMHSEO" stopped.
2025-08-31 19:06:57.886 +03:00 [DBG] Connection 0HNF8L1KMHSEP established using the following protocol: "Tls13"
2025-08-31 19:06:57.888 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:06:57.892 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:57.893 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:06:57.895 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:06:57.898 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:06:57.910 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:06:57.913 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:06:57.950 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000001": started reading request body.
2025-08-31 19:06:57.952 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000001": done reading request body.
2025-08-31 19:06:58.030 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:06:58.065 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:06:58.263 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:06:58.289 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:06:58.290 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:06:58.292 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:58.294 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:58.295 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:06:58.296 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:06:58.298 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:06:58.301 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:58.307 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:58.337 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:06:58.363 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:58.366 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 56ms reading results.
2025-08-31 19:06:58.369 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:58.370 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:06:58.378 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:06:58.382 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:06:58.383 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:58.384 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:06:58.385 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:06:58.386 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:06:58.388 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:58.390 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:06:58.394 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:58.395 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:06:58.397 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:06:58.398 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:06:58.407 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:06:58.418 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:07:12.098 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:07:12.464 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:07:16.927 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:07:18.414 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:08:20.739 +03:00 [ERR] SQL execution failed after 65304 ms: Parameter count mismatch.
2025-08-31 19:08:21.021 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:21.172 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.Reflection.TargetParameterCountException: Parameter count mismatch.
   at System.Reflection.MethodBaseInvoker.ThrowTargetParameterCountException()
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.PropertyInfo.GetValue(Object obj)
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.AddParameters(DbCommand cmd, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 871
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 787
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 722
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 739
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 266
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:08:21.187 +03:00 [ERR] Error occurred.
2025-08-31 19:08:21.214 +03:00 [DBG] Connection id "0HNF8L1KMHSEP" completed keep alive response.
2025-08-31 19:08:21.217 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:08:21.222 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:08:21.235 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (12ms).
2025-08-31 19:08:21.237 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 500 null application/json; charset=utf-8 83348.1641ms
2025-08-31 19:08:36.165 +03:00 [DBG] Connection id "0HNF8L1KMHSEQ" received FIN.
2025-08-31 19:08:36.167 +03:00 [DBG] Connection id "0HNF8L1KMHSEQ" accepted.
2025-08-31 19:08:36.168 +03:00 [DBG] Connection id "0HNF8L1KMHSEQ" started.
2025-08-31 19:08:36.168 +03:00 [DBG] Connection id "0HNF8L1KMHSER" accepted.
2025-08-31 19:08:36.169 +03:00 [DBG] Connection id "0HNF8L1KMHSEQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:08:36.170 +03:00 [DBG] Connection id "0HNF8L1KMHSER" started.
2025-08-31 19:08:36.175 +03:00 [DBG] Connection id "0HNF8L1KMHSEQ" disconnecting.
2025-08-31 19:08:36.176 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:08:36.177 +03:00 [DBG] Connection id "0HNF8L1KMHSEQ" stopped.
2025-08-31 19:08:36.179 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:36.181 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:36.182 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:36.185 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:08:36.186 +03:00 [DBG] Connection id "0HNF8L1KMHSER" completed keep alive response.
2025-08-31 19:08:36.187 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 10.8261ms
2025-08-31 19:08:36.188 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:08:36.190 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000001": started reading request body.
2025-08-31 19:08:36.192 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:36.193 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000001": done reading request body.
2025-08-31 19:08:36.194 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:36.197 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:36.198 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:36.209 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:08:36.211 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:08:36.211 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000002": started reading request body.
2025-08-31 19:08:36.212 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000002": done reading request body.
2025-08-31 19:08:36.216 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:08:36.217 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:08:36.217 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:08:36.218 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:36.219 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:08:36.220 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:08:36.222 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:08:36.223 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:36.225 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:36.227 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:08:36.229 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:36.230 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:08:36.231 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:36.233 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:08:36.235 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:08:36.236 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:08:36.237 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:36.239 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:08:36.240 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:08:36.242 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:08:36.243 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:36.245 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:36.248 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:36.249 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 19:08:36.251 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:36.252 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:08:36.254 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:08:36.254 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:08:40.546 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:08:40.850 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:08:41.875 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:08:41.878 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:08:41.947 +03:00 [ERR] SQL execution failed after 72 ms: Parameter count mismatch.
2025-08-31 19:08:43.823 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:43.860 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.Reflection.TargetParameterCountException: Parameter count mismatch.
   at System.Reflection.MethodBaseInvoker.ThrowTargetParameterCountException()
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.PropertyInfo.GetValue(Object obj)
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.AddParameters(DbCommand cmd, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 871
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 787
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 722
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 739
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 266
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:08:43.865 +03:00 [ERR] Error occurred.
2025-08-31 19:08:43.866 +03:00 [DBG] Connection id "0HNF8L1KMHSEP" completed keep alive response.
2025-08-31 19:08:43.867 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:08:43.868 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:08:43.869 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:08:43.871 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 500 null application/json; charset=utf-8 7682.6014ms
2025-08-31 19:08:49.176 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 277
2025-08-31 19:08:49.178 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:49.179 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:49.180 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:49.181 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:08:49.182 +03:00 [DBG] Connection id "0HNF8L1KMHSER" completed keep alive response.
2025-08-31 19:08:49.184 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 7.6168ms
2025-08-31 19:08:49.184 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 277
2025-08-31 19:08:49.186 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000002": started reading request body.
2025-08-31 19:08:49.188 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:49.189 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000002": done reading request body.
2025-08-31 19:08:49.190 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:08:49.191 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:49.193 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:08:49.194 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:08:49.195 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:08:49.196 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000003": started reading request body.
2025-08-31 19:08:49.197 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000003": done reading request body.
2025-08-31 19:08:49.199 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:08:49.200 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:08:49.201 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:08:49.202 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:49.203 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:08:49.204 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:08:49.205 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:08:49.206 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:49.208 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:49.210 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:08:49.211 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:49.212 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:08:49.213 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:49.215 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:08:49.217 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:08:49.218 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:08:49.219 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:49.220 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:08:49.221 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:08:49.222 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:08:49.223 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:49.224 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:08:49.226 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:49.227 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 19:08:49.228 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:08:49.229 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:08:49.230 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:08:49.232 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:08:51.689 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:08:52.042 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:08:53.013 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:08:53.015 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:08:53.063 +03:00 [ERR] SQL execution failed after 49 ms: Parameter count mismatch.
2025-08-31 19:09:13.443 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:09:13.491 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.Reflection.TargetParameterCountException: Parameter count mismatch.
   at System.Reflection.MethodBaseInvoker.ThrowTargetParameterCountException()
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.PropertyInfo.GetValue(Object obj)
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.AddParameters(DbCommand cmd, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 871
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 787
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 722
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 739
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 266
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:09:13.497 +03:00 [ERR] Error occurred.
2025-08-31 19:09:13.498 +03:00 [DBG] Connection id "0HNF8L1KMHSEP" completed keep alive response.
2025-08-31 19:09:13.499 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:09:13.500 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:09:13.502 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:09:13.504 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 500 null application/json; charset=utf-8 24320.0817ms
2025-08-31 19:09:19.836 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 278
2025-08-31 19:09:19.839 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:09:19.841 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:09:19.842 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:09:19.843 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:09:19.844 +03:00 [DBG] Connection id "0HNF8L1KMHSER" completed keep alive response.
2025-08-31 19:09:19.845 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 8.8475ms
2025-08-31 19:09:19.868 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 278
2025-08-31 19:09:19.872 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000003": started reading request body.
2025-08-31 19:09:19.874 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:09:19.875 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000003": done reading request body.
2025-08-31 19:09:19.876 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:09:19.878 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:09:19.878 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:09:19.880 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:09:19.882 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:09:19.883 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000004": started reading request body.
2025-08-31 19:09:19.884 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000004": done reading request body.
2025-08-31 19:09:19.886 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:09:19.886 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:09:19.887 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:09:19.888 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:09:19.889 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:09:19.890 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:09:19.891 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:09:19.892 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:09:19.894 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:09:19.896 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:09:19.898 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:09:19.899 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:09:19.900 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:09:19.901 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:09:19.902 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:09:19.903 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:09:19.904 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:09:19.905 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:09:19.906 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:09:19.907 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:09:19.908 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:09:19.910 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:09:19.912 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:09:19.913 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 19:09:19.914 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:09:19.914 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:09:19.916 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:09:19.917 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:09:22.561 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:09:22.798 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:09:23.593 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:09:23.594 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:09:23.638 +03:00 [ERR] SQL execution failed after 45 ms: Parameter count mismatch.
2025-08-31 19:09:26.035 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:09:26.082 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.Reflection.TargetParameterCountException: Parameter count mismatch.
   at System.Reflection.MethodBaseInvoker.ThrowTargetParameterCountException()
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.PropertyInfo.GetValue(Object obj)
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.AddParameters(DbCommand cmd, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 871
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 787
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 722
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 739
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 266
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:09:26.102 +03:00 [ERR] Error occurred.
2025-08-31 19:09:26.103 +03:00 [DBG] Connection id "0HNF8L1KMHSEP" completed keep alive response.
2025-08-31 19:09:26.104 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:09:26.105 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:09:26.107 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:09:26.109 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 500 null application/json; charset=utf-8 6262.4564ms
2025-08-31 19:10:02.413 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:10:02.417 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:10:02.418 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:10:02.420 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:10:02.421 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:10:02.422 +03:00 [DBG] Connection id "0HNF8L1KMHSER" completed keep alive response.
2025-08-31 19:10:02.423 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 31.6866ms
2025-08-31 19:10:02.468 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:10:02.470 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000004": started reading request body.
2025-08-31 19:10:02.472 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:10:02.473 +03:00 [DBG] Connection id "0HNF8L1KMHSER", Request id "0HNF8L1KMHSER:00000004": done reading request body.
2025-08-31 19:10:02.474 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:10:02.476 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:10:02.477 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:10:02.479 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:10:02.481 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:10:02.481 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000005": started reading request body.
2025-08-31 19:10:02.482 +03:00 [DBG] Connection id "0HNF8L1KMHSEP", Request id "0HNF8L1KMHSEP:00000005": done reading request body.
2025-08-31 19:10:02.485 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:10:02.486 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:10:02.487 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:10:02.488 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:10:02.490 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:10:02.491 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:10:02.492 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:10:02.493 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:10:02.495 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:10:02.497 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:10:02.498 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:10:02.499 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:10:02.501 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:10:02.502 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:10:02.503 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:10:02.504 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:10:02.505 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:10:02.506 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:10:02.507 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:10:02.508 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:10:02.510 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:10:02.512 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:10:02.513 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:10:02.515 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 19:10:02.516 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:10:02.517 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:10:02.518 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:10:02.520 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:10:07.054 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:10:08.669 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:10:10.791 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:10:11.081 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:12:58.987 +03:00 [INF] This is a test log to file!
2025-08-31 19:12:59.260 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:12:59.267 +03:00 [INF] API configured successfully.
2025-08-31 19:12:59.350 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:12:59.399 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:12:59.841 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:12:59.868 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:12:59.876 +03:00 [INF] Registered 13 endpoints in 779 milliseconds.
2025-08-31 19:12:59.882 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:12:59.918 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:12:59.995 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:13:00.006 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 19:13:00.011 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:00.016 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:13:00.018 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 19:13:00.020 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:00.027 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:00.031 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:00.036 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:13:00.038 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:00.041 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:00.043 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:13:00.048 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:13:00.052 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:13:00.054 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 19:13:00.060 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:13:00.081 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:13:00.084 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:13:00.086 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:13:00.087 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:13:00.088 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:13:00.0847034+00:00');
SELECT changes();
2025-08-31 19:13:00.094 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:13:00.0847034+00:00');
SELECT changes();
2025-08-31 19:13:00.136 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:13:00.139 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:13:00.142 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:13:00.143 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 19:13:00.144 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 19:13:00.146 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:13:00.148 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:13:00.151 +03:00 [DBG] Committing transaction.
2025-08-31 19:13:00.154 +03:00 [DBG] Committed transaction.
2025-08-31 19:13:00.157 +03:00 [DBG] Disposing transaction.
2025-08-31 19:13:00.160 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:13:00.162 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:13:00.164 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:13:00.166 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:13:00.167 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:00.169 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:00.170 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:00.172 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:13:00.174 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:13:00.174 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:13:00.176 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:13:00.177 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:13:00.179 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:13:00.182 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:13:00.184 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:13:00.185 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:13:00.187 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:13:00.188 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:13:00.193 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:00.195 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:13:00.199 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:13:00.200 +03:00 [DBG] Committing transaction.
2025-08-31 19:13:00.200 +03:00 [DBG] Committed transaction.
2025-08-31 19:13:00.201 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:13:00.202 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:13:00.203 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:13:00.204 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:13:00.208 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:13:00.210 +03:00 [DBG] Disposing transaction.
2025-08-31 19:13:00.212 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:00.215 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 19:13:00.217 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:13:00.218 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:00.219 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:13:00.220 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:13:00.221 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:13:00.242 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:13:00.272 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:13:00.273 +03:00 [DBG] Hosting starting
2025-08-31 19:13:00.284 +03:00 [DBG] Middleware loaded
2025-08-31 19:13:00.287 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:13:00.289 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:13:00.451 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:13:00.453 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:13:00.456 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:13:00.503 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:13:00.549 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:13:00.550 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:13:00.551 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:13:00.552 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:13:00.552 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:13:00.553 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:13:00.560 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:13:00.566 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:13:00.597 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:13:00.598 +03:00 [INF] Hosting environment: Development
2025-08-31 19:13:00.598 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:13:00.599 +03:00 [DBG] Hosting started
2025-08-31 19:13:14.715 +03:00 [DBG] Connection id "0HNF8L551UBP6" received FIN.
2025-08-31 19:13:14.722 +03:00 [DBG] Connection id "0HNF8L551UBP6" accepted.
2025-08-31 19:13:14.723 +03:00 [DBG] Connection id "0HNF8L551UBP6" started.
2025-08-31 19:13:14.725 +03:00 [DBG] Connection id "0HNF8L551UBP7" accepted.
2025-08-31 19:13:14.726 +03:00 [DBG] Connection id "0HNF8L551UBP7" started.
2025-08-31 19:13:14.731 +03:00 [DBG] Connection id "0HNF8L551UBP6" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:13:14.734 +03:00 [DBG] Connection id "0HNF8L551UBP6" disconnecting.
2025-08-31 19:13:14.737 +03:00 [DBG] Connection id "0HNF8L551UBP6" stopped.
2025-08-31 19:13:14.753 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:13:14.793 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:13:14.795 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:13:14.797 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:13:14.824 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:13:14.827 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:13:14.829 +03:00 [DBG] Connection id "0HNF8L551UBP7" completed keep alive response.
2025-08-31 19:13:14.832 +03:00 [DBG] Connection id "0HNF8L551UBP8" accepted.
2025-08-31 19:13:14.832 +03:00 [DBG] Connection id "0HNF8L551UBP8" received FIN.
2025-08-31 19:13:14.832 +03:00 [DBG] Connection id "0HNF8L551UBP9" accepted.
2025-08-31 19:13:14.833 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 83.11ms
2025-08-31 19:13:14.839 +03:00 [DBG] Connection id "0HNF8L551UBP8" started.
2025-08-31 19:13:14.841 +03:00 [DBG] Connection id "0HNF8L551UBP9" started.
2025-08-31 19:13:14.846 +03:00 [DBG] Connection id "0HNF8L551UBP8" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:13:14.847 +03:00 [DBG] Connection id "0HNF8L551UBP7", Request id "0HNF8L551UBP7:00000001": started reading request body.
2025-08-31 19:13:14.848 +03:00 [DBG] Connection id "0HNF8L551UBP8" disconnecting.
2025-08-31 19:13:14.849 +03:00 [DBG] Connection id "0HNF8L551UBP7", Request id "0HNF8L551UBP7:00000001": done reading request body.
2025-08-31 19:13:14.850 +03:00 [DBG] Connection id "0HNF8L551UBP8" stopped.
2025-08-31 19:13:14.881 +03:00 [DBG] Connection 0HNF8L551UBP9 established using the following protocol: "Tls13"
2025-08-31 19:13:14.885 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:13:14.889 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:13:14.890 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:13:14.892 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:13:14.896 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:13:14.908 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:13:14.911 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:13:14.951 +03:00 [DBG] Connection id "0HNF8L551UBP9", Request id "0HNF8L551UBP9:00000001": started reading request body.
2025-08-31 19:13:14.953 +03:00 [DBG] Connection id "0HNF8L551UBP9", Request id "0HNF8L551UBP9:00000001": done reading request body.
2025-08-31 19:13:15.040 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:13:15.078 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:13:15.286 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:13:15.316 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:13:15.318 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 19:13:15.321 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:15.324 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:15.326 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:13:15.327 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:13:15.329 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 19:13:15.332 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:13:15.338 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:13:15.371 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:13:15.398 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:15.400 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 60ms reading results.
2025-08-31 19:13:15.403 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:15.405 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:13:15.416 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:13:15.419 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:15.421 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:15.422 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:13:15.423 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:13:15.424 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:13:15.426 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:13:15.428 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:13:15.431 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:15.433 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:13:15.435 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:13:15.436 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:13:15.447 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:13:15.461 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:13:21.751 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:13:22.143 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:13:26.638 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:13:27.480 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:13:59.478 +03:00 [ERR] SQL execution failed after 33849 ms: Parameter count mismatch.
2025-08-31 19:13:59.747 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:13:59.876 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.Reflection.TargetParameterCountException: Parameter count mismatch.
   at System.Reflection.MethodBaseInvoker.ThrowTargetParameterCountException()
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.PropertyInfo.GetValue(Object obj)
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.AddParameters(DbCommand cmd, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 871
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 787
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 722
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 739
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 266
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:13:59.889 +03:00 [ERR] Error occurred.
2025-08-31 19:13:59.906 +03:00 [DBG] Connection id "0HNF8L551UBP9" completed keep alive response.
2025-08-31 19:13:59.908 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:13:59.912 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:13:59.913 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:13:59.916 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 500 null application/json; charset=utf-8 45030.5753ms
2025-08-31 19:14:13.180 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:14:13.183 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:14:13.184 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:14:13.186 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:14:13.188 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:14:13.190 +03:00 [DBG] Connection id "0HNF8L551UBP7" completed keep alive response.
2025-08-31 19:14:13.191 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 11.1306ms
2025-08-31 19:14:13.217 +03:00 [DBG] Connection id "0HNF8L551UBP7", Request id "0HNF8L551UBP7:00000002": started reading request body.
2025-08-31 19:14:13.217 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:14:13.218 +03:00 [DBG] Connection id "0HNF8L551UBP7", Request id "0HNF8L551UBP7:00000002": done reading request body.
2025-08-31 19:14:13.220 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:14:13.222 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:14:13.223 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:14:13.224 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:14:13.234 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:14:13.235 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:14:13.236 +03:00 [DBG] Connection id "0HNF8L551UBP9", Request id "0HNF8L551UBP9:00000002": started reading request body.
2025-08-31 19:14:13.237 +03:00 [DBG] Connection id "0HNF8L551UBP9", Request id "0HNF8L551UBP9:00000002": done reading request body.
2025-08-31 19:14:13.239 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:14:13.240 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:14:13.241 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:14:13.242 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:14:13.243 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:14:13.244 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:14:13.245 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:14:13.246 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:14:13.247 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:14:13.249 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:14:13.251 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:14:13.252 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:14:13.253 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:14:13.254 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:14:13.256 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:14:13.257 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:14:13.258 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:14:13.259 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:14:13.259 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:14:13.261 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:14:13.262 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:14:13.263 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:14:13.265 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:14:13.266 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 19:14:13.267 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:14:13.268 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:14:13.270 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:14:13.271 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:14:13.271 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:14:13.272 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:14:13.273 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:14:13.276 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:15:08.393 +03:00 [INF] This is a test log to file!
2025-08-31 19:15:08.794 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:15:08.814 +03:00 [INF] API configured successfully.
2025-08-31 19:15:08.933 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:15:09.009 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:15:09.729 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:15:09.780 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:15:09.792 +03:00 [INF] Registered 13 endpoints in 1,277 milliseconds.
2025-08-31 19:15:09.802 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:15:09.843 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:15:09.930 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:09.941 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 19:15:09.943 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:09.948 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:09.950 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 19:15:09.952 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:09.963 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:09.966 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:09.984 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (14ms).
2025-08-31 19:15:09.985 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:09.994 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:09.996 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:15:10.001 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:10.008 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 19:15:10.010 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-08-31 19:15:10.025 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:15:10.069 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:15:10.073 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:10.074 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:15:10.075 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:15:10.081 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:15:10.072944+00:00');
SELECT changes();
2025-08-31 19:15:10.087 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:15:10.072944+00:00');
SELECT changes();
2025-08-31 19:15:10.140 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:15:10.143 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:15:10.146 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:15:10.146 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 19:15:10.148 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 19:15:10.149 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:15:10.152 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:15:10.154 +03:00 [DBG] Committing transaction.
2025-08-31 19:15:10.155 +03:00 [DBG] Committed transaction.
2025-08-31 19:15:10.158 +03:00 [DBG] Disposing transaction.
2025-08-31 19:15:10.160 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:15:10.161 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:15:10.164 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:10.165 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:15:10.166 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:10.176 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:10.177 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:10.178 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:15:10.180 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:10.181 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:15:10.183 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:15:10.195 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:15:10.196 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:15:10.200 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:10.201 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:15:10.202 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:15:10.203 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:15:10.206 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:15:10.210 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:10.213 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-31 19:15:10.218 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:15:10.219 +03:00 [DBG] Committing transaction.
2025-08-31 19:15:10.220 +03:00 [DBG] Committed transaction.
2025-08-31 19:15:10.221 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:10.222 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:15:10.223 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:15:10.224 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:15:10.232 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:15:10.234 +03:00 [DBG] Disposing transaction.
2025-08-31 19:15:10.240 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:10.244 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 19:15:10.245 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:15:10.246 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:10.247 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:15:10.263 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:15:10.264 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:15:10.300 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:15:10.330 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:15:10.333 +03:00 [DBG] Hosting starting
2025-08-31 19:15:10.348 +03:00 [DBG] Middleware loaded
2025-08-31 19:15:10.352 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:15:10.353 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:15:10.447 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:15:10.450 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:15:10.454 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:15:10.494 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:15:10.569 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:15:10.570 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:15:10.571 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:15:10.572 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:15:10.573 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:15:10.581 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:15:10.592 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:15:10.599 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:15:10.692 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:15:10.692 +03:00 [INF] Hosting environment: Development
2025-08-31 19:15:10.693 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:15:10.694 +03:00 [DBG] Hosting started
2025-08-31 19:15:11.071 +03:00 [DBG] Connection id "0HNF8L67NJAS9" received FIN.
2025-08-31 19:15:11.092 +03:00 [DBG] Connection id "0HNF8L67NJAS9" accepted.
2025-08-31 19:15:11.093 +03:00 [DBG] Connection id "0HNF8L67NJAS9" started.
2025-08-31 19:15:11.095 +03:00 [DBG] Connection id "0HNF8L67NJASA" accepted.
2025-08-31 19:15:11.098 +03:00 [DBG] Connection id "0HNF8L67NJASA" started.
2025-08-31 19:15:11.103 +03:00 [DBG] Connection id "0HNF8L67NJAS9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:15:11.109 +03:00 [DBG] Connection id "0HNF8L67NJAS9" disconnecting.
2025-08-31 19:15:11.114 +03:00 [DBG] Connection id "0HNF8L67NJAS9" stopped.
2025-08-31 19:15:11.131 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:15:11.172 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:11.175 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:11.178 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:11.221 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:15:11.230 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:15:11.243 +03:00 [DBG] Connection id "0HNF8L67NJASA" completed keep alive response.
2025-08-31 19:15:11.247 +03:00 [DBG] Connection id "0HNF8L67NJASB" accepted.
2025-08-31 19:15:11.248 +03:00 [DBG] Connection id "0HNF8L67NJASB" received FIN.
2025-08-31 19:15:11.249 +03:00 [DBG] Connection id "0HNF8L67NJASC" accepted.
2025-08-31 19:15:11.255 +03:00 [DBG] Connection id "0HNF8L67NJASB" started.
2025-08-31 19:15:11.255 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 124.2578ms
2025-08-31 19:15:11.257 +03:00 [DBG] Connection id "0HNF8L67NJASC" started.
2025-08-31 19:15:11.259 +03:00 [DBG] Connection id "0HNF8L67NJASB" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:15:11.269 +03:00 [DBG] Connection id "0HNF8L67NJASA", Request id "0HNF8L67NJASA:00000001": started reading request body.
2025-08-31 19:15:11.270 +03:00 [DBG] Connection id "0HNF8L67NJASB" disconnecting.
2025-08-31 19:15:11.272 +03:00 [DBG] Connection id "0HNF8L67NJASA", Request id "0HNF8L67NJASA:00000001": done reading request body.
2025-08-31 19:15:11.274 +03:00 [DBG] Connection id "0HNF8L67NJASB" stopped.
2025-08-31 19:15:11.328 +03:00 [DBG] Connection 0HNF8L67NJASC established using the following protocol: "Tls13"
2025-08-31 19:15:11.333 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:15:11.339 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:11.341 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:11.342 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:11.346 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:11.362 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:15:11.366 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:15:11.420 +03:00 [DBG] Connection id "0HNF8L67NJASC", Request id "0HNF8L67NJASC:00000001": started reading request body.
2025-08-31 19:15:11.421 +03:00 [DBG] Connection id "0HNF8L67NJASC", Request id "0HNF8L67NJASC:00000001": done reading request body.
2025-08-31 19:15:11.530 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:15:11.599 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:15:11.795 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:15:11.826 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:11.828 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 19:15:11.831 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:11.833 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:11.834 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:11.836 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:15:11.838 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 19:15:11.840 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:11.846 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:11.876 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:15:11.902 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:11.904 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 55ms reading results.
2025-08-31 19:15:11.906 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:11.909 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:15:11.918 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:15:11.921 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:11.923 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:11.923 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:11.924 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:15:11.925 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:15:11.926 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:11.928 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:11.931 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:11.932 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:15:11.934 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:11.935 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:15:11.945 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:15:11.956 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:15:11.959 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:15:11.960 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:15:11.961 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:15:12.150 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:15:18.802 +03:00 [ERR] SQL execution failed after 6840 ms: Parameter count mismatch.
2025-08-31 19:15:19.053 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:19.189 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.Reflection.TargetParameterCountException: Parameter count mismatch.
   at System.Reflection.MethodBaseInvoker.ThrowTargetParameterCountException()
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.PropertyInfo.GetValue(Object obj)
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.AddParameters(DbCommand cmd, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 871
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 787
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 722
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 739
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 266
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:15:19.203 +03:00 [ERR] Error occurred.
2025-08-31 19:15:19.219 +03:00 [DBG] Connection id "0HNF8L67NJASC" completed keep alive response.
2025-08-31 19:15:19.221 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:15:19.226 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:19.228 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:15:19.230 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 500 null application/json; charset=utf-8 7897.6771ms
2025-08-31 19:15:22.775 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:15:22.778 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:22.779 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:22.781 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:22.783 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:15:22.784 +03:00 [DBG] Connection id "0HNF8L67NJASA" completed keep alive response.
2025-08-31 19:15:22.785 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 10.0213ms
2025-08-31 19:15:22.786 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:15:22.788 +03:00 [DBG] Connection id "0HNF8L67NJASA", Request id "0HNF8L67NJASA:00000002": started reading request body.
2025-08-31 19:15:22.789 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:22.790 +03:00 [DBG] Connection id "0HNF8L67NJASA", Request id "0HNF8L67NJASA:00000002": done reading request body.
2025-08-31 19:15:22.791 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:22.792 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:22.793 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:22.803 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:15:22.804 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:15:22.805 +03:00 [DBG] Connection id "0HNF8L67NJASC", Request id "0HNF8L67NJASC:00000002": started reading request body.
2025-08-31 19:15:22.806 +03:00 [DBG] Connection id "0HNF8L67NJASC", Request id "0HNF8L67NJASC:00000002": done reading request body.
2025-08-31 19:15:22.808 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:22.809 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:15:22.810 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:22.811 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:22.812 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:22.813 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:15:22.814 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:15:22.814 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:22.816 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:22.818 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:15:22.819 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:22.820 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:15:22.821 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:22.822 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:15:22.823 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:15:22.825 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:22.826 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:22.826 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:22.827 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:15:22.828 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:15:22.829 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:22.831 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:22.832 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:22.833 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-31 19:15:22.834 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:22.835 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:15:22.836 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:15:22.837 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:15:22.838 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:15:22.839 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:15:22.840 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:15:22.843 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:15:54.195 +03:00 [INF] This is a test log to file!
2025-08-31 19:15:54.811 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:15:54.821 +03:00 [INF] API configured successfully.
2025-08-31 19:15:54.958 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:15:55.037 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:15:55.690 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:15:55.726 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:15:55.739 +03:00 [INF] Registered 13 endpoints in 1,215 milliseconds.
2025-08-31 19:15:55.756 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:15:55.810 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:15:55.902 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:55.911 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 19:15:55.914 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:55.919 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:55.922 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 19:15:55.923 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:55.933 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:55.937 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:55.942 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:15:55.945 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:55.948 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:55.951 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:15:55.956 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:55.961 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 19:15:55.964 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-08-31 19:15:55.971 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:15:55.992 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:15:55.995 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:55.996 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:15:55.997 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:15:55.998 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:15:55.9956357+00:00');
SELECT changes();
2025-08-31 19:15:56.003 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:15:55.9956357+00:00');
SELECT changes();
2025-08-31 19:15:56.071 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:15:56.076 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:15:56.079 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:15:56.080 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 19:15:56.086 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (7ms).
2025-08-31 19:15:56.088 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:15:56.091 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:15:56.095 +03:00 [DBG] Committing transaction.
2025-08-31 19:15:56.097 +03:00 [DBG] Committed transaction.
2025-08-31 19:15:56.099 +03:00 [DBG] Disposing transaction.
2025-08-31 19:15:56.105 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:15:56.106 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:15:56.109 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:56.110 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:15:56.111 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:56.112 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:56.114 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:56.115 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:15:56.117 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:56.118 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:15:56.119 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:15:56.120 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:15:56.122 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:15:56.126 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:56.140 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (14ms).
2025-08-31 19:15:56.142 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (15ms).
2025-08-31 19:15:56.143 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:15:56.146 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:15:56.154 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:56.169 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 19ms reading results.
2025-08-31 19:15:56.177 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:15:56.179 +03:00 [DBG] Committing transaction.
2025-08-31 19:15:56.180 +03:00 [DBG] Committed transaction.
2025-08-31 19:15:56.182 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:15:56.188 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (5ms).
2025-08-31 19:15:56.190 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (8ms).
2025-08-31 19:15:56.192 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:15:56.198 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:15:56.200 +03:00 [DBG] Disposing transaction.
2025-08-31 19:15:56.202 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:56.205 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-31 19:15:56.207 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:15:56.207 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:56.208 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:15:56.210 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:15:56.211 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:15:56.236 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:15:56.266 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:15:56.268 +03:00 [DBG] Hosting starting
2025-08-31 19:15:56.279 +03:00 [DBG] Middleware loaded
2025-08-31 19:15:56.282 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:15:56.284 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:15:56.356 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:15:56.358 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:15:56.361 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:15:56.484 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:15:56.691 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:15:56.692 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:15:56.693 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:15:56.694 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:15:56.696 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:15:56.698 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:15:56.706 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:15:56.718 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:15:56.839 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:15:56.840 +03:00 [INF] Hosting environment: Development
2025-08-31 19:15:56.842 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:15:56.844 +03:00 [DBG] Hosting started
2025-08-31 19:15:56.937 +03:00 [DBG] Connection id "0HNF8L6LD0JES" received FIN.
2025-08-31 19:15:56.947 +03:00 [DBG] Connection id "0HNF8L6LD0JES" accepted.
2025-08-31 19:15:56.958 +03:00 [DBG] Connection id "0HNF8L6LD0JES" started.
2025-08-31 19:15:56.960 +03:00 [DBG] Connection id "0HNF8L6LD0JET" accepted.
2025-08-31 19:15:56.961 +03:00 [DBG] Connection id "0HNF8L6LD0JET" started.
2025-08-31 19:15:56.967 +03:00 [DBG] Connection id "0HNF8L6LD0JES" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:15:56.980 +03:00 [DBG] Connection id "0HNF8L6LD0JES" disconnecting.
2025-08-31 19:15:56.986 +03:00 [DBG] Connection id "0HNF8L6LD0JES" stopped.
2025-08-31 19:15:57.009 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:15:57.062 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:57.064 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:57.069 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:57.106 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:15:57.110 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:15:57.113 +03:00 [DBG] Connection id "0HNF8L6LD0JET" completed keep alive response.
2025-08-31 19:15:57.116 +03:00 [DBG] Connection id "0HNF8L6LD0JEU" accepted.
2025-08-31 19:15:57.117 +03:00 [DBG] Connection id "0HNF8L6LD0JEU" received FIN.
2025-08-31 19:15:57.117 +03:00 [DBG] Connection id "0HNF8L6LD0JEV" accepted.
2025-08-31 19:15:57.117 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 116.9342ms
2025-08-31 19:15:57.123 +03:00 [DBG] Connection id "0HNF8L6LD0JEU" started.
2025-08-31 19:15:57.130 +03:00 [DBG] Connection id "0HNF8L6LD0JEV" started.
2025-08-31 19:15:57.136 +03:00 [DBG] Connection id "0HNF8L6LD0JEU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:15:57.136 +03:00 [DBG] Connection id "0HNF8L6LD0JET", Request id "0HNF8L6LD0JET:00000001": started reading request body.
2025-08-31 19:15:57.138 +03:00 [DBG] Connection id "0HNF8L6LD0JEU" disconnecting.
2025-08-31 19:15:57.140 +03:00 [DBG] Connection id "0HNF8L6LD0JET", Request id "0HNF8L6LD0JET:00000001": done reading request body.
2025-08-31 19:15:57.141 +03:00 [DBG] Connection id "0HNF8L6LD0JEU" stopped.
2025-08-31 19:15:57.191 +03:00 [DBG] Connection 0HNF8L6LD0JEV established using the following protocol: "Tls13"
2025-08-31 19:15:57.195 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:15:57.201 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:57.202 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:15:57.204 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:57.209 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:15:57.226 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:15:57.229 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:15:57.284 +03:00 [DBG] Connection id "0HNF8L6LD0JEV", Request id "0HNF8L6LD0JEV:00000001": started reading request body.
2025-08-31 19:15:57.286 +03:00 [DBG] Connection id "0HNF8L6LD0JEV", Request id "0HNF8L6LD0JEV:00000001": done reading request body.
2025-08-31 19:15:57.399 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:15:57.461 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:15:57.693 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:15:57.722 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:15:57.723 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:15:57.727 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:57.729 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:57.731 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:57.732 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:15:57.735 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 19:15:57.739 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:57.746 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:57.777 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:15:57.807 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:57.809 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 61ms reading results.
2025-08-31 19:15:57.814 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:57.816 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:15:57.827 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:15:57.831 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:15:57.833 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:57.835 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:15:57.836 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:15:57.837 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:15:57.838 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:57.840 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:15:57.844 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:57.845 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:15:57.847 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:15:57.848 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:15:57.857 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:15:57.869 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:15:57.872 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:15:57.873 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:15:57.875 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:15:58.055 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:16:14.441 +03:00 [INF] This is a test log to file!
2025-08-31 19:16:14.820 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:16:14.832 +03:00 [INF] API configured successfully.
2025-08-31 19:16:15.094 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:16:15.156 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:16:15.814 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:16:15.851 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:16:15.864 +03:00 [INF] Registered 13 endpoints in 1,274 milliseconds.
2025-08-31 19:16:15.873 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:16:15.928 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:16:16.109 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:16.121 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-31 19:16:16.124 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:16.128 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:16.131 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 19:16:16.133 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:16.141 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:16.145 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:16.150 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:16.152 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:16.154 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:16.158 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:16:16.163 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:16.167 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:16:16.169 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-08-31 19:16:16.176 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:16:16.202 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:16:16.207 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:16.208 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:16:16.209 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:16:16.210 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:16:16.2067361+00:00');
SELECT changes();
2025-08-31 19:16:16.216 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:16:16.2067361+00:00');
SELECT changes();
2025-08-31 19:16:16.308 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:16:16.317 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:16:16.325 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:16:16.333 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (7ms).
2025-08-31 19:16:16.335 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (10ms).
2025-08-31 19:16:16.338 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:16:16.343 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:16:16.351 +03:00 [DBG] Committing transaction.
2025-08-31 19:16:16.353 +03:00 [DBG] Committed transaction.
2025-08-31 19:16:16.357 +03:00 [DBG] Disposing transaction.
2025-08-31 19:16:16.360 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:16:16.362 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:16:16.364 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:16.365 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:16:16.366 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:16.369 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:16.371 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:16.372 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:16.374 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:16.376 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:16:16.377 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:16:16.380 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:16:16.382 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:16:16.387 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:16:16.389 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:16:16.405 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (18ms).
2025-08-31 19:16:16.407 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:16:16.409 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:16:16.413 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:16.416 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:16:16.438 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:16:16.439 +03:00 [DBG] Committing transaction.
2025-08-31 19:16:16.440 +03:00 [DBG] Committed transaction.
2025-08-31 19:16:16.441 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:16.453 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (12ms).
2025-08-31 19:16:16.457 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (16ms).
2025-08-31 19:16:16.459 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:16:16.463 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:16:16.466 +03:00 [DBG] Disposing transaction.
2025-08-31 19:16:16.468 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:16.473 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-31 19:16:16.474 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:16:16.475 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:16.476 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:16.478 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:16:16.478 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:16:16.533 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:16:16.574 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:16:16.576 +03:00 [DBG] Hosting starting
2025-08-31 19:16:16.591 +03:00 [DBG] Middleware loaded
2025-08-31 19:16:16.594 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:16:16.596 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:16:16.684 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:16:16.687 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:16:16.691 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:16:16.726 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:16:16.786 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:16:16.787 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:16:16.788 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:16:16.789 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:16:16.789 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:16:16.790 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:16:16.798 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:16:16.807 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:16:16.917 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:16:16.927 +03:00 [INF] Hosting environment: Development
2025-08-31 19:16:16.928 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:16:16.930 +03:00 [DBG] Hosting started
2025-08-31 19:16:17.986 +03:00 [DBG] Connection id "0HNF8L6RLO2PJ" received FIN.
2025-08-31 19:16:17.991 +03:00 [DBG] Connection id "0HNF8L6RLO2PJ" accepted.
2025-08-31 19:16:17.994 +03:00 [DBG] Connection id "0HNF8L6RLO2PJ" started.
2025-08-31 19:16:17.995 +03:00 [DBG] Connection id "0HNF8L6RLO2PK" accepted.
2025-08-31 19:16:17.996 +03:00 [DBG] Connection id "0HNF8L6RLO2PK" started.
2025-08-31 19:16:18.000 +03:00 [DBG] Connection id "0HNF8L6RLO2PJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:16:18.005 +03:00 [DBG] Connection id "0HNF8L6RLO2PJ" disconnecting.
2025-08-31 19:16:18.007 +03:00 [DBG] Connection id "0HNF8L6RLO2PJ" stopped.
2025-08-31 19:16:18.021 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:16:18.064 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:18.066 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:18.069 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:16:18.090 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:16:18.093 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:16:18.096 +03:00 [DBG] Connection id "0HNF8L6RLO2PK" completed keep alive response.
2025-08-31 19:16:18.098 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 80.9767ms
2025-08-31 19:16:18.098 +03:00 [DBG] Connection id "0HNF8L6RLO2PL" accepted.
2025-08-31 19:16:18.099 +03:00 [DBG] Connection id "0HNF8L6RLO2PL" received FIN.
2025-08-31 19:16:18.098 +03:00 [DBG] Connection id "0HNF8L6RLO2PM" accepted.
2025-08-31 19:16:18.108 +03:00 [DBG] Connection id "0HNF8L6RLO2PL" started.
2025-08-31 19:16:18.108 +03:00 [DBG] Connection id "0HNF8L6RLO2PK", Request id "0HNF8L6RLO2PK:00000001": started reading request body.
2025-08-31 19:16:18.110 +03:00 [DBG] Connection id "0HNF8L6RLO2PM" started.
2025-08-31 19:16:18.111 +03:00 [DBG] Connection id "0HNF8L6RLO2PL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:16:18.112 +03:00 [DBG] Connection id "0HNF8L6RLO2PK", Request id "0HNF8L6RLO2PK:00000001": done reading request body.
2025-08-31 19:16:18.114 +03:00 [DBG] Connection id "0HNF8L6RLO2PL" disconnecting.
2025-08-31 19:16:18.117 +03:00 [DBG] Connection id "0HNF8L6RLO2PL" stopped.
2025-08-31 19:16:18.146 +03:00 [DBG] Connection 0HNF8L6RLO2PM established using the following protocol: "Tls13"
2025-08-31 19:16:18.149 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:16:18.154 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:18.155 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:18.157 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:16:18.161 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:16:18.177 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:16:18.179 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:16:18.218 +03:00 [DBG] Connection id "0HNF8L6RLO2PM", Request id "0HNF8L6RLO2PM:00000001": started reading request body.
2025-08-31 19:16:18.221 +03:00 [DBG] Connection id "0HNF8L6RLO2PM", Request id "0HNF8L6RLO2PM:00000001": done reading request body.
2025-08-31 19:16:18.310 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:16:18.347 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:16:18.547 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:16:18.575 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:18.576 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:16:18.578 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:18.581 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:18.582 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:16:18.583 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:16:18.586 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 19:16:18.588 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:18.595 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:18.626 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:16:18.652 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:18.654 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 57ms reading results.
2025-08-31 19:16:18.657 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:18.659 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:18.667 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:16:18.671 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:18.672 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:18.674 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:16:18.674 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:16:18.675 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:16:18.677 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:18.679 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:18.681 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:18.683 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:16:18.684 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:18.685 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:18.694 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:16:18.705 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:16:18.713 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:16:18.714 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:16:18.716 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:16:18.908 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:16:19.988 +03:00 [ERR] SQL execution failed after 1271 ms: No mapping exists from object type System.Text.Json.JsonElement to a known managed provider native type.
2025-08-31 19:16:20.307 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:16:20.473 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Core.Exceptions.DbExecutionException: Error executing SQL command.
 ---> System.ArgumentException: No mapping exists from object type System.Text.Json.JsonElement to a known managed provider native type.
   at Microsoft.Data.SqlClient.MetaType.GetMetaTypeFromValue(Type dataType, Object value, Boolean inferLen, Boolean streamAllowed)
   at Microsoft.Data.SqlClient.MetaType.GetMetaTypeFromType(Type dataType)
   at Microsoft.Data.SqlClient.SqlParameter.GetMetaTypeOnly()
   at Microsoft.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at Microsoft.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters, Boolean includeReturnValue)
   at Microsoft.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryInternal(CommandBehavior behavior, AsyncCallback callback, Object stateObject, Int32 timeout, Boolean inRetry, Boolean asyncWrite)
   at Microsoft.Data.SqlClient.SqlCommand.BeginExecuteNonQueryAsync(AsyncCallback callback, Object stateObject)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__193_0(AsyncCallback callback, Object stateObject)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncImpl(Func`3 beginMethod, Func`2 endFunction, Action`1 endAction, Object state, TaskCreationOptions creationOptions)
   at System.Threading.Tasks.TaskFactory`1.FromAsync(Func`3 beginMethod, Func`2 endMethod, Object state)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQueryAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteNonQuery(DbConnection conn, ProviderConnectionConfig config, String sql, Object parameters, CancellationToken ct, Stopwatch sw) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 789
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 722
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteSqlCommand(ProviderConnectionConfig config, String sql, CancellationToken ct, Object parameters) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 739
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.ExecuteAsync(ProviderConnectionConfig config, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 266
   at NaturalToQuery.Application.Services.ProfileDbService.ExecuteAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 32
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ExecuteQueryAsync(Guid profileId, String sql, String userQuery, Object parameters, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 79
   at NaturalToQuery.Api.Controllers.Query.ExecuteQuery.HandleAsync(ExecuteQueryRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ExecuteQuery.cs:line 35
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-31 19:16:20.491 +03:00 [ERR] Error occurred.
2025-08-31 19:16:20.504 +03:00 [DBG] Connection id "0HNF8L6RLO2PM" completed keep alive response.
2025-08-31 19:16:20.506 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:16:20.510 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:20.512 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:16:20.515 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 500 null application/json; charset=utf-8 2365.4428ms
2025-08-31 19:16:38.466 +03:00 [INF] This is a test log to file!
2025-08-31 19:16:38.879 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:16:38.892 +03:00 [INF] API configured successfully.
2025-08-31 19:16:39.058 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:16:39.134 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:16:39.922 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:16:39.984 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:16:40.000 +03:00 [INF] Registered 13 endpoints in 1,386 milliseconds.
2025-08-31 19:16:40.011 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:16:40.074 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:16:40.167 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:40.181 +03:00 [DBG] Created DbConnection. (12ms).
2025-08-31 19:16:40.185 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:40.191 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:40.194 +03:00 [DBG] Created DbConnection. (3ms).
2025-08-31 19:16:40.196 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:40.207 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:40.213 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:40.223 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:16:40.226 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:40.232 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:40.236 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:16:40.243 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:40.250 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (5ms).
2025-08-31 19:16:40.253 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (10ms).
2025-08-31 19:16:40.261 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:16:40.286 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:16:40.291 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:40.293 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:16:40.295 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 19:16:40.296 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:16:40.2911292+00:00');
SELECT changes();
2025-08-31 19:16:40.316 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:16:40.2911292+00:00');
SELECT changes();
2025-08-31 19:16:40.389 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:16:40.393 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:16:40.395 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:16:40.396 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-31 19:16:40.398 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 19:16:40.399 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:16:40.402 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:16:40.405 +03:00 [DBG] Committing transaction.
2025-08-31 19:16:40.406 +03:00 [DBG] Committed transaction.
2025-08-31 19:16:40.408 +03:00 [DBG] Disposing transaction.
2025-08-31 19:16:40.411 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:16:40.412 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:16:40.414 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:40.414 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:16:40.416 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:40.417 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:40.418 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:40.420 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:40.422 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:40.423 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:16:40.425 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 19:16:40.434 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:16:40.437 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:16:40.442 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:16:40.442 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:16:40.443 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:16:40.445 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:16:40.447 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:16:40.465 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:40.467 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:16:40.473 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:16:40.474 +03:00 [DBG] Committing transaction.
2025-08-31 19:16:40.474 +03:00 [DBG] Committed transaction.
2025-08-31 19:16:40.475 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:16:40.477 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:16:40.478 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:16:40.478 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:16:40.482 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:16:40.485 +03:00 [DBG] Disposing transaction.
2025-08-31 19:16:40.486 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:40.503 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (17ms).
2025-08-31 19:16:40.504 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:16:40.505 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:40.507 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:40.508 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:16:40.509 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:16:40.554 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:16:40.601 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:16:40.603 +03:00 [DBG] Hosting starting
2025-08-31 19:16:40.619 +03:00 [DBG] Middleware loaded
2025-08-31 19:16:40.623 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:16:40.625 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:16:40.738 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:16:40.741 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:16:40.759 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:16:40.799 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:16:40.868 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:16:40.870 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:16:40.871 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:16:40.872 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:16:40.873 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:16:40.874 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:16:40.881 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:16:40.890 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:16:41.002 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:16:41.004 +03:00 [INF] Hosting environment: Development
2025-08-31 19:16:41.005 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:16:41.006 +03:00 [DBG] Hosting started
2025-08-31 19:16:42.243 +03:00 [DBG] Connection id "0HNF8L72T2RBV" received FIN.
2025-08-31 19:16:42.248 +03:00 [DBG] Connection id "0HNF8L72T2RBV" accepted.
2025-08-31 19:16:42.251 +03:00 [DBG] Connection id "0HNF8L72T2RBV" started.
2025-08-31 19:16:42.252 +03:00 [DBG] Connection id "0HNF8L72T2RC0" accepted.
2025-08-31 19:16:42.254 +03:00 [DBG] Connection id "0HNF8L72T2RC0" started.
2025-08-31 19:16:42.257 +03:00 [DBG] Connection id "0HNF8L72T2RBV" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:16:42.260 +03:00 [DBG] Connection id "0HNF8L72T2RBV" disconnecting.
2025-08-31 19:16:42.262 +03:00 [DBG] Connection id "0HNF8L72T2RBV" stopped.
2025-08-31 19:16:42.277 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:16:42.311 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:42.313 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:42.316 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:16:42.339 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:16:42.342 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:16:42.344 +03:00 [DBG] Connection id "0HNF8L72T2RC0" completed keep alive response.
2025-08-31 19:16:42.347 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 73.6601ms
2025-08-31 19:16:42.348 +03:00 [DBG] Connection id "0HNF8L72T2RC1" received FIN.
2025-08-31 19:16:42.347 +03:00 [DBG] Connection id "0HNF8L72T2RC1" accepted.
2025-08-31 19:16:42.347 +03:00 [DBG] Connection id "0HNF8L72T2RC2" accepted.
2025-08-31 19:16:42.359 +03:00 [DBG] Connection id "0HNF8L72T2RC0", Request id "0HNF8L72T2RC0:00000001": started reading request body.
2025-08-31 19:16:42.359 +03:00 [DBG] Connection id "0HNF8L72T2RC1" started.
2025-08-31 19:16:42.360 +03:00 [DBG] Connection id "0HNF8L72T2RC2" started.
2025-08-31 19:16:42.361 +03:00 [DBG] Connection id "0HNF8L72T2RC0", Request id "0HNF8L72T2RC0:00000001": done reading request body.
2025-08-31 19:16:42.362 +03:00 [DBG] Connection id "0HNF8L72T2RC1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:16:42.365 +03:00 [DBG] Connection id "0HNF8L72T2RC1" disconnecting.
2025-08-31 19:16:42.366 +03:00 [DBG] Connection id "0HNF8L72T2RC1" stopped.
2025-08-31 19:16:42.392 +03:00 [DBG] Connection 0HNF8L72T2RC2 established using the following protocol: "Tls13"
2025-08-31 19:16:42.395 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:16:42.399 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:42.400 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:16:42.401 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:16:42.405 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:16:42.417 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:16:42.420 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:16:42.457 +03:00 [DBG] Connection id "0HNF8L72T2RC2", Request id "0HNF8L72T2RC2:00000001": started reading request body.
2025-08-31 19:16:42.459 +03:00 [DBG] Connection id "0HNF8L72T2RC2", Request id "0HNF8L72T2RC2:00000001": done reading request body.
2025-08-31 19:16:42.539 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:16:42.577 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:16:42.765 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:16:42.795 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:16:42.796 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:16:42.799 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:42.802 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:42.803 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:16:42.804 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:16:42.806 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-31 19:16:42.809 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:42.814 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:42.843 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:16:42.868 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:42.870 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 53ms reading results.
2025-08-31 19:16:42.873 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:42.874 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:42.884 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:16:42.887 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:16:42.889 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:42.890 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:16:42.890 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:16:42.891 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:16:42.892 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:42.894 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:16:42.896 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:42.898 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:16:42.899 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:16:42.900 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:16:42.908 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:16:42.919 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:16:42.921 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:16:42.922 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:16:42.924 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:16:43.102 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:19:32.574 +03:00 [INF] This is a test log to file!
2025-08-31 19:19:33.107 +03:00 [INF] Shared Kernal configured successfully.
2025-08-31 19:19:33.116 +03:00 [INF] API configured successfully.
2025-08-31 19:19:33.203 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-08-31 19:19:33.261 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-31 19:19:33.756 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:19:33.785 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:19:33.794 +03:00 [INF] Registered 13 endpoints in 968 milliseconds.
2025-08-31 19:19:33.810 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:19:33.857 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:19:33.946 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:19:33.956 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-31 19:19:33.959 +03:00 [DBG] Migrating using database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:33.963 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:19:33.966 +03:00 [DBG] Created DbConnection. (2ms).
2025-08-31 19:19:33.967 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:33.976 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:33.982 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:33.985 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:19:33.986 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:33.989 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:33.992 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-31 19:19:34.000 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:19:34.004 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-08-31 19:19:34.007 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-08-31 19:19:34.020 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:19:34.040 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-31 19:19:34.043 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:19:34.044 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:19:34.045 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:19:34.046 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:19:34.0433792+00:00');
SELECT changes();
2025-08-31 19:19:34.051 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-31 16:19:34.0433792+00:00');
SELECT changes();
2025-08-31 19:19:34.137 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:19:34.141 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:19:34.143 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-31 19:19:34.144 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (1ms).
2025-08-31 19:19:34.146 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-31 19:19:34.147 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:19:34.149 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-31 19:19:34.152 +03:00 [DBG] Committing transaction.
2025-08-31 19:19:34.154 +03:00 [DBG] Committed transaction.
2025-08-31 19:19:34.155 +03:00 [DBG] Disposing transaction.
2025-08-31 19:19:34.158 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-31 19:19:34.158 +03:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-08-31 19:19:34.160 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:19:34.161 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-31 19:19:34.162 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:34.164 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:34.165 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:34.166 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:19:34.167 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:19:34.168 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:19:34.170 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (2ms).
2025-08-31 19:19:34.171 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:19:34.172 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-31 19:19:34.175 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:19:34.176 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:19:34.176 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:19:34.178 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:19:34.180 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-31 19:19:34.184 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:34.185 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:19:34.190 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-31 19:19:34.191 +03:00 [DBG] Committing transaction.
2025-08-31 19:19:34.191 +03:00 [DBG] Committed transaction.
2025-08-31 19:19:34.192 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-31 19:19:34.193 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-31 19:19:34.194 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (1ms).
2025-08-31 19:19:34.195 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:19:34.199 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-31 19:19:34.200 +03:00 [DBG] Disposing transaction.
2025-08-31 19:19:34.201 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:34.204 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-31 19:19:34.206 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:19:34.207 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:34.208 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:19:34.209 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:19:34.210 +03:00 [INF] Infrastructure configured successfully.
2025-08-31 19:19:34.233 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-31 19:19:34.261 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-31 19:19:34.263 +03:00 [DBG] Hosting starting
2025-08-31 19:19:34.276 +03:00 [DBG] Middleware loaded
2025-08-31 19:19:34.278 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-31 19:19:34.282 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-31 19:19:34.375 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-31 19:19:34.385 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-31 19:19:34.388 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-31 19:19:34.425 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-31 19:19:34.477 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-31 19:19:34.478 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-31 19:19:34.479 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-31 19:19:34.480 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-31 19:19:34.480 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-31 19:19:34.491 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-31 19:19:34.498 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:19:34.505 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-31 19:19:34.544 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-31 19:19:34.545 +03:00 [INF] Hosting environment: Development
2025-08-31 19:19:34.546 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-31 19:19:34.547 +03:00 [DBG] Hosting started
2025-08-31 19:19:40.173 +03:00 [DBG] Connection id "0HNF8L8NTUUB9" received FIN.
2025-08-31 19:19:40.181 +03:00 [DBG] Connection id "0HNF8L8NTUUB9" accepted.
2025-08-31 19:19:40.185 +03:00 [DBG] Connection id "0HNF8L8NTUUB9" started.
2025-08-31 19:19:40.187 +03:00 [DBG] Connection id "0HNF8L8NTUUBA" accepted.
2025-08-31 19:19:40.189 +03:00 [DBG] Connection id "0HNF8L8NTUUBA" started.
2025-08-31 19:19:40.193 +03:00 [DBG] Connection id "0HNF8L8NTUUB9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:19:40.197 +03:00 [DBG] Connection id "0HNF8L8NTUUB9" disconnecting.
2025-08-31 19:19:40.202 +03:00 [DBG] Connection id "0HNF8L8NTUUB9" stopped.
2025-08-31 19:19:40.220 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:19:40.268 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:19:40.270 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:19:40.273 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:19:40.295 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-31 19:19:40.297 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'.
2025-08-31 19:19:40.300 +03:00 [DBG] Connection id "0HNF8L8NTUUBA" completed keep alive response.
2025-08-31 19:19:40.303 +03:00 [DBG] Connection id "0HNF8L8NTUUBB" accepted.
2025-08-31 19:19:40.303 +03:00 [DBG] Connection id "0HNF8L8NTUUBC" accepted.
2025-08-31 19:19:40.303 +03:00 [DBG] Connection id "0HNF8L8NTUUBB" received FIN.
2025-08-31 19:19:40.303 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 307 0 null 87.9179ms
2025-08-31 19:19:40.308 +03:00 [DBG] Connection id "0HNF8L8NTUUBB" started.
2025-08-31 19:19:40.309 +03:00 [DBG] Connection id "0HNF8L8NTUUBC" started.
2025-08-31 19:19:40.316 +03:00 [DBG] Connection id "0HNF8L8NTUUBB" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-31 19:19:40.316 +03:00 [DBG] Connection id "0HNF8L8NTUUBA", Request id "0HNF8L8NTUUBA:00000001": started reading request body.
2025-08-31 19:19:40.318 +03:00 [DBG] Connection id "0HNF8L8NTUUBB" disconnecting.
2025-08-31 19:19:40.319 +03:00 [DBG] Connection id "0HNF8L8NTUUBA", Request id "0HNF8L8NTUUBA:00000001": done reading request body.
2025-08-31 19:19:40.319 +03:00 [DBG] Connection id "0HNF8L8NTUUBB" stopped.
2025-08-31 19:19:40.347 +03:00 [DBG] Connection 0HNF8L8NTUUBC established using the following protocol: "Tls13"
2025-08-31 19:19:40.350 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - application/json 279
2025-08-31 19:19:40.354 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:19:40.355 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute'
2025-08-31 19:19:40.357 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:19:40.361 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:19:40.375 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-31 19:19:40.379 +03:00 [INF] Groq API key configured for HttpClient
2025-08-31 19:19:40.423 +03:00 [DBG] Connection id "0HNF8L8NTUUBC", Request id "0HNF8L8NTUUBC:00000001": started reading request body.
2025-08-31 19:19:40.424 +03:00 [DBG] Connection id "0HNF8L8NTUUBC", Request id "0HNF8L8NTUUBC:00000001": done reading request body.
2025-08-31 19:19:40.532 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-31 19:19:40.597 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-31 19:19:40.841 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.DatabaseName (string) Required, 3], [Property: Profile.Name (string) Required MaxLength(200), 4], [Property: Profile.Provider (ProviderType) Required, 5], [Property: Profile.SecretRef (string) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Query.ProfileId (Guid) Required FK Index, 8], [Property: Query.ResultJson (string) Required, 9], [Property: Query.SqlQuery (string) Required, 10], [Property: Query.TimestampUtc (DateTime) Required, 11], [Property: Query.UserQuery (string) Required, 12] }
                3 -> 7
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.DatabaseName, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.DatabaseName, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<DatabaseName>k__BackingField = dataReader.GetString(3);
                                        instance.<Name>k__BackingField = dataReader.GetString(4);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(5));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(7) ? default(Guid?) : (Guid?)dataReader.GetGuid(7) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(7) ? default(object) : (object)dataReader.GetGuid(7) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(8) ? default(Guid) : dataReader.GetGuid(8);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime) : dataReader.GetDateTime(11);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-31 19:19:40.867 +03:00 [DBG] Creating DbConnection.
2025-08-31 19:19:40.869 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-31 19:19:40.871 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:40.874 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:40.875 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:19:40.876 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:19:40.879 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-08-31 19:19:40.882 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:19:40.888 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:19:40.917 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:19:40.942 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:40.943 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 54ms reading results.
2025-08-31 19:19:40.946 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:40.948 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:19:40.958 +03:00 [INF] Fetching connection string for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:19:40.961 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:40.962 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:40.964 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:19:40.965 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:19:40.966 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-31 19:19:40.967 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:19:40.969 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:19:40.972 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:40.973 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-31 19:19:40.974 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:40.976 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:19:40.985 +03:00 [DBG] Fetched secret for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:19:40.995 +03:00 [INF] Executing SQL for Profile "93f95c43-e775-4fa9-a782-eca1a00c9222", Mode="Write"
2025-08-31 19:19:40.998 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="Write")
2025-08-31 19:19:41.000 +03:00 [DBG] SQL: UPDATE C SET C.Name = @param1 FROM Categories C WHERE C.Name = @param2;
2025-08-31 19:19:41.002 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:19:41.177 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-31 19:19:41.261 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-08-31 19:19:41.288 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:19:41.298 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-31 19:19:41.385 +03:00 [INF] Loaded 3 tables
2025-08-31 19:19:41.573 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-31 19:19:41.677 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-31 19:19:41.679 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-31 19:19:41.680 +03:00 [INF] Non-query execution finished in 257 ms, affected 15 rows
2025-08-31 19:19:41.683 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:41.684 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:41.685 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:19:41.686 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:19:41.687 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:19:41.688 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:19:41.689 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."DatabaseName", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."DatabaseName", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-31 19:19:41.692 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:41.692 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-31 19:19:41.694 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:41.694 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:19:41.742 +03:00 [DBG] The navigation 'Query.Profile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:19:41.748 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Query' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:19:41.754 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 19:19:41.772 +03:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'Profile.Queries'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:19:41.777 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 19:19:41.782 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-31 19:19:41.785 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-31 19:19:41.786 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-31 19:19:41.827 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:41.829 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:41.831 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-31 19:19:41.832 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-31 19:19:41.833 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-31 19:19:41.834 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 98), @p3='?' (Size = 71), @p4='?' (DbType = DateTime), @p5='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 19:19:41.839 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 98), @p3='?' (Size = 71), @p4='?' (DbType = DateTime), @p5='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Queries" ("Id", "ProfileId", "ResultJson", "SqlQuery", "TimestampUtc", "UserQuery")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-31 19:19:41.843 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:41.844 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 3ms reading results.
2025-08-31 19:19:41.845 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-31 19:19:41.846 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-31 19:19:41.852 +03:00 [DBG] An entity of type 'Query' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-31 19:19:41.854 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-31 19:19:41.860 +03:00 [INF] ProfileSettingsChangedEvent triggered: {"DateOccurred":"2025-08-31T16:19:41.7069067Z","$type":"QueryAddedEvent"}
2025-08-31 19:19:41.863 +03:00 [INF] Saved query to DB for profile "93f95c43-e775-4fa9-a782-eca1a00c9222"
2025-08-31 19:19:41.871 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-31 19:19:41.875 +03:00 [DBG] Connection id "0HNF8L8NTUUBC" completed keep alive response.
2025-08-31 19:19:41.877 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-31 19:19:41.880 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-31 19:19:41.882 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-31 19:19:41.884 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/93f95c43-e775-4fa9-a782-eca1a00c9222/execute - 200 null application/json; charset=utf-8 1534.1153ms
