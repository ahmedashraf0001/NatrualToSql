2025-08-29 15:39:34.550 +03:00 [INF] This is a test log to file!
2025-08-29 15:39:34.887 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 15:39:34.901 +03:00 [INF] API configured successfully.
2025-08-29 15:39:35.073 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 15:39:35.535 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 15:39:35.570 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 15:39:35.577 +03:00 [INF] Registered 10 endpoints in 949 milliseconds.
2025-08-29 15:39:35.584 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 15:39:35.587 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 15:39:35.588 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 15:39:35.618 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 15:39:35.652 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 15:39:35.655 +03:00 [DBG] Hosting starting
2025-08-29 15:39:35.670 +03:00 [DBG] Middleware loaded
2025-08-29 15:39:35.675 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 15:39:35.677 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 15:39:35.769 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 15:39:35.770 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 15:39:35.772 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 15:39:35.802 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 15:39:35.845 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 15:39:35.846 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 15:39:35.847 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 15:39:35.848 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 15:39:35.849 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 15:39:35.849 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 15:39:35.855 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 15:39:35.861 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 15:39:35.961 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 15:39:35.962 +03:00 [INF] Hosting environment: Development
2025-08-29 15:39:35.963 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 15:39:35.964 +03:00 [DBG] Hosting started
2025-08-29 15:40:04.006 +03:00 [DBG] Connection id "0HNF6V4MN0PMQ" received FIN.
2025-08-29 15:40:04.016 +03:00 [DBG] Connection id "0HNF6V4MN0PMQ" accepted.
2025-08-29 15:40:04.022 +03:00 [DBG] Connection id "0HNF6V4MN0PMQ" started.
2025-08-29 15:40:04.023 +03:00 [DBG] Connection id "0HNF6V4MN0PMR" accepted.
2025-08-29 15:40:04.024 +03:00 [DBG] Connection id "0HNF6V4MN0PMR" started.
2025-08-29 15:40:04.031 +03:00 [DBG] Connection id "0HNF6V4MN0PMQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 15:40:04.033 +03:00 [DBG] Connection id "0HNF6V4MN0PMQ" disconnecting.
2025-08-29 15:40:04.035 +03:00 [DBG] Connection id "0HNF6V4MN0PMQ" stopped.
2025-08-29 15:40:04.053 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases - null null
2025-08-29 15:40:04.107 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases'
2025-08-29 15:40:04.110 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/databases' with route pattern 'api/query/{profileId}/databases' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases'
2025-08-29 15:40:04.111 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 15:40:04.135 +03:00 [DBG] Https port '7202' loaded from configuration.
2025-08-29 15:40:04.137 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases'.
2025-08-29 15:40:04.140 +03:00 [DBG] Connection id "0HNF6V4MN0PMR" completed keep alive response.
2025-08-29 15:40:04.142 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases - 307 0 null 92.6254ms
2025-08-29 15:40:04.145 +03:00 [DBG] Connection id "0HNF6V4MN0PMS" accepted.
2025-08-29 15:40:04.146 +03:00 [DBG] Connection id "0HNF6V4MN0PMS" received FIN.
2025-08-29 15:40:04.146 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" accepted.
2025-08-29 15:40:04.151 +03:00 [DBG] Connection id "0HNF6V4MN0PMS" started.
2025-08-29 15:40:04.152 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" started.
2025-08-29 15:40:04.153 +03:00 [DBG] Connection id "0HNF6V4MN0PMS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 15:40:04.155 +03:00 [DBG] Connection id "0HNF6V4MN0PMS" disconnecting.
2025-08-29 15:40:04.155 +03:00 [DBG] Connection id "0HNF6V4MN0PMS" stopped.
2025-08-29 15:40:04.185 +03:00 [DBG] Connection 0HNF6V4MN0PMT established using the following protocol: "Tls13"
2025-08-29 15:40:04.189 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases - null null
2025-08-29 15:40:04.191 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases'
2025-08-29 15:40:04.192 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/databases' with route pattern 'api/query/{profileId}/databases' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases'
2025-08-29 15:40:04.194 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 15:40:04.197 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 15:40:04.232 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 15:40:04.312 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 15:40:04.347 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 15:40:04.570 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 15:40:04.598 +03:00 [DBG] Creating DbConnection.
2025-08-29 15:40:04.607 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-29 15:40:04.610 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:40:04.624 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:40:04.628 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 15:40:04.633 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 15:40:04.637 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-29 15:40:04.644 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:40:04.668 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:40:04.700 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 15:40:04.724 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:40:04.730 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 56ms reading results.
2025-08-29 15:40:04.734 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:40:04.737 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 15:40:04.746 +03:00 [INF] Fetching connection string for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:40:04.749 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:40:04.750 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:40:04.751 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 15:40:04.752 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 15:40:04.753 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 15:40:04.753 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:40:04.755 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:40:04.757 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:40:04.758 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 15:40:04.759 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:40:04.760 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 15:40:04.772 +03:00 [DBG] Fetched secret for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:40:04.794 +03:00 [DBG] Fetching databases for Profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:40:04.795 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 15:40:04.807 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 15:40:05.043 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 15:40:05.540 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 15:40:05.556 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 15:40:05.560 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" completed keep alive response.
2025-08-29 15:40:05.562 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 15:40:05.567 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:40:05.568 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 15:40:05.571 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/databases - 200 null application/json; charset=utf-8 1381.9722ms
2025-08-29 15:41:58.964 +03:00 [DBG] Connection id "0HNF6V4MN0PMU" received FIN.
2025-08-29 15:41:58.966 +03:00 [DBG] Connection id "0HNF6V4MN0PMU" accepted.
2025-08-29 15:41:58.973 +03:00 [DBG] Connection id "0HNF6V4MN0PMU" started.
2025-08-29 15:41:58.973 +03:00 [DBG] Connection id "0HNF6V4MN0PMV" accepted.
2025-08-29 15:41:58.978 +03:00 [DBG] Connection id "0HNF6V4MN0PMU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 15:41:58.979 +03:00 [DBG] Connection id "0HNF6V4MN0PMV" started.
2025-08-29 15:41:58.980 +03:00 [DBG] Connection id "0HNF6V4MN0PMU" disconnecting.
2025-08-29 15:41:58.981 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:41:58.982 +03:00 [DBG] Connection id "0HNF6V4MN0PMU" stopped.
2025-08-29 15:41:58.984 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:41:58.985 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:41:58.986 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:41:58.988 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'.
2025-08-29 15:41:58.989 +03:00 [DBG] Connection id "0HNF6V4MN0PMV" completed keep alive response.
2025-08-29 15:41:58.990 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 307 0 null 8.6183ms
2025-08-29 15:41:58.992 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:41:58.993 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000001": started reading request body.
2025-08-29 15:41:58.994 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:41:58.995 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000001": done reading request body.
2025-08-29 15:41:58.996 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:41:58.998 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:41:58.999 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:41:59.017 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 15:41:59.019 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 15:41:59.030 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000002": started reading request body.
2025-08-29 15:41:59.031 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000002": done reading request body.
2025-08-29 15:41:59.075 +03:00 [INF] Converting NL to SQL for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:41:59.077 +03:00 [DBG] Creating DbConnection.
2025-08-29 15:41:59.078 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 15:41:59.079 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:41:59.080 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:41:59.080 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 15:41:59.081 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 15:41:59.082 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 15:41:59.083 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:41:59.084 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:41:59.086 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 15:41:59.087 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:41:59.088 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 15:41:59.089 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:41:59.090 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 15:41:59.093 +03:00 [INF] Fetching connection string for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:41:59.094 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:41:59.095 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:41:59.096 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 15:41:59.097 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 15:41:59.097 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 15:41:59.098 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:41:59.100 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:41:59.101 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:41:59.102 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 15:41:59.103 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:41:59.104 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 15:41:59.105 +03:00 [DBG] Fetched secret for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:41:59.106 +03:00 [DBG] Fetching schema for Profile "abb423db-5670-442d-ac8f-2a2cc1beb754", ForceRefresh=false
2025-08-29 15:41:59.108 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 15:41:59.213 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 15:41:59.230 +03:00 [INF] Converting natural language to SQL. User query: show all the products
2025-08-29 15:41:59.232 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 15:41:59.233 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 15:41:59.243 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 15:42:00.316 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 15:42:00.326 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 15:42:00.330 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:00.331 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" completed keep alive response.
2025-08-29 15:42:00.334 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 15:42:00.335 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:42:00.337 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 15:42:00.338 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 200 null application/json; charset=utf-8 1345.4348ms
2025-08-29 15:42:04.884 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:42:04.886 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:04.887 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:04.888 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:04.889 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'.
2025-08-29 15:42:04.889 +03:00 [DBG] Connection id "0HNF6V4MN0PMV" completed keep alive response.
2025-08-29 15:42:04.890 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 307 0 null 6.3428ms
2025-08-29 15:42:04.891 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:42:04.892 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000002": started reading request body.
2025-08-29 15:42:04.894 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:04.895 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000002": done reading request body.
2025-08-29 15:42:04.895 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:04.897 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:04.898 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:04.899 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 15:42:04.901 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 15:42:04.901 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000003": started reading request body.
2025-08-29 15:42:04.902 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000003": done reading request body.
2025-08-29 15:42:04.904 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:04.905 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" completed keep alive response.
2025-08-29 15:42:04.906 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 15:42:04.907 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 200 null application/json; charset=utf-8 16.4359ms
2025-08-29 15:42:06.049 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:42:06.052 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:06.052 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:06.053 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:06.054 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'.
2025-08-29 15:42:06.055 +03:00 [DBG] Connection id "0HNF6V4MN0PMV" completed keep alive response.
2025-08-29 15:42:06.055 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 307 0 null 6.7165ms
2025-08-29 15:42:06.056 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:42:06.057 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000003": started reading request body.
2025-08-29 15:42:06.059 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:06.059 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000003": done reading request body.
2025-08-29 15:42:06.060 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:06.062 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:06.062 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:06.064 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 15:42:06.065 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 15:42:06.065 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000004": started reading request body.
2025-08-29 15:42:06.066 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000004": done reading request body.
2025-08-29 15:42:06.067 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:06.068 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" completed keep alive response.
2025-08-29 15:42:06.069 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 15:42:06.070 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 200 null application/json; charset=utf-8 14.0084ms
2025-08-29 15:42:13.080 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 75
2025-08-29 15:42:13.082 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:13.083 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:13.084 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:13.085 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'.
2025-08-29 15:42:13.085 +03:00 [DBG] Connection id "0HNF6V4MN0PMV" completed keep alive response.
2025-08-29 15:42:13.086 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 307 0 null 6.1879ms
2025-08-29 15:42:13.087 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 75
2025-08-29 15:42:13.088 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000004": started reading request body.
2025-08-29 15:42:13.089 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:13.090 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000004": done reading request body.
2025-08-29 15:42:13.091 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:13.093 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:13.094 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:13.095 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 15:42:13.097 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 15:42:13.097 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000005": started reading request body.
2025-08-29 15:42:13.098 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000005": done reading request body.
2025-08-29 15:42:13.100 +03:00 [INF] Converting NL to SQL for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:42:13.102 +03:00 [DBG] Creating DbConnection.
2025-08-29 15:42:13.103 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 15:42:13.103 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:42:13.104 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:42:13.105 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 15:42:13.105 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 15:42:13.106 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 15:42:13.107 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:42:13.108 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:42:13.110 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 15:42:13.111 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:42:13.111 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 15:42:13.112 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:42:13.113 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 15:42:13.114 +03:00 [INF] Fetching connection string for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:42:13.115 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:42:13.116 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:42:13.117 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 15:42:13.118 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 15:42:13.118 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 15:42:13.119 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:42:13.121 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 15:42:13.122 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:42:13.123 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 15:42:13.124 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 15:42:13.124 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 15:42:13.125 +03:00 [DBG] Fetched secret for profile "abb423db-5670-442d-ac8f-2a2cc1beb754"
2025-08-29 15:42:13.126 +03:00 [DBG] Fetching schema for Profile "abb423db-5670-442d-ac8f-2a2cc1beb754", ForceRefresh=false
2025-08-29 15:42:13.127 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 15:42:13.128 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 15:42:13.129 +03:00 [INF] Converting natural language to SQL. User query: show  the products
2025-08-29 15:42:13.130 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 15:42:13.130 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 15:42:13.131 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 15:42:13.834 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 15:42:13.837 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 15:42:13.838 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:13.838 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" completed keep alive response.
2025-08-29 15:42:13.839 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 15:42:13.841 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 15:42:13.842 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 15:42:13.844 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 200 null application/json; charset=utf-8 757.0057ms
2025-08-29 15:42:18.345 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:42:18.347 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:18.348 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:18.349 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:18.349 +03:00 [DBG] Redirecting to 'https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'.
2025-08-29 15:42:18.350 +03:00 [DBG] Connection id "0HNF6V4MN0PMV" completed keep alive response.
2025-08-29 15:42:18.351 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 307 0 null 6.1177ms
2025-08-29 15:42:18.351 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - application/json 78
2025-08-29 15:42:18.353 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000005": started reading request body.
2025-08-29 15:42:18.354 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:18.355 +03:00 [DBG] Connection id "0HNF6V4MN0PMV", Request id "0HNF6V4MN0PMV:00000005": done reading request body.
2025-08-29 15:42:18.356 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert'
2025-08-29 15:42:18.357 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:18.358 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:18.359 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 15:42:18.360 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 15:42:18.361 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000006": started reading request body.
2025-08-29 15:42:18.362 +03:00 [DBG] Connection id "0HNF6V4MN0PMT", Request id "0HNF6V4MN0PMT:00000006": done reading request body.
2025-08-29 15:42:18.363 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 15:42:18.364 +03:00 [DBG] Connection id "0HNF6V4MN0PMT" completed keep alive response.
2025-08-29 15:42:18.365 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 15:42:18.365 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/abb423db-5670-442d-ac8f-2a2cc1beb754/convert - 200 null application/json; charset=utf-8 14.2767ms
2025-08-29 16:32:55.156 +03:00 [INF] This is a test log to file!
2025-08-29 16:32:55.488 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:32:55.498 +03:00 [INF] API configured successfully.
2025-08-29 16:32:55.663 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:32:56.204 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:32:56.236 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:32:56.247 +03:00 [INF] Registered 10 endpoints in 977 milliseconds.
2025-08-29 16:32:56.254 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:32:56.256 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:32:56.257 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:32:56.277 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:32:56.304 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:32:56.305 +03:00 [DBG] Hosting starting
2025-08-29 16:32:56.315 +03:00 [DBG] Middleware loaded
2025-08-29 16:32:56.318 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:32:56.319 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:32:56.378 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:32:56.379 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:32:56.381 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:32:56.406 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:32:56.464 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:32:56.466 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:32:56.467 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:32:56.468 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:32:56.468 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:32:56.469 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:32:56.474 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:32:56.480 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:32:56.558 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:32:56.559 +03:00 [INF] Hosting environment: Development
2025-08-29 16:32:56.560 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:32:56.561 +03:00 [DBG] Hosting started
2025-08-29 16:33:30.273 +03:00 [DBG] Connection id "0HNF702I8BK4L" received FIN.
2025-08-29 16:33:30.282 +03:00 [DBG] Connection id "0HNF702I8BK4L" accepted.
2025-08-29 16:33:30.308 +03:00 [DBG] Connection id "0HNF702I8BK4L" started.
2025-08-29 16:33:30.310 +03:00 [DBG] Connection id "0HNF702I8BK4M" accepted.
2025-08-29 16:33:30.311 +03:00 [DBG] Connection id "0HNF702I8BK4M" started.
2025-08-29 16:33:30.371 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:33:30.377 +03:00 [DBG] Connection id "0HNF702I8BK4L" stopped.
2025-08-29 16:33:30.381 +03:00 [DBG] Connection id "0HNF702I8BK4L" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:33:30.399 +03:00 [DBG] Connection 0HNF702I8BK4M established using the following protocol: "Tls13"
2025-08-29 16:33:30.429 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/health - null null
2025-08-29 16:33:30.460 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-29 16:33:30.462 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-29 16:33:30.488 +03:00 [INF] Executing endpoint 'HTTP: GET api/health'
2025-08-29 16:33:30.515 +03:00 [INF] Health check sent.
2025-08-29 16:33:30.517 +03:00 [INF] Executed endpoint 'HTTP: GET api/health'
2025-08-29 16:33:30.518 +03:00 [DBG] Connection id "0HNF702I8BK4M" completed keep alive response.
2025-08-29 16:33:30.520 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/health - 200 null application/json; charset=utf-8 95.1235ms
2025-08-29 16:38:01.124 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 16:38:01.125 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:38:01.126 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:38:01.386 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:38:01.387 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:38:01.388 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 16:38:41.834 +03:00 [INF] This is a test log to file!
2025-08-29 16:38:42.115 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:38:42.124 +03:00 [INF] API configured successfully.
2025-08-29 16:38:42.273 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:38:42.735 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:38:42.763 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:38:42.771 +03:00 [INF] Registered 10 endpoints in 847 milliseconds.
2025-08-29 16:38:42.777 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:38:42.779 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:38:42.780 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:38:42.800 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:38:42.826 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:38:42.827 +03:00 [DBG] Hosting starting
2025-08-29 16:38:42.839 +03:00 [DBG] Middleware loaded
2025-08-29 16:38:42.841 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:38:42.843 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:38:42.921 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:38:42.923 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:38:42.927 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:38:42.974 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:38:43.057 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:38:43.059 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:38:43.060 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:38:43.060 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:38:43.061 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:38:43.062 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:38:43.067 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:38:43.073 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:38:43.097 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:38:43.098 +03:00 [INF] Hosting environment: Development
2025-08-29 16:38:43.098 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:38:43.099 +03:00 [DBG] Hosting started
2025-08-29 16:38:43.155 +03:00 [DBG] Connection id "0HNF705FG7L0K" received FIN.
2025-08-29 16:38:43.164 +03:00 [DBG] Connection id "0HNF705FG7L0K" accepted.
2025-08-29 16:38:43.166 +03:00 [DBG] Connection id "0HNF705FG7L0K" started.
2025-08-29 16:38:43.167 +03:00 [DBG] Connection id "0HNF705FG7L0L" accepted.
2025-08-29 16:38:43.168 +03:00 [DBG] Connection id "0HNF705FG7L0L" started.
2025-08-29 16:38:43.229 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:38:43.235 +03:00 [DBG] Connection id "0HNF705FG7L0K" stopped.
2025-08-29 16:38:43.238 +03:00 [DBG] Connection id "0HNF705FG7L0K" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:38:43.249 +03:00 [DBG] Connection 0HNF705FG7L0L established using the following protocol: "Tls13"
2025-08-29 16:38:43.273 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/health - null null
2025-08-29 16:38:43.300 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-29 16:38:43.302 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-29 16:38:43.325 +03:00 [INF] Executing endpoint 'HTTP: GET api/health'
2025-08-29 16:38:43.353 +03:00 [INF] Health check sent.
2025-08-29 16:38:43.355 +03:00 [INF] Executed endpoint 'HTTP: GET api/health'
2025-08-29 16:38:43.357 +03:00 [DBG] Connection id "0HNF705FG7L0L" completed keep alive response.
2025-08-29 16:38:43.359 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/health - 200 null application/json; charset=utf-8 90.0787ms
2025-08-29 16:38:44.609 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/health - null null
2025-08-29 16:38:44.613 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-29 16:38:44.614 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-29 16:38:44.616 +03:00 [INF] Executing endpoint 'HTTP: GET api/health'
2025-08-29 16:38:44.617 +03:00 [INF] Health check sent.
2025-08-29 16:38:44.618 +03:00 [INF] Executed endpoint 'HTTP: GET api/health'
2025-08-29 16:38:44.619 +03:00 [DBG] Connection id "0HNF705FG7L0L" completed keep alive response.
2025-08-29 16:38:44.620 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/health - 200 null application/json; charset=utf-8 10.8596ms
2025-08-29 16:39:32.672 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-29 16:39:32.676 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-29 16:39:32.677 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:39:32.680 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:39:32.722 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:39:32.729 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:39:32.730 +03:00 [DBG] Connection id "0HNF705FG7L0L" completed keep alive response.
2025-08-29 16:39:32.732 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:39:32.735 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 63.3413ms
2025-08-29 16:40:02.636 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer/0 - null null
2025-08-29 16:40:02.639 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/SqlServer/0'
2025-08-29 16:40:02.641 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:40:02.642 +03:00 [DBG] Connection id "0HNF705FG7L0L" completed keep alive response.
2025-08-29 16:40:02.643 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer/0 - 404 0 null 6.9491ms
2025-08-29 16:40:02.646 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/SqlServer/0, Response status code: 404
2025-08-29 16:40:51.334 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer/0 - null null
2025-08-29 16:40:51.336 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/SqlServer/0'
2025-08-29 16:40:51.337 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:40:51.338 +03:00 [DBG] Connection id "0HNF705FG7L0L" completed keep alive response.
2025-08-29 16:40:51.339 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer/0 - 404 0 null 5.234ms
2025-08-29 16:40:51.341 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/SqlServer/0, Response status code: 404
2025-08-29 16:41:05.951 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0 - null null
2025-08-29 16:41:05.954 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/0'
2025-08-29 16:41:05.956 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/0'
2025-08-29 16:41:05.958 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:41:05.959 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:41:05.970 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:41:05.996 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 16:41:05.999 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 16:41:06.015 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:41:06.205 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:41:06.210 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:41:06.273 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 16:41:06.348 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:41:06.350 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:41:06.355 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:41:06.358 +03:00 [DBG] Connection id "0HNF705FG7L0L" completed keep alive response.
2025-08-29 16:41:06.360 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:41:06.361 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0 - 200 null application/json; charset=utf-8 409.9394ms
2025-08-29 16:42:17.760 +03:00 [DBG] Connection id "0HNF705FG7L0M" received FIN.
2025-08-29 16:42:17.762 +03:00 [DBG] Connection id "0HNF705FG7L0M" accepted.
2025-08-29 16:42:17.768 +03:00 [DBG] Connection id "0HNF705FG7L0M" started.
2025-08-29 16:42:17.768 +03:00 [DBG] Connection id "0HNF705FG7L0N" accepted.
2025-08-29 16:42:17.804 +03:00 [DBG] Connection id "0HNF705FG7L0N" started.
2025-08-29 16:42:17.822 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:42:17.825 +03:00 [DBG] Connection id "0HNF705FG7L0M" stopped.
2025-08-29 16:42:17.826 +03:00 [DBG] Connection id "0HNF705FG7L0M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:42:17.830 +03:00 [DBG] Connection 0HNF705FG7L0N established using the following protocol: "Tls13"
2025-08-29 16:42:17.832 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5//SQLEXPRESS - null null
2025-08-29 16:42:17.834 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5//SQLEXPRESS'
2025-08-29 16:42:17.835 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:42:17.835 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:42:17.836 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5//SQLEXPRESS - 404 0 null 4.1366ms
2025-08-29 16:42:17.839 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5//SQLEXPRESS, Response status code: 404
2025-08-29 16:42:31.472 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS - null null
2025-08-29 16:42:31.475 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS'
2025-08-29 16:42:31.476 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:42:31.477 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:42:31.477 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS - 404 0 null 5.8163ms
2025-08-29 16:42:31.480 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS, Response status code: 404
2025-08-29 16:42:58.790 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS - null null
2025-08-29 16:42:58.791 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS'
2025-08-29 16:42:58.792 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:42:58.793 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:42:58.794 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS - 404 0 null 4.3062ms
2025-08-29 16:42:58.796 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS, Response status code: 404
2025-08-29 16:43:06.584 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS - null null
2025-08-29 16:43:06.587 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS'
2025-08-29 16:43:06.588 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:43:06.589 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:43:06.589 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS - 404 0 null 5.122ms
2025-08-29 16:43:06.592 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5/SQLEXPRESS, Response status code: 404
2025-08-29 16:44:06.272 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:44:06.273 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:44:06.274 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:44:06.274 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:44:06.275 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - 404 0 null 3.9009ms
2025-08-29 16:44:06.277 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5%5CSQLEXPRESS, Response status code: 404
2025-08-29 16:44:17.111 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:44:17.113 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:44:17.114 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:44:17.115 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:44:17.116 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - 404 0 null 4.8165ms
2025-08-29 16:44:17.119 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5%5CSQLEXPRESS, Response status code: 404
2025-08-29 16:44:25.792 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\\SQLEXPRESS - null null
2025-08-29 16:44:25.794 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5\\SQLEXPRESS'
2025-08-29 16:44:25.794 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:44:25.795 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:44:25.796 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\\SQLEXPRESS - 404 0 null 4.8719ms
2025-08-29 16:44:25.798 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5%5C%5CSQLEXPRESS, Response status code: 404
2025-08-29 16:44:43.552 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS
 - null null
2025-08-29 16:44:43.555 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS
'
2025-08-29 16:44:43.556 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:44:43.557 +03:00 [DBG] Connection id "0HNF705FG7L0N" completed keep alive response.
2025-08-29 16:44:43.558 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS
 - 404 0 null 5.8901ms
2025-08-29 16:44:43.560 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5%5CSQLEXPRESS%0A, Response status code: 404
2025-08-29 16:44:51.981 +03:00 [DBG] Connection id "0HNF705FG7L0O" accepted.
2025-08-29 16:44:51.982 +03:00 [DBG] Connection id "0HNF705FG7L0O" started.
2025-08-29 16:44:51.987 +03:00 [DBG] Connection id "0HNF705FG7L0O" received FIN.
2025-08-29 16:44:51.993 +03:00 [DBG] Connection id "0HNF705FG7L0P" accepted.
2025-08-29 16:44:52.027 +03:00 [DBG] Connection id "0HNF705FG7L0P" started.
2025-08-29 16:44:52.077 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.Security.Authentication.AuthenticationException: Authentication failed, see inner exception.
 ---> System.ComponentModel.Win32Exception (0x80090327): An unknown error occurred while processing the certificate.
   --- End of inner exception stack trace ---
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:44:52.080 +03:00 [DBG] Connection 0HNF705FG7L0P established using the following protocol: "Tls13"
2025-08-29 16:44:52.080 +03:00 [DBG] Connection id "0HNF705FG7L0O" stopped.
2025-08-29 16:44:52.082 +03:00 [DBG] Connection id "0HNF705FG7L0O" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:44:52.104 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:44:52.187 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:44:52.188 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:44:52.190 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - 404 0 null 86.4217ms
2025-08-29 16:44:52.193 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5%5CSQLEXPRESS, Response status code: 404
2025-08-29 16:45:16.494 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7202/api/setup/servers/0 - null null
2025-08-29 16:45:16.503 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/0'
2025-08-29 16:45:16.504 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/0'
2025-08-29 16:45:16.505 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:45:16.505 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:45:16.514 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:45:16.516 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 16:45:16.517 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 16:45:16.518 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:45:16.519 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:45:16.520 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:45:16.542 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 16:45:16.545 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:45:16.546 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:45:16.549 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:45:16.550 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:45:16.550 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7202/api/setup/servers/0 - 200 null application/json; charset=utf-8 56.6811ms
2025-08-29 16:45:16.598 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7202/favicon.ico - null null
2025-08-29 16:45:16.600 +03:00 [DBG] No candidates found for the request path '/favicon.ico'
2025-08-29 16:45:16.600 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:45:16.601 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7202/favicon.ico - 404 0 null 3.7688ms
2025-08-29 16:45:16.603 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/favicon.ico, Response status code: 404
2025-08-29 16:45:31.112 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:45:31.116 +03:00 [DBG] No candidates found for the request path '/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:45:31.117 +03:00 [DBG] Request did not match any endpoints
2025-08-29 16:45:31.118 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5\SQLEXPRESS - 404 0 null 6.5682ms
2025-08-29 16:45:31.122 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7202/api/setup/servers/0/DESKTOP-QCK8UI5%5CSQLEXPRESS, Response status code: 404
2025-08-29 16:45:57.023 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:45:57.032 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:45:57.034 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:45:57.035 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:45:57.036 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:45:57.037 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:46:01.114 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:01.122 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:46:01.123 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:01.568 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:01.574 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:01.575 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:46:01.576 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 4553.0274ms
2025-08-29 16:46:07.096 +03:00 [DBG] Connection id "0HNF705FG7L0Q" accepted.
2025-08-29 16:46:07.096 +03:00 [DBG] Connection id "0HNF705FG7L0Q" received FIN.
2025-08-29 16:46:07.097 +03:00 [DBG] Connection id "0HNF705FG7L0Q" started.
2025-08-29 16:46:07.098 +03:00 [DBG] Connection id "0HNF705FG7L0R" accepted.
2025-08-29 16:46:07.133 +03:00 [DBG] Connection id "0HNF705FG7L0R" started.
2025-08-29 16:46:07.150 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:46:07.152 +03:00 [DBG] Connection id "0HNF705FG7L0Q" stopped.
2025-08-29 16:46:07.152 +03:00 [DBG] Connection id "0HNF705FG7L0Q" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:46:07.153 +03:00 [DBG] Connection 0HNF705FG7L0R established using the following protocol: "Tls13"
2025-08-29 16:46:07.154 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:46:07.156 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:46:07.157 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:46:07.158 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:07.158 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:07.160 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:46:09.549 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:09.550 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:46:09.552 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:09.732 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:09.733 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:09.735 +03:00 [DBG] Connection id "0HNF705FG7L0R" completed keep alive response.
2025-08-29 16:46:09.736 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:46:09.737 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 2582.6766ms
2025-08-29 16:46:11.288 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:46:11.291 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:46:11.292 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:46:11.293 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:11.294 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:11.295 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:46:11.297 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:11.297 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:46:11.298 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:11.528 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:11.529 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:11.530 +03:00 [DBG] Connection id "0HNF705FG7L0R" completed keep alive response.
2025-08-29 16:46:11.531 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:46:11.532 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 244.189ms
2025-08-29 16:46:12.859 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:46:12.863 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:46:12.864 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:46:12.867 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:12.868 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:12.871 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:46:12.876 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:12.877 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:46:12.878 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:13.163 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:46:13.163 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:46:13.165 +03:00 [DBG] Connection id "0HNF705FG7L0R" completed keep alive response.
2025-08-29 16:46:13.166 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:46:13.167 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/0/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 308.4718ms
2025-08-29 16:51:45.725 +03:00 [INF] This is a test log to file!
2025-08-29 16:51:46.010 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:51:46.021 +03:00 [INF] API configured successfully.
2025-08-29 16:51:46.201 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:51:46.758 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:51:46.791 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:51:46.801 +03:00 [INF] Registered 10 endpoints in 985 milliseconds.
2025-08-29 16:51:46.808 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:51:46.811 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:51:46.812 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:51:46.840 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:51:46.873 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:51:46.874 +03:00 [DBG] Hosting starting
2025-08-29 16:51:46.887 +03:00 [DBG] Middleware loaded
2025-08-29 16:51:46.889 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:51:46.890 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:51:46.969 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:51:46.971 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:51:46.973 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:51:47.011 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:51:47.068 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:51:47.069 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:51:47.070 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:51:47.070 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:51:47.071 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:51:47.072 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:51:47.078 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:51:47.088 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:51:47.215 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:51:47.216 +03:00 [INF] Hosting environment: Development
2025-08-29 16:51:47.217 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:51:47.218 +03:00 [DBG] Hosting started
2025-08-29 16:53:37.730 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 16:53:37.731 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:53:37.732 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:53:37.991 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:53:37.992 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:53:37.992 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 16:54:10.079 +03:00 [INF] This is a test log to file!
2025-08-29 16:54:10.347 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:54:10.355 +03:00 [INF] API configured successfully.
2025-08-29 16:54:10.561 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:54:10.981 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:54:11.010 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:54:11.018 +03:00 [INF] Registered 10 endpoints in 850 milliseconds.
2025-08-29 16:54:11.024 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:54:11.026 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:54:11.027 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:54:11.047 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:54:11.074 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:54:11.076 +03:00 [DBG] Hosting starting
2025-08-29 16:54:11.087 +03:00 [DBG] Middleware loaded
2025-08-29 16:54:11.089 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:54:11.091 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:54:11.156 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:54:11.158 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:54:11.160 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:54:11.186 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:54:11.245 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:54:11.247 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:54:11.248 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:54:11.248 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:54:11.249 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:54:11.250 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:54:11.256 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:54:11.262 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:54:11.372 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:54:11.382 +03:00 [INF] Hosting environment: Development
2025-08-29 16:54:11.383 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:54:11.385 +03:00 [DBG] Hosting started
2025-08-29 16:54:22.899 +03:00 [INF] This is a test log to file!
2025-08-29 16:54:23.224 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:54:23.235 +03:00 [INF] API configured successfully.
2025-08-29 16:54:23.411 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:54:24.123 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:54:24.166 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:54:24.186 +03:00 [INF] Registered 10 endpoints in 1,199 milliseconds.
2025-08-29 16:54:24.196 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:54:24.199 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:54:24.201 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:54:24.238 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:54:24.271 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:54:24.273 +03:00 [DBG] Hosting starting
2025-08-29 16:54:24.287 +03:00 [DBG] Middleware loaded
2025-08-29 16:54:24.292 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:54:24.293 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:54:24.366 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:54:24.368 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:54:24.370 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:54:24.409 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:54:24.471 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:54:24.473 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:54:24.474 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:54:24.475 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:54:24.476 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:54:24.477 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:54:24.485 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:54:24.492 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:54:24.613 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:54:24.614 +03:00 [INF] Hosting environment: Development
2025-08-29 16:54:24.615 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:54:24.616 +03:00 [DBG] Hosting started
2025-08-29 16:54:26.930 +03:00 [DBG] Connection id "0HNF70E8OOST3" received FIN.
2025-08-29 16:54:26.935 +03:00 [DBG] Connection id "0HNF70E8OOST3" accepted.
2025-08-29 16:54:26.937 +03:00 [DBG] Connection id "0HNF70E8OOST3" started.
2025-08-29 16:54:26.938 +03:00 [DBG] Connection id "0HNF70E8OOST4" accepted.
2025-08-29 16:54:26.939 +03:00 [DBG] Connection id "0HNF70E8OOST4" started.
2025-08-29 16:54:27.005 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:54:27.011 +03:00 [DBG] Connection id "0HNF70E8OOST3" stopped.
2025-08-29 16:54:27.014 +03:00 [DBG] Connection id "0HNF70E8OOST3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:54:27.026 +03:00 [DBG] Connection 0HNF70E8OOST4 established using the following protocol: "Tls13"
2025-08-29 16:54:27.052 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-29 16:54:27.084 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-29 16:54:27.087 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:54:27.114 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:54:27.151 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:54:27.196 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:54:27.198 +03:00 [DBG] Connection id "0HNF70E8OOST4" completed keep alive response.
2025-08-29 16:54:27.201 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:54:27.204 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 155.1869ms
2025-08-29 16:56:49.018 +03:00 [INF] This is a test log to file!
2025-08-29 16:56:49.256 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:56:49.263 +03:00 [INF] API configured successfully.
2025-08-29 16:56:49.376 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:56:49.807 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:56:49.833 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:56:49.841 +03:00 [INF] Registered 10 endpoints in 740 milliseconds.
2025-08-29 16:56:49.847 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:56:49.849 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:56:49.850 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:56:49.870 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:56:49.894 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:56:49.896 +03:00 [DBG] Hosting starting
2025-08-29 16:56:49.907 +03:00 [DBG] Middleware loaded
2025-08-29 16:56:49.909 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:56:49.911 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:56:49.972 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:56:49.973 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:56:49.975 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:56:50.000 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:56:50.040 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:56:50.041 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:56:50.042 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:56:50.043 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:56:50.044 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:56:50.044 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:56:50.050 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:56:50.056 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:56:50.131 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:56:50.132 +03:00 [INF] Hosting environment: Development
2025-08-29 16:56:50.133 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:56:50.133 +03:00 [DBG] Hosting started
2025-08-29 16:56:51.425 +03:00 [DBG] Connection id "0HNF70FJQP8IO" received FIN.
2025-08-29 16:56:51.429 +03:00 [DBG] Connection id "0HNF70FJQP8IO" accepted.
2025-08-29 16:56:51.431 +03:00 [DBG] Connection id "0HNF70FJQP8IO" started.
2025-08-29 16:56:51.433 +03:00 [DBG] Connection id "0HNF70FJQP8IP" accepted.
2025-08-29 16:56:51.434 +03:00 [DBG] Connection id "0HNF70FJQP8IP" started.
2025-08-29 16:56:51.522 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:56:51.538 +03:00 [DBG] Connection id "0HNF70FJQP8IO" stopped.
2025-08-29 16:56:51.543 +03:00 [DBG] Connection id "0HNF70FJQP8IO" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:56:51.556 +03:00 [DBG] Connection 0HNF70FJQP8IP established using the following protocol: "Tls13"
2025-08-29 16:56:51.584 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-29 16:56:51.621 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-29 16:56:51.622 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:56:51.664 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:56:51.713 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:56:51.748 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-29 16:56:51.749 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:56:51.752 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:56:51.756 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 175.1197ms
2025-08-29 16:57:02.104 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 16:57:02.107 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 16:57:02.109 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 16:57:02.111 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:02.113 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:02.130 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:57:02.152 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 16:57:02.154 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 16:57:02.166 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:02.349 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:02.355 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:02.407 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 16:57:02.484 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:02.485 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:02.491 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:02.494 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:57:02.495 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:57:02.496 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 392.6412ms
2025-08-29 16:57:06.840 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/0 - null null
2025-08-29 16:57:06.842 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/0'
2025-08-29 16:57:06.843 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/0'
2025-08-29 16:57:06.844 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:06.846 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:06.847 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:57:06.849 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 16:57:06.850 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 16:57:06.850 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:06.852 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:06.852 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:06.855 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 16:57:06.859 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:06.860 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:06.861 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:06.862 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:57:06.863 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:57:06.864 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/0 - 200 null application/json; charset=utf-8 24.3491ms
2025-08-29 16:57:09.702 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 16:57:09.704 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 16:57:09.705 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 16:57:09.706 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:09.707 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:09.708 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:57:09.710 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 16:57:09.711 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 16:57:09.712 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:09.713 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:09.714 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:09.716 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 16:57:09.719 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:09.720 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:09.721 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:09.722 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:57:09.723 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:57:09.724 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 22.0775ms
2025-08-29 16:57:11.881 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/1 - null null
2025-08-29 16:57:11.883 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/1'
2025-08-29 16:57:11.884 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/1'
2025-08-29 16:57:11.885 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:11.886 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:11.887 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:57:11.889 +03:00 [ERR] Unsupported provider type '"1"' requested in CreateStandalone
2025-08-29 16:57:11.972 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:12.015 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotImplementedException: Unsupported provider type
   at NaturalToQuery.Infrastructure.Factory.DbProviderFactory.HandleUnsupportedProvider(ProviderType type, String method) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Factory\DbProviderFactory.cs:line 55
   at NaturalToQuery.Infrastructure.Factory.DbProviderFactory.CreateStandalone(ProviderType Type) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Factory\DbProviderFactory.cs:line 48
   at NaturalToQuery.Application.Services.SetupService.GetAvailableServersAsync(ProviderType type, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 49
   at NaturalToQuery.Api.Controllers.Setup.GetAvailableServers.HandleAsync(GetAvailableServersRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\AvailableServers.cs:line 25
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 16:57:12.025 +03:00 [ERR] Unhandled exception occurred.
2025-08-29 16:57:12.028 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:57:12.029 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:57:12.030 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/1 - 500 null application/json; charset=utf-8 148.9376ms
2025-08-29 16:57:13.524 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 16:57:13.525 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 16:57:13.526 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 16:57:13.527 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:13.528 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:13.529 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:57:13.530 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 16:57:13.531 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 16:57:13.532 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:13.533 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:13.534 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:13.535 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 16:57:13.538 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:13.539 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 16:57:13.539 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 16:57:13.540 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:57:13.541 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:57:13.542 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 18.3697ms
2025-08-29 16:57:19.215 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 16:57:19.218 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:57:19.219 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 16:57:19.219 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:57:19.220 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:57:19.221 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:57:19.226 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:57:19.235 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 16:57:19.236 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:57:19.666 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 16:57:19.672 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 16:57:19.674 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:57:19.675 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:57:19.676 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 460.5422ms
2025-08-29 16:57:41.933 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-29 16:57:41.937 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 16:57:41.938 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:57:41.938 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:57:41.940 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:57:41.957 +03:00 [DBG] Connection id "0HNF70FJQP8IP", Request id "0HNF70FJQP8IP:00000008": started reading request body.
2025-08-29 16:57:41.958 +03:00 [DBG] Connection id "0HNF70FJQP8IP", Request id "0HNF70FJQP8IP:00000008": done reading request body.
2025-08-29 16:57:42.122 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:57:42.124 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:57:42.125 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:57:42.126 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 400 null application/problem+json; charset=utf-8 192.6861ms
2025-08-29 16:58:17.798 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-29 16:58:17.800 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 16:58:17.801 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:58:17.802 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:58:17.803 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:58:17.804 +03:00 [DBG] Connection id "0HNF70FJQP8IP", Request id "0HNF70FJQP8IP:00000009": started reading request body.
2025-08-29 16:58:17.805 +03:00 [DBG] Connection id "0HNF70FJQP8IP", Request id "0HNF70FJQP8IP:00000009": done reading request body.
2025-08-29 16:58:17.930 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:58:17.932 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:58:17.932 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:58:17.933 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 400 null application/problem+json; charset=utf-8 135.2088ms
2025-08-29 16:58:33.310 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 184
2025-08-29 16:58:33.311 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 16:58:33.312 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:58:33.313 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:58:33.314 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:58:33.315 +03:00 [DBG] Connection id "0HNF70FJQP8IP", Request id "0HNF70FJQP8IP:0000000A": started reading request body.
2025-08-29 16:58:33.316 +03:00 [DBG] Connection id "0HNF70FJQP8IP", Request id "0HNF70FJQP8IP:0000000A": done reading request body.
2025-08-29 16:58:33.445 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:58:33.446 +03:00 [DBG] Connection id "0HNF70FJQP8IP" completed keep alive response.
2025-08-29 16:58:33.447 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:58:33.448 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 400 null application/problem+json; charset=utf-8 138.1932ms
2025-08-29 16:59:36.117 +03:00 [INF] This is a test log to file!
2025-08-29 16:59:36.488 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:59:36.496 +03:00 [INF] API configured successfully.
2025-08-29 16:59:36.614 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:59:37.022 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:59:37.050 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:59:37.058 +03:00 [INF] Registered 10 endpoints in 790 milliseconds.
2025-08-29 16:59:37.064 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:59:37.066 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:59:37.066 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:59:37.086 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:59:37.110 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:59:37.111 +03:00 [DBG] Hosting starting
2025-08-29 16:59:37.122 +03:00 [DBG] Middleware loaded
2025-08-29 16:59:37.124 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:59:37.126 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:59:37.193 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:59:37.196 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:59:37.199 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:59:37.224 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:59:37.304 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:59:37.306 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:59:37.308 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:59:37.309 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:59:37.310 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:59:37.310 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:59:37.316 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:59:37.321 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:59:37.346 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:59:37.347 +03:00 [INF] Hosting environment: Development
2025-08-29 16:59:37.348 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:59:37.349 +03:00 [DBG] Hosting started
2025-08-29 16:59:37.410 +03:00 [DBG] Connection id "0HNF70H59O1FU" received FIN.
2025-08-29 16:59:37.416 +03:00 [DBG] Connection id "0HNF70H59O1FU" accepted.
2025-08-29 16:59:37.418 +03:00 [DBG] Connection id "0HNF70H59O1FU" started.
2025-08-29 16:59:37.418 +03:00 [DBG] Connection id "0HNF70H59O1FV" accepted.
2025-08-29 16:59:37.419 +03:00 [DBG] Connection id "0HNF70H59O1FV" started.
2025-08-29 16:59:37.479 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:59:37.486 +03:00 [DBG] Connection id "0HNF70H59O1FU" stopped.
2025-08-29 16:59:37.490 +03:00 [DBG] Connection id "0HNF70H59O1FU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:59:37.508 +03:00 [DBG] Connection 0HNF70H59O1FV established using the following protocol: "Tls13"
2025-08-29 16:59:37.539 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 184
2025-08-29 16:59:37.565 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 16:59:37.567 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:59:37.587 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:59:37.624 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:59:37.659 +03:00 [DBG] Connection id "0HNF70H59O1FV", Request id "0HNF70H59O1FV:00000001": started reading request body.
2025-08-29 16:59:37.661 +03:00 [DBG] Connection id "0HNF70H59O1FV", Request id "0HNF70H59O1FV:00000001": done reading request body.
2025-08-29 16:59:37.836 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:59:37.839 +03:00 [DBG] Connection id "0HNF70H59O1FV" completed keep alive response.
2025-08-29 16:59:37.842 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:59:37.845 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 400 null application/problem+json; charset=utf-8 310.2137ms
2025-08-29 16:59:53.355 +03:00 [INF] This is a test log to file!
2025-08-29 16:59:53.620 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 16:59:53.627 +03:00 [INF] API configured successfully.
2025-08-29 16:59:53.746 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 16:59:54.210 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:59:54.262 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 16:59:54.274 +03:00 [INF] Registered 10 endpoints in 830 milliseconds.
2025-08-29 16:59:54.283 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 16:59:54.289 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:59:54.290 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 16:59:54.312 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 16:59:54.336 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 16:59:54.337 +03:00 [DBG] Hosting starting
2025-08-29 16:59:54.348 +03:00 [DBG] Middleware loaded
2025-08-29 16:59:54.350 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 16:59:54.351 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 16:59:54.411 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 16:59:54.414 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 16:59:54.416 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 16:59:54.440 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 16:59:54.520 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 16:59:54.523 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 16:59:54.523 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 16:59:54.524 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 16:59:54.524 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 16:59:54.525 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 16:59:54.530 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:59:54.536 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 16:59:54.615 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 16:59:54.616 +03:00 [INF] Hosting environment: Development
2025-08-29 16:59:54.617 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 16:59:54.617 +03:00 [DBG] Hosting started
2025-08-29 16:59:55.069 +03:00 [DBG] Connection id "0HNF70HAI528O" received FIN.
2025-08-29 16:59:55.074 +03:00 [DBG] Connection id "0HNF70HAI528O" accepted.
2025-08-29 16:59:55.075 +03:00 [DBG] Connection id "0HNF70HAI528O" started.
2025-08-29 16:59:55.076 +03:00 [DBG] Connection id "0HNF70HAI528P" accepted.
2025-08-29 16:59:55.077 +03:00 [DBG] Connection id "0HNF70HAI528P" started.
2025-08-29 16:59:55.162 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 16:59:55.167 +03:00 [DBG] Connection id "0HNF70HAI528O" stopped.
2025-08-29 16:59:55.171 +03:00 [DBG] Connection id "0HNF70HAI528O" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 16:59:55.182 +03:00 [DBG] Connection 0HNF70HAI528P established using the following protocol: "Tls13"
2025-08-29 16:59:55.208 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 184
2025-08-29 16:59:55.257 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 16:59:55.260 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:59:55.283 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 16:59:55.320 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 16:59:55.356 +03:00 [DBG] Connection id "0HNF70HAI528P", Request id "0HNF70HAI528P:00000001": started reading request body.
2025-08-29 16:59:55.358 +03:00 [DBG] Connection id "0HNF70HAI528P", Request id "0HNF70HAI528P:00000001": done reading request body.
2025-08-29 16:59:55.384 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-29 16:59:55.393 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5/SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:00:09.674 +03:00 [DBG] failed to connect ConnectionString: Data Source=DESKTOP-QCK8UI5/SQLEXPRESS;Initial Catalog=ProductInventory;Integrated Security=True;Connect Timeout=15;Trust Server Certificate=True, 
2025-08-29 17:00:09.677 +03:00 [DBG] failed to connect to the configured connection string NaturalToQuery.Infrastructure.Providers.ProviderConnectionConfig
2025-08-29 17:00:09.824 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:00:09.930 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: failed to connect to the configured connection string Data Source=DESKTOP-QCK8UI5/SQLEXPRESS;Initial Catalog=ProductInventory;Integrated Security=True;Connect Timeout=15;Trust Server Certificate=True
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 38
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 33
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:00:09.939 +03:00 [ERR] Unhandled exception occurred.
2025-08-29 17:00:09.950 +03:00 [DBG] Connection id "0HNF70HAI528P" completed keep alive response.
2025-08-29 17:00:09.953 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:00:09.956 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 14751.6546ms
2025-08-29 17:00:16.761 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-29 17:00:16.764 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 17:00:16.765 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:00:16.767 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:00:16.792 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:00:16.794 +03:00 [DBG] Connection id "0HNF70HAI528P", Request id "0HNF70HAI528P:00000002": started reading request body.
2025-08-29 17:00:16.795 +03:00 [DBG] Connection id "0HNF70HAI528P", Request id "0HNF70HAI528P:00000002": done reading request body.
2025-08-29 17:00:16.797 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-29 17:00:16.797 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:00:16.933 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:00:16.950 +03:00 [DBG] Saved secret profile-11355a5c-c6a4-4d41-a388-b8e26be1dc20 for provider "SqlServer"
2025-08-29 17:00:16.951 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-29 17:00:17.012 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0)'
2025-08-29 17:00:17.182 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:00:17.214 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:00:17.224 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-29 17:00:17.226 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:00:17.237 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:17.240 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:00:17.244 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:00:17.249 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-29 17:00:17.255 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:00:17.271 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:00:17.278 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:17.284 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 7ms reading results.
2025-08-29 17:00:17.287 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:17.291 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-29 17:00:17.437 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:00:17.532 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A profile for SqlServer already exists.
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 26
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 53
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 33
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:00:17.535 +03:00 [ERR] Unhandled exception occurred.
2025-08-29 17:00:17.536 +03:00 [DBG] Connection id "0HNF70HAI528P" completed keep alive response.
2025-08-29 17:00:17.537 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:00:17.539 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:00:17.541 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:00:17.543 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 782.1845ms
2025-08-29 17:00:34.655 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-29 17:00:34.657 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 17:00:34.658 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:00:34.660 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:00:34.662 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:00:34.664 +03:00 [DBG] Connection id "0HNF70HAI528P", Request id "0HNF70HAI528P:00000003": started reading request body.
2025-08-29 17:00:34.665 +03:00 [DBG] Connection id "0HNF70HAI528P", Request id "0HNF70HAI528P:00000003": done reading request body.
2025-08-29 17:00:34.666 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-29 17:00:34.667 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:00:34.670 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:00:34.673 +03:00 [DBG] Saved secret profile-5993e33a-6a15-42eb-ab33-a502aee486fa for provider "SqlServer"
2025-08-29 17:00:34.674 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-29 17:00:34.678 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:00:34.678 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:00:34.679 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:00:34.680 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:34.681 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:00:34.682 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:00:34.683 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:00:34.684 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:00:34.686 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:00:34.687 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:34.688 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:00:34.689 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:34.690 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:00:34.721 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:00:34.788 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:00:34.798 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 17:00:34.810 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 17:00:34.816 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-29 17:00:34.817 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 17:00:34.818 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 17:00:34.868 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:00:34.869 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:34.871 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:00:34.872 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:00:34.873 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:00:34.875 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-29 17:00:34.882 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-29 17:00:34.885 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:34.886 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:00:34.888 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:00:34.889 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:00:34.895 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:00:34.897 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-29 17:00:34.899 +03:00 [INF] Profile created successfully with Id "b08630c5-76a9-48c8-af41-8449ca6548e7"
2025-08-29 17:00:34.904 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:00:34.906 +03:00 [DBG] Connection id "0HNF70HAI528P" completed keep alive response.
2025-08-29 17:00:34.906 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:00:34.908 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:00:34.909 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:00:34.910 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 255.2322ms
2025-08-29 17:00:42.406 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 17:00:42.409 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 17:00:42.410 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 17:00:42.411 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 17:00:42.415 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 17:00:42.416 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:00:42.422 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 17:00:42.423 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 17:00:42.426 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:00:42.434 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:00:42.458 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:00:42.510 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 17:00:42.593 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 17:00:42.594 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 17:00:42.597 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 17:00:42.598 +03:00 [DBG] Connection id "0HNF70HAI528P" completed keep alive response.
2025-08-29 17:00:42.599 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:00:42.599 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 193.2772ms
2025-08-29 17:00:44.253 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 17:00:44.255 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 17:00:44.256 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 17:00:44.257 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 17:00:44.258 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 17:00:44.259 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:00:44.265 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:00:44.276 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:00:44.277 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:00:44.720 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:00:44.725 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 17:00:44.727 +03:00 [DBG] Connection id "0HNF70HAI528P" completed keep alive response.
2025-08-29 17:00:44.729 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:00:44.730 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 477.0233ms
2025-08-29 17:00:45.931 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-29 17:00:45.933 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-29 17:00:45.934 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-29 17:00:45.935 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-29 17:00:45.937 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:00:45.951 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-29 17:00:45.952 +03:00 [DBG] Connection id "0HNF70HAI528P" completed keep alive response.
2025-08-29 17:00:45.953 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:00:45.954 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 22.6341ms
2025-08-29 17:01:20.105 +03:00 [INF] This is a test log to file!
2025-08-29 17:01:20.379 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 17:01:20.393 +03:00 [INF] API configured successfully.
2025-08-29 17:01:20.540 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 17:01:21.083 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:01:21.117 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:01:21.127 +03:00 [INF] Registered 10 endpoints in 924 milliseconds.
2025-08-29 17:01:21.142 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:01:21.144 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:01:21.144 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:01:21.171 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 17:01:21.197 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 17:01:21.199 +03:00 [DBG] Hosting starting
2025-08-29 17:01:21.211 +03:00 [DBG] Middleware loaded
2025-08-29 17:01:21.213 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 17:01:21.215 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 17:01:21.279 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 17:01:21.281 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 17:01:21.283 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 17:01:21.317 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 17:01:21.367 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 17:01:21.369 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 17:01:21.370 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 17:01:21.370 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 17:01:21.371 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 17:01:21.385 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 17:01:21.393 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:01:21.406 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:01:21.431 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 17:01:21.432 +03:00 [INF] Hosting environment: Development
2025-08-29 17:01:21.433 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 17:01:21.433 +03:00 [DBG] Hosting started
2025-08-29 17:02:10.312 +03:00 [DBG] Connection id "0HNF70IIRU287" received FIN.
2025-08-29 17:02:10.324 +03:00 [DBG] Connection id "0HNF70IIRU287" accepted.
2025-08-29 17:02:10.373 +03:00 [DBG] Connection id "0HNF70IIRU287" started.
2025-08-29 17:02:10.375 +03:00 [DBG] Connection id "0HNF70IIRU288" accepted.
2025-08-29 17:02:10.376 +03:00 [DBG] Connection id "0HNF70IIRU288" started.
2025-08-29 17:02:10.461 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:02:10.468 +03:00 [DBG] Connection id "0HNF70IIRU287" stopped.
2025-08-29 17:02:10.473 +03:00 [DBG] Connection id "0HNF70IIRU287" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:02:10.489 +03:00 [DBG] Connection 0HNF70IIRU288 established using the following protocol: "Tls13"
2025-08-29 17:02:10.516 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7 - null null
2025-08-29 17:02:10.552 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7'
2025-08-29 17:02:10.554 +03:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2025-08-29 17:02:10.580 +03:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-08-29 17:02:10.582 +03:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-08-29 17:02:10.584 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:02:10.587 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7 - 405 0 null 75.4654ms
2025-08-29 17:02:15.716 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7 - null null
2025-08-29 17:02:15.720 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7'
2025-08-29 17:02:15.723 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7'
2025-08-29 17:02:15.724 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 17:02:15.751 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 17:02:15.811 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:02:15.846 +03:00 [INF] Deleting profile "b08630c5-76a9-48c8-af41-8449ca6548e7"
2025-08-29 17:02:15.893 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 17:02:15.932 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 17:02:16.179 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:02:16.209 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:02:16.221 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-29 17:02:16.224 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:02:16.235 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:16.239 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:02:16.245 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-29 17:02:16.249 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-08-29 17:02:16.256 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:02:16.271 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:02:16.305 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:02:16.336 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:16.342 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 64ms reading results.
2025-08-29 17:02:16.347 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:16.352 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (5ms).
2025-08-29 17:02:16.372 +03:00 [DBG] Deleted secret profile-5993e33a-6a15-42eb-ab33-a502aee486fa for profile "b08630c5-76a9-48c8-af41-8449ca6548e7"
2025-08-29 17:02:16.375 +03:00 [DBG] Deleted cache directory C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer for profile "b08630c5-76a9-48c8-af41-8449ca6548e7"
2025-08-29 17:02:16.384 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:02:16.394 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 17:02:16.409 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 17:02:16.413 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-29 17:02:16.414 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 17:02:16.416 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 17:02:16.457 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:02:16.459 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:16.462 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:02:16.463 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:02:16.465 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:02:16.466 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-29 17:02:16.470 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-29 17:02:16.478 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:16.479 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 7ms reading results.
2025-08-29 17:02:16.481 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:16.482 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:02:16.486 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:02:16.489 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-29 17:02:16.491 +03:00 [INF] Profile "b08630c5-76a9-48c8-af41-8449ca6548e7" deleted successfully
2025-08-29 17:02:16.499 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 17:02:16.501 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:02:16.503 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:02:16.506 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:02:16.508 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:02:16.510 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7 - 200 null application/json; charset=utf-8 794.909ms
2025-08-29 17:02:36.010 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-29 17:02:36.012 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 17:02:36.013 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:02:36.018 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:02:36.032 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:02:36.057 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000003": started reading request body.
2025-08-29 17:02:36.059 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000003": done reading request body.
2025-08-29 17:02:36.086 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-29 17:02:36.094 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:02:36.388 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:02:36.406 +03:00 [DBG] Saved secret profile-243f52de-8783-4b50-bb32-a205127b592b for provider "SqlServer"
2025-08-29 17:02:36.407 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-29 17:02:36.419 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0)'
2025-08-29 17:02:36.428 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:02:36.434 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:02:36.435 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-29 17:02:36.436 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:02:36.437 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:36.438 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:02:36.439 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:02:36.442 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-29 17:02:36.443 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:02:36.444 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:02:36.447 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:36.448 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:02:36.449 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:36.450 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:02:36.467 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:02:36.472 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:02:36.474 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 17:02:36.474 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 17:02:36.475 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-29 17:02:36.476 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 17:02:36.477 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 17:02:36.483 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:02:36.485 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:36.485 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:02:36.486 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:02:36.487 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:02:36.488 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-29 17:02:36.492 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-29 17:02:36.493 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:36.494 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:02:36.495 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:02:36.496 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:02:36.498 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:02:36.499 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-29 17:02:36.500 +03:00 [INF] Profile created successfully with Id "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:02:36.505 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:02:36.507 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:02:36.508 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:02:36.509 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:02:36.510 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:02:36.511 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 501.295ms
2025-08-29 17:03:09.631 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - application/json 98
2025-08-29 17:03:09.632 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:03:09.634 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:03:09.635 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:09.636 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:09.646 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:03:09.648 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:03:09.652 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000004": started reading request body.
2025-08-29 17:03:09.653 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000004": done reading request body.
2025-08-29 17:03:09.666 +03:00 [INF] Converting NL to SQL for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:09.672 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:03:09.672 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:03:09.673 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:09.674 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:09.675 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:03:09.676 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:03:09.677 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:03:09.678 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:09.680 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:09.681 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:03:09.682 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:09.683 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:03:09.684 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:09.685 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:03:09.688 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:09.689 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:09.690 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:09.691 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:03:09.692 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:03:09.692 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:03:09.694 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:09.695 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:09.697 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:09.698 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:03:09.699 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:09.700 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:03:09.710 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:09.713 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=false
2025-08-29 17:03:09.715 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 17:03:09.724 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:03:09.728 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:03:09.827 +03:00 [INF] Loaded 3 tables
2025-08-29 17:03:10.016 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-29 17:03:10.088 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:03:10.089 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:03:10.091 +03:00 [INF] Converting natural language to SQL. User query: Show me all users created in the last 30 days
2025-08-29 17:03:10.093 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 17:03:10.094 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 17:03:10.099 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 17:03:11.289 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 17:03:11.298 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 17:03:11.301 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:11.302 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:03:11.306 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:03:11.307 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:11.308 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:03:11.309 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - 200 null application/json; charset=utf-8 1678.6857ms
2025-08-29 17:03:25.401 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - application/json 81
2025-08-29 17:03:25.404 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:03:25.405 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:03:25.407 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:25.408 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:25.410 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:03:25.411 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:03:25.412 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000005": started reading request body.
2025-08-29 17:03:25.413 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000005": done reading request body.
2025-08-29 17:03:25.415 +03:00 [INF] Converting NL to SQL for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:25.416 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:03:25.417 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:03:25.418 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:25.419 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:25.420 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:03:25.421 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:03:25.422 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:03:25.424 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:25.425 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:25.427 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:03:25.428 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:25.429 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:03:25.430 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:25.431 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:03:25.433 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:25.434 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:25.435 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:25.436 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:03:25.437 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:03:25.438 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:03:25.439 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:25.441 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:25.442 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:25.443 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:03:25.444 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:25.445 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:03:25.447 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:25.448 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=false
2025-08-29 17:03:25.448 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 17:03:25.478 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 17:03:25.479 +03:00 [INF] Converting natural language to SQL. User query: Show me all products created
2025-08-29 17:03:25.479 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 17:03:25.480 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 17:03:25.481 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 17:03:26.247 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 17:03:26.248 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 17:03:26.249 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:26.250 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:03:26.252 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:03:26.252 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:26.253 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:03:26.254 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - 200 null application/json; charset=utf-8 853.6736ms
2025-08-29 17:03:36.982 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - application/json 73
2025-08-29 17:03:36.984 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:03:36.985 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:03:36.986 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:36.987 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:36.988 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:03:36.989 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:03:36.990 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000006": started reading request body.
2025-08-29 17:03:36.991 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000006": done reading request body.
2025-08-29 17:03:36.992 +03:00 [INF] Converting NL to SQL for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:36.993 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:03:36.994 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:03:36.995 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:36.995 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:36.996 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:03:36.997 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:03:36.998 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:03:36.999 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:37.001 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:37.002 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:03:37.004 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:37.005 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:03:37.006 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:37.007 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:03:37.008 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:37.009 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:37.010 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:37.011 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:03:37.012 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:03:37.012 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:03:37.013 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:37.015 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:03:37.016 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:37.017 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:03:37.018 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:03:37.019 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:03:37.020 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:03:37.021 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=false
2025-08-29 17:03:37.022 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 17:03:37.024 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 17:03:37.025 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 17:03:37.025 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 17:03:37.026 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 17:03:37.027 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 17:03:37.797 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 17:03:37.798 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 17:03:37.799 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:03:37.800 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:03:37.801 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:03:37.802 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:03:37.803 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:03:37.805 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - 200 null application/json; charset=utf-8 823.0922ms
2025-08-29 17:04:04.042 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - application/json 73
2025-08-29 17:04:04.043 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:04:04.044 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:04:04.046 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:04:04.047 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:04:04.048 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:04:04.049 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:04:04.050 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000007": started reading request body.
2025-08-29 17:04:04.051 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000007": done reading request body.
2025-08-29 17:04:04.053 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:04:04.054 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:04:04.055 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:04:04.056 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - 200 null application/json; charset=utf-8 17.0084ms
2025-08-29 17:04:05.558 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - application/json 73
2025-08-29 17:04:05.561 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:04:05.562 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:04:05.564 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:04:05.565 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:04:05.567 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:04:05.568 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:04:05.569 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000008": started reading request body.
2025-08-29 17:04:05.569 +03:00 [DBG] Connection id "0HNF70IIRU288", Request id "0HNF70IIRU288:00000008": done reading request body.
2025-08-29 17:04:05.570 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:04:05.571 +03:00 [DBG] Connection id "0HNF70IIRU288" completed keep alive response.
2025-08-29 17:04:05.573 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:04:05.574 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - 200 null application/json; charset=utf-8 15.8787ms
2025-08-29 17:05:31.000 +03:00 [DBG] Connection id "0HNF70IIRU289" received FIN.
2025-08-29 17:05:31.002 +03:00 [DBG] Connection id "0HNF70IIRU289" accepted.
2025-08-29 17:05:31.011 +03:00 [DBG] Connection id "0HNF70IIRU289" started.
2025-08-29 17:05:31.033 +03:00 [DBG] Connection id "0HNF70IIRU28A" accepted.
2025-08-29 17:05:31.064 +03:00 [DBG] Connection id "0HNF70IIRU28A" started.
2025-08-29 17:05:31.084 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:05:31.087 +03:00 [DBG] Connection id "0HNF70IIRU289" stopped.
2025-08-29 17:05:31.087 +03:00 [DBG] Connection 0HNF70IIRU28A established using the following protocol: "Tls13"
2025-08-29 17:05:31.087 +03:00 [DBG] Connection id "0HNF70IIRU289" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:05:31.089 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/{profileId}/execute - application/json 306
2025-08-29 17:05:31.091 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/{profileId}/execute'
2025-08-29 17:05:31.092 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/{profileId}/execute'
2025-08-29 17:05:31.093 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:05:31.094 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:05:31.095 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:05:31.096 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:05:31.109 +03:00 [DBG] Connection id "0HNF70IIRU28A", Request id "0HNF70IIRU28A:00000001": started reading request body.
2025-08-29 17:05:31.110 +03:00 [DBG] Connection id "0HNF70IIRU28A", Request id "0HNF70IIRU28A:00000001": done reading request body.
2025-08-29 17:05:31.311 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:05:31.312 +03:00 [DBG] Connection id "0HNF70IIRU28A" completed keep alive response.
2025-08-29 17:05:31.314 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:05:31.314 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/{profileId}/execute - 400 null application/problem+json; charset=utf-8 225.9029ms
2025-08-29 17:07:08.063 +03:00 [INF] This is a test log to file!
2025-08-29 17:07:08.349 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 17:07:08.357 +03:00 [INF] API configured successfully.
2025-08-29 17:07:08.489 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 17:07:08.941 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:07:08.969 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:07:08.977 +03:00 [INF] Registered 10 endpoints in 818 milliseconds.
2025-08-29 17:07:08.985 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:07:08.987 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:07:08.988 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:07:09.011 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 17:07:09.040 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 17:07:09.043 +03:00 [DBG] Hosting starting
2025-08-29 17:07:09.057 +03:00 [DBG] Middleware loaded
2025-08-29 17:07:09.061 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 17:07:09.063 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 17:07:09.142 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 17:07:09.145 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 17:07:09.148 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 17:07:09.182 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 17:07:09.223 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 17:07:09.224 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 17:07:09.226 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 17:07:09.227 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 17:07:09.227 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 17:07:09.228 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 17:07:09.233 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:07:09.240 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:07:09.268 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 17:07:09.269 +03:00 [INF] Hosting environment: Development
2025-08-29 17:07:09.270 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 17:07:09.272 +03:00 [DBG] Hosting started
2025-08-29 17:07:09.358 +03:00 [DBG] Connection id "0HNF70LBVRMI1" received FIN.
2025-08-29 17:07:09.363 +03:00 [DBG] Connection id "0HNF70LBVRMI1" accepted.
2025-08-29 17:07:09.365 +03:00 [DBG] Connection id "0HNF70LBVRMI1" started.
2025-08-29 17:07:09.365 +03:00 [DBG] Connection id "0HNF70LBVRMI2" accepted.
2025-08-29 17:07:09.367 +03:00 [DBG] Connection id "0HNF70LBVRMI2" started.
2025-08-29 17:07:09.425 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:07:09.431 +03:00 [DBG] Connection id "0HNF70LBVRMI1" stopped.
2025-08-29 17:07:09.435 +03:00 [DBG] Connection id "0HNF70LBVRMI1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:07:09.446 +03:00 [DBG] Connection 0HNF70LBVRMI2 established using the following protocol: "Tls13"
2025-08-29 17:07:09.473 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/{profileId}/execute - application/json 306
2025-08-29 17:07:09.503 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/{profileId}/execute'
2025-08-29 17:07:09.505 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/{profileId}/execute'
2025-08-29 17:07:09.507 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:07:09.530 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:07:09.569 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:07:09.573 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:07:09.608 +03:00 [DBG] Connection id "0HNF70LBVRMI2", Request id "0HNF70LBVRMI2:00000001": started reading request body.
2025-08-29 17:07:09.611 +03:00 [DBG] Connection id "0HNF70LBVRMI2", Request id "0HNF70LBVRMI2:00000001": done reading request body.
2025-08-29 17:07:09.694 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:07:09.697 +03:00 [DBG] Connection id "0HNF70LBVRMI2" completed keep alive response.
2025-08-29 17:07:09.700 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:07:09.703 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/{profileId}/execute - 400 null application/problem+json; charset=utf-8 234.0294ms
2025-08-29 17:07:23.097 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute - application/json 306
2025-08-29 17:07:23.101 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute'
2025-08-29 17:07:23.103 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute'
2025-08-29 17:07:23.104 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:07:23.106 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:07:23.148 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:07:23.150 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:07:23.151 +03:00 [DBG] Connection id "0HNF70LBVRMI2", Request id "0HNF70LBVRMI2:00000002": started reading request body.
2025-08-29 17:07:23.152 +03:00 [DBG] Connection id "0HNF70LBVRMI2", Request id "0HNF70LBVRMI2:00000002": done reading request body.
2025-08-29 17:07:23.213 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 17:07:23.249 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 17:07:23.482 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:07:23.511 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:07:23.522 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-29 17:07:23.524 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:07:23.535 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:23.539 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:07:23.544 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 17:07:23.548 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-29 17:07:23.555 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:07:23.571 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:07:23.605 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:07:23.632 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:23.637 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 60ms reading results.
2025-08-29 17:07:23.640 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:23.644 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-29 17:07:23.653 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:07:23.656 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:07:23.657 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:23.657 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:07:23.658 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:07:23.660 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:07:23.661 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:07:23.662 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:07:23.665 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:23.667 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:07:23.668 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:23.669 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:07:23.679 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:07:23.690 +03:00 [INF] Executing SQL for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", Mode="ReadOnly"
2025-08-29 17:07:23.702 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-29 17:07:23.703 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.Price, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-29 17:07:23.705 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:07:23.917 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:07:26.930 +03:00 [INF] Query execution finished in 3225 ms, returned 0 rows
2025-08-29 17:07:26.947 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:07:26.955 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:26.959 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:07:26.960 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:07:26.961 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:07:26.964 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:07:26.966 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:07:26.968 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:26.970 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:07:26.971 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:26.973 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:07:26.999 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0)'
2025-08-29 17:07:27.013 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:07:27.022 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:07:27.024 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:27.025 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:07:27.026 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:07:27.029 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-29 17:07:27.030 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:07:27.033 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:07:27.037 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:27.038 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 4ms reading results.
2025-08-29 17:07:27.039 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:07:27.063 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (23ms).
2025-08-29 17:07:27.196 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products
2025-08-29 17:07:27.202 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:07:27.209 +03:00 [DBG] Connection id "0HNF70LBVRMI2" completed keep alive response.
2025-08-29 17:07:27.212 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:07:27.215 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:07:27.218 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 17:07:27.221 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute - 200 null application/json; charset=utf-8 4124.0144ms
2025-08-29 17:33:33.469 +03:00 [DBG] Connection id "0HNF70LBVRMI3" received FIN.
2025-08-29 17:33:33.473 +03:00 [DBG] Connection id "0HNF70LBVRMI3" accepted.
2025-08-29 17:33:33.476 +03:00 [DBG] Connection id "0HNF70LBVRMI3" started.
2025-08-29 17:33:33.476 +03:00 [DBG] Connection id "0HNF70LBVRMI4" accepted.
2025-08-29 17:33:33.504 +03:00 [DBG] Connection id "0HNF70LBVRMI4" started.
2025-08-29 17:33:33.565 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:33:33.568 +03:00 [DBG] Connection id "0HNF70LBVRMI3" stopped.
2025-08-29 17:33:33.569 +03:00 [DBG] Connection id "0HNF70LBVRMI3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:33:33.569 +03:00 [DBG] Connection 0HNF70LBVRMI4 established using the following protocol: "Tls13"
2025-08-29 17:33:33.572 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute - application/json 306
2025-08-29 17:33:33.573 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute'
2025-08-29 17:33:33.574 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute'
2025-08-29 17:33:33.575 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:33:33.577 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:33:33.579 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:33:33.580 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:33:33.581 +03:00 [DBG] Connection id "0HNF70LBVRMI4", Request id "0HNF70LBVRMI4:00000001": started reading request body.
2025-08-29 17:33:33.582 +03:00 [DBG] Connection id "0HNF70LBVRMI4", Request id "0HNF70LBVRMI4:00000001": done reading request body.
2025-08-29 17:33:33.584 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:33:33.585 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:33:33.585 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:33:33.587 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.588 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:33:33.588 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:33:33.589 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:33:33.590 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:33:33.592 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:33:33.594 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:33:33.595 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.596 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:33:33.598 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.598 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:33:33.600 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:33:33.601 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:33:33.601 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.602 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:33:33.603 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:33:33.604 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:33:33.605 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:33:33.606 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:33:33.608 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.608 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:33:33.610 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.611 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:33:33.612 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:33:33.613 +03:00 [INF] Executing SQL for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", Mode="ReadOnly"
2025-08-29 17:33:33.614 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-29 17:33:33.615 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.Price, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-29 17:33:33.616 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:33:33.623 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:33:33.655 +03:00 [INF] Query execution finished in 39 ms, returned 1 rows
2025-08-29 17:33:33.656 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:33:33.657 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.658 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:33:33.659 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:33:33.660 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:33:33.661 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:33:33.662 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:33:33.663 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.664 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:33:33.666 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.666 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:33:33.677 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:33:33.678 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.679 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:33:33.680 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:33:33.680 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:33:33.681 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:33:33.683 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:33:33.684 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.685 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:33:33.686 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:33:33.687 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:33:33.720 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products
2025-08-29 17:33:33.723 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:33:33.724 +03:00 [DBG] Connection id "0HNF70LBVRMI4" completed keep alive response.
2025-08-29 17:33:33.725 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:33:33.727 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:33:33.728 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:33:33.729 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute - 200 null application/json; charset=utf-8 157.9708ms
2025-08-29 17:35:59.321 +03:00 [DBG] Connection id "0HNF70LBVRMI5" received FIN.
2025-08-29 17:35:59.323 +03:00 [DBG] Connection id "0HNF70LBVRMI5" accepted.
2025-08-29 17:35:59.328 +03:00 [DBG] Connection id "0HNF70LBVRMI5" started.
2025-08-29 17:35:59.328 +03:00 [DBG] Connection id "0HNF70LBVRMI6" accepted.
2025-08-29 17:35:59.368 +03:00 [DBG] Connection id "0HNF70LBVRMI6" started.
2025-08-29 17:35:59.421 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:35:59.423 +03:00 [DBG] Connection id "0HNF70LBVRMI5" stopped.
2025-08-29 17:35:59.424 +03:00 [DBG] Connection id "0HNF70LBVRMI5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:35:59.425 +03:00 [DBG] Connection 0HNF70LBVRMI6 established using the following protocol: "Tls13"
2025-08-29 17:35:59.427 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases - null 0
2025-08-29 17:35:59.429 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases'
2025-08-29 17:35:59.430 +03:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2025-08-29 17:35:59.431 +03:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-08-29 17:35:59.432 +03:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-08-29 17:35:59.432 +03:00 [DBG] Connection id "0HNF70LBVRMI6" completed keep alive response.
2025-08-29 17:35:59.433 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases - 405 0 null 6.3536ms
2025-08-29 17:36:05.798 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases - null null
2025-08-29 17:36:05.800 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases'
2025-08-29 17:36:05.801 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/databases' with route pattern 'api/query/{profileId}/databases' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases'
2025-08-29 17:36:05.802 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 17:36:05.806 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 17:36:05.808 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:36:05.813 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:36:05.814 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:36:05.815 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:36:05.816 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:05.816 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:36:05.817 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:36:05.818 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:36:05.819 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:05.821 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:05.822 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:36:05.823 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:05.824 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:36:05.825 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:05.826 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:36:05.828 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:36:05.829 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:36:05.830 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:05.831 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:36:05.831 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:36:05.832 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:36:05.834 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:05.835 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:05.837 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:05.838 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:36:05.839 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:05.839 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:36:05.841 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:36:05.842 +03:00 [DBG] Fetching databases for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:36:05.843 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:36:05.851 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:36:05.853 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:36:06.254 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:36:06.259 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 17:36:06.260 +03:00 [DBG] Connection id "0HNF70LBVRMI6" completed keep alive response.
2025-08-29 17:36:06.261 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:36:06.262 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:36:06.264 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:36:06.265 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases - 200 null application/json; charset=utf-8 466.5086ms
2025-08-29 17:36:43.260 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema - null null
2025-08-29 17:36:43.264 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:36:43.266 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:36:43.267 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:36:43.268 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:36:43.269 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:36:43.276 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:36:43.276 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:36:43.277 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:36:43.279 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:43.280 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:36:43.280 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:36:43.281 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:36:43.282 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:43.284 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:43.285 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:36:43.286 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:43.287 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:36:43.288 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:43.290 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:36:43.291 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:36:43.292 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:36:43.293 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:43.294 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:36:43.295 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:36:43.296 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:36:43.297 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:43.299 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:36:43.301 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:43.302 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:36:43.304 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:36:43.305 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:36:43.306 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:36:43.307 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=false
2025-08-29 17:36:43.310 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 17:36:43.409 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 17:36:43.415 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:36:43.416 +03:00 [DBG] Connection id "0HNF70LBVRMI6" completed keep alive response.
2025-08-29 17:36:43.417 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:36:43.418 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:36:43.419 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:36:43.420 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema - 200 null application/json; charset=utf-8 163.8262ms
2025-08-29 17:48:53.515 +03:00 [INF] This is a test log to file!
2025-08-29 17:48:53.914 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 17:48:53.925 +03:00 [INF] API configured successfully.
2025-08-29 17:48:54.090 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 17:48:54.615 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:48:54.642 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:48:54.650 +03:00 [INF] Registered 10 endpoints in 999 milliseconds.
2025-08-29 17:48:54.656 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:48:54.658 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:48:54.659 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:48:54.680 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 17:48:54.705 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 17:48:54.706 +03:00 [DBG] Hosting starting
2025-08-29 17:48:54.717 +03:00 [DBG] Middleware loaded
2025-08-29 17:48:54.719 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 17:48:54.721 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 17:48:54.785 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 17:48:54.786 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 17:48:54.788 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 17:48:54.816 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 17:48:54.875 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 17:48:54.878 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 17:48:54.880 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 17:48:54.881 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 17:48:54.882 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 17:48:54.882 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 17:48:54.888 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:48:54.893 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:48:54.917 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 17:48:54.919 +03:00 [INF] Hosting environment: Development
2025-08-29 17:48:54.920 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 17:48:54.920 +03:00 [DBG] Hosting started
2025-08-29 17:49:18.952 +03:00 [DBG] Connection id "0HNF71CTRUEHE" received FIN.
2025-08-29 17:49:18.964 +03:00 [DBG] Connection id "0HNF71CTRUEHE" accepted.
2025-08-29 17:49:18.971 +03:00 [DBG] Connection id "0HNF71CTRUEHE" started.
2025-08-29 17:49:18.973 +03:00 [DBG] Connection id "0HNF71CTRUEHF" accepted.
2025-08-29 17:49:18.974 +03:00 [DBG] Connection id "0HNF71CTRUEHF" started.
2025-08-29 17:49:19.057 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:49:19.063 +03:00 [DBG] Connection id "0HNF71CTRUEHE" stopped.
2025-08-29 17:49:19.067 +03:00 [DBG] Connection id "0HNF71CTRUEHE" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:49:19.078 +03:00 [DBG] Connection 0HNF71CTRUEHF established using the following protocol: "Tls13"
2025-08-29 17:49:19.105 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 17:49:19.142 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 17:49:19.143 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 17:49:19.145 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 17:49:19.170 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 17:49:19.205 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:49:19.238 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 17:49:19.241 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 17:49:19.254 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:49:19.434 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:49:19.439 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:49:19.494 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 17:49:19.563 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 17:49:19.565 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 17:49:19.574 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 17:49:19.577 +03:00 [DBG] Connection id "0HNF71CTRUEHF" completed keep alive response.
2025-08-29 17:49:19.579 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:49:19.581 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 479.8401ms
2025-08-29 17:49:21.529 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 17:49:21.533 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 17:49:21.535 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 17:49:21.536 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 17:49:21.538 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 17:49:21.556 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:49:21.561 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:49:21.569 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 17:49:21.570 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:49:22.015 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:49:22.020 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 17:49:22.021 +03:00 [DBG] Connection id "0HNF71CTRUEHF" completed keep alive response.
2025-08-29 17:49:22.022 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:49:22.023 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 494.8896ms
2025-08-29 17:49:31.606 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-29 17:49:31.610 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 17:49:31.611 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:49:31.613 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:49:31.615 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:49:31.635 +03:00 [DBG] Connection id "0HNF71CTRUEHF", Request id "0HNF71CTRUEHF:00000003": started reading request body.
2025-08-29 17:49:31.637 +03:00 [DBG] Connection id "0HNF71CTRUEHF", Request id "0HNF71CTRUEHF:00000003": done reading request body.
2025-08-29 17:49:31.649 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-29 17:49:31.650 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:49:31.680 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:49:31.692 +03:00 [DBG] Saved secret profile-791986c8-bf82-46a6-b672-55b901c4f30b for provider "SqlServer"
2025-08-29 17:49:31.693 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-29 17:49:31.752 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0)'
2025-08-29 17:49:31.904 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:49:31.931 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:49:31.941 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-29 17:49:31.945 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:49:31.955 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:49:31.959 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:49:31.964 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 17:49:31.970 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-08-29 17:49:31.977 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:49:31.994 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:49:32.001 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:49:32.006 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 7ms reading results.
2025-08-29 17:49:32.010 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:49:32.014 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 17:49:32.182 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 17:49:32.285 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A profile for SqlServer already exists.
   at ProfileRepository.AddAsync(Profile profile, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Persistence\Repositories\ProfileRepository.cs:line 26
   at NaturalToQuery.Application.Services.ProfileService.CreateAsync(ProviderType Type, ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 54
   at NaturalToQuery.Application.Services.SetupService.CreateProfileAsync(SetupRequest request, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 33
   at NaturalToQuery.Api.Controllers.Setup.CreateProfile.HandleAsync(SetupRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\CreateProfile.cs:line 24
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:49:32.299 +03:00 [ERR] Unhandled exception occurred.
2025-08-29 17:49:32.305 +03:00 [DBG] Connection id "0HNF71CTRUEHF" completed keep alive response.
2025-08-29 17:49:32.305 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:49:32.308 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:49:32.310 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:49:32.311 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 500 null application/json; charset=utf-8 704.8913ms
2025-08-29 17:49:35.314 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7 - null null
2025-08-29 17:49:35.315 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7'
2025-08-29 17:49:35.316 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7'
2025-08-29 17:49:35.317 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 17:49:35.318 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 17:49:35.319 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:49:35.325 +03:00 [INF] Deleting profile "b08630c5-76a9-48c8-af41-8449ca6548e7"
2025-08-29 17:49:35.330 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 17:49:35.340 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 17:49:35.421 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:49:35.429 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:49:35.430 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:49:35.430 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:49:35.431 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:49:35.432 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:49:35.433 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:49:35.433 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:49:35.434 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:49:35.437 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:49:35.438 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:49:35.439 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:49:35.440 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:49:35.441 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:49:35.442 +03:00 [WRN] Profile "b08630c5-76a9-48c8-af41-8449ca6548e7" not found while attempting delete
2025-08-29 17:49:35.561 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 17:49:35.602 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Profile not found
   at NaturalToQuery.Application.Services.ProfileService.RemoveAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 71
   at NaturalToQuery.Application.Services.SetupService.RemoveProfileAsync(Guid ProfileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 39
   at NaturalToQuery.Api.Controllers.Setup.RemoveProfile.HandleAsync(RemoveProfileDto req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\RemoveProfile.cs:line 25
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:49:35.605 +03:00 [ERR] Unhandled exception occurred.
2025-08-29 17:49:35.606 +03:00 [DBG] Connection id "0HNF71CTRUEHF" completed keep alive response.
2025-08-29 17:49:35.607 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:49:35.607 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:49:35.608 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:49:35.609 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/b08630c5-76a9-48c8-af41-8449ca6548e7 - 500 null application/json; charset=utf-8 295.5068ms
2025-08-29 17:53:51.145 +03:00 [DBG] Connection id "0HNF71CTRUEHG" received FIN.
2025-08-29 17:53:51.170 +03:00 [DBG] Connection id "0HNF71CTRUEHG" accepted.
2025-08-29 17:53:51.194 +03:00 [DBG] Connection id "0HNF71CTRUEHG" started.
2025-08-29 17:53:51.194 +03:00 [DBG] Connection id "0HNF71CTRUEHH" accepted.
2025-08-29 17:53:51.226 +03:00 [DBG] Connection id "0HNF71CTRUEHH" started.
2025-08-29 17:53:51.301 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:53:51.305 +03:00 [DBG] Connection id "0HNF71CTRUEHG" stopped.
2025-08-29 17:53:51.306 +03:00 [DBG] Connection id "0HNF71CTRUEHG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:53:51.306 +03:00 [DBG] Connection 0HNF71CTRUEHH established using the following protocol: "Tls13"
2025-08-29 17:53:51.308 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute - application/json 306
2025-08-29 17:53:51.310 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute'
2025-08-29 17:53:51.310 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute'
2025-08-29 17:53:51.311 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:53:51.312 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:53:51.314 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:53:51.316 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:53:51.326 +03:00 [DBG] Connection id "0HNF71CTRUEHH", Request id "0HNF71CTRUEHH:00000001": started reading request body.
2025-08-29 17:53:51.326 +03:00 [DBG] Connection id "0HNF71CTRUEHH", Request id "0HNF71CTRUEHH:00000001": done reading request body.
2025-08-29 17:53:51.336 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:53:51.336 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:53:51.337 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:51.338 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.339 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:53:51.340 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:53:51.341 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:53:51.342 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:51.344 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:51.368 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:53:51.387 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.390 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 45ms reading results.
2025-08-29 17:53:51.391 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.392 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:53:51.396 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:53:51.397 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:51.398 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.398 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:53:51.399 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:53:51.400 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:53:51.400 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:51.401 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:51.404 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.405 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:53:51.405 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.406 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:53:51.418 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:53:51.421 +03:00 [INF] Executing SQL for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", Mode="ReadOnly"
2025-08-29 17:53:51.430 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-29 17:53:51.431 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.Price, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-29 17:53:51.432 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:53:51.433 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:53:51.441 +03:00 [INF] Query execution finished in 8 ms, returned 1 rows
2025-08-29 17:53:51.443 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:51.443 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.444 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:53:51.445 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:53:51.446 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:53:51.446 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:51.448 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:51.449 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.450 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:53:51.450 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.451 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:53:51.465 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:51.466 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.467 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:53:51.468 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:53:51.469 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:53:51.470 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:53:51.471 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 17:53:51.472 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.473 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:53:51.473 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:51.474 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:53:51.516 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products
2025-08-29 17:53:51.519 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 17:53:51.520 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:53:51.521 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:53:51.522 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:51.523 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:53:51.524 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/execute - 200 null application/json; charset=utf-8 215.5195ms
2025-08-29 17:53:54.594 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - application/json 73
2025-08-29 17:53:54.597 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:53:54.599 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert'
2025-08-29 17:53:54.599 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:53:54.600 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:53:54.601 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:53:54.602 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:53:54.606 +03:00 [DBG] Connection id "0HNF71CTRUEHH", Request id "0HNF71CTRUEHH:00000002": started reading request body.
2025-08-29 17:53:54.607 +03:00 [DBG] Connection id "0HNF71CTRUEHH", Request id "0HNF71CTRUEHH:00000002": done reading request body.
2025-08-29 17:53:54.610 +03:00 [INF] Converting NL to SQL for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:53:54.612 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:53:54.612 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:53:54.613 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:54.614 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:54.615 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:53:54.615 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:53:54.616 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:53:54.617 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:54.618 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:54.620 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:53:54.621 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:54.622 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:53:54.622 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:54.623 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:53:54.624 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:53:54.625 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:54.626 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:54.626 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:53:54.627 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:53:54.628 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:53:54.628 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:54.630 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:53:54.631 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:54.632 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:53:54.632 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:53:54.633 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:53:54.634 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:53:54.635 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=false
2025-08-29 17:53:54.636 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 17:53:54.665 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 17:53:54.669 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 17:53:54.670 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 17:53:54.671 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 17:53:54.676 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 17:53:55.638 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 17:53:55.648 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 17:53:55.652 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 17:53:55.653 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:53:55.656 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:53:55.656 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:53:55.658 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:53:55.659 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/convert - 200 null application/json; charset=utf-8 1064.7481ms
2025-08-29 17:54:01.625 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases - null null
2025-08-29 17:54:01.627 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases'
2025-08-29 17:54:01.628 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/databases' with route pattern 'api/query/{profileId}/databases' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases'
2025-08-29 17:54:01.629 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 17:54:01.630 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 17:54:01.631 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:54:01.635 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:54:01.636 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:54:01.636 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:54:01.637 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:01.638 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:54:01.639 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:54:01.640 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:54:01.641 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:01.643 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:01.645 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:54:01.646 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:01.647 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:54:01.648 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:01.649 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:54:01.650 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:54:01.651 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:54:01.652 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:01.652 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:54:01.653 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:54:01.654 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:54:01.655 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:01.656 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:01.658 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:01.659 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:54:01.660 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:01.661 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:54:01.663 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:54:01.664 +03:00 [DBG] Fetching databases for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:54:01.664 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:54:01.665 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:54:01.666 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:54:02.111 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 17:54:02.113 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 17:54:02.114 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:54:02.115 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:54:02.115 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:54:02.116 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:54:02.117 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/databases - 200 null application/json; charset=utf-8 492.7868ms
2025-08-29 17:54:04.068 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema - null null
2025-08-29 17:54:04.071 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:54:04.071 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:54:04.072 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:54:04.073 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:54:04.075 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:54:04.079 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:54:04.079 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:54:04.080 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:54:04.081 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:04.082 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:54:04.082 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:54:04.083 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:54:04.084 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:04.085 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:04.087 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:54:04.088 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:04.089 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:54:04.090 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:04.091 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:54:04.092 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:54:04.093 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:54:04.095 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:04.096 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:54:04.096 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:54:04.097 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:54:04.098 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:04.100 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:54:04.101 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:04.102 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:54:04.103 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:54:04.104 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:54:04.105 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:54:04.106 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=false
2025-08-29 17:54:04.106 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 17:54:04.108 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 17:54:04.111 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:54:04.112 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:54:04.112 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:54:04.113 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:54:04.114 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:54:04.115 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema - 200 null application/json; charset=utf-8 47.2295ms
2025-08-29 17:54:51.201 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema - null null
2025-08-29 17:54:51.206 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:54:51.207 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:54:51.209 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:54:51.210 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:54:51.211 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:54:51.212 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:54:51.213 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:54:51.214 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:54:51.215 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema - 200 null application/json; charset=utf-8 15.924ms
2025-08-29 17:55:19.043 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:55:19.045 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:19.046 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:19.047 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:19.047 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:19.049 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:55:19.055 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:55:19.056 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:55:19.056 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:19.057 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:19.058 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:19.058 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:55:19.059 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:55:19.060 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:19.061 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:19.063 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:55:19.064 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:19.064 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:55:19.065 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:19.066 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:55:19.068 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:55:19.069 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:19.069 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:19.070 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:19.071 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:55:19.071 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:55:19.072 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:19.074 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:19.075 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:19.076 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:55:19.077 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:19.077 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:55:19.079 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:55:19.080 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=true
2025-08-29 17:55:19.080 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-08-29 17:55:19.083 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:55:19.084 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:55:19.105 +03:00 [INF] Loaded 3 tables
2025-08-29 17:55:19.263 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-29 17:55:19.316 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:55:19.317 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:55:19.318 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:19.318 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:55:19.319 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:55:19.320 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:19.321 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:55:19.322 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 200 null application/json; charset=utf-8 278.8432ms
2025-08-29 17:55:21.678 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:55:21.681 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:21.682 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:21.683 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:21.684 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:21.685 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:55:21.687 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:55:21.688 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:55:21.688 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:21.689 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:21.690 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:21.691 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:55:21.692 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:55:21.693 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:21.694 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:21.696 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:55:21.697 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:21.697 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:55:21.698 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:21.699 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:55:21.701 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:55:21.702 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:21.703 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:21.704 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:21.705 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:55:21.706 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:55:21.707 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:21.709 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:21.710 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:21.711 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:55:21.712 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:21.713 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:55:21.714 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:55:21.714 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=true
2025-08-29 17:55:21.715 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-08-29 17:55:21.716 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:55:21.717 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:55:21.728 +03:00 [INF] Loaded 3 tables
2025-08-29 17:55:21.855 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-29 17:55:21.859 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:55:21.860 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:55:21.861 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:21.862 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:55:21.863 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:55:21.864 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:21.864 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:55:21.866 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 200 null application/json; charset=utf-8 187.6492ms
2025-08-29 17:55:23.333 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:55:23.335 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:23.336 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:23.337 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:23.338 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:23.339 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:55:23.340 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:55:23.341 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:55:23.342 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:23.343 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:23.344 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:23.344 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:55:23.345 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:55:23.346 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:23.347 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:23.349 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:55:23.350 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:23.351 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:55:23.352 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:23.353 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:55:23.354 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:55:23.355 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:23.356 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:23.357 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:23.358 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:55:23.359 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:55:23.360 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:23.362 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:23.363 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:23.364 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:55:23.365 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:23.366 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:55:23.368 +03:00 [DBG] Fetched secret for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:55:23.369 +03:00 [DBG] Fetching schema for Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2", ForceRefresh=true
2025-08-29 17:55:23.370 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-08-29 17:55:23.371 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:55:23.372 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 17:55:23.384 +03:00 [INF] Loaded 3 tables
2025-08-29 17:55:23.501 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-29 17:55:23.506 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:55:23.507 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 17:55:23.508 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:23.509 +03:00 [DBG] Connection id "0HNF71CTRUEHH" completed keep alive response.
2025-08-29 17:55:23.510 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:55:23.511 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:23.512 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:55:23.513 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 200 null application/json; charset=utf-8 180.1871ms
2025-08-29 17:55:40.987 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:55:40.989 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:40.990 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:55:40.991 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:40.992 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:55:40.993 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:55:49.361 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:55:49.363 +03:00 [DBG] Created DbConnection. (1ms).
2025-08-29 17:55:49.363 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:49.365 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:49.365 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:49.366 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:55:49.367 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:55:49.367 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:49.369 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:49.370 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:55:49.371 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:49.372 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:55:49.373 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:49.373 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:55:56.644 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:55:56.957 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:55:56.959 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:56.960 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:55:56.961 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:55:56.961 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:55:56.963 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:56.964 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:55:56.965 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:56.966 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 17:55:56.967 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:55:56.968 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:56:18.355 +03:00 [INF] This is a test log to file!
2025-08-29 17:56:18.651 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 17:56:18.658 +03:00 [INF] API configured successfully.
2025-08-29 17:56:18.776 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 17:56:19.150 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:56:19.179 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:56:19.190 +03:00 [INF] Registered 10 endpoints in 721 milliseconds.
2025-08-29 17:56:19.196 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:56:19.198 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:56:19.199 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:56:19.251 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 17:56:19.280 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 17:56:19.281 +03:00 [DBG] Hosting starting
2025-08-29 17:56:19.291 +03:00 [DBG] Middleware loaded
2025-08-29 17:56:19.293 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 17:56:19.294 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 17:56:19.358 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 17:56:19.360 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 17:56:19.362 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 17:56:19.390 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 17:56:19.450 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 17:56:19.451 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 17:56:19.452 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 17:56:19.453 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 17:56:19.453 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 17:56:19.454 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 17:56:19.460 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:56:19.465 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:56:19.566 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 17:56:19.567 +03:00 [INF] Hosting environment: Development
2025-08-29 17:56:19.567 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 17:56:19.568 +03:00 [DBG] Hosting started
2025-08-29 17:56:21.292 +03:00 [DBG] Connection id "0HNF71GRNM809" received FIN.
2025-08-29 17:56:21.296 +03:00 [DBG] Connection id "0HNF71GRNM809" accepted.
2025-08-29 17:56:21.298 +03:00 [DBG] Connection id "0HNF71GRNM809" started.
2025-08-29 17:56:21.299 +03:00 [DBG] Connection id "0HNF71GRNM80A" accepted.
2025-08-29 17:56:21.300 +03:00 [DBG] Connection id "0HNF71GRNM80A" started.
2025-08-29 17:56:21.371 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:56:21.377 +03:00 [DBG] Connection id "0HNF71GRNM809" stopped.
2025-08-29 17:56:21.381 +03:00 [DBG] Connection id "0HNF71GRNM809" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:56:21.395 +03:00 [DBG] Connection 0HNF71GRNM80A established using the following protocol: "Tls13"
2025-08-29 17:56:21.421 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:56:21.451 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:56:21.453 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:56:21.456 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:56:21.481 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:56:21.516 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:56:24.100 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 17:56:24.138 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 17:56:24.355 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:56:24.387 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:56:24.396 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-29 17:56:24.400 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:56:24.412 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:56:24.416 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:56:24.421 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 17:56:24.425 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-29 17:56:24.432 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:56:24.450 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:56:24.504 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:56:24.543 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:56:24.549 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 84ms reading results.
2025-08-29 17:56:24.553 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:56:24.556 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 17:56:24.566 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:56:24.569 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:56:24.570 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:56:24.571 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:56:24.572 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:56:24.572 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:56:24.573 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:56:24.575 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:56:24.578 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:56:24.579 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:56:24.580 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:56:24.581 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:56:24.794 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:56:24.851 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
 ---> NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 31
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 37
   at NaturalToQuery.Application.Services.ProfileService.GetConnectionStringAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 173
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.GetSchemaAsync(Guid profileId, Boolean forceRefresh, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 45
   at NaturalToQuery.Api.Controllers.Query.GetSchema.HandleAsync(GetSchemaRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\GetSchema.cs:line 39
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:56:24.861 +03:00 [ERR] Error occurred.
2025-08-29 17:56:24.869 +03:00 [DBG] Connection id "0HNF71GRNM80A" completed keep alive response.
2025-08-29 17:56:24.872 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:56:24.875 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:56:24.876 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:56:24.879 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 500 null application/json; charset=utf-8 3461.6117ms
2025-08-29 17:57:06.473 +03:00 [INF] This is a test log to file!
2025-08-29 17:57:06.715 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 17:57:06.722 +03:00 [INF] API configured successfully.
2025-08-29 17:57:06.844 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 17:57:07.401 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:57:07.435 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:57:07.451 +03:00 [INF] Registered 10 endpoints in 895 milliseconds.
2025-08-29 17:57:07.468 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:57:07.471 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:57:07.471 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:57:07.504 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 17:57:07.535 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 17:57:07.537 +03:00 [DBG] Hosting starting
2025-08-29 17:57:07.551 +03:00 [DBG] Middleware loaded
2025-08-29 17:57:07.556 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 17:57:07.560 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 17:57:07.658 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 17:57:07.662 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 17:57:07.664 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 17:57:07.693 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 17:57:07.752 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 17:57:07.753 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 17:57:07.754 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 17:57:07.754 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 17:57:07.755 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 17:57:07.756 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 17:57:07.761 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:57:07.767 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:57:07.796 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 17:57:07.798 +03:00 [INF] Hosting environment: Development
2025-08-29 17:57:07.799 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 17:57:07.847 +03:00 [DBG] Hosting started
2025-08-29 17:57:08.052 +03:00 [DBG] Connection id "0HNF71H9LK84G" received FIN.
2025-08-29 17:57:08.057 +03:00 [DBG] Connection id "0HNF71H9LK84G" accepted.
2025-08-29 17:57:08.059 +03:00 [DBG] Connection id "0HNF71H9LK84G" started.
2025-08-29 17:57:08.060 +03:00 [DBG] Connection id "0HNF71H9LK84H" accepted.
2025-08-29 17:57:08.062 +03:00 [DBG] Connection id "0HNF71H9LK84H" started.
2025-08-29 17:57:08.177 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:57:08.183 +03:00 [DBG] Connection id "0HNF71H9LK84G" stopped.
2025-08-29 17:57:08.188 +03:00 [DBG] Connection id "0HNF71H9LK84G" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:57:08.199 +03:00 [DBG] Connection 0HNF71H9LK84H established using the following protocol: "Tls13"
2025-08-29 17:57:08.226 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:57:08.258 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:08.261 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:08.268 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:08.300 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:08.344 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:57:08.439 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 17:57:08.504 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 17:57:08.808 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:57:08.839 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:57:08.853 +03:00 [DBG] Created DbConnection. (12ms).
2025-08-29 17:57:08.857 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:08.868 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:08.872 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:08.878 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 17:57:08.886 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (14ms).
2025-08-29 17:57:08.897 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:08.915 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:08.947 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:57:08.975 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:08.981 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 60ms reading results.
2025-08-29 17:57:08.990 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:08.994 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-29 17:57:09.011 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:57:09.014 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:09.016 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:09.017 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:09.018 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:57:09.019 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:57:09.020 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:09.022 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:09.024 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:09.025 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:57:09.026 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:09.027 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:57:09.275 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:09.321 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
 ---> NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 31
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 37
   at NaturalToQuery.Application.Services.ProfileService.GetConnectionStringAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 173
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.GetSchemaAsync(Guid profileId, Boolean forceRefresh, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 45
   at NaturalToQuery.Api.Controllers.Query.GetSchema.HandleAsync(GetSchemaRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\GetSchema.cs:line 39
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:57:09.332 +03:00 [ERR] Error occurred.
2025-08-29 17:57:09.341 +03:00 [DBG] Connection id "0HNF71H9LK84H" completed keep alive response.
2025-08-29 17:57:09.343 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:57:09.346 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:09.348 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:57:09.351 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 500 null application/json; charset=utf-8 1130.1338ms
2025-08-29 17:57:10.398 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:57:10.402 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:10.403 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:10.405 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:10.407 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:10.417 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:57:10.420 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:57:10.420 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 17:57:10.421 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:10.422 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:10.423 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:10.424 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:57:10.425 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:57:10.426 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:10.427 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:10.429 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:57:10.430 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:10.431 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:57:10.432 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:10.433 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:57:10.435 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:57:10.436 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:10.437 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:10.438 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:10.439 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:57:10.440 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:57:10.441 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:10.442 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:10.444 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:10.445 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 17:57:10.446 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:10.447 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:57:10.610 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:10.654 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
 ---> NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 31
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 37
   at NaturalToQuery.Application.Services.ProfileService.GetConnectionStringAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 173
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.GetSchemaAsync(Guid profileId, Boolean forceRefresh, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 45
   at NaturalToQuery.Api.Controllers.Query.GetSchema.HandleAsync(GetSchemaRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\GetSchema.cs:line 39
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:57:10.658 +03:00 [ERR] Error occurred.
2025-08-29 17:57:10.660 +03:00 [DBG] Connection id "0HNF71H9LK84H" completed keep alive response.
2025-08-29 17:57:10.660 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:57:10.661 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:10.662 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:57:10.663 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 500 null application/json; charset=utf-8 265.1362ms
2025-08-29 17:57:32.901 +03:00 [INF] This is a test log to file!
2025-08-29 17:57:33.188 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 17:57:33.195 +03:00 [INF] API configured successfully.
2025-08-29 17:57:33.317 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 17:57:33.729 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:57:33.757 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:57:33.765 +03:00 [INF] Registered 10 endpoints in 760 milliseconds.
2025-08-29 17:57:33.772 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:57:33.774 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:57:33.775 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:57:33.795 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 17:57:33.822 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 17:57:33.824 +03:00 [DBG] Hosting starting
2025-08-29 17:57:33.834 +03:00 [DBG] Middleware loaded
2025-08-29 17:57:33.837 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 17:57:33.839 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 17:57:33.901 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 17:57:33.903 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 17:57:33.905 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 17:57:33.935 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 17:57:33.977 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 17:57:33.978 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 17:57:33.979 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 17:57:33.980 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 17:57:33.981 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 17:57:33.981 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 17:57:33.987 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:57:33.993 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:57:34.069 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 17:57:34.070 +03:00 [INF] Hosting environment: Development
2025-08-29 17:57:34.071 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 17:57:34.072 +03:00 [DBG] Hosting started
2025-08-29 17:57:35.001 +03:00 [DBG] Connection id "0HNF71HHMKLUS" received FIN.
2025-08-29 17:57:35.009 +03:00 [DBG] Connection id "0HNF71HHMKLUS" accepted.
2025-08-29 17:57:35.011 +03:00 [DBG] Connection id "0HNF71HHMKLUS" started.
2025-08-29 17:57:35.013 +03:00 [DBG] Connection id "0HNF71HHMKLUT" accepted.
2025-08-29 17:57:35.014 +03:00 [DBG] Connection id "0HNF71HHMKLUT" started.
2025-08-29 17:57:35.085 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:57:35.092 +03:00 [DBG] Connection id "0HNF71HHMKLUS" stopped.
2025-08-29 17:57:35.096 +03:00 [DBG] Connection id "0HNF71HHMKLUS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:57:35.108 +03:00 [DBG] Connection 0HNF71HHMKLUT established using the following protocol: "Tls13"
2025-08-29 17:57:35.135 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:57:35.171 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:35.173 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:35.176 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:35.210 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:35.250 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:57:35.346 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 17:57:35.395 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 17:57:35.661 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:57:35.699 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:57:35.712 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-29 17:57:35.716 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:35.736 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:35.740 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:35.749 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-08-29 17:57:35.754 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (14ms).
2025-08-29 17:57:35.762 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:35.777 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:35.810 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:57:35.837 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:35.848 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 65ms reading results.
2025-08-29 17:57:35.857 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:35.862 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-29 17:57:35.873 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:57:35.877 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:35.878 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:35.879 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:35.880 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 17:57:35.882 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:57:35.883 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:35.885 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:35.887 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:35.889 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:57:35.891 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:35.892 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 17:57:36.110 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:36.157 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
 ---> NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 31
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 37
   at NaturalToQuery.Application.Services.ProfileService.GetConnectionStringAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 173
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.GetSchemaAsync(Guid profileId, Boolean forceRefresh, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 45
   at NaturalToQuery.Api.Controllers.Query.GetSchema.HandleAsync(GetSchemaRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\GetSchema.cs:line 39
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:57:36.169 +03:00 [ERR] Error occurred.
2025-08-29 17:57:36.179 +03:00 [DBG] Connection id "0HNF71HHMKLUT" completed keep alive response.
2025-08-29 17:57:36.181 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:57:36.183 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:36.186 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 17:57:36.188 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 500 null application/json; charset=utf-8 1057.4822ms
2025-08-29 17:57:52.188 +03:00 [INF] This is a test log to file!
2025-08-29 17:57:52.451 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 17:57:52.464 +03:00 [INF] API configured successfully.
2025-08-29 17:57:52.600 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 17:57:53.120 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:57:53.149 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 17:57:53.156 +03:00 [INF] Registered 10 endpoints in 891 milliseconds.
2025-08-29 17:57:53.162 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:57:53.164 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:57:53.165 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 17:57:53.185 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 17:57:53.212 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 17:57:53.215 +03:00 [DBG] Hosting starting
2025-08-29 17:57:53.229 +03:00 [DBG] Middleware loaded
2025-08-29 17:57:53.232 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 17:57:53.234 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 17:57:53.296 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 17:57:53.297 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 17:57:53.300 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 17:57:53.327 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 17:57:53.392 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 17:57:53.393 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 17:57:53.394 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 17:57:53.394 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 17:57:53.395 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 17:57:53.396 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 17:57:53.401 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:57:53.407 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 17:57:53.430 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 17:57:53.431 +03:00 [INF] Hosting environment: Development
2025-08-29 17:57:53.432 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 17:57:53.432 +03:00 [DBG] Hosting started
2025-08-29 17:57:53.975 +03:00 [DBG] Connection id "0HNF71HNBIV2P" received FIN.
2025-08-29 17:57:53.980 +03:00 [DBG] Connection id "0HNF71HNBIV2P" accepted.
2025-08-29 17:57:53.982 +03:00 [DBG] Connection id "0HNF71HNBIV2P" started.
2025-08-29 17:57:53.984 +03:00 [DBG] Connection id "0HNF71HNBIV2Q" accepted.
2025-08-29 17:57:53.985 +03:00 [DBG] Connection id "0HNF71HNBIV2Q" started.
2025-08-29 17:57:54.041 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 17:57:54.049 +03:00 [DBG] Connection id "0HNF71HNBIV2P" stopped.
2025-08-29 17:57:54.054 +03:00 [DBG] Connection id "0HNF71HNBIV2P" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 17:57:54.074 +03:00 [DBG] Connection 0HNF71HNBIV2Q established using the following protocol: "Tls13"
2025-08-29 17:57:54.107 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - null null
2025-08-29 17:57:54.138 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:54.139 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema'
2025-08-29 17:57:54.142 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:54.172 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:54.235 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 17:57:54.318 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 17:57:54.356 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 17:57:54.642 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 17:57:54.673 +03:00 [DBG] Creating DbConnection.
2025-08-29 17:57:54.684 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-29 17:57:54.687 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:54.698 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:54.703 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:54.709 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 17:57:54.713 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-29 17:57:54.720 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:54.739 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:54.779 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 17:57:54.803 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:54.808 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 61ms reading results.
2025-08-29 17:57:54.812 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:54.820 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (7ms).
2025-08-29 17:57:54.831 +03:00 [INF] Fetching connection string for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 17:57:54.834 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:54.837 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:54.839 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 17:57:54.840 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 17:57:54.841 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 17:57:54.842 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:54.843 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 17:57:54.846 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:54.847 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 17:57:54.848 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 17:57:54.849 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 17:57:55.083 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 17:57:55.145 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
 ---> NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStoreException: Failed to retrieve secret for key 'profile-243f52de-8783-4b50-bb32-a205127b592b'.
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 31
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Secrets.WindowsCredentialStore.GetSecretAsync(String key, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Secrets\WindowsCredentialStore.cs:line 37
   at NaturalToQuery.Application.Services.ProfileService.GetConnectionStringAsync(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileService.cs:line 173
   at NaturalToQuery.Application.Services.ProfileDbService.CreateContext(Guid profileId, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 63
   at NaturalToQuery.Application.Services.ProfileDbService.GetSchemaAsync(Guid profileId, Boolean forceRefresh, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\ProfileDbService.cs:line 45
   at NaturalToQuery.Api.Controllers.Query.GetSchema.HandleAsync(GetSchemaRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\GetSchema.cs:line 39
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 17:57:55.194 +03:00 [ERR] Error occurred.
2025-08-29 17:57:55.208 +03:00 [DBG] Connection id "0HNF71HNBIV2Q" completed keep alive response.
2025-08-29 17:57:55.212 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 17:57:55.216 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 17:57:55.218 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 17:57:55.222 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/c5afa716-04eb-4ffc-a7d1-2e6ff91662e2/schema?forceRefresh=true - 500 null application/json; charset=utf-8 1118.7162ms
2025-08-29 18:13:41.445 +03:00 [INF] This is a test log to file!
2025-08-29 18:13:41.748 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 18:13:41.758 +03:00 [INF] API configured successfully.
2025-08-29 18:13:41.898 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 18:13:42.424 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:13:42.459 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 18:13:42.469 +03:00 [INF] Registered 10 endpoints in 931 milliseconds.
2025-08-29 18:13:42.475 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:13:42.477 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 18:13:42.479 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 18:13:42.505 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 18:13:42.534 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 18:13:42.535 +03:00 [DBG] Hosting starting
2025-08-29 18:13:42.550 +03:00 [DBG] Middleware loaded
2025-08-29 18:13:42.553 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 18:13:42.554 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 18:13:42.623 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 18:13:42.624 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 18:13:42.626 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 18:13:42.657 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 18:13:42.720 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 18:13:42.722 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 18:13:42.723 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 18:13:42.723 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 18:13:42.724 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 18:13:42.725 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 18:13:42.730 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 18:13:42.735 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 18:13:42.760 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 18:13:42.761 +03:00 [INF] Hosting environment: Development
2025-08-29 18:13:42.762 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 18:13:42.763 +03:00 [DBG] Hosting started
2025-08-29 18:14:25.933 +03:00 [INF] This is a test log to file!
2025-08-29 18:14:26.288 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 18:14:26.300 +03:00 [INF] API configured successfully.
2025-08-29 18:14:26.458 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 18:14:26.995 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:14:27.026 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 18:14:27.035 +03:00 [INF] Registered 10 endpoints in 1,011 milliseconds.
2025-08-29 18:14:27.040 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:14:27.050 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 18:14:27.051 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 18:14:27.081 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 18:14:27.113 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 18:14:27.114 +03:00 [DBG] Hosting starting
2025-08-29 18:14:27.127 +03:00 [DBG] Middleware loaded
2025-08-29 18:14:27.132 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 18:14:27.133 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 18:14:27.214 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 18:14:27.216 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 18:14:27.218 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 18:14:27.253 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 18:14:27.348 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 18:14:27.351 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 18:14:27.358 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 18:14:27.359 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 18:14:27.360 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 18:14:27.360 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 18:14:27.371 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 18:14:27.377 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 18:14:27.473 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 18:14:27.474 +03:00 [INF] Hosting environment: Development
2025-08-29 18:14:27.475 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 18:14:27.476 +03:00 [DBG] Hosting started
2025-08-29 18:14:42.163 +03:00 [DBG] Connection id "0HNF71R3QDFKC" received FIN.
2025-08-29 18:14:42.167 +03:00 [DBG] Connection id "0HNF71R3QDFKC" accepted.
2025-08-29 18:14:42.169 +03:00 [DBG] Connection id "0HNF71R3QDFKC" started.
2025-08-29 18:14:42.170 +03:00 [DBG] Connection id "0HNF71R3QDFKD" accepted.
2025-08-29 18:14:42.171 +03:00 [DBG] Connection id "0HNF71R3QDFKD" started.
2025-08-29 18:14:42.237 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 18:14:42.244 +03:00 [DBG] Connection id "0HNF71R3QDFKC" stopped.
2025-08-29 18:14:42.248 +03:00 [DBG] Connection id "0HNF71R3QDFKC" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 18:14:42.260 +03:00 [DBG] Connection 0HNF71R3QDFKD established using the following protocol: "Tls13"
2025-08-29 18:14:42.287 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/health - null null
2025-08-29 18:14:42.318 +03:00 [DBG] 1 candidate(s) found for the request path '/api/health'
2025-08-29 18:14:42.320 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/health'
2025-08-29 18:14:42.345 +03:00 [INF] Executing endpoint 'HTTP: GET api/health'
2025-08-29 18:14:42.373 +03:00 [INF] Health check sent.
2025-08-29 18:14:42.375 +03:00 [INF] Executed endpoint 'HTTP: GET api/health'
2025-08-29 18:14:42.376 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:14:42.378 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/health - 200 null application/json; charset=utf-8 95.0004ms
2025-08-29 18:14:45.887 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-29 18:14:45.890 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-29 18:14:45.891 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:14:45.893 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:14:45.935 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:14:45.944 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:14:45.945 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:14:45.947 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:14:45.949 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 62.3541ms
2025-08-29 18:14:48.038 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 18:14:48.041 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 18:14:48.042 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 18:14:48.044 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:14:48.046 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:14:48.064 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:14:48.089 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 18:14:48.092 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 18:14:48.104 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:14:48.279 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:14:48.286 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:14:48.340 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 18:14:48.413 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 18:14:48.413 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 18:14:48.418 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:14:48.421 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:14:48.422 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:14:48.423 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 384.8145ms
2025-08-29 18:15:01.389 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/C5AFA716-04EB-4FFC-A7D1-2E6FF91662E2 - null null
2025-08-29 18:15:01.392 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile/C5AFA716-04EB-4FFC-A7D1-2E6FF91662E2'
2025-08-29 18:15:01.393 +03:00 [DBG] Endpoint 'HTTP: DELETE api/setup/profile/{id}' with route pattern 'api/setup/profile/{id}' is valid for the request path '/api/setup/profile/C5AFA716-04EB-4FFC-A7D1-2E6FF91662E2'
2025-08-29 18:15:01.394 +03:00 [DBG] Request matched endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 18:15:01.394 +03:00 [INF] Executing endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 18:15:01.395 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:01.401 +03:00 [INF] Deleting profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 18:15:01.455 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 18:15:01.491 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 18:15:01.688 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 18:15:01.715 +03:00 [DBG] Creating DbConnection.
2025-08-29 18:15:01.725 +03:00 [DBG] Created DbConnection. (7ms).
2025-08-29 18:15:01.728 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:01.737 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:01.740 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:01.744 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-29 18:15:01.747 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-08-29 18:15:01.755 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:01.770 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:01.798 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:01.823 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:01.828 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 53ms reading results.
2025-08-29 18:15:01.831 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:01.834 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 18:15:01.842 +03:00 [DBG] Deleted secret profile-243f52de-8783-4b50-bb32-a205127b592b for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 18:15:01.845 +03:00 [DBG] Deleted cache directory C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer for profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2"
2025-08-29 18:15:01.854 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:01.862 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 18:15:01.875 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 18:15:01.879 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-29 18:15:01.882 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 18:15:01.883 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 18:15:01.923 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:01.925 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:01.927 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:01.928 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:01.929 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:01.930 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-29 18:15:01.931 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Profiles"
WHERE "Id" = @p0
RETURNING 1;
2025-08-29 18:15:01.938 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:01.939 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 6ms reading results.
2025-08-29 18:15:01.940 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:01.942 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:01.946 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:01.947 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-29 18:15:01.949 +03:00 [INF] Profile "c5afa716-04eb-4ffc-a7d1-2e6ff91662e2" deleted successfully
2025-08-29 18:15:01.951 +03:00 [INF] Executed endpoint 'HTTP: DELETE api/setup/profile/{id}'
2025-08-29 18:15:01.951 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:01.952 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:01.955 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:01.956 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:01.957 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7202/api/setup/profile/C5AFA716-04EB-4FFC-A7D1-2E6FF91662E2 - 200 null application/json; charset=utf-8 567.8743ms
2025-08-29 18:15:06.249 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-29 18:15:06.251 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-29 18:15:06.252 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:15:06.252 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:15:06.254 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:06.256 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:15:06.257 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:06.258 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:06.259 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 10.0754ms
2025-08-29 18:15:07.924 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 18:15:07.926 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 18:15:07.927 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 18:15:07.928 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:15:07.928 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:15:07.930 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:07.932 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 18:15:07.932 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 18:15:07.933 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:15:07.934 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:15:07.935 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:15:07.937 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with 4 running DBs
2025-08-29 18:15:07.940 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 18:15:07.941 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 18:15:07.942 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:15:07.943 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:07.944 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:07.944 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 20.6696ms
2025-08-29 18:15:10.243 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 18:15:10.245 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 18:15:10.246 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 18:15:10.247 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:15:10.247 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:15:10.248 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:10.253 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:15:10.261 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:15:10.262 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:15:10.634 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:15:10.638 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:15:10.639 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:10.640 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:10.641 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 399.2189ms
2025-08-29 18:15:19.160 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/setup/profile - application/json 185
2025-08-29 18:15:19.164 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/profile'
2025-08-29 18:15:19.165 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/setup/profile'
2025-08-29 18:15:19.165 +03:00 [INF] Executing endpoint 'HTTP: POST api/setup/profile'
2025-08-29 18:15:19.166 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:19.184 +03:00 [DBG] Connection id "0HNF71R3QDFKD", Request id "0HNF71R3QDFKD:00000008": started reading request body.
2025-08-29 18:15:19.185 +03:00 [DBG] Connection id "0HNF71R3QDFKD", Request id "0HNF71R3QDFKD:00000008": done reading request body.
2025-08-29 18:15:19.196 +03:00 [INF] Creating profile for provider "SqlServer"
2025-08-29 18:15:19.197 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:19.205 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:19.219 +03:00 [DBG] Saved secret profile-50fbb3fd-ddea-4f7e-a5d1-bb74bcb4f946 for provider "SqlServer"
2025-08-29 18:15:19.220 +03:00 [DBG] Generated profile name SqlServer - ProductInventory with cache dir C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer
2025-08-29 18:15:19.230 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Any(p => (int)p.Provider == (int)__profile_Provider_0)'
2025-08-29 18:15:19.236 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Profiles AS p
                WHERE p.Provider == @__profile_Provider_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 18:15:19.241 +03:00 [DBG] Creating DbConnection.
2025-08-29 18:15:19.242 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 18:15:19.242 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:19.243 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:19.244 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:19.245 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:19.247 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-08-29 18:15:19.249 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 18:15:19.251 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 18:15:19.253 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:19.254 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 18:15:19.255 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:19.256 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:19.275 +03:00 [DBG] 'ProfilesDbContext' generated a value for the property 'Profile.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:19.280 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:19.282 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 18:15:19.283 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 18:15:19.284 +03:00 [DBG] SaveChanges starting for 'ProfilesDbContext'.
2025-08-29 18:15:19.285 +03:00 [DBG] DetectChanges starting for 'ProfilesDbContext'.
2025-08-29 18:15:19.286 +03:00 [DBG] DetectChanges completed for 'ProfilesDbContext'.
2025-08-29 18:15:19.292 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:19.294 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:19.295 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:19.296 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:19.297 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:19.298 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-29 18:15:19.303 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 49), @p2='?' (DbType = DateTimeOffset), @p3='?' (Size = 28), @p4='?' (DbType = Int32), @p5='?' (Size = 44)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Profiles" ("Id", "CacheFile", "CreatedUtc", "Name", "Provider", "SecretRef")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-08-29 18:15:19.304 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:19.305 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 18:15:19.306 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:19.307 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:19.309 +03:00 [DBG] An entity of type 'Profile' tracked by 'ProfilesDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:19.311 +03:00 [DBG] SaveChanges completed for 'ProfilesDbContext' with 1 entities written to the database.
2025-08-29 18:15:19.312 +03:00 [INF] Profile created successfully with Id "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:19.316 +03:00 [INF] Executed endpoint 'HTTP: POST api/setup/profile'
2025-08-29 18:15:19.317 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:19.318 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:19.319 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:19.320 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:19.321 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/setup/profile - 200 null application/json; charset=utf-8 161.5558ms
2025-08-29 18:15:28.471 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 18:15:28.474 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 18:15:28.475 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 18:15:28.476 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 18:15:28.477 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 18:15:28.480 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:28.482 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 18:15:28.486 +03:00 [DBG] Connection id "0HNF71R3QDFKD", Request id "0HNF71R3QDFKD:00000009": started reading request body.
2025-08-29 18:15:28.487 +03:00 [DBG] Connection id "0HNF71R3QDFKD", Request id "0HNF71R3QDFKD:00000009": done reading request body.
2025-08-29 18:15:28.492 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:28.497 +03:00 [DBG] Creating DbConnection.
2025-08-29 18:15:28.498 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 18:15:28.499 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:28.500 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:28.501 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:28.502 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:28.502 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:28.503 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:28.505 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:28.506 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:28.507 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:28.508 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 18:15:28.509 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:28.510 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:28.513 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:28.513 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:28.514 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:28.515 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:28.516 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:28.517 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:28.518 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:28.519 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:28.520 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:28.521 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 18:15:28.522 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:28.523 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:28.534 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:28.537 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 18:15:28.539 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 18:15:28.542 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:28.543 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:28.565 +03:00 [INF] Loaded 3 tables
2025-08-29 18:15:28.715 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-29 18:15:28.730 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 18:15:28.731 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 18:15:28.733 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 18:15:28.734 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 18:15:28.735 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 18:15:28.740 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 18:15:29.652 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 18:15:29.660 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 18:15:29.663 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 18:15:29.664 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:29.667 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:29.667 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:29.669 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:29.669 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 200 null application/json; charset=utf-8 1198.5143ms
2025-08-29 18:15:36.851 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/execute - application/json 306
2025-08-29 18:15:36.854 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/execute'
2025-08-29 18:15:36.855 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/execute' with route pattern 'api/query/{profileId}/execute' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/execute'
2025-08-29 18:15:36.856 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 18:15:36.856 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 18:15:36.857 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:36.859 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 18:15:36.867 +03:00 [DBG] Connection id "0HNF71R3QDFKD", Request id "0HNF71R3QDFKD:0000000A": started reading request body.
2025-08-29 18:15:36.868 +03:00 [DBG] Connection id "0HNF71R3QDFKD", Request id "0HNF71R3QDFKD:0000000A": done reading request body.
2025-08-29 18:15:36.875 +03:00 [DBG] Creating DbConnection.
2025-08-29 18:15:36.875 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 18:15:36.876 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:36.877 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.878 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:36.878 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:36.879 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:36.880 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:36.882 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:36.883 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:36.884 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.885 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 18:15:36.887 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.888 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:36.889 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:36.890 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:36.891 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.892 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:36.893 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:36.894 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:36.895 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:36.897 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:36.899 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.901 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 18:15:36.902 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.903 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:36.905 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:36.906 +03:00 [INF] Executing SQL for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", Mode="ReadOnly"
2025-08-29 18:15:36.914 +03:00 [INF] Executing SQL on DESKTOP-QCK8UI5\SQLEXPRESS/ProductInventory (Mode="ReadOnly")
2025-08-29 18:15:36.915 +03:00 [DBG] SQL: SELECT P.Id, P.Name, P.Price, P.StockQuantity, P.CategoryId, C.Name AS CategoryName FROM Products P INNER JOIN Categories C ON P.CategoryId = C.Id;
2025-08-29 18:15:36.917 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:36.918 +03:00 [DBG] Connection opened to DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:15:36.927 +03:00 [INF] Query execution finished in 9 ms, returned 1 rows
2025-08-29 18:15:36.929 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:36.930 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.931 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:36.932 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:36.933 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:36.934 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:36.935 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:36.936 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.937 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 18:15:36.938 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.939 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:36.952 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:36.953 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.954 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:36.955 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:36.956 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:36.957 +03:00 [DBG] Executing DbCommand [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 18:15:36.958 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__profile_Provider_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Profiles" AS "p"
    WHERE "p"."Provider" = @__profile_Provider_0)
2025-08-29 18:15:36.959 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.960 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 18:15:36.961 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:36.962 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:37.010 +03:00 [ERR] Failed to persist query to DB for userQuery=Show me all products: A profile for SqlServer already exists.
2025-08-29 18:15:37.013 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/execute'
2025-08-29 18:15:37.014 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:37.015 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:37.016 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:37.017 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:37.018 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/execute - 200 null application/json; charset=utf-8 167.5478ms
2025-08-29 18:15:44.114 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/databases - null null
2025-08-29 18:15:44.117 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/databases'
2025-08-29 18:15:44.118 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/databases' with route pattern 'api/query/{profileId}/databases' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/databases'
2025-08-29 18:15:44.119 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 18:15:44.120 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 18:15:44.121 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:44.125 +03:00 [DBG] Creating DbConnection.
2025-08-29 18:15:44.126 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 18:15:44.126 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:44.127 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:44.129 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:44.129 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:44.130 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:44.131 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:44.132 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:44.134 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:44.135 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:44.136 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 18:15:44.137 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:44.138 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:44.139 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:44.140 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:44.141 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:44.142 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:44.143 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:44.144 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:44.145 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:44.147 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:44.149 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:44.150 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 18:15:44.151 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:44.152 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:44.154 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:44.155 +03:00 [DBG] Fetching databases for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:44.156 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:15:44.157 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:44.158 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:15:44.528 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:15:44.530 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/databases'
2025-08-29 18:15:44.531 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:44.532 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:44.532 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:44.533 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:44.534 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/databases - 200 null application/json; charset=utf-8 419.9957ms
2025-08-29 18:15:51.043 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/schema?forceRefresh=true - null null
2025-08-29 18:15:51.045 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/schema'
2025-08-29 18:15:51.047 +03:00 [DBG] Endpoint 'HTTP: GET api/query/{profileId}/schema' with route pattern 'api/query/{profileId}/schema' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/schema'
2025-08-29 18:15:51.049 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 18:15:51.051 +03:00 [INF] Executing endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 18:15:51.052 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:15:51.065 +03:00 [DBG] Creating DbConnection.
2025-08-29 18:15:51.066 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 18:15:51.067 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:51.069 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:51.070 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:51.070 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:51.071 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:51.073 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:51.075 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:51.077 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 18:15:51.078 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:51.080 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 18:15:51.081 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:51.082 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 18:15:51.084 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:51.085 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:51.086 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:51.087 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 18:15:51.088 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 18:15:51.089 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 18:15:51.090 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:51.091 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 18:15:51.093 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:51.094 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 18:15:51.095 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 18:15:51.096 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:51.098 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 18:15:51.099 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=true
2025-08-29 18:15:51.101 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=true)
2025-08-29 18:15:51.102 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:51.103 +03:00 [DBG] Connected to database for schema extraction (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=ProductInventory)
2025-08-29 18:15:51.110 +03:00 [INF] Loaded 3 tables
2025-08-29 18:15:51.117 +03:00 [INF] Schema loaded: 3 tables, 10 columns, 1 relations
2025-08-29 18:15:51.143 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 18:15:51.144 +03:00 [INF] Cached schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer_schemas.json
2025-08-29 18:15:51.147 +03:00 [INF] Executed endpoint 'HTTP: GET api/query/{profileId}/schema'
2025-08-29 18:15:51.148 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:15:51.149 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:15:51.149 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 18:15:51.150 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 18:15:51.151 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/schema?forceRefresh=true - 200 null application/json; charset=utf-8 108.5543ms
2025-08-29 18:16:44.709 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/providers - null null
2025-08-29 18:16:44.713 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/providers'
2025-08-29 18:16:44.715 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:16:44.716 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:16:44.717 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:16:44.719 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/providers'
2025-08-29 18:16:44.720 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:16:44.720 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:16:44.721 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/providers - 200 null application/json; charset=utf-8 11.622ms
2025-08-29 18:16:47.003 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - null null
2025-08-29 18:16:47.005 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/SqlServer'
2025-08-29 18:16:47.006 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/SqlServer'
2025-08-29 18:16:47.008 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:16:47.008 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:16:47.009 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:16:47.011 +03:00 [INF] Fetching servers (forceRefresh=true)
2025-08-29 18:16:47.012 +03:00 [DBG] Looking up servers from registry key SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
2025-08-29 18:16:47.012 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:17:02.000 +03:00 [DBG] Failed to connect ConnectionString: Data Source=DESKTOP-QCK8UI5\SQLEXPRESS;Initial Catalog=master;Integrated Security=True;Connect Timeout=15;Trust Server Certificate=True
2025-08-29 18:17:02.002 +03:00 [WRN] Unable to connect to server DESKTOP-QCK8UI5\SQLEXPRESS when counting DBs
2025-08-29 18:17:02.003 +03:00 [INF] Discovered server DESKTOP-QCK8UI5\SQLEXPRESS with -1 running DBs
2025-08-29 18:17:02.009 +03:00 [DBG] Saved cache file C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 18:17:02.012 +03:00 [INF] Cached 1 servers to C:\Users\Zyad\AppData\Local\MicroSqlRag\SqlServer\SqlServer.json
2025-08-29 18:17:02.014 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 18:17:02.016 +03:00 [DBG] Connection id "0HNF71R3QDFKD" completed keep alive response.
2025-08-29 18:17:02.017 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:17:02.018 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/SqlServer - 200 null application/json; charset=utf-8 15014.7161ms
2025-08-29 18:17:56.576 +03:00 [DBG] Connection id "0HNF71R3QDFKE" received FIN.
2025-08-29 18:17:56.578 +03:00 [DBG] Connection id "0HNF71R3QDFKE" accepted.
2025-08-29 18:17:56.582 +03:00 [DBG] Connection id "0HNF71R3QDFKE" started.
2025-08-29 18:17:56.582 +03:00 [DBG] Connection id "0HNF71R3QDFKF" accepted.
2025-08-29 18:17:56.602 +03:00 [DBG] Connection id "0HNF71R3QDFKF" started.
2025-08-29 18:17:56.655 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 18:17:56.657 +03:00 [DBG] Connection id "0HNF71R3QDFKE" stopped.
2025-08-29 18:17:56.658 +03:00 [DBG] Connection id "0HNF71R3QDFKE" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 18:17:56.658 +03:00 [DBG] Connection 0HNF71R3QDFKF established using the following protocol: "Tls13"
2025-08-29 18:17:56.660 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 18:17:56.662 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 18:17:56.663 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 18:17:56.664 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:17:56.665 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:17:56.666 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:17:56.667 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:17:56.668 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:18:11.439 +03:00 [ERR] Failed to fetch databases for DESKTOP-QCK8UI5\SQLEXPRESS: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)
2025-08-29 18:18:11.637 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:18:11.756 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.Providers.SqlServerProviderException: Failed to fetch databases from server 'DESKTOP-QCK8UI5\SQLEXPRESS'.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, TimeoutTimer timeout, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, IDbConnectionPool pool, Func`3 accessTokenCallback)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionPoolGroupProviderInfo poolGroupProviderInfo, IDbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(IDbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.ConnectionPool.WaitHandleDbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.SqlClient.ConnectionPool.WaitHandleDbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.SqlClient.ConnectionPool.WaitHandleDbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.SqlClient.ConnectionPool.WaitHandleDbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.FetchDatabasesFromServer(ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 445
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:-1,State:0,Class:20
   --- End of inner exception stack trace ---
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.FetchDatabasesFromServer(ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 489
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.GetDatabasesAsync(ProviderConnectionConfig config, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 152
   at NaturalToQuery.Infrastructure.Providers.SqlServerDbProvider.GetDatabasesAsync(String serverName, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Providers\SqlServerDbProvider.cs:line 175
   at NaturalToQuery.Api.Controllers.Setup.GetAvailableDatabases.HandleAsync(GetAvailableDatabasesRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\AvailableDatabases.cs:line 25
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 18:18:11.776 +03:00 [ERR] Error occurred.
2025-08-29 18:18:11.781 +03:00 [DBG] Connection id "0HNF71R3QDFKF" completed keep alive response.
2025-08-29 18:18:11.782 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:18:11.783 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 500 null application/json; charset=utf-8 15123.7375ms
2025-08-29 18:40:49.531 +03:00 [DBG] Connection id "0HNF71R3QDFKG" received FIN.
2025-08-29 18:40:49.533 +03:00 [DBG] Connection id "0HNF71R3QDFKG" accepted.
2025-08-29 18:40:49.539 +03:00 [DBG] Connection id "0HNF71R3QDFKG" started.
2025-08-29 18:40:49.539 +03:00 [DBG] Connection id "0HNF71R3QDFKH" accepted.
2025-08-29 18:40:49.582 +03:00 [DBG] Connection id "0HNF71R3QDFKH" started.
2025-08-29 18:40:49.600 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 18:40:49.603 +03:00 [DBG] Connection id "0HNF71R3QDFKG" stopped.
2025-08-29 18:40:49.603 +03:00 [DBG] Connection id "0HNF71R3QDFKG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 18:40:49.606 +03:00 [DBG] Connection 0HNF71R3QDFKH established using the following protocol: "Tls13"
2025-08-29 18:40:49.610 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 18:40:49.611 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 18:40:49.612 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 18:40:49.613 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:40:49.614 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:40:49.616 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 18:40:49.617 +03:00 [INF] Fetching databases for server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:40:49.618 +03:00 [INF] Creating connection (Server=DESKTOP-QCK8UI5\SQLEXPRESS, Database=master)
2025-08-29 18:40:49.630 +03:00 [DBG] Connected to server DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:40:50.163 +03:00 [INF] Found 8 databases on DESKTOP-QCK8UI5\SQLEXPRESS
2025-08-29 18:40:50.164 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 18:40:50.166 +03:00 [DBG] Connection id "0HNF71R3QDFKH" completed keep alive response.
2025-08-29 18:40:50.167 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 18:40:50.167 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/SqlServer/DESKTOP-QCK8UI5\SQLEXPRESS - 200 null application/json; charset=utf-8 558.1297ms
2025-08-29 19:29:47.120 +03:00 [INF] This is a test log to file!
2025-08-29 19:29:47.431 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:29:47.448 +03:00 [INF] API configured successfully.
2025-08-29 19:29:47.598 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:29:48.020 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:29:48.048 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:29:48.055 +03:00 [INF] Registered 10 endpoints in 837 milliseconds.
2025-08-29 19:29:48.061 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:29:48.063 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:29:48.063 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:29:48.084 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:29:48.109 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:29:48.111 +03:00 [DBG] Hosting starting
2025-08-29 19:29:48.122 +03:00 [DBG] Middleware loaded
2025-08-29 19:29:48.124 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:29:48.126 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:29:48.188 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:29:48.190 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:29:48.192 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:29:48.222 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:29:48.273 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:29:48.274 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:29:48.275 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:29:48.276 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:29:48.276 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:29:48.277 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:29:48.282 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:29:48.298 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:29:48.332 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:29:48.333 +03:00 [INF] Hosting environment: Development
2025-08-29 19:29:48.334 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:29:48.335 +03:00 [DBG] Hosting started
2025-08-29 19:30:00.946 +03:00 [DBG] Connection id "0HNF7356GSJ3M" received FIN.
2025-08-29 19:30:00.951 +03:00 [DBG] Connection id "0HNF7356GSJ3M" accepted.
2025-08-29 19:30:00.952 +03:00 [DBG] Connection id "0HNF7356GSJ3M" started.
2025-08-29 19:30:00.953 +03:00 [DBG] Connection id "0HNF7356GSJ3N" accepted.
2025-08-29 19:30:00.955 +03:00 [DBG] Connection id "0HNF7356GSJ3N" started.
2025-08-29 19:30:01.012 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:30:01.017 +03:00 [DBG] Connection id "0HNF7356GSJ3M" stopped.
2025-08-29 19:30:01.021 +03:00 [DBG] Connection id "0HNF7356GSJ3M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:30:01.034 +03:00 [DBG] Connection 0HNF7356GSJ3N established using the following protocol: "Tls13"
2025-08-29 19:30:01.060 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:30:01.090 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:30:01.092 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:30:01.095 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:01.118 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:01.154 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:30:01.157 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:30:01.190 +03:00 [DBG] Connection id "0HNF7356GSJ3N", Request id "0HNF7356GSJ3N:00000001": started reading request body.
2025-08-29 19:30:01.192 +03:00 [DBG] Connection id "0HNF7356GSJ3N", Request id "0HNF7356GSJ3N:00000001": done reading request body.
2025-08-29 19:30:01.215 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:30:01.263 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 19:30:01.298 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 19:30:01.507 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 19:30:01.535 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:30:01.545 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-29 19:30:01.547 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:30:01.557 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:01.560 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:30:01.565 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 19:30:01.568 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-29 19:30:01.574 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:01.588 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:01.617 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:30:01.639 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:01.645 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 52ms reading results.
2025-08-29 19:30:01.648 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:01.651 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:30:01.659 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:30:01.662 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:30:01.663 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:01.664 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:30:01.665 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 19:30:01.665 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:30:01.666 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:01.668 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:01.670 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:01.672 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 19:30:01.673 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:01.673 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 19:30:01.682 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:30:01.692 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:30:01.694 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:30:01.781 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:30:01.800 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:30:01.802 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:30:01.804 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:30:01.810 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:30:02.915 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 19:30:02.925 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 19:30:02.935 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:02.939 +03:00 [DBG] Connection id "0HNF7356GSJ3N" completed keep alive response.
2025-08-29 19:30:02.944 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:30:02.948 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:30:02.950 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:30:02.952 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 200 null application/json; charset=utf-8 1896.551ms
2025-08-29 19:30:24.680 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 19:30:24.683 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:30:24.683 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:30:24.935 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:30:24.936 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:30:24.937 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 19:30:28.352 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:30:28.355 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:30:28.356 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:30:28.357 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:28.358 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:28.373 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:30:28.374 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:30:28.375 +03:00 [DBG] Connection id "0HNF7356GSJ3N", Request id "0HNF7356GSJ3N:00000002": started reading request body.
2025-08-29 19:30:28.376 +03:00 [DBG] Connection id "0HNF7356GSJ3N", Request id "0HNF7356GSJ3N:00000002": done reading request body.
2025-08-29 19:30:28.378 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:28.379 +03:00 [DBG] Connection id "0HNF7356GSJ3N" completed keep alive response.
2025-08-29 19:30:28.380 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:30:28.381 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 200 null application/json; charset=utf-8 29.7203ms
2025-08-29 19:30:31.952 +03:00 [INF] This is a test log to file!
2025-08-29 19:30:32.233 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:30:32.242 +03:00 [INF] API configured successfully.
2025-08-29 19:30:32.371 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:30:32.806 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:30:32.836 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:30:32.844 +03:00 [INF] Registered 10 endpoints in 814 milliseconds.
2025-08-29 19:30:32.850 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:30:32.852 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:30:32.853 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:30:32.877 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:30:32.902 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:30:32.904 +03:00 [DBG] Hosting starting
2025-08-29 19:30:32.915 +03:00 [DBG] Middleware loaded
2025-08-29 19:30:32.917 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:30:32.919 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:30:32.982 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:30:32.983 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:30:32.985 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:30:33.015 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:30:33.080 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:30:33.081 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:30:33.082 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:30:33.083 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:30:33.083 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:30:33.084 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:30:33.089 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:30:33.095 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:30:33.119 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:30:33.120 +03:00 [INF] Hosting environment: Development
2025-08-29 19:30:33.121 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:30:33.122 +03:00 [DBG] Hosting started
2025-08-29 19:30:34.531 +03:00 [DBG] Connection id "0HNF735GH5TEA" received FIN.
2025-08-29 19:30:34.535 +03:00 [DBG] Connection id "0HNF735GH5TEA" accepted.
2025-08-29 19:30:34.538 +03:00 [DBG] Connection id "0HNF735GH5TEA" started.
2025-08-29 19:30:34.539 +03:00 [DBG] Connection id "0HNF735GH5TEB" accepted.
2025-08-29 19:30:34.539 +03:00 [DBG] Connection id "0HNF735GH5TEB" started.
2025-08-29 19:30:34.597 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:30:34.604 +03:00 [DBG] Connection id "0HNF735GH5TEA" stopped.
2025-08-29 19:30:34.608 +03:00 [DBG] Connection id "0HNF735GH5TEA" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:30:34.618 +03:00 [DBG] Connection 0HNF735GH5TEB established using the following protocol: "Tls13"
2025-08-29 19:30:34.643 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:30:34.672 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:30:34.675 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:30:34.678 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:34.698 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:34.734 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:30:34.739 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:30:34.767 +03:00 [DBG] Connection id "0HNF735GH5TEB", Request id "0HNF735GH5TEB:00000001": started reading request body.
2025-08-29 19:30:34.769 +03:00 [DBG] Connection id "0HNF735GH5TEB", Request id "0HNF735GH5TEB:00000001": done reading request body.
2025-08-29 19:30:34.791 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:30:34.838 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 19:30:34.871 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 19:30:35.097 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 19:30:35.129 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:30:35.142 +03:00 [DBG] Created DbConnection. (11ms).
2025-08-29 19:30:35.145 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:30:35.157 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:35.162 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:30:35.168 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 19:30:35.172 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-08-29 19:30:35.179 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:35.195 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:35.230 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:30:35.259 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:35.265 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 63ms reading results.
2025-08-29 19:30:35.269 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:35.273 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (4ms).
2025-08-29 19:30:35.282 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:30:35.285 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:30:35.286 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:35.288 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:30:35.289 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:30:35.290 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 19:30:35.291 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:35.293 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:30:35.297 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:35.298 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 19:30:35.300 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:30:35.302 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 19:30:35.311 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:30:35.325 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:30:35.327 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:30:35.419 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:30:35.437 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:30:35.440 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:30:35.441 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:30:35.449 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:30:35.739 +03:00 [INF] Groq API responded with status: "Unauthorized"
2025-08-29 19:30:35.742 +03:00 [ERR] Groq API error: "Unauthorized" - {"error":{"message":"Invalid API Key","type":"invalid_request_error","code":"invalid_api_key"}}

2025-08-29 19:30:36.020 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:30:36.179 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.LLM.GroqServiceException: Groq API request failed with status Unauthorized
   at NaturalToQuery.Infrastructure.LLM.GroqService.CallGroqApiAsync(PromptMessage[] messages, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 88
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 54
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:30:36.191 +03:00 [ERR] Unhandled exception occurred.
2025-08-29 19:30:36.214 +03:00 [DBG] Connection id "0HNF735GH5TEB" completed keep alive response.
2025-08-29 19:30:36.230 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:30:36.234 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:30:36.236 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:30:36.239 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 500 null application/json; charset=utf-8 1599.31ms
2025-08-29 19:30:43.974 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 19:30:43.976 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:30:43.977 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:30:44.228 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:30:44.229 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:30:44.230 +03:00 [DBG] Config reload token fired. Checking for changes...
2025-08-29 19:31:40.015 +03:00 [INF] This is a test log to file!
2025-08-29 19:31:40.330 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:31:40.337 +03:00 [INF] API configured successfully.
2025-08-29 19:31:40.459 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:31:40.877 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:31:40.904 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:31:40.912 +03:00 [INF] Registered 10 endpoints in 813 milliseconds.
2025-08-29 19:31:40.917 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:31:40.919 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:31:40.920 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:31:40.940 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:31:40.966 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:31:40.967 +03:00 [DBG] Hosting starting
2025-08-29 19:31:40.977 +03:00 [DBG] Middleware loaded
2025-08-29 19:31:40.980 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:31:40.982 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:31:41.042 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:31:41.043 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:31:41.045 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:31:41.071 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:31:41.108 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:31:41.110 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:31:41.110 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:31:41.111 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:31:41.112 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:31:41.112 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:31:41.118 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:31:41.123 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:31:41.201 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:31:41.202 +03:00 [INF] Hosting environment: Development
2025-08-29 19:31:41.203 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:31:41.204 +03:00 [DBG] Hosting started
2025-08-29 19:31:48.556 +03:00 [INF] This is a test log to file!
2025-08-29 19:31:48.940 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:31:48.959 +03:00 [INF] API configured successfully.
2025-08-29 19:31:49.165 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:31:49.731 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:31:49.758 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:31:49.765 +03:00 [INF] Registered 10 endpoints in 1,101 milliseconds.
2025-08-29 19:31:49.772 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:31:49.774 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:31:49.775 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:31:49.796 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:31:49.826 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:31:49.828 +03:00 [DBG] Hosting starting
2025-08-29 19:31:49.843 +03:00 [DBG] Middleware loaded
2025-08-29 19:31:49.845 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:31:49.847 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:31:49.912 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:31:49.913 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:31:49.915 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:31:49.941 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:31:49.998 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:31:50.001 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:31:50.002 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:31:50.003 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:31:50.003 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:31:50.004 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:31:50.009 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:31:50.014 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:31:50.037 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:31:50.039 +03:00 [INF] Hosting environment: Development
2025-08-29 19:31:50.040 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:31:50.040 +03:00 [DBG] Hosting started
2025-08-29 19:31:51.276 +03:00 [DBG] Connection id "0HNF7367D2PSL" received FIN.
2025-08-29 19:31:51.284 +03:00 [DBG] Connection id "0HNF7367D2PSL" accepted.
2025-08-29 19:31:51.287 +03:00 [DBG] Connection id "0HNF7367D2PSL" started.
2025-08-29 19:31:51.289 +03:00 [DBG] Connection id "0HNF7367D2PSM" accepted.
2025-08-29 19:31:51.290 +03:00 [DBG] Connection id "0HNF7367D2PSM" started.
2025-08-29 19:31:51.351 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:31:51.358 +03:00 [DBG] Connection id "0HNF7367D2PSL" stopped.
2025-08-29 19:31:51.363 +03:00 [DBG] Connection id "0HNF7367D2PSL" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:31:51.374 +03:00 [DBG] Connection 0HNF7367D2PSM established using the following protocol: "Tls13"
2025-08-29 19:31:51.400 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:31:51.429 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:31:51.432 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:31:51.435 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:31:51.456 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:31:51.494 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:31:51.497 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:31:51.526 +03:00 [DBG] Connection id "0HNF7367D2PSM", Request id "0HNF7367D2PSM:00000001": started reading request body.
2025-08-29 19:31:51.528 +03:00 [DBG] Connection id "0HNF7367D2PSM", Request id "0HNF7367D2PSM:00000001": done reading request body.
2025-08-29 19:31:51.549 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:31:51.596 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 19:31:51.631 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 19:31:51.847 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 19:31:51.877 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:31:51.887 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-29 19:31:51.890 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:31:51.902 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:31:51.906 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:31:51.911 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-29 19:31:51.914 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-29 19:31:51.920 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:31:51.936 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:31:51.967 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:31:51.991 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:31:51.996 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 55ms reading results.
2025-08-29 19:31:52.000 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:31:52.004 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 19:31:52.012 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:31:52.015 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:31:52.016 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:31:52.017 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:31:52.019 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:31:52.020 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 19:31:52.021 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:31:52.023 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:31:52.025 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:31:52.027 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 19:31:52.028 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:31:52.029 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 19:31:52.039 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:31:52.050 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:31:52.052 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:31:52.149 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:31:52.166 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:31:52.168 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:31:52.169 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:31:52.175 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:31:52.628 +03:00 [INF] Groq API responded with status: "Unauthorized"
2025-08-29 19:31:52.631 +03:00 [ERR] Groq API error: "Unauthorized" - {"error":{"message":"Invalid API Key","type":"invalid_request_error","code":"invalid_api_key"}}

2025-08-29 19:31:52.855 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:31:52.973 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.LLM.GroqServiceException: Groq API request failed with status Unauthorized
   at NaturalToQuery.Infrastructure.LLM.GroqService.CallGroqApiAsync(PromptMessage[] messages, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 88
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 54
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:31:52.981 +03:00 [ERR] Error occurred.
2025-08-29 19:31:52.991 +03:00 [DBG] Connection id "0HNF7367D2PSM" completed keep alive response.
2025-08-29 19:31:52.995 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:31:52.998 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:31:53.001 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:31:53.004 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 401 null application/json; charset=utf-8 1606.8487ms
2025-08-29 19:32:49.619 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:32:49.622 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:32:49.624 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:32:49.625 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:32:49.627 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:32:49.672 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:32:49.674 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:32:49.674 +03:00 [DBG] Connection id "0HNF7367D2PSM", Request id "0HNF7367D2PSM:00000002": started reading request body.
2025-08-29 19:32:49.675 +03:00 [DBG] Connection id "0HNF7367D2PSM", Request id "0HNF7367D2PSM:00000002": done reading request body.
2025-08-29 19:32:49.676 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:32:49.678 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:32:49.679 +03:00 [DBG] Created DbConnection. (0ms).
2025-08-29 19:32:49.680 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:32:49.680 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:32:49.681 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:32:49.682 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 19:32:49.683 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:32:49.684 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:32:49.685 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:32:49.687 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:32:49.688 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:32:49.689 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 19:32:49.690 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:32:49.691 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 19:32:49.692 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:32:49.693 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:32:49.694 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:32:49.694 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:32:49.695 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 19:32:49.696 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:32:49.697 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:32:49.699 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:32:49.700 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:32:49.701 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 0ms reading results.
2025-08-29 19:32:49.702 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:32:49.703 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 19:32:49.704 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:32:49.705 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:32:49.706 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:32:49.708 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:32:49.709 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:32:49.710 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:32:49.711 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:32:49.712 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:32:49.956 +03:00 [INF] Groq API responded with status: "Unauthorized"
2025-08-29 19:32:49.957 +03:00 [ERR] Groq API error: "Unauthorized" - {"error":{"message":"Invalid API Key","type":"invalid_request_error","code":"invalid_api_key"}}

2025-08-29 19:32:50.165 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:32:50.272 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.LLM.GroqServiceException: Groq API request failed with status Unauthorized
   at NaturalToQuery.Infrastructure.LLM.GroqService.CallGroqApiAsync(PromptMessage[] messages, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 88
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 54
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:32:50.276 +03:00 [ERR] Error occurred.
2025-08-29 19:32:50.277 +03:00 [DBG] Connection id "0HNF7367D2PSM" completed keep alive response.
2025-08-29 19:32:50.278 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:32:50.279 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:32:50.280 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 19:32:50.281 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 401 null application/json; charset=utf-8 662.124ms
2025-08-29 19:36:01.176 +03:00 [INF] This is a test log to file!
2025-08-29 19:36:01.441 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:36:01.448 +03:00 [INF] API configured successfully.
2025-08-29 19:36:01.570 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:36:01.995 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:36:02.024 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:36:02.032 +03:00 [INF] Registered 10 endpoints in 764 milliseconds.
2025-08-29 19:36:02.039 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:36:02.042 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:36:02.043 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:36:02.065 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:36:02.091 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:36:02.093 +03:00 [DBG] Hosting starting
2025-08-29 19:36:02.103 +03:00 [DBG] Middleware loaded
2025-08-29 19:36:02.106 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:36:02.107 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:36:02.170 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:36:02.171 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:36:02.173 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:36:02.199 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:36:02.237 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:36:02.240 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:36:02.241 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:36:02.242 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:36:02.242 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:36:02.243 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:36:02.248 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:36:02.253 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:36:02.276 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:36:02.278 +03:00 [INF] Hosting environment: Development
2025-08-29 19:36:02.278 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:36:02.279 +03:00 [DBG] Hosting started
2025-08-29 19:36:10.306 +03:00 [DBG] Connection id "0HNF738KJCCH5" received FIN.
2025-08-29 19:36:10.312 +03:00 [DBG] Connection id "0HNF738KJCCH5" accepted.
2025-08-29 19:36:10.313 +03:00 [DBG] Connection id "0HNF738KJCCH5" started.
2025-08-29 19:36:10.314 +03:00 [DBG] Connection id "0HNF738KJCCH6" accepted.
2025-08-29 19:36:10.315 +03:00 [DBG] Connection id "0HNF738KJCCH6" started.
2025-08-29 19:36:10.372 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:36:10.379 +03:00 [DBG] Connection id "0HNF738KJCCH5" stopped.
2025-08-29 19:36:10.383 +03:00 [DBG] Connection id "0HNF738KJCCH5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:36:10.396 +03:00 [DBG] Connection 0HNF738KJCCH6 established using the following protocol: "Tls13"
2025-08-29 19:36:10.421 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:36:10.451 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:36:10.453 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:36:10.455 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:36:10.476 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:36:10.521 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:36:10.524 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:36:10.553 +03:00 [DBG] Connection id "0HNF738KJCCH6", Request id "0HNF738KJCCH6:00000001": started reading request body.
2025-08-29 19:36:10.555 +03:00 [DBG] Connection id "0HNF738KJCCH6", Request id "0HNF738KJCCH6:00000001": done reading request body.
2025-08-29 19:36:10.578 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:36:10.627 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 19:36:10.661 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 19:36:10.888 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 19:36:10.928 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:36:10.942 +03:00 [DBG] Created DbConnection. (13ms).
2025-08-29 19:36:10.945 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:36:10.956 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:10.960 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:36:10.964 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-29 19:36:10.968 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-29 19:36:10.974 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:10.989 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:11.021 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:36:11.043 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:11.049 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 55ms reading results.
2025-08-29 19:36:11.052 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:11.055 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:36:11.064 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:36:11.067 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:36:11.068 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:11.069 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:36:11.070 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 19:36:11.071 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:36:11.072 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:11.073 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:11.076 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:11.077 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 19:36:11.078 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:11.079 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 19:36:11.088 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:36:11.100 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:36:11.102 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:36:11.187 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:36:11.206 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:36:11.209 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:36:11.210 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:36:11.217 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:36:11.561 +03:00 [INF] Groq API responded with status: "Unauthorized"
2025-08-29 19:36:11.564 +03:00 [ERR] Groq API error: "Unauthorized" - {"error":{"message":"Invalid API Key","type":"invalid_request_error","code":"invalid_api_key"}}

2025-08-29 19:36:11.792 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:36:11.912 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.LLM.GroqServiceException: Groq API request failed with status Unauthorized
   at NaturalToQuery.Infrastructure.LLM.GroqService.CallGroqApiAsync(PromptMessage[] messages, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 88
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 54
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:36:11.923 +03:00 [ERR] Error occurred.
2025-08-29 19:36:11.933 +03:00 [DBG] Connection id "0HNF738KJCCH6" completed keep alive response.
2025-08-29 19:36:11.937 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:36:11.941 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:36:11.943 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:36:11.945 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 401 null application/json; charset=utf-8 1527.9982ms
2025-08-29 19:36:26.507 +03:00 [INF] This is a test log to file!
2025-08-29 19:36:26.751 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:36:26.761 +03:00 [INF] API configured successfully.
2025-08-29 19:36:26.916 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:36:27.398 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:36:27.427 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:36:27.435 +03:00 [INF] Registered 10 endpoints in 856 milliseconds.
2025-08-29 19:36:27.442 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:36:27.445 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:36:27.446 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:36:27.466 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:36:27.491 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:36:27.493 +03:00 [DBG] Hosting starting
2025-08-29 19:36:27.503 +03:00 [DBG] Middleware loaded
2025-08-29 19:36:27.506 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:36:27.508 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:36:27.578 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:36:27.580 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:36:27.583 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:36:27.608 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:36:27.687 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:36:27.689 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:36:27.690 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:36:27.691 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:36:27.691 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:36:27.692 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:36:27.697 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:36:27.704 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:36:27.799 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:36:27.800 +03:00 [INF] Hosting environment: Development
2025-08-29 19:36:27.801 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:36:27.802 +03:00 [DBG] Hosting started
2025-08-29 19:36:29.482 +03:00 [DBG] Connection id "0HNF738QA8HUS" received FIN.
2025-08-29 19:36:29.488 +03:00 [DBG] Connection id "0HNF738QA8HUS" accepted.
2025-08-29 19:36:29.495 +03:00 [DBG] Connection id "0HNF738QA8HUS" started.
2025-08-29 19:36:29.496 +03:00 [DBG] Connection id "0HNF738QA8HUT" accepted.
2025-08-29 19:36:29.497 +03:00 [DBG] Connection id "0HNF738QA8HUT" started.
2025-08-29 19:36:29.593 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:36:29.609 +03:00 [DBG] Connection id "0HNF738QA8HUS" stopped.
2025-08-29 19:36:29.613 +03:00 [DBG] Connection 0HNF738QA8HUT established using the following protocol: "Tls13"
2025-08-29 19:36:29.613 +03:00 [DBG] Connection id "0HNF738QA8HUS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:36:29.641 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:36:29.683 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:36:29.684 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:36:29.687 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:36:29.712 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:36:29.760 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:36:29.762 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:36:29.809 +03:00 [DBG] Connection id "0HNF738QA8HUT", Request id "0HNF738QA8HUT:00000001": started reading request body.
2025-08-29 19:36:29.810 +03:00 [DBG] Connection id "0HNF738QA8HUT", Request id "0HNF738QA8HUT:00000001": done reading request body.
2025-08-29 19:36:29.836 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:36:29.900 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 19:36:29.957 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 19:36:30.182 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 19:36:30.209 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:36:30.221 +03:00 [DBG] Created DbConnection. (9ms).
2025-08-29 19:36:30.223 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:36:30.234 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:30.237 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:36:30.242 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 19:36:30.245 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-29 19:36:30.251 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:30.265 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:30.294 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:36:30.317 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:30.321 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 51ms reading results.
2025-08-29 19:36:30.325 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:30.328 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 19:36:30.336 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:36:30.338 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:36:30.340 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:30.341 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:36:30.342 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:36:30.343 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-08-29 19:36:30.345 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:30.347 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:36:30.350 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:30.351 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 2ms reading results.
2025-08-29 19:36:30.353 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:36:30.354 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 19:36:30.363 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:36:30.374 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:36:30.377 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:36:30.463 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:36:30.480 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:36:30.483 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:36:30.484 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:36:30.490 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:36:30.783 +03:00 [INF] Groq API responded with status: "Unauthorized"
2025-08-29 19:36:30.786 +03:00 [ERR] Groq API error: "Unauthorized" - {"error":{"message":"Invalid API Key","type":"invalid_request_error","code":"invalid_api_key"}}

2025-08-29 19:36:31.025 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:36:31.143 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.LLM.GroqServiceException: Groq API request failed with status Unauthorized
   at NaturalToQuery.Infrastructure.LLM.GroqService.CallGroqApiAsync(PromptMessage[] messages, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 88
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 54
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:36:31.152 +03:00 [ERR] Error occurred.
2025-08-29 19:36:31.163 +03:00 [DBG] Connection id "0HNF738QA8HUT" completed keep alive response.
2025-08-29 19:36:31.166 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:36:31.171 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:36:31.173 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:36:31.175 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 401 null application/json; charset=utf-8 1538.2993ms
2025-08-29 19:37:45.935 +03:00 [INF] This is a test log to file!
2025-08-29 19:37:46.306 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:37:46.315 +03:00 [INF] API configured successfully.
2025-08-29 19:37:46.494 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:37:47.025 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:37:47.064 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:37:47.084 +03:00 [INF] Registered 10 endpoints in 965 milliseconds.
2025-08-29 19:37:47.102 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:37:47.104 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:37:47.105 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:37:47.139 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:37:47.173 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:37:47.175 +03:00 [DBG] Hosting starting
2025-08-29 19:37:47.189 +03:00 [DBG] Middleware loaded
2025-08-29 19:37:47.191 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:37:47.193 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:37:47.253 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:37:47.255 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:37:47.257 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:37:47.284 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:37:47.348 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:37:47.350 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:37:47.351 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:37:47.353 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:37:47.356 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:37:47.358 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:37:47.364 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:37:47.370 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:37:47.460 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:37:47.461 +03:00 [INF] Hosting environment: Development
2025-08-29 19:37:47.462 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:37:47.463 +03:00 [DBG] Hosting started
2025-08-29 19:37:49.280 +03:00 [DBG] Connection id "0HNF739I38PJ8" received FIN.
2025-08-29 19:37:49.286 +03:00 [DBG] Connection id "0HNF739I38PJ8" accepted.
2025-08-29 19:37:49.287 +03:00 [DBG] Connection id "0HNF739I38PJ8" started.
2025-08-29 19:37:49.288 +03:00 [DBG] Connection id "0HNF739I38PJ9" accepted.
2025-08-29 19:37:49.289 +03:00 [DBG] Connection id "0HNF739I38PJ9" started.
2025-08-29 19:37:49.348 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:37:49.354 +03:00 [DBG] Connection id "0HNF739I38PJ8" stopped.
2025-08-29 19:37:49.359 +03:00 [DBG] Connection id "0HNF739I38PJ8" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:37:49.373 +03:00 [DBG] Connection 0HNF739I38PJ9 established using the following protocol: "Tls13"
2025-08-29 19:37:49.399 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:37:49.428 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:37:49.430 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:37:49.432 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:37:49.455 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:37:49.492 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:37:49.494 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:37:49.525 +03:00 [DBG] Connection id "0HNF739I38PJ9", Request id "0HNF739I38PJ9:00000001": started reading request body.
2025-08-29 19:37:49.526 +03:00 [DBG] Connection id "0HNF739I38PJ9", Request id "0HNF739I38PJ9:00000001": done reading request body.
2025-08-29 19:37:49.549 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:37:49.597 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 19:37:49.633 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 19:37:49.849 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 19:37:49.879 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:37:49.889 +03:00 [DBG] Created DbConnection. (8ms).
2025-08-29 19:37:49.893 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:37:49.902 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:37:49.905 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:37:49.910 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-29 19:37:49.913 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-08-29 19:37:49.919 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:37:49.934 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:37:49.962 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:37:49.987 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:37:49.992 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 54ms reading results.
2025-08-29 19:37:49.996 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:37:49.999 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:37:50.007 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:37:50.010 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:37:50.011 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:37:50.012 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:37:50.013 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 19:37:50.013 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:37:50.014 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:37:50.015 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:37:50.018 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:37:50.019 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 19:37:50.020 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:37:50.021 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 19:37:50.029 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:37:50.041 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:37:50.043 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:37:50.130 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:37:50.148 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:37:50.151 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:37:50.152 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:37:50.159 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:37:50.547 +03:00 [INF] Groq API responded with status: "Unauthorized"
2025-08-29 19:37:50.549 +03:00 [ERR] Groq API error: "Unauthorized" - {"error":{"message":"Invalid API Key","type":"invalid_request_error","code":"invalid_api_key"}}

2025-08-29 19:37:50.790 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:37:50.911 +03:00 [ERR] An unhandled exception has occurred while executing the request.
NaturalToQuery.Infrastructure.LLM.GroqServiceException: Groq API request failed with status Unauthorized
   at NaturalToQuery.Infrastructure.LLM.GroqService.CallGroqApiAsync(PromptMessage[] messages, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 88
   at NaturalToQuery.Infrastructure.LLM.GroqService.ConvertToSqlAsync(String schema, String userQuery, ExecutionMode mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\LLM\GroqService.cs:line 54
   at NaturalToQuery.Application.Services.QueryOrchestrationService.ConvertNaturalLanguageAsync(Guid profileId, String naturalLanguage, ExecutionMode Mode, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\QueryOrchestrationService.cs:line 41
   at NaturalToQuery.Api.Controllers.Query.ConvertNaturalLanguage.HandleAsync(ConvertNaturalLanguageRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Query\ConvertNaturalLanguage.cs:line 45
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:37:50.920 +03:00 [ERR] Error occurred.
2025-08-29 19:37:50.930 +03:00 [DBG] Connection id "0HNF739I38PJ9" completed keep alive response.
2025-08-29 19:37:50.934 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:37:50.938 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:37:50.941 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:37:50.943 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 401 null application/json; charset=utf-8 1547.898ms
2025-08-29 19:38:03.651 +03:00 [INF] This is a test log to file!
2025-08-29 19:38:03.943 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:38:03.950 +03:00 [INF] API configured successfully.
2025-08-29 19:38:04.086 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:38:04.569 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:38:04.598 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:38:04.606 +03:00 [INF] Registered 10 endpoints in 865 milliseconds.
2025-08-29 19:38:04.612 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:38:04.614 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:38:04.615 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:38:04.639 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:38:04.669 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:38:04.671 +03:00 [DBG] Hosting starting
2025-08-29 19:38:04.685 +03:00 [DBG] Middleware loaded
2025-08-29 19:38:04.689 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:38:04.691 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:38:04.760 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:38:04.762 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:38:04.765 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:38:04.794 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:38:04.876 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:38:04.877 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:38:04.879 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:38:04.879 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:38:04.880 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:38:04.880 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:38:04.886 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:38:04.891 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:38:04.971 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:38:04.972 +03:00 [INF] Hosting environment: Development
2025-08-29 19:38:04.973 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:38:04.973 +03:00 [DBG] Hosting started
2025-08-29 19:38:05.696 +03:00 [DBG] Connection id "0HNF739MVQIHD" received FIN.
2025-08-29 19:38:05.702 +03:00 [DBG] Connection id "0HNF739MVQIHD" accepted.
2025-08-29 19:38:05.704 +03:00 [DBG] Connection id "0HNF739MVQIHD" started.
2025-08-29 19:38:05.705 +03:00 [DBG] Connection id "0HNF739MVQIHE" accepted.
2025-08-29 19:38:05.707 +03:00 [DBG] Connection id "0HNF739MVQIHE" started.
2025-08-29 19:38:05.785 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:38:05.791 +03:00 [DBG] Connection id "0HNF739MVQIHD" stopped.
2025-08-29 19:38:05.795 +03:00 [DBG] Connection id "0HNF739MVQIHD" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:38:05.804 +03:00 [DBG] Connection 0HNF739MVQIHE established using the following protocol: "Tls13"
2025-08-29 19:38:05.830 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 19:38:05.857 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:38:05.860 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 19:38:05.862 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:38:05.883 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:38:05.919 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:38:05.922 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:38:05.951 +03:00 [DBG] Connection id "0HNF739MVQIHE", Request id "0HNF739MVQIHE:00000001": started reading request body.
2025-08-29 19:38:05.953 +03:00 [DBG] Connection id "0HNF739MVQIHE", Request id "0HNF739MVQIHE:00000001": done reading request body.
2025-08-29 19:38:05.975 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:38:06.021 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 19:38:06.055 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 19:38:06.318 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 19:38:06.344 +03:00 [DBG] Creating DbConnection.
2025-08-29 19:38:06.355 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-29 19:38:06.359 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:38:06.370 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:38:06.374 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:38:06.378 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 19:38:06.383 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-29 19:38:06.390 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:38:06.406 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:38:06.436 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 19:38:06.460 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:38:06.465 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 54ms reading results.
2025-08-29 19:38:06.469 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:38:06.473 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 19:38:06.480 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:38:06.483 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:38:06.484 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:38:06.485 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 19:38:06.485 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 19:38:06.486 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 19:38:06.487 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:38:06.488 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 19:38:06.491 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:38:06.492 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 19:38:06.493 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 19:38:06.493 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 19:38:06.502 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 19:38:06.513 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 19:38:06.516 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 19:38:06.600 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 19:38:06.616 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 19:38:06.619 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 19:38:06.620 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 19:38:06.627 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 19:38:07.443 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 19:38:07.456 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 19:38:07.468 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 19:38:07.472 +03:00 [DBG] Connection id "0HNF739MVQIHE" completed keep alive response.
2025-08-29 19:38:07.476 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:38:07.480 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 19:38:07.483 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 19:38:07.486 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 200 null application/json; charset=utf-8 1659.8189ms
2025-08-29 19:44:05.346 +03:00 [INF] This is a test log to file!
2025-08-29 19:44:05.648 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:44:05.657 +03:00 [INF] API configured successfully.
2025-08-29 19:44:05.822 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:44:06.356 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:44:06.407 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:44:06.416 +03:00 [INF] Registered 10 endpoints in 990 milliseconds.
2025-08-29 19:44:06.423 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:44:06.425 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:44:06.425 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:44:06.448 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:44:06.475 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:44:06.476 +03:00 [DBG] Hosting starting
2025-08-29 19:44:06.489 +03:00 [DBG] Middleware loaded
2025-08-29 19:44:06.492 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:44:06.495 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:44:06.565 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:44:06.567 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:44:06.570 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:44:06.599 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:44:06.647 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:44:06.649 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:44:06.656 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:44:06.657 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:44:06.659 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:44:06.659 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:44:06.685 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:44:06.711 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:44:06.838 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:44:06.840 +03:00 [INF] Hosting environment: Development
2025-08-29 19:44:06.841 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:44:06.842 +03:00 [DBG] Hosting started
2025-08-29 19:44:14.558 +03:00 [DBG] Connection id "0HNF73D4TI7BE" received FIN.
2025-08-29 19:44:14.564 +03:00 [DBG] Connection id "0HNF73D4TI7BE" accepted.
2025-08-29 19:44:14.566 +03:00 [DBG] Connection id "0HNF73D4TI7BE" started.
2025-08-29 19:44:14.568 +03:00 [DBG] Connection id "0HNF73D4TI7BF" accepted.
2025-08-29 19:44:14.572 +03:00 [DBG] Connection id "0HNF73D4TI7BF" started.
2025-08-29 19:44:14.646 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:44:14.653 +03:00 [DBG] Connection id "0HNF73D4TI7BE" stopped.
2025-08-29 19:44:14.657 +03:00 [DBG] Connection id "0HNF73D4TI7BE" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:44:14.672 +03:00 [DBG] Connection 0HNF73D4TI7BF established using the following protocol: "Tls13"
2025-08-29 19:44:14.699 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/databases/sex/DESKTOP-QCK8UI5\SQLEXPRESS - null null
2025-08-29 19:44:14.741 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/databases/sex/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 19:44:14.746 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}' with route pattern 'api/setup/databases/{type}/{serverName}' is valid for the request path '/api/setup/databases/sex/DESKTOP-QCK8UI5\SQLEXPRESS'
2025-08-29 19:44:14.758 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 19:44:14.786 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 19:44:14.832 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:44:14.928 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/databases/{type}/{serverName}'
2025-08-29 19:44:14.929 +03:00 [DBG] Connection id "0HNF73D4TI7BF" completed keep alive response.
2025-08-29 19:44:14.932 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:44:14.934 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/databases/sex/DESKTOP-QCK8UI5\SQLEXPRESS - 400 null application/problem+json; charset=utf-8 239.3074ms
2025-08-29 19:46:41.243 +03:00 [INF] This is a test log to file!
2025-08-29 19:46:41.544 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:46:41.553 +03:00 [INF] API configured successfully.
2025-08-29 19:46:41.732 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:46:42.268 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:46:42.300 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:46:42.311 +03:00 [INF] Registered 10 endpoints in 977 milliseconds.
2025-08-29 19:46:42.316 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:46:42.318 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:46:42.319 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:46:42.350 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:46:42.377 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:46:42.378 +03:00 [DBG] Hosting starting
2025-08-29 19:46:42.389 +03:00 [DBG] Middleware loaded
2025-08-29 19:46:42.391 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:46:42.393 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:46:42.457 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:46:42.458 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:46:42.461 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:46:42.486 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:46:42.545 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:46:42.548 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:46:42.549 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:46:42.549 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:46:42.550 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:46:42.551 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:46:42.557 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:46:42.563 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:46:42.641 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:46:42.642 +03:00 [INF] Hosting environment: Development
2025-08-29 19:46:42.643 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:46:42.644 +03:00 [DBG] Hosting started
2025-08-29 19:46:49.990 +03:00 [DBG] Connection id "0HNF73EJ7SJA9" received FIN.
2025-08-29 19:46:49.996 +03:00 [DBG] Connection id "0HNF73EJ7SJA9" accepted.
2025-08-29 19:46:49.997 +03:00 [DBG] Connection id "0HNF73EJ7SJA9" started.
2025-08-29 19:46:49.998 +03:00 [DBG] Connection id "0HNF73EJ7SJAA" accepted.
2025-08-29 19:46:50.000 +03:00 [DBG] Connection id "0HNF73EJ7SJAA" started.
2025-08-29 19:46:50.061 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:46:50.068 +03:00 [DBG] Connection id "0HNF73EJ7SJA9" stopped.
2025-08-29 19:46:50.071 +03:00 [DBG] Connection id "0HNF73EJ7SJA9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:46:50.085 +03:00 [DBG] Connection 0HNF73EJ7SJAA established using the following protocol: "Tls13"
2025-08-29 19:46:50.111 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/Postgres - null null
2025-08-29 19:46:50.147 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/Postgres'
2025-08-29 19:46:50.150 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/Postgres'
2025-08-29 19:46:50.152 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:46:50.187 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:46:50.240 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:46:50.274 +03:00 [ERR] Unsupported provider type '"Postgres"' requested in CreateStandalone
2025-08-29 19:46:50.383 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:46:50.436 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotImplementedException: Unsupported provider type
   at NaturalToQuery.Infrastructure.Factory.DbProviderFactory.HandleUnsupportedProvider(ProviderType type, String method) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Factory\DbProviderFactory.cs:line 55
   at NaturalToQuery.Infrastructure.Factory.DbProviderFactory.CreateStandalone(ProviderType Type) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Factory\DbProviderFactory.cs:line 48
   at NaturalToQuery.Application.Services.SetupService.GetAvailableServersAsync(ProviderType type, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 49
   at NaturalToQuery.Api.Controllers.Setup.GetAvailableServers.HandleAsync(GetAvailableServersRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\AvailableServers.cs:line 25
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:46:50.445 +03:00 [ERR] Error occurred.
2025-08-29 19:46:50.454 +03:00 [DBG] Connection id "0HNF73EJ7SJAA" completed keep alive response.
2025-08-29 19:46:50.456 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:46:50.458 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/Postgres - 500 null application/json; charset=utf-8 351.3756ms
2025-08-29 19:48:14.835 +03:00 [INF] This is a test log to file!
2025-08-29 19:48:15.163 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:48:15.171 +03:00 [INF] API configured successfully.
2025-08-29 19:48:15.296 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:48:15.870 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:48:15.919 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:48:15.927 +03:00 [INF] Registered 10 endpoints in 976 milliseconds.
2025-08-29 19:48:15.934 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:48:15.937 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:48:15.938 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:48:15.970 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:48:16.009 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:48:16.023 +03:00 [DBG] Hosting starting
2025-08-29 19:48:16.047 +03:00 [DBG] Middleware loaded
2025-08-29 19:48:16.050 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:48:16.055 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:48:16.144 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:48:16.145 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:48:16.147 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:48:16.175 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:48:16.217 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:48:16.218 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:48:16.219 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:48:16.220 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:48:16.220 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:48:16.221 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:48:16.227 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:48:16.235 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:48:16.347 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:48:16.348 +03:00 [INF] Hosting environment: Development
2025-08-29 19:48:16.349 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:48:16.350 +03:00 [DBG] Hosting started
2025-08-29 19:48:16.995 +03:00 [DBG] Connection id "0HNF73FD5K658" received FIN.
2025-08-29 19:48:17.000 +03:00 [DBG] Connection id "0HNF73FD5K658" accepted.
2025-08-29 19:48:17.002 +03:00 [DBG] Connection id "0HNF73FD5K658" started.
2025-08-29 19:48:17.005 +03:00 [DBG] Connection id "0HNF73FD5K659" accepted.
2025-08-29 19:48:17.007 +03:00 [DBG] Connection id "0HNF73FD5K659" started.
2025-08-29 19:48:17.084 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:48:17.095 +03:00 [DBG] Connection id "0HNF73FD5K658" stopped.
2025-08-29 19:48:17.099 +03:00 [DBG] Connection id "0HNF73FD5K658" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:48:17.114 +03:00 [DBG] Connection 0HNF73FD5K659 established using the following protocol: "Tls13"
2025-08-29 19:48:17.149 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/Postgres - null null
2025-08-29 19:48:17.190 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/Postgres'
2025-08-29 19:48:17.192 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/Postgres'
2025-08-29 19:48:17.194 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:48:17.219 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:48:17.254 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:48:17.283 +03:00 [ERR] Unsupported provider type '"Postgres"' requested in CreateStandalone
2025-08-29 19:48:17.368 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:48:17.414 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotImplementedException: Unsupported provider type
   at NaturalToQuery.Infrastructure.Factory.DbProviderFactory.HandleUnsupportedProvider(ProviderType type, String method) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Factory\DbProviderFactory.cs:line 55
   at NaturalToQuery.Infrastructure.Factory.DbProviderFactory.CreateStandalone(ProviderType Type) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Infrastructure\Factory\DbProviderFactory.cs:line 48
   at NaturalToQuery.Application.Services.SetupService.GetAvailableServersAsync(ProviderType type, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToQuery.Application\Services\SetupService.cs:line 49
   at NaturalToQuery.Api.Controllers.Setup.GetAvailableServers.HandleAsync(GetAvailableServersRequest req, CancellationToken ct) in C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\Controllers\Setup\AvailableServers.cs:line 25
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-29 19:48:17.424 +03:00 [ERR] Error occurred.
2025-08-29 19:48:17.433 +03:00 [DBG] Connection id "0HNF73FD5K659" completed keep alive response.
2025-08-29 19:48:17.436 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:48:17.439 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/Postgres - 500 null application/json; charset=utf-8 299.0006ms
2025-08-29 19:49:18.151 +03:00 [INF] This is a test log to file!
2025-08-29 19:49:18.469 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:49:18.478 +03:00 [INF] API configured successfully.
2025-08-29 19:49:18.604 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:49:19.019 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:49:19.049 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:49:19.058 +03:00 [INF] Registered 10 endpoints in 821 milliseconds.
2025-08-29 19:49:19.066 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:49:19.069 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:49:19.070 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:49:19.092 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:49:19.119 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:49:19.120 +03:00 [DBG] Hosting starting
2025-08-29 19:49:19.132 +03:00 [DBG] Middleware loaded
2025-08-29 19:49:19.134 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:49:19.136 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:49:19.198 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:49:19.199 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:49:19.201 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:49:19.228 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:49:19.311 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:49:19.313 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:49:19.315 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:49:19.316 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:49:19.316 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:49:19.317 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:49:19.323 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:49:19.334 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:49:19.416 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 19:49:19.418 +03:00 [INF] Hosting environment: Development
2025-08-29 19:49:19.418 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 19:49:19.419 +03:00 [DBG] Hosting started
2025-08-29 19:49:32.274 +03:00 [DBG] Connection id "0HNF73G3JHL9M" received FIN.
2025-08-29 19:49:32.278 +03:00 [DBG] Connection id "0HNF73G3JHL9M" accepted.
2025-08-29 19:49:32.280 +03:00 [DBG] Connection id "0HNF73G3JHL9M" started.
2025-08-29 19:49:32.281 +03:00 [DBG] Connection id "0HNF73G3JHL9N" accepted.
2025-08-29 19:49:32.282 +03:00 [DBG] Connection id "0HNF73G3JHL9N" started.
2025-08-29 19:49:32.363 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 19:49:32.368 +03:00 [DBG] Connection id "0HNF73G3JHL9M" stopped.
2025-08-29 19:49:32.371 +03:00 [DBG] Connection id "0HNF73G3JHL9M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 19:49:32.383 +03:00 [DBG] Connection 0HNF73G3JHL9N established using the following protocol: "Tls13"
2025-08-29 19:49:32.407 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7202/api/setup/servers/Postgres - null null
2025-08-29 19:49:32.436 +03:00 [DBG] 1 candidate(s) found for the request path '/api/setup/servers/Postgres'
2025-08-29 19:49:32.438 +03:00 [DBG] Endpoint 'HTTP: GET api/setup/servers/{type}' with route pattern 'api/setup/servers/{type}' is valid for the request path '/api/setup/servers/Postgres'
2025-08-29 19:49:32.440 +03:00 [DBG] Request matched endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:49:32.463 +03:00 [INF] Executing endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:49:32.498 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:49:32.594 +03:00 [INF] Executed endpoint 'HTTP: GET api/setup/servers/{type}'
2025-08-29 19:49:32.597 +03:00 [DBG] Connection id "0HNF73G3JHL9N" completed keep alive response.
2025-08-29 19:49:32.600 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:49:32.602 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7202/api/setup/servers/Postgres - 400 null application/problem+json; charset=utf-8 198.7936ms
2025-08-29 19:54:00.312 +03:00 [INF] This is a test log to file!
2025-08-29 19:54:00.563 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 19:54:00.570 +03:00 [INF] API configured successfully.
2025-08-29 19:54:00.689 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 19:54:01.117 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 19:54:01.159 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 19:54:01.169 +03:00 [INF] Registered 10 endpoints in 769 milliseconds.
2025-08-29 19:54:01.175 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 19:54:01.178 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:54:01.179 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 19:54:01.205 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 19:54:01.231 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 19:54:01.232 +03:00 [DBG] Hosting starting
2025-08-29 19:54:01.242 +03:00 [DBG] Middleware loaded
2025-08-29 19:54:01.244 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 19:54:01.246 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 19:54:01.307 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 19:54:01.309 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 19:54:01.310 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 19:54:01.338 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 19:54:01.376 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 19:54:01.378 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 19:54:01.379 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 19:54:01.379 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 19:54:01.380 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 19:54:01.380 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 19:54:01.385 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 19:54:01.390 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 21:53:12.903 +03:00 [INF] This is a test log to file!
2025-08-29 21:53:13.480 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 21:53:13.495 +03:00 [INF] API configured successfully.
2025-08-29 21:53:13.775 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 21:53:14.436 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 21:53:14.483 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 21:53:14.497 +03:00 [INF] Registered 10 endpoints in 1,399 milliseconds.
2025-08-29 21:53:14.507 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 21:53:14.516 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 21:53:14.518 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 21:53:14.571 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 21:53:14.613 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 21:53:14.614 +03:00 [DBG] Hosting starting
2025-08-29 21:53:14.625 +03:00 [DBG] Middleware loaded
2025-08-29 21:53:14.628 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 21:53:14.629 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 21:53:14.721 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 21:53:14.723 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 21:53:14.725 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 21:53:14.763 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 21:53:14.835 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 21:53:14.837 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 21:53:14.838 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 21:53:14.839 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 21:53:14.840 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 21:53:14.841 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 21:53:14.846 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 21:53:14.852 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 21:53:14.875 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 21:53:14.877 +03:00 [INF] Hosting environment: Development
2025-08-29 21:53:14.877 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 21:53:14.878 +03:00 [DBG] Hosting started
2025-08-29 21:54:09.774 +03:00 [INF] This is a test log to file!
2025-08-29 21:54:10.047 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 21:54:10.054 +03:00 [INF] API configured successfully.
2025-08-29 21:54:10.169 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 21:54:10.575 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 21:54:10.602 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 21:54:10.609 +03:00 [INF] Registered 10 endpoints in 739 milliseconds.
2025-08-29 21:54:10.615 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 21:54:10.617 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 21:54:10.617 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 21:54:10.638 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 21:54:10.666 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 21:54:10.667 +03:00 [DBG] Hosting starting
2025-08-29 21:54:10.680 +03:00 [DBG] Middleware loaded
2025-08-29 21:54:10.684 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 21:54:10.689 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 21:54:10.779 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 21:54:10.781 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 21:54:10.783 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 21:54:10.815 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 21:54:10.899 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 21:54:10.901 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 21:54:10.902 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 21:54:10.903 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 21:54:10.904 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 21:54:10.905 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 21:54:10.910 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 21:54:10.921 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 21:54:11.006 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 21:54:11.007 +03:00 [INF] Hosting environment: Development
2025-08-29 21:54:11.009 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 21:54:11.009 +03:00 [DBG] Hosting started
2025-08-29 21:54:20.775 +03:00 [DBG] Connection id "0HNF75LRBEMCJ" received FIN.
2025-08-29 21:54:20.782 +03:00 [DBG] Connection id "0HNF75LRBEMCJ" accepted.
2025-08-29 21:54:20.784 +03:00 [DBG] Connection id "0HNF75LRBEMCJ" started.
2025-08-29 21:54:20.785 +03:00 [DBG] Connection id "0HNF75LRBEMCK" accepted.
2025-08-29 21:54:20.786 +03:00 [DBG] Connection id "0HNF75LRBEMCK" started.
2025-08-29 21:54:20.863 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 21:54:20.869 +03:00 [DBG] Connection id "0HNF75LRBEMCJ" stopped.
2025-08-29 21:54:20.872 +03:00 [DBG] Connection id "0HNF75LRBEMCJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 21:54:20.884 +03:00 [DBG] Connection 0HNF75LRBEMCK established using the following protocol: "Tls13"
2025-08-29 21:54:20.922 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 21:54:20.961 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 21:54:20.963 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 21:54:20.966 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:54:21.004 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:54:21.071 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 21:54:21.076 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 21:54:21.117 +03:00 [DBG] Connection id "0HNF75LRBEMCK", Request id "0HNF75LRBEMCK:00000001": started reading request body.
2025-08-29 21:54:21.119 +03:00 [DBG] Connection id "0HNF75LRBEMCK", Request id "0HNF75LRBEMCK:00000001": done reading request body.
2025-08-29 21:54:21.150 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 21:54:21.207 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 21:54:21.244 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 21:54:21.521 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 21:54:21.551 +03:00 [DBG] Creating DbConnection.
2025-08-29 21:54:21.564 +03:00 [DBG] Created DbConnection. (12ms).
2025-08-29 21:54:21.567 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 21:54:21.585 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:54:21.592 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 21:54:21.597 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-08-29 21:54:21.601 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-08-29 21:54:21.608 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:54:21.632 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:54:21.667 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 21:54:21.690 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:54:21.695 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 57ms reading results.
2025-08-29 21:54:21.698 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:54:21.701 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 21:54:21.710 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 21:54:21.713 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 21:54:21.714 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:54:21.715 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 21:54:21.716 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 21:54:21.717 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 21:54:21.718 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:54:21.720 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:54:21.723 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:54:21.724 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 21:54:21.725 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:54:21.726 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (0ms).
2025-08-29 21:54:21.741 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 21:54:21.764 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 21:54:21.767 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 21:54:21.882 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 21:54:21.900 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 21:54:21.904 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 21:54:21.905 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 21:54:21.912 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 21:54:22.906 +03:00 [INF] Groq API responded with status: "OK"
2025-08-29 21:54:55.921 +03:00 [INF] Successfully converted natural language to SQL query
2025-08-29 21:54:55.932 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:54:55.936 +03:00 [DBG] Connection id "0HNF75LRBEMCK" completed keep alive response.
2025-08-29 21:54:55.940 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 21:54:56.000 +03:00 [DBG] Disposing connection to database 'main' on server 'schema_cache.db'.
2025-08-29 21:54:56.002 +03:00 [DBG] Disposed connection to database 'main' on server 'schema_cache.db' (2ms).
2025-08-29 21:54:56.004 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 200 null application/json; charset=utf-8 35087.7713ms
2025-08-29 21:55:19.647 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 21:55:19.650 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 21:55:19.651 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 21:55:19.652 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:55:19.654 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:55:19.680 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 21:55:19.681 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 21:55:19.682 +03:00 [DBG] Connection id "0HNF75LRBEMCK", Request id "0HNF75LRBEMCK:00000002": started reading request body.
2025-08-29 21:55:19.683 +03:00 [DBG] Connection id "0HNF75LRBEMCK", Request id "0HNF75LRBEMCK:00000002": done reading request body.
2025-08-29 21:55:19.685 +03:00 [INF] Executed endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:55:19.687 +03:00 [DBG] Connection id "0HNF75LRBEMCK" completed keep alive response.
2025-08-29 21:55:19.688 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 21:55:19.689 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - 200 null application/json; charset=utf-8 41.9197ms
2025-08-29 21:55:32.553 +03:00 [INF] This is a test log to file!
2025-08-29 21:55:32.925 +03:00 [INF] Shared Kernal configured successfully.
2025-08-29 21:55:32.935 +03:00 [INF] API configured successfully.
2025-08-29 21:55:33.068 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-29 21:55:33.587 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 21:55:33.620 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 21:55:33.634 +03:00 [INF] Registered 10 endpoints in 980 milliseconds.
2025-08-29 21:55:33.642 +03:00 [DBG] 'ProfilesDbContext' disposed.
2025-08-29 21:55:33.645 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 21:55:33.646 +03:00 [INF] Infrastructure configured successfully.
2025-08-29 21:55:33.669 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-08-29 21:55:33.698 +03:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-29 21:55:33.700 +03:00 [DBG] Hosting starting
2025-08-29 21:55:33.711 +03:00 [DBG] Middleware loaded
2025-08-29 21:55:33.714 +03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16521 B).
2025-08-29 21:55:33.716 +03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-08-29 21:55:33.778 +03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-08-29 21:55:33.781 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-08-29 21:55:33.783 +03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-08-29 21:55:33.813 +03:00 [WRN] The ASP.NET Core developer certificate is not trusted. For information about trusting the ASP.NET Core developer certificate, see https://aka.ms/aspnet/https-trust-dev-cert
2025-08-29 21:55:33.874 +03:00 [DBG] Connection id "0HNF75MH4IRB3" received FIN.
2025-08-29 21:55:33.881 +03:00 [DBG] Connection id "0HNF75MH4IRB3" accepted.
2025-08-29 21:55:33.883 +03:00 [DBG] Connection id "0HNF75MH4IRB3" started.
2025-08-29 21:55:33.885 +03:00 [DBG] Connection id "0HNF75MH4IRB4" accepted.
2025-08-29 21:55:33.887 +03:00 [DBG] Connection id "0HNF75MH4IRB4" started.
2025-08-29 21:55:33.890 +03:00 [INF] Now listening on: https://localhost:7202
2025-08-29 21:55:33.892 +03:00 [INF] Now listening on: http://localhost:5000
2025-08-29 21:55:33.893 +03:00 [DBG] Loaded hosting startup assembly NaturalToQuery.Api
2025-08-29 21:55:33.895 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-08-29 21:55:33.896 +03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-08-29 21:55:33.897 +03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-08-29 21:55:33.975 +03:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-08-29 21:55:33.978 +03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 21:55:34.000 +03:00 [DBG] Connection id "0HNF75MH4IRB3" stopped.
2025-08-29 21:55:34.004 +03:00 [DBG] Connection id "0HNF75MH4IRB3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-08-29 21:55:34.007 +03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2025-08-29 21:55:34.011 +03:00 [DBG] Connection 0HNF75MH4IRB4 established using the following protocol: "Tls13"
2025-08-29 21:55:34.042 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7202/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert - application/json 73
2025-08-29 21:55:34.049 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-29 21:55:34.082 +03:00 [INF] Hosting environment: Development
2025-08-29 21:55:34.083 +03:00 [INF] Content root path: C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql
2025-08-29 21:55:34.097 +03:00 [DBG] Hosting started
2025-08-29 21:55:34.163 +03:00 [DBG] 1 candidate(s) found for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 21:55:34.164 +03:00 [DBG] Endpoint 'HTTP: POST api/query/{profileId}/convert' with route pattern 'api/query/{profileId}/convert' is valid for the request path '/api/query/f8ddc42e-3263-4dd8-a6b5-691d13278325/convert'
2025-08-29 21:55:34.167 +03:00 [DBG] Request matched endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:55:34.194 +03:00 [INF] Executing endpoint 'HTTP: POST api/query/{profileId}/convert'
2025-08-29 21:55:34.234 +03:00 [DBG] Entity Framework Core 9.0.8 initialized 'ProfilesDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:9.0.8' with options: None
2025-08-29 21:55:34.237 +03:00 [INF] Groq API key configured for HttpClient
2025-08-29 21:55:34.267 +03:00 [DBG] Connection id "0HNF75MH4IRB4", Request id "0HNF75MH4IRB4:00000001": started reading request body.
2025-08-29 21:55:34.269 +03:00 [DBG] Connection id "0HNF75MH4IRB4", Request id "0HNF75MH4IRB4:00000001": done reading request body.
2025-08-29 21:55:34.301 +03:00 [INF] Converting NL to SQL for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 21:55:34.359 +03:00 [DBG] Compiling query expression: 
'DbSet<Profile>()
    .Include(e => e.Queries)
    .FirstOrDefault(e => e.Id.Equals(__id_0))'
2025-08-29 21:55:34.394 +03:00 [DBG] Including navigation: 'Profile.Queries'.
2025-08-29 21:55:34.623 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Profile>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Profile>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Profile.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Profile.CacheFile (string) MaxLength(500), 1], [Property: Profile.CreatedUtc (DateTimeOffset) Required, 2], [Property: Profile.Name (string) Required MaxLength(200), 3], [Property: Profile.Provider (ProviderType) Required, 4], [Property: Profile.SecretRef (string) Required, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: Query.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Query.ProfileId (Guid) Required FK Index, 7], [Property: Query.ResultJson (string) Required, 8], [Property: Query.SqlQuery (string) Required, 9], [Property: Query.TimestampUtc (DateTime) Required, 10], [Property: Query.UserQuery (string) Required, 11] }
                3 -> 6
            SELECT p0.Id, p0.CacheFile, p0.CreatedUtc, p0.Name, p0.Provider, p0.SecretRef, q.Id, q.ProfileId, q.ResultJson, q.SqlQuery, q.TimestampUtc, q.UserQuery
            FROM 
            (
                SELECT TOP(1) p.Id, p.CacheFile, p.CreatedUtc, p.Name, p.Provider, p.SecretRef
                FROM Profiles AS p
                WHERE p.Id == @__id_0
            ) AS p0
            LEFT JOIN Queries AS q ON p0.Id == q.ProfileId
            ORDER BY p0.Id ASC, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            resultContext.Values == null ? 
            {
                Profile entity;
                entity = 
                {
                    MaterializationContext materializationContext1;
                    IEntityType entityType1;
                    Profile instance1;
                    InternalEntityEntry entry1;
                    bool hasNullKey1;
                    materializationContext1 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance1 = default(Profile);
                    entry1 = queryContext.TryGetEntry(
                        key: [LIFTABLE Constant: Key: Profile.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindPrimaryKey()], 
                        keyValues: new object[]{ (object)dataReader.GetGuid(0) }, 
                        throwOnNullKey: True, 
                        hasNullKey: hasNullKey1);
                    !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                    {
                        entityType1 = entry1.EntityType;
                        return instance1 = (Profile)entry1.Entity;
                    } : 
                    {
                        ISnapshot shadowSnapshot1;
                        shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType1 = [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")];
                        instance1 = switch (entityType1)
                        {
                            case [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]: 
                                {
                                    return 
                                    {
                                        Profile instance;
                                        instance = new Profile();
                                        instance.<Id>k__BackingField = dataReader.GetGuid(0);
                                        instance.<CacheFile>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                        instance.<CreatedUtc>k__BackingField = dataReader.GetFieldValue<DateTimeOffset>(2);
                                        instance.<Name>k__BackingField = dataReader.GetString(3);
                                        instance.<Provider>k__BackingField = Invoke(((EnumToNumberConverter<ProviderType, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Profile.Provider (ProviderType) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindProperty("Provider")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(4));
                                        instance.<SecretRef>k__BackingField = dataReader.GetString(5);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext1.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: TrackAll, 
                                            structuralType: [LIFTABLE Constant: EntityType: Profile | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(Profile)
                        }
                        ;
                        entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                            entityType: entityType1, 
                            entity: instance1, 
                            snapshot: shadowSnapshot1);
                        return instance1;
                    } : default(void);
                    return instance1;
                };
                resultContext.Values = new object[]{ entity };
                ShaperProcessingExpressionVisitor.InitializeIncludeCollection<Profile, Profile>(
                    collectionId: 0, 
                    queryContext: queryContext, 
                    dbDataReader: dataReader, 
                    resultCoordinator: resultCoordinator, 
                    entity: (Profile)(resultContext.Values[0]), 
                    parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                    navigation: [LIFTABLE Constant: Navigation: Profile.Queries (List<Query>) Collection ToDependent Query Inverse: Profile | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries")], 
                    clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()], 
                    trackingQuery: True, 
                    setLoaded: True);
            } : default(void);
            ShaperProcessingExpressionVisitor.PopulateIncludeCollection<Profile, Query>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(Guid?)dataReader.GetGuid(0) }], 
                selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(6) ? default(Guid?) : (Guid?)dataReader.GetGuid(6) }], 
                parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (Guid)left == (Guid)right }], 
                innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
                {
                    Query entity;
                    entity = 
                    {
                        MaterializationContext materializationContext2;
                        IEntityType entityType2;
                        Query instance2;
                        InternalEntityEntry entry2;
                        bool hasNullKey2;
                        materializationContext2 = new MaterializationContext(
                            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                            queryContext.Context
                        );
                        instance2 = default(Query);
                        entry2 = queryContext.TryGetEntry(
                            key: [LIFTABLE Constant: Key: Query.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindPrimaryKey()], 
                            keyValues: new object[]{ dataReader.IsDBNull(6) ? default(object) : (object)dataReader.GetGuid(6) }, 
                            throwOnNullKey: False, 
                            hasNullKey: hasNullKey2);
                        !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                        {
                            entityType2 = entry2.EntityType;
                            return instance2 = (Query)entry2.Entity;
                        } : 
                        {
                            ISnapshot shadowSnapshot2;
                            shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                            entityType2 = [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")];
                            instance2 = switch (entityType2)
                            {
                                case [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]: 
                                    {
                                        return 
                                        {
                                            Query instance;
                                            instance = new Query();
                                            instance.<Id>k__BackingField = dataReader.IsDBNull(6) ? default(Guid) : dataReader.GetGuid(6);
                                            instance.<ProfileId>k__BackingField = dataReader.IsDBNull(7) ? default(Guid) : dataReader.GetGuid(7);
                                            instance.<ResultJson>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                            instance.<SqlQuery>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                            instance.<TimestampUtc>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime) : dataReader.GetDateTime(10);
                                            instance.<UserQuery>k__BackingField = dataReader.IsDBNull(11) ? default(string) : dataReader.GetString(11);
                                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                                context: materializationContext2.Context, 
                                                entity: instance, 
                                                queryTrackingBehavior: TrackAll, 
                                                structuralType: [LIFTABLE Constant: EntityType: Query | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query")]) : default(void);
                                            return instance;
                                        }}
                                default: 
                                    default(Query)
                            }
                            ;
                            entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                                entityType: entityType2, 
                                entity: instance2, 
                                snapshot: shadowSnapshot2);
                            return instance2;
                        } : default(void);
                        return instance2;
                    };
                    return entity;
                }, 
                inverseNavigation: [LIFTABLE Constant: Navigation: Query.Profile (Profile) ToPrincipal Profile Inverse: Queries | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Queries.Query").FindNavigation("Profile")], 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    [LIFTABLE Constant: ClrICollectionAccessor<Profile, List<Query>, Query> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("NaturalToQuery.Core.Contributers.Entities.Profiles.Profile").FindNavigation("Queries").GetCollectionAccessor()].Add(
                        entity: namelessParameter{10}, 
                        value: namelessParameter{11}, 
                        forMaterialization: True);
                    return namelessParameter{11}.<Profile>k__BackingField = namelessParameter{10};
                }, 
                trackingQuery: True);
            return IsTrue(resultCoordinator.ResultReady)
             ? (Profile)(resultContext.Values[0]) : default(Profile);
        }, 
        contextType: NaturalToQuery.Infrastructure.Persistence.ProfilesDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-08-29 21:55:34.669 +03:00 [DBG] Creating DbConnection.
2025-08-29 21:55:34.680 +03:00 [DBG] Created DbConnection. (10ms).
2025-08-29 21:55:34.684 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 21:55:34.695 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:55:34.699 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 21:55:34.704 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-08-29 21:55:34.707 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-08-29 21:55:34.713 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:55:34.729 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:55:34.763 +03:00 [DBG] Context 'ProfilesDbContext' started tracking 'Profile' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-08-29 21:55:34.786 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:55:34.793 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 57ms reading results.
2025-08-29 21:55:34.796 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:55:34.800 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (3ms).
2025-08-29 21:55:34.809 +03:00 [INF] Fetching connection string for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 21:55:34.812 +03:00 [DBG] Opening connection to database 'main' on server 'schema_cache.db'.
2025-08-29 21:55:34.813 +03:00 [DBG] Opened connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:55:34.814 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-29 21:55:34.814 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-29 21:55:34.815 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-08-29 21:55:34.817 +03:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:55:34.818 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "p0"."Id", "p0"."CacheFile", "p0"."CreatedUtc", "p0"."Name", "p0"."Provider", "p0"."SecretRef", "q"."Id", "q"."ProfileId", "q"."ResultJson", "q"."SqlQuery", "q"."TimestampUtc", "q"."UserQuery"
FROM (
    SELECT "p"."Id", "p"."CacheFile", "p"."CreatedUtc", "p"."Name", "p"."Provider", "p"."SecretRef"
    FROM "Profiles" AS "p"
    WHERE "p"."Id" = @__id_0
    LIMIT 1
) AS "p0"
LEFT JOIN "Queries" AS "q" ON "p0"."Id" = "q"."ProfileId"
ORDER BY "p0"."Id"
2025-08-29 21:55:34.821 +03:00 [DBG] Closing data reader to 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:55:34.822 +03:00 [DBG] A data reader for 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db' is being disposed after spending 1ms reading results.
2025-08-29 21:55:34.823 +03:00 [DBG] Closing connection to database 'main' on server 'C:\Users\Zyad\Documents\NaturalToSql\NaturalToSql\schema_cache.db'.
2025-08-29 21:55:34.824 +03:00 [DBG] Closed connection to database 'main' on server 'schema_cache.db' (1ms).
2025-08-29 21:55:34.833 +03:00 [DBG] Fetched secret for profile "f8ddc42e-3263-4dd8-a6b5-691d13278325"
2025-08-29 21:55:34.846 +03:00 [DBG] Fetching schema for Profile "f8ddc42e-3263-4dd8-a6b5-691d13278325", ForceRefresh=false
2025-08-29 21:55:34.849 +03:00 [INF] Fetching schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory (ForceRefresh=false)
2025-08-29 21:55:34.964 +03:00 [INF] Loaded schema for DESKTOP-QCK8UI5\SQLEXPRESS|ProductInventory from cache file
2025-08-29 21:55:34.981 +03:00 [INF] Converting natural language to SQL. User query: Show me all products
2025-08-29 21:55:34.983 +03:00 [DBG] Generated prompt with system message, 2 examples, and user query
2025-08-29 21:55:34.984 +03:00 [DBG] Generated prompt with 6 messages
2025-08-29 21:55:34.991 +03:00 [DBG] Request payload prepared for Groq API
2025-08-29 21:55:40.497 +03:00 [INF] Groq API responded with status: "OK"
